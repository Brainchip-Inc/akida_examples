<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CNN conversion flow tutorial &mdash; Akida Examples  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Advanced CNN2SNN tutorial" href="plot_1_advanced_cnn2snn.html" />
    <link rel="prev" title="YOLO/PASCAL-VOC detection tutorial" href="../general/plot_6_voc_yolo_detection.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #78b3ff" >
            <a href="../../index.html">
            <img src="../../_static/akida.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                MetaTF 2.1.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#quick-installation">Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#running-examples">Running examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/user_guide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/getting_started.html">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/getting_started.html#for-beginners">For beginners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/getting_started.html#for-users-familiar-with-deep-learning">For users familiar with deep-learning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/akida.html">Akida user guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#akida-layers">Akida layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#input-format">Input Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#a-versatile-machine-learning-framework">A versatile machine learning framework</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#the-sequential-model">The Sequential model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#specifying-the-model">Specifying the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#accessing-layer-parameters-and-weights">Accessing layer parameters and weights</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#inference">Inference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#saving-and-loading">Saving and loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#input-layer-types">Input layer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#data-processing-layer-types">Data-Processing layer types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#model-hardware-mapping">Model Hardware Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#devices">Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#model-mapping">Model mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#advanced-mapping-details-and-hardware-devices-usage">Advanced Mapping Details and Hardware Devices Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#performances-measurement">Performances measurement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#id1">Using Akida Edge learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#learning-constraints">Learning constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#compiling-a-layer">Compiling a layer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/cnn2snn.html">CNN2SNN toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#conversion-workflow">Conversion workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#typical-training-scenario">Typical training scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#design-compatibility-constraints">Design compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#quantization-compatibility-constraints">Quantization compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#command-line-interface">Command-line interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#layers-considerations">Layers Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#supported-layer-types">Supported layer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#cnn2snn-quantization-aware-layers">CNN2SNN Quantization-aware layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#training-only-layers">Training-Only Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#first-layers">First Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#id6">Final Layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/akida_models.html">Akida models zoo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-creation">Command-line interface for model creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-training">Command-line interface for model training</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#cifar10-training-and-tuning">CIFAR10 training and tuning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#utk-face-training">UTK Face training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#kws-training">KWS training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#yolo-training">YOLO training</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-evaluation">Command-line interface for model evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#id1">Layer Blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#conv-block"><code class="docutils literal notranslate"><span class="pre">conv_block</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#dense-block"><code class="docutils literal notranslate"><span class="pre">dense_block</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#separable-conv-block"><code class="docutils literal notranslate"><span class="pre">separable_conv_block</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hw_constraints.html">Hardware constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#inputconvolutional">InputConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#convolutional">Convolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#separableconvolutional">SeparableConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#fullyconnected">FullyConnected</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/compatibility.html">Akida versions compatibility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/compatibility.html#upgrading-models-with-legacy-quantizers">Upgrading models with legacy quantizers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/api_reference.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/akida_apis.html">Akida runtime</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#model">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#layer">Layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id1">Layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#mapping">Mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#inputdata">InputData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#inputconvolutional">InputConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#fullyconnected">FullyConnected</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#convolutional">Convolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#separableconvolutional">SeparableConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#concat">Concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#layer-parameters">Layer parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#layertype">LayerType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#padding">Padding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#pooltype">PoolType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#learningtype">LearningType</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#sequence">Sequence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id2">Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#backendtype">BackendType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#pass">Pass</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#device">Device</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id3">Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#hwversion">HwVersion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#hwdevice">HWDevice</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id4">HWDevice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#socdriver">SocDriver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#clockmode">ClockMode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#powermeter">PowerMeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#np">NP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#tools">Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#sparsity">Sparsity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#compatibility">Compatibility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html">CNN2SNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#tool-functions">Tool functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantize">quantize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantize-layer">quantize_layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#convert">convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#check-model-compatibility">check_model_compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#load-quantized-model">load_quantized_model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#transforms">Transforms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizers">Quantizers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#weightquantizer">WeightQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#linearweightquantizer">LinearWeightQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#stdweightquantizer">StdWeightQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#stdperaxisquantizer">StdPerAxisQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#maxquantizer">MaxQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#maxperaxisquantizer">MaxPerAxisQuantizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantized-layers">Quantized layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizedconv2d">QuantizedConv2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizeddense">QuantizedDense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizedseparableconv2d">QuantizedSeparableConv2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizedactivation">QuantizedActivation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#activationdiscreterelu">ActivationDiscreteRelu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizedrelu">QuantizedReLU</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/akida_models_apis.html">Akida models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#layer-blocks">Layer blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#conv-block">conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#separable-conv-block">separable_conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#dense-block">dense_block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#helpers">Helpers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#batchnormalization-gamma-constraint">BatchNormalization gamma constraint</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#knowledge-distillation">Knowledge distillation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#pruning">Pruning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#model-zoo">Model zoo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#akidanet">AkidaNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#mobilenet">Mobilenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#ds-cnn">DS-CNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#vgg">VGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#yolo">YOLO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#convtiny">ConvTiny</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#pointnet">PointNet++</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#gxnor">GXNOR</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#general-examples">General examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../general/plot_0_gxnor_mnist.html">GXNOR/MNIST inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_0_gxnor_mnist.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_0_gxnor_mnist.html#create-a-keras-gxnor-model">2. Create a Keras GXNOR model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_0_gxnor_mnist.html#conversion-to-akida">3. Conversion to Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../general/plot_1_ds_cnn_cifar10.html">DS-CNN CIFAR10 inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_1_ds_cnn_cifar10.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_1_ds_cnn_cifar10.html#create-a-keras-ds-cnn-model">2. Create a Keras DS-CNN model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_1_ds_cnn_cifar10.html#quantized-model">3. Quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_1_ds_cnn_cifar10.html#pretrained-quantized-model">4. Pretrained quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_1_ds_cnn_cifar10.html#conversion-to-akida">5. Conversion to Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../general/plot_2_akidanet_imagenet.html">AkidaNet/ImageNet inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_2_akidanet_imagenet.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_2_akidanet_imagenet.html#create-a-keras-akidanet-model">2. Create a Keras AkidaNet model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_2_akidanet_imagenet.html#quantized-model">3. Quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_2_akidanet_imagenet.html#pretrained-quantized-model">4. Pretrained quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_2_akidanet_imagenet.html#conversion-to-akida">5. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_2_akidanet_imagenet.html#hardware-mapping-and-performance">6. Hardware mapping and performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../general/plot_3_ds_cnn_kws.html">DS-CNN/KWS inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_3_ds_cnn_kws.html#load-the-preprocessed-dataset">1. Load the preprocessed dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_3_ds_cnn_kws.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_3_ds_cnn_kws.html#load-a-pre-trained-quantized-keras-model-satisfying-akida-nsoc-requirements">3. Load a pre-trained quantized Keras model satisfying Akida NSoC requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_3_ds_cnn_kws.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_3_ds_cnn_kws.html#confusion-matrix">5. Confusion matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../general/plot_4_regression.html">Regression tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_4_regression.html#load-the-dataset">1. Load the dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_4_regression.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_4_regression.html#load-a-pre-trained-quantized-keras-model-satisfying-akida-nsoc-requirements">3. Load a pre-trained quantized Keras model satisfying Akida NSoC requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_4_regression.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_4_regression.html#estimate-age-on-a-single-image">5. Estimate age on a single image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../general/plot_5_transfer_learning.html">Transfer learning with AkidaNet for PlantVillage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_5_transfer_learning.html#transfer-learning-process">Transfer learning process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_5_transfer_learning.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_5_transfer_learning.html#get-a-trained-akidanet-base-model">2. Get a trained AkidaNet base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_5_transfer_learning.html#add-a-float-classification-head-to-the-model">3. Add a float classification head to the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_5_transfer_learning.html#freeze-the-base-model">4. Freeze the base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_5_transfer_learning.html#train-for-a-few-epochs">5. Train for a few epochs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_5_transfer_learning.html#quantize-the-classification-head">6. Quantize the classification head</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_5_transfer_learning.html#compute-accuracy">7. Compute accuracy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../general/plot_6_voc_yolo_detection.html">YOLO/PASCAL-VOC detection tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_6_voc_yolo_detection.html#introduction">1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_6_voc_yolo_detection.html#preprocessing-tools">2. Preprocessing tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_6_voc_yolo_detection.html#model-architecture">3. Model architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_6_voc_yolo_detection.html#training">4. Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_6_voc_yolo_detection.html#performance">5. Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general/plot_6_voc_yolo_detection.html#conversion-to-akida">6. Conversion to Akida</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#cnn2snn-tutorials">CNN2SNN tutorials</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">CNN conversion flow tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#load-and-reshape-mnist-dataset">1. Load and reshape MNIST dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-definition">2. Model definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-training">3. Model training</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-quantization">4. Model quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-fine-tuning-quantization-aware-training">5. Model fine tuning (quantization-aware training)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-conversion">6. Model conversion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_1_advanced_cnn2snn.html">Advanced CNN2SNN tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_1_advanced_cnn2snn.html#design-a-cnn2snn-quantized-model">1. Design a CNN2SNN quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_advanced_cnn2snn.html#weight-quantizer-details">2. Weight Quantizer Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_advanced_cnn2snn.html#understanding-quantized-activation">3. Understanding quantized activation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_advanced_cnn2snn.html#how-to-deal-with-too-high-scale-factors">4. How to deal with too high scale factors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#edge-examples">Edge examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html">Akida vision edge learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#prepare-akida-model-for-learning">2. Prepare Akida model for learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#edge-learning-with-akida">3. Edge learning with Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html">Akida edge learning for keyword spotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#edge-learning-process">1. Edge learning process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#dataset-preparation">2. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#prepare-akida-model-for-learning">3. Prepare Akida model for learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#learn-with-akida-using-the-training-set">4. Learn with Akida using the training set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#edge-learning">5. Edge learning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html">Tips to set Akida learning parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#akida-learning-parameters">1. Akida learning parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#create-akida-model">2. Create Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#estimate-the-required-number-of-weights-of-the-trainable-layer">3. Estimate the required number of weights of the trainable layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#estimate-the-number-of-neurons-per-class">4. Estimate the number of neurons per class</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../zoo_performances.html">Model zoo performances</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../zoo_performances.html#image-icon-ref-image-domain"> Image domain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../zoo_performances.html#classification">Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../zoo_performances.html#object-detection">Object detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../zoo_performances.html#regression">Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../zoo_performances.html#face-recognition">Face recognition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../zoo_performances.html#audio-icon-ref-audio-domain"> Audio domain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../zoo_performances.html#keyword-spotting">Keyword spotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../zoo_performances.html#time-icon-ref-time-domain"> Time domain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../zoo_performances.html#fault-detection">Fault detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../zoo_performances.html#id1">Classification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../zoo_performances.html#pointcloud-icon-ref-point-cloud"> Point cloud</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../zoo_performances.html#id2">Classification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Brainchip-Inc/akida_examples/releases">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://support.brainchip.com/portal/home">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #78b3ff" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Akida Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Akida examples</a> &raquo;</li>
      <li>CNN conversion flow tutorial</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-cnn2snn-plot-0-cnn-flow-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="cnn-conversion-flow-tutorial">
<span id="sphx-glr-examples-cnn2snn-plot-0-cnn-flow-py"></span><h1>CNN conversion flow tutorial<a class="headerlink" href="#cnn-conversion-flow-tutorial" title="Permalink to this headline"></a></h1>
<p>This tutorial illustrates how to use the CNN2SNN toolkit to <strong>convert CNN
networks to SNN networks</strong> compatible with the <strong>Akida NSoC</strong> in a few steps.
You can refer to our <a class="reference external" href="../../user_guide/cnn2snn.html">CNN2SNN toolkit user guide</a> for further
explanation.</p>
<p>The CNN2SNN tool is based on Keras, TensorFlow high-level API for building and
training deep learning models.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please refer to TensorFlow  <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/models">tf.keras.models</a>
module for model creation/import details and <a class="reference external" href="https://www.tensorflow.org/guide">TensorFlow
Guide</a> for details of how
TensorFlow works.</p>
<p>MNIST example below is light enough so you do not need a <a class="reference external" href="https://www.tensorflow.org/install/gpu">GPU</a> to run the CNN2SNN
tool.</p>
</div>
<a class="reference internal image-reference" href="../../_images/cnn2snn_flow_small.jpg"><img alt="../../_images/cnn2snn_flow_small.jpg" src="../../_images/cnn2snn_flow_small.jpg" style="width: 725.9px; height: 170.1px;" /></a>
<section id="load-and-reshape-mnist-dataset">
<h2>1. Load and reshape MNIST dataset<a class="headerlink" href="#load-and-reshape-mnist-dataset" title="Permalink to this headline"></a></h2>
<p>After loading, we make 2 transformations on the dataset:</p>
<ol class="arabic simple">
<li><p>Reshape the sample content data (x values) into a num_samples x width x
height x channels matrix.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At this point, we’ll set aside the raw data for testing our
converted model in the Akida runtime later.</p>
</div>
<ol class="arabic simple" start="2">
<li><p>Rescale the 8-bit loaded data to the range 0-to-1 for training.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Input data normalization is a common step dealing with CNN
(rationale is to keep data in a range that works with selected
optimizers, some reading can be found
<a class="reference external" href="https://www.jeremyjordan.me/batch-normalization/">here</a>.</p>
<p>This shift makes almost no difference in the current example, but
for some datasets rescaling the absolute values (and also shifting
to zero-mean) can make a really major difference.</p>
<p>Also note that we store the scaling values <code class="docutils literal notranslate"><span class="pre">input_scaling</span></code> for
use when preparing the model for the Akida neuromorphic IP. The
implementation of the Akida neural network allows us to completely
skip the rescaling step (i.e. the Akida model should be fed with
the raw 8-bit values) but that does require information about what
scaling was applied prior to training - see below for more details.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>

<span class="c1"># Load MNIST dataset</span>
<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1"># Reshape x-data</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">60000</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Set aside raw test data for use with Akida runtime later</span>
<span class="n">raw_x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="n">raw_y_test</span> <span class="o">=</span> <span class="n">y_test</span>

<span class="c1"># Rescale x-data</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">255</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">input_scaling</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_train</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_test</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
</pre></div>
</div>
</section>
<section id="model-definition">
<h2>2. Model definition<a class="headerlink" href="#model-definition" title="Permalink to this headline"></a></h2>
<p>Note that at this stage, there is nothing specific to the Akida NSoC.
This start point is very much a completely standard CNN as defined
within <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras">Keras</a>.</p>
<p>An appropriate model for MNIST (inspired by <a class="reference external" href="https://www.tensorflow.org/model_optimization/guide/quantization/training_example#train_a_model_for_mnist_without_quantization_aware_training">this
example</a>)
might look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_keras</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SeparableConv2D</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">],</span> <span class="s1">&#39;mnistnet&#39;</span><span class="p">)</span>

<span class="n">model_keras</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Model: &quot;mnistnet&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 13, 13, 32)        320
_________________________________________________________________
batch_normalization (BatchNo (None, 13, 13, 32)        128
_________________________________________________________________
re_lu (ReLU)                 (None, 13, 13, 32)        0
_________________________________________________________________
separable_conv2d (SeparableC (None, 7, 7, 64)          2400
_________________________________________________________________
batch_normalization_1 (Batch (None, 7, 7, 64)          256
_________________________________________________________________
re_lu_1 (ReLU)               (None, 7, 7, 64)          0
_________________________________________________________________
flatten (Flatten)            (None, 3136)              0
_________________________________________________________________
dense (Dense)                (None, 10)                31370
=================================================================
Total params: 34,474
Trainable params: 34,282
Non-trainable params: 192
_________________________________________________________________
</pre></div>
</div>
<p>The model defined above is compatible for conversion into an Akida model, i.e.
the model doesn’t include any layers or operations that aren’t Akida-compatible
(please refer to the <a class="reference external" href="../../user_guide/cnn2snn.html">CNN2SNN toolkit</a> documentation for full
details):</p>
<ul class="simple">
<li><p>Standard Conv2D and Dense layers are supported</p></li>
<li><p>Hidden layers must be followed  by a ReLU layer.</p></li>
<li><p>BatchNormalization must always happen before activations.</p></li>
<li><p>Convolutional blocks can optionally be followed by a MaxPooling.</p></li>
</ul>
<p>The CNN2SNN toolkit provides the
<a class="reference external" href="../../api_reference/cnn2snn_apis.html#check-model-compatibility">check_model_compatibility</a>
function to ensure that the model can be converted into an Akida model. If
the model is not fully compatible, substitutes will be needed for the
relevant layers/operations (guidelines included in the documentation).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">check_model_compatibility</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model compatible for Akida conversion:&quot;</span><span class="p">,</span>
      <span class="n">check_model_compatibility</span><span class="p">(</span><span class="n">model_keras</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Model compatible for Akida conversion: True
</pre></div>
</div>
</section>
<section id="model-training">
<h2>3. Model training<a class="headerlink" href="#model-training" title="Permalink to this headline"></a></h2>
<p>Before going any further, train the model and get its performance.
The created model should have achieved a test accuracy over 98% after 10
epochs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_keras</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="n">model_keras</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Epoch 1/10

   1/1688 [..............................] - ETA: 10:58 - loss: 2.6384 - accuracy: 0.1250
  33/1688 [..............................] - ETA: 2s - loss: 1.1406 - accuracy: 0.6562   
  66/1688 [&gt;.............................] - ETA: 2s - loss: 0.8092 - accuracy: 0.7580
 100/1688 [&gt;.............................] - ETA: 2s - loss: 0.6711 - accuracy: 0.8012
 133/1688 [=&gt;............................] - ETA: 2s - loss: 0.5781 - accuracy: 0.8292
 164/1688 [=&gt;............................] - ETA: 2s - loss: 0.5310 - accuracy: 0.8438
 196/1688 [==&gt;...........................] - ETA: 2s - loss: 0.4812 - accuracy: 0.8587
 230/1688 [===&gt;..........................] - ETA: 2s - loss: 0.4446 - accuracy: 0.8693
 263/1688 [===&gt;..........................] - ETA: 2s - loss: 0.4228 - accuracy: 0.8762
 296/1688 [====&gt;.........................] - ETA: 2s - loss: 0.4021 - accuracy: 0.8831
 329/1688 [====&gt;.........................] - ETA: 2s - loss: 0.3836 - accuracy: 0.8879
 362/1688 [=====&gt;........................] - ETA: 2s - loss: 0.3650 - accuracy: 0.8933
 395/1688 [======&gt;.......................] - ETA: 2s - loss: 0.3511 - accuracy: 0.8968
 428/1688 [======&gt;.......................] - ETA: 1s - loss: 0.3381 - accuracy: 0.9003
 461/1688 [=======&gt;......................] - ETA: 1s - loss: 0.3229 - accuracy: 0.9051
 494/1688 [=======&gt;......................] - ETA: 1s - loss: 0.3112 - accuracy: 0.9082
 528/1688 [========&gt;.....................] - ETA: 1s - loss: 0.3010 - accuracy: 0.9110
 561/1688 [========&gt;.....................] - ETA: 1s - loss: 0.2913 - accuracy: 0.9137
 594/1688 [=========&gt;....................] - ETA: 1s - loss: 0.2843 - accuracy: 0.9159
 626/1688 [==========&gt;...................] - ETA: 1s - loss: 0.2789 - accuracy: 0.9174
 659/1688 [==========&gt;...................] - ETA: 1s - loss: 0.2707 - accuracy: 0.9195
 693/1688 [===========&gt;..................] - ETA: 1s - loss: 0.2642 - accuracy: 0.9212
 727/1688 [===========&gt;..................] - ETA: 1s - loss: 0.2581 - accuracy: 0.9229
 760/1688 [============&gt;.................] - ETA: 1s - loss: 0.2527 - accuracy: 0.9248
 792/1688 [=============&gt;................] - ETA: 1s - loss: 0.2472 - accuracy: 0.9265
 825/1688 [=============&gt;................] - ETA: 1s - loss: 0.2427 - accuracy: 0.9280
 858/1688 [==============&gt;...............] - ETA: 1s - loss: 0.2383 - accuracy: 0.9292
 892/1688 [==============&gt;...............] - ETA: 1s - loss: 0.2336 - accuracy: 0.9307
 925/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2299 - accuracy: 0.9319
 959/1688 [================&gt;.............] - ETA: 1s - loss: 0.2261 - accuracy: 0.9327
 992/1688 [================&gt;.............] - ETA: 1s - loss: 0.2222 - accuracy: 0.9340
1024/1688 [=================&gt;............] - ETA: 1s - loss: 0.2190 - accuracy: 0.9349
1058/1688 [=================&gt;............] - ETA: 0s - loss: 0.2155 - accuracy: 0.9362
1092/1688 [==================&gt;...........] - ETA: 0s - loss: 0.2126 - accuracy: 0.9370
1125/1688 [==================&gt;...........] - ETA: 0s - loss: 0.2100 - accuracy: 0.9379
1159/1688 [===================&gt;..........] - ETA: 0s - loss: 0.2077 - accuracy: 0.9386
1191/1688 [====================&gt;.........] - ETA: 0s - loss: 0.2043 - accuracy: 0.9395
1226/1688 [====================&gt;.........] - ETA: 0s - loss: 0.2014 - accuracy: 0.9403
1259/1688 [=====================&gt;........] - ETA: 0s - loss: 0.1986 - accuracy: 0.9410
1292/1688 [=====================&gt;........] - ETA: 0s - loss: 0.1963 - accuracy: 0.9419
1325/1688 [======================&gt;.......] - ETA: 0s - loss: 0.1938 - accuracy: 0.9425
1359/1688 [=======================&gt;......] - ETA: 0s - loss: 0.1916 - accuracy: 0.9432
1393/1688 [=======================&gt;......] - ETA: 0s - loss: 0.1893 - accuracy: 0.9437
1428/1688 [========================&gt;.....] - ETA: 0s - loss: 0.1872 - accuracy: 0.9443
1459/1688 [========================&gt;.....] - ETA: 0s - loss: 0.1850 - accuracy: 0.9450
1493/1688 [=========================&gt;....] - ETA: 0s - loss: 0.1829 - accuracy: 0.9456
1526/1688 [==========================&gt;...] - ETA: 0s - loss: 0.1813 - accuracy: 0.9461
1559/1688 [==========================&gt;...] - ETA: 0s - loss: 0.1793 - accuracy: 0.9466
1592/1688 [===========================&gt;..] - ETA: 0s - loss: 0.1774 - accuracy: 0.9472
1625/1688 [===========================&gt;..] - ETA: 0s - loss: 0.1763 - accuracy: 0.9476
1658/1688 [============================&gt;.] - ETA: 0s - loss: 0.1742 - accuracy: 0.9482
1688/1688 [==============================] - ETA: 0s - loss: 0.1725 - accuracy: 0.9487
1688/1688 [==============================] - 3s 2ms/step - loss: 0.1725 - accuracy: 0.9487 - val_loss: 0.0786 - val_accuracy: 0.9793
Epoch 2/10

   1/1688 [..............................] - ETA: 3s - loss: 0.0076 - accuracy: 1.0000
  35/1688 [..............................] - ETA: 2s - loss: 0.0555 - accuracy: 0.9848
  69/1688 [&gt;.............................] - ETA: 2s - loss: 0.0591 - accuracy: 0.9810
 101/1688 [&gt;.............................] - ETA: 2s - loss: 0.0628 - accuracy: 0.9790
 135/1688 [=&gt;............................] - ETA: 2s - loss: 0.0699 - accuracy: 0.9762
 169/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0689 - accuracy: 0.9771
 202/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0684 - accuracy: 0.9777
 236/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0689 - accuracy: 0.9772
 270/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0685 - accuracy: 0.9775
 303/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0661 - accuracy: 0.9785
 335/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0653 - accuracy: 0.9787
 369/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0671 - accuracy: 0.9777
 401/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0677 - accuracy: 0.9779
 433/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0695 - accuracy: 0.9774
 466/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0679 - accuracy: 0.9777
 499/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0695 - accuracy: 0.9773
 533/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0712 - accuracy: 0.9771
 567/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0710 - accuracy: 0.9775
 601/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0713 - accuracy: 0.9774
 634/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0710 - accuracy: 0.9776
 666/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0717 - accuracy: 0.9776
 698/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0713 - accuracy: 0.9777
 732/1688 [============&gt;.................] - ETA: 1s - loss: 0.0707 - accuracy: 0.9778
 765/1688 [============&gt;.................] - ETA: 1s - loss: 0.0708 - accuracy: 0.9777
 799/1688 [=============&gt;................] - ETA: 1s - loss: 0.0708 - accuracy: 0.9776
 832/1688 [=============&gt;................] - ETA: 1s - loss: 0.0711 - accuracy: 0.9777
 865/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0711 - accuracy: 0.9776
 898/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0715 - accuracy: 0.9775
 930/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0712 - accuracy: 0.9778
 963/1688 [================&gt;.............] - ETA: 1s - loss: 0.0714 - accuracy: 0.9776
 996/1688 [================&gt;.............] - ETA: 1s - loss: 0.0722 - accuracy: 0.9773
1029/1688 [=================&gt;............] - ETA: 1s - loss: 0.0724 - accuracy: 0.9772
1062/1688 [=================&gt;............] - ETA: 0s - loss: 0.0730 - accuracy: 0.9770
1095/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0733 - accuracy: 0.9772
1128/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0729 - accuracy: 0.9773
1161/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0725 - accuracy: 0.9773
1195/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0725 - accuracy: 0.9774
1228/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0722 - accuracy: 0.9776
1262/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0724 - accuracy: 0.9777
1295/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0724 - accuracy: 0.9777
1327/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0718 - accuracy: 0.9779
1360/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0716 - accuracy: 0.9778
1393/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0720 - accuracy: 0.9777
1426/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0716 - accuracy: 0.9778
1459/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0718 - accuracy: 0.9779
1492/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0714 - accuracy: 0.9780
1525/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0715 - accuracy: 0.9781
1559/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0718 - accuracy: 0.9781
1592/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0719 - accuracy: 0.9780
1626/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0714 - accuracy: 0.9781
1659/1688 [============================&gt;.] - ETA: 0s - loss: 0.0713 - accuracy: 0.9781
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0710 - accuracy: 0.9782 - val_loss: 0.0576 - val_accuracy: 0.9857
Epoch 3/10

   1/1688 [..............................] - ETA: 2s - loss: 0.0012 - accuracy: 1.0000
  37/1688 [..............................] - ETA: 2s - loss: 0.0484 - accuracy: 0.9831
  70/1688 [&gt;.............................] - ETA: 2s - loss: 0.0425 - accuracy: 0.9862
 103/1688 [&gt;.............................] - ETA: 2s - loss: 0.0373 - accuracy: 0.9873
 137/1688 [=&gt;............................] - ETA: 2s - loss: 0.0382 - accuracy: 0.9868
 170/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0426 - accuracy: 0.9866
 204/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0420 - accuracy: 0.9861
 238/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0410 - accuracy: 0.9866
 271/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0402 - accuracy: 0.9871
 303/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0409 - accuracy: 0.9864
 336/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0413 - accuracy: 0.9863
 368/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0409 - accuracy: 0.9865
 400/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0422 - accuracy: 0.9861
 433/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0415 - accuracy: 0.9864
 466/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0429 - accuracy: 0.9859
 499/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0464 - accuracy: 0.9849
 531/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0461 - accuracy: 0.9849
 564/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0465 - accuracy: 0.9848
 597/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0481 - accuracy: 0.9845
 631/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0479 - accuracy: 0.9844
 665/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0478 - accuracy: 0.9845
 698/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0484 - accuracy: 0.9843
 731/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0488 - accuracy: 0.9844
 764/1688 [============&gt;.................] - ETA: 1s - loss: 0.0493 - accuracy: 0.9842
 797/1688 [=============&gt;................] - ETA: 1s - loss: 0.0492 - accuracy: 0.9844
 830/1688 [=============&gt;................] - ETA: 1s - loss: 0.0495 - accuracy: 0.9845
 863/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0487 - accuracy: 0.9846
 896/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0496 - accuracy: 0.9844
 929/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0495 - accuracy: 0.9845
 961/1688 [================&gt;.............] - ETA: 1s - loss: 0.0492 - accuracy: 0.9845
 994/1688 [================&gt;.............] - ETA: 1s - loss: 0.0486 - accuracy: 0.9847
1027/1688 [=================&gt;............] - ETA: 1s - loss: 0.0485 - accuracy: 0.9846
1061/1688 [=================&gt;............] - ETA: 0s - loss: 0.0486 - accuracy: 0.9847
1093/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0487 - accuracy: 0.9847
1125/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0488 - accuracy: 0.9846
1158/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0494 - accuracy: 0.9845
1192/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0495 - accuracy: 0.9844
1225/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0498 - accuracy: 0.9842
1258/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0498 - accuracy: 0.9843
1291/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0498 - accuracy: 0.9843
1324/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0507 - accuracy: 0.9840
1357/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0504 - accuracy: 0.9841
1392/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0508 - accuracy: 0.9840
1426/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0516 - accuracy: 0.9838
1458/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0519 - accuracy: 0.9836
1492/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0523 - accuracy: 0.9836
1526/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0525 - accuracy: 0.9836
1559/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0528 - accuracy: 0.9835
1592/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0534 - accuracy: 0.9833
1626/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0538 - accuracy: 0.9832
1658/1688 [============================&gt;.] - ETA: 0s - loss: 0.0537 - accuracy: 0.9833
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0535 - accuracy: 0.9833 - val_loss: 0.0647 - val_accuracy: 0.9820
Epoch 4/10

   1/1688 [..............................] - ETA: 2s - loss: 0.0262 - accuracy: 1.0000
  35/1688 [..............................] - ETA: 2s - loss: 0.0425 - accuracy: 0.9875
  69/1688 [&gt;.............................] - ETA: 2s - loss: 0.0332 - accuracy: 0.9896
 101/1688 [&gt;.............................] - ETA: 2s - loss: 0.0316 - accuracy: 0.9898
 135/1688 [=&gt;............................] - ETA: 2s - loss: 0.0329 - accuracy: 0.9896
 168/1688 [=&gt;............................] - ETA: 2s - loss: 0.0332 - accuracy: 0.9892
 201/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0329 - accuracy: 0.9894
 233/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0338 - accuracy: 0.9890
 265/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0375 - accuracy: 0.9881
 299/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0389 - accuracy: 0.9872
 333/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0390 - accuracy: 0.9875
 367/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0397 - accuracy: 0.9871
 401/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0388 - accuracy: 0.9875
 434/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0384 - accuracy: 0.9876
 466/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0383 - accuracy: 0.9876
 499/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0384 - accuracy: 0.9875
 532/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0387 - accuracy: 0.9873
 565/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0380 - accuracy: 0.9873
 597/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0382 - accuracy: 0.9873
 631/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0379 - accuracy: 0.9875
 664/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0367 - accuracy: 0.9879
 696/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0363 - accuracy: 0.9879
 728/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0368 - accuracy: 0.9877
 761/1688 [============&gt;.................] - ETA: 1s - loss: 0.0366 - accuracy: 0.9878
 794/1688 [=============&gt;................] - ETA: 1s - loss: 0.0370 - accuracy: 0.9878
 827/1688 [=============&gt;................] - ETA: 1s - loss: 0.0369 - accuracy: 0.9879
 860/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0365 - accuracy: 0.9880
 894/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0373 - accuracy: 0.9879
 927/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0380 - accuracy: 0.9876
 960/1688 [================&gt;.............] - ETA: 1s - loss: 0.0392 - accuracy: 0.9873
 994/1688 [================&gt;.............] - ETA: 1s - loss: 0.0397 - accuracy: 0.9872
1028/1688 [=================&gt;............] - ETA: 1s - loss: 0.0401 - accuracy: 0.9871
1061/1688 [=================&gt;............] - ETA: 0s - loss: 0.0400 - accuracy: 0.9871
1094/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0401 - accuracy: 0.9870
1127/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0401 - accuracy: 0.9871
1159/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0401 - accuracy: 0.9871
1191/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0401 - accuracy: 0.9870
1224/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0406 - accuracy: 0.9868
1257/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0410 - accuracy: 0.9867
1291/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0410 - accuracy: 0.9868
1323/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0413 - accuracy: 0.9867
1357/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0413 - accuracy: 0.9867
1389/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0411 - accuracy: 0.9868
1423/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0411 - accuracy: 0.9867
1456/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0410 - accuracy: 0.9868
1489/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0415 - accuracy: 0.9867
1522/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0418 - accuracy: 0.9866
1556/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0416 - accuracy: 0.9866
1588/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0417 - accuracy: 0.9865
1621/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0415 - accuracy: 0.9866
1654/1688 [============================&gt;.] - ETA: 0s - loss: 0.0415 - accuracy: 0.9866
1688/1688 [==============================] - ETA: 0s - loss: 0.0417 - accuracy: 0.9865
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0417 - accuracy: 0.9865 - val_loss: 0.0563 - val_accuracy: 0.9858
Epoch 5/10

   1/1688 [..............................] - ETA: 2s - loss: 0.0665 - accuracy: 0.9688
  38/1688 [..............................] - ETA: 2s - loss: 0.0238 - accuracy: 0.9910
  71/1688 [&gt;.............................] - ETA: 2s - loss: 0.0293 - accuracy: 0.9894
 104/1688 [&gt;.............................] - ETA: 2s - loss: 0.0306 - accuracy: 0.9895
 137/1688 [=&gt;............................] - ETA: 2s - loss: 0.0339 - accuracy: 0.9888
 170/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0330 - accuracy: 0.9892
 203/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0343 - accuracy: 0.9892
 236/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0318 - accuracy: 0.9902
 269/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0321 - accuracy: 0.9895
 301/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0328 - accuracy: 0.9894
 333/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0325 - accuracy: 0.9895
 367/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0311 - accuracy: 0.9900
 400/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0302 - accuracy: 0.9902
 434/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0308 - accuracy: 0.9901
 467/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0304 - accuracy: 0.9904
 501/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0311 - accuracy: 0.9902
 535/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0307 - accuracy: 0.9902
 568/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0301 - accuracy: 0.9903
 601/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0304 - accuracy: 0.9901
 635/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0307 - accuracy: 0.9900
 667/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0309 - accuracy: 0.9898
 700/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0313 - accuracy: 0.9898
 733/1688 [============&gt;.................] - ETA: 1s - loss: 0.0317 - accuracy: 0.9898
 766/1688 [============&gt;.................] - ETA: 1s - loss: 0.0315 - accuracy: 0.9899
 799/1688 [=============&gt;................] - ETA: 1s - loss: 0.0317 - accuracy: 0.9899
 832/1688 [=============&gt;................] - ETA: 1s - loss: 0.0316 - accuracy: 0.9899
 865/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0321 - accuracy: 0.9896
 899/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0326 - accuracy: 0.9895
 931/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0327 - accuracy: 0.9896
 964/1688 [================&gt;.............] - ETA: 1s - loss: 0.0331 - accuracy: 0.9893
 998/1688 [================&gt;.............] - ETA: 1s - loss: 0.0330 - accuracy: 0.9893
1030/1688 [=================&gt;............] - ETA: 1s - loss: 0.0329 - accuracy: 0.9893
1064/1688 [=================&gt;............] - ETA: 0s - loss: 0.0327 - accuracy: 0.9893
1097/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0328 - accuracy: 0.9893
1130/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0332 - accuracy: 0.9892
1164/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0333 - accuracy: 0.9891
1198/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0332 - accuracy: 0.9891
1232/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0329 - accuracy: 0.9892
1263/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0335 - accuracy: 0.9890
1296/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0335 - accuracy: 0.9890
1329/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0337 - accuracy: 0.9888
1363/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0339 - accuracy: 0.9887
1396/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0340 - accuracy: 0.9887
1429/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0341 - accuracy: 0.9886
1463/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0339 - accuracy: 0.9887
1496/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0337 - accuracy: 0.9888
1529/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0338 - accuracy: 0.9888
1561/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0336 - accuracy: 0.9889
1594/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0337 - accuracy: 0.9888
1627/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0336 - accuracy: 0.9889
1660/1688 [============================&gt;.] - ETA: 0s - loss: 0.0338 - accuracy: 0.9889
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0339 - accuracy: 0.9888 - val_loss: 0.0554 - val_accuracy: 0.9852
Epoch 6/10

   1/1688 [..............................] - ETA: 2s - loss: 0.0014 - accuracy: 1.0000
  36/1688 [..............................] - ETA: 2s - loss: 0.0123 - accuracy: 0.9948
  69/1688 [&gt;.............................] - ETA: 2s - loss: 0.0198 - accuracy: 0.9918
 103/1688 [&gt;.............................] - ETA: 2s - loss: 0.0190 - accuracy: 0.9930
 135/1688 [=&gt;............................] - ETA: 2s - loss: 0.0192 - accuracy: 0.9926
 168/1688 [=&gt;............................] - ETA: 2s - loss: 0.0187 - accuracy: 0.9931
 201/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0186 - accuracy: 0.9933
 234/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0183 - accuracy: 0.9936
 267/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0192 - accuracy: 0.9933
 300/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0194 - accuracy: 0.9935
 333/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0200 - accuracy: 0.9932
 365/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0216 - accuracy: 0.9928
 399/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0228 - accuracy: 0.9924
 432/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0243 - accuracy: 0.9917
 465/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0243 - accuracy: 0.9915
 498/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0252 - accuracy: 0.9913
 531/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0251 - accuracy: 0.9915
 564/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0244 - accuracy: 0.9917
 597/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0246 - accuracy: 0.9918
 630/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0251 - accuracy: 0.9916
 664/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0250 - accuracy: 0.9916
 698/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0249 - accuracy: 0.9916
 730/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0255 - accuracy: 0.9914
 764/1688 [============&gt;.................] - ETA: 1s - loss: 0.0252 - accuracy: 0.9914
 797/1688 [=============&gt;................] - ETA: 1s - loss: 0.0249 - accuracy: 0.9915
 831/1688 [=============&gt;................] - ETA: 1s - loss: 0.0248 - accuracy: 0.9915
 864/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0249 - accuracy: 0.9915
 897/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0247 - accuracy: 0.9915
 931/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0245 - accuracy: 0.9916
 963/1688 [================&gt;.............] - ETA: 1s - loss: 0.0246 - accuracy: 0.9915
 996/1688 [================&gt;.............] - ETA: 1s - loss: 0.0248 - accuracy: 0.9916
1029/1688 [=================&gt;............] - ETA: 1s - loss: 0.0251 - accuracy: 0.9913
1063/1688 [=================&gt;............] - ETA: 0s - loss: 0.0257 - accuracy: 0.9911
1096/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0263 - accuracy: 0.9910
1129/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0268 - accuracy: 0.9909
1162/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0271 - accuracy: 0.9908
1194/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0272 - accuracy: 0.9907
1228/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0272 - accuracy: 0.9908
1261/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0271 - accuracy: 0.9909
1295/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0274 - accuracy: 0.9908
1327/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0273 - accuracy: 0.9908
1360/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0271 - accuracy: 0.9908
1395/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0269 - accuracy: 0.9909
1429/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0270 - accuracy: 0.9908
1462/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0270 - accuracy: 0.9908
1496/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0271 - accuracy: 0.9908
1529/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0273 - accuracy: 0.9907
1563/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0273 - accuracy: 0.9907
1596/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0271 - accuracy: 0.9908
1629/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0271 - accuracy: 0.9908
1662/1688 [============================&gt;.] - ETA: 0s - loss: 0.0272 - accuracy: 0.9908
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0273 - accuracy: 0.9907 - val_loss: 0.0651 - val_accuracy: 0.9828
Epoch 7/10

   1/1688 [..............................] - ETA: 2s - loss: 0.0030 - accuracy: 1.0000
  35/1688 [..............................] - ETA: 2s - loss: 0.0232 - accuracy: 0.9946
  68/1688 [&gt;.............................] - ETA: 2s - loss: 0.0201 - accuracy: 0.9940
 101/1688 [&gt;.............................] - ETA: 2s - loss: 0.0184 - accuracy: 0.9944
 134/1688 [=&gt;............................] - ETA: 2s - loss: 0.0205 - accuracy: 0.9932
 167/1688 [=&gt;............................] - ETA: 2s - loss: 0.0205 - accuracy: 0.9933
 200/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0199 - accuracy: 0.9939
 234/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0206 - accuracy: 0.9937
 266/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0199 - accuracy: 0.9939
 299/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0197 - accuracy: 0.9939
 333/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0202 - accuracy: 0.9936
 366/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0206 - accuracy: 0.9935
 399/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0208 - accuracy: 0.9935
 433/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0203 - accuracy: 0.9936
 467/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0206 - accuracy: 0.9934
 499/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0204 - accuracy: 0.9932
 532/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0202 - accuracy: 0.9932
 565/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0210 - accuracy: 0.9929
 597/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0217 - accuracy: 0.9927
 630/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0218 - accuracy: 0.9926
 663/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0220 - accuracy: 0.9925
 696/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0219 - accuracy: 0.9925
 729/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0215 - accuracy: 0.9927
 763/1688 [============&gt;.................] - ETA: 1s - loss: 0.0212 - accuracy: 0.9928
 795/1688 [=============&gt;................] - ETA: 1s - loss: 0.0213 - accuracy: 0.9928
 828/1688 [=============&gt;................] - ETA: 1s - loss: 0.0212 - accuracy: 0.9928
 860/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0215 - accuracy: 0.9927
 895/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0219 - accuracy: 0.9926
 928/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0215 - accuracy: 0.9928
 962/1688 [================&gt;.............] - ETA: 1s - loss: 0.0219 - accuracy: 0.9926
 996/1688 [================&gt;.............] - ETA: 1s - loss: 0.0222 - accuracy: 0.9925
1029/1688 [=================&gt;............] - ETA: 1s - loss: 0.0224 - accuracy: 0.9925
1061/1688 [=================&gt;............] - ETA: 0s - loss: 0.0222 - accuracy: 0.9926
1093/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0224 - accuracy: 0.9925
1126/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0231 - accuracy: 0.9923
1158/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0232 - accuracy: 0.9923
1190/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0233 - accuracy: 0.9923
1223/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0233 - accuracy: 0.9923
1257/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0233 - accuracy: 0.9924
1290/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0233 - accuracy: 0.9923
1322/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0236 - accuracy: 0.9923
1355/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0238 - accuracy: 0.9923
1389/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0235 - accuracy: 0.9924
1422/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0238 - accuracy: 0.9922
1455/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0238 - accuracy: 0.9921
1487/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0240 - accuracy: 0.9921
1519/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0238 - accuracy: 0.9921
1552/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0238 - accuracy: 0.9921
1586/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0239 - accuracy: 0.9920
1619/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0244 - accuracy: 0.9919
1651/1688 [============================&gt;.] - ETA: 0s - loss: 0.0246 - accuracy: 0.9918
1684/1688 [============================&gt;.] - ETA: 0s - loss: 0.0245 - accuracy: 0.9918
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0245 - accuracy: 0.9918 - val_loss: 0.0607 - val_accuracy: 0.9847
Epoch 8/10

   1/1688 [..............................] - ETA: 2s - loss: 7.6478e-04 - accuracy: 1.0000
  36/1688 [..............................] - ETA: 2s - loss: 0.0137 - accuracy: 0.9957    
  69/1688 [&gt;.............................] - ETA: 2s - loss: 0.0129 - accuracy: 0.9959
 101/1688 [&gt;.............................] - ETA: 2s - loss: 0.0122 - accuracy: 0.9966
 133/1688 [=&gt;............................] - ETA: 2s - loss: 0.0131 - accuracy: 0.9962
 166/1688 [=&gt;............................] - ETA: 2s - loss: 0.0126 - accuracy: 0.9962
 198/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0140 - accuracy: 0.9954
 231/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0150 - accuracy: 0.9947
 265/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0145 - accuracy: 0.9947
 298/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0140 - accuracy: 0.9949
 332/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0147 - accuracy: 0.9947
 365/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0149 - accuracy: 0.9945
 397/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0156 - accuracy: 0.9945
 430/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0160 - accuracy: 0.9946
 463/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0160 - accuracy: 0.9946
 497/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0165 - accuracy: 0.9945
 529/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0171 - accuracy: 0.9943
 563/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0171 - accuracy: 0.9943
 596/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0174 - accuracy: 0.9943
 629/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0172 - accuracy: 0.9944
 661/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0170 - accuracy: 0.9945
 694/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0168 - accuracy: 0.9946
 727/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0165 - accuracy: 0.9947
 760/1688 [============&gt;.................] - ETA: 1s - loss: 0.0167 - accuracy: 0.9947
 793/1688 [=============&gt;................] - ETA: 1s - loss: 0.0168 - accuracy: 0.9946
 826/1688 [=============&gt;................] - ETA: 1s - loss: 0.0175 - accuracy: 0.9944
 860/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0178 - accuracy: 0.9943
 893/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0179 - accuracy: 0.9943
 926/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0177 - accuracy: 0.9944
 958/1688 [================&gt;.............] - ETA: 1s - loss: 0.0184 - accuracy: 0.9944
 991/1688 [================&gt;.............] - ETA: 1s - loss: 0.0187 - accuracy: 0.9941
1023/1688 [=================&gt;............] - ETA: 1s - loss: 0.0192 - accuracy: 0.9939
1056/1688 [=================&gt;............] - ETA: 0s - loss: 0.0194 - accuracy: 0.9938
1089/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0197 - accuracy: 0.9938
1122/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0201 - accuracy: 0.9936
1156/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0197 - accuracy: 0.9938
1189/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0196 - accuracy: 0.9938
1222/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0195 - accuracy: 0.9937
1255/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0195 - accuracy: 0.9937
1288/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0196 - accuracy: 0.9936
1322/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0200 - accuracy: 0.9935
1355/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0204 - accuracy: 0.9933
1388/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0203 - accuracy: 0.9933
1420/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0203 - accuracy: 0.9933
1453/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0201 - accuracy: 0.9934
1487/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0202 - accuracy: 0.9933
1520/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0201 - accuracy: 0.9934
1553/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0206 - accuracy: 0.9933
1586/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0204 - accuracy: 0.9933
1620/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0205 - accuracy: 0.9933
1653/1688 [============================&gt;.] - ETA: 0s - loss: 0.0208 - accuracy: 0.9932
1687/1688 [============================&gt;.] - ETA: 0s - loss: 0.0209 - accuracy: 0.9932
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0209 - accuracy: 0.9932 - val_loss: 0.0700 - val_accuracy: 0.9843
Epoch 9/10

   1/1688 [..............................] - ETA: 2s - loss: 0.0034 - accuracy: 1.0000
  35/1688 [..............................] - ETA: 2s - loss: 0.0108 - accuracy: 0.9973
  69/1688 [&gt;.............................] - ETA: 2s - loss: 0.0108 - accuracy: 0.9973
 102/1688 [&gt;.............................] - ETA: 2s - loss: 0.0105 - accuracy: 0.9969
 136/1688 [=&gt;............................] - ETA: 2s - loss: 0.0113 - accuracy: 0.9963
 168/1688 [=&gt;............................] - ETA: 2s - loss: 0.0126 - accuracy: 0.9953
 202/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0131 - accuracy: 0.9950
 233/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0132 - accuracy: 0.9952
 266/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0136 - accuracy: 0.9949
 299/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0133 - accuracy: 0.9951
 332/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0132 - accuracy: 0.9951
 365/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0131 - accuracy: 0.9954
 398/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0132 - accuracy: 0.9952
 431/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0136 - accuracy: 0.9953
 465/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0135 - accuracy: 0.9954
 499/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0138 - accuracy: 0.9952
 533/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0136 - accuracy: 0.9953
 567/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0142 - accuracy: 0.9950
 600/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0141 - accuracy: 0.9949
 633/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0139 - accuracy: 0.9950
 665/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0140 - accuracy: 0.9949
 699/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0137 - accuracy: 0.9950
 732/1688 [============&gt;.................] - ETA: 1s - loss: 0.0141 - accuracy: 0.9950
 766/1688 [============&gt;.................] - ETA: 1s - loss: 0.0147 - accuracy: 0.9947
 800/1688 [=============&gt;................] - ETA: 1s - loss: 0.0147 - accuracy: 0.9947
 832/1688 [=============&gt;................] - ETA: 1s - loss: 0.0148 - accuracy: 0.9947
 866/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0157 - accuracy: 0.9945
 898/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0161 - accuracy: 0.9945
 931/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0162 - accuracy: 0.9944
 965/1688 [================&gt;.............] - ETA: 1s - loss: 0.0162 - accuracy: 0.9944
 997/1688 [================&gt;.............] - ETA: 1s - loss: 0.0159 - accuracy: 0.9946
1029/1688 [=================&gt;............] - ETA: 1s - loss: 0.0161 - accuracy: 0.9945
1063/1688 [=================&gt;............] - ETA: 0s - loss: 0.0161 - accuracy: 0.9945
1096/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0162 - accuracy: 0.9945
1129/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0161 - accuracy: 0.9946
1162/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0162 - accuracy: 0.9945
1196/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0160 - accuracy: 0.9946
1229/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0161 - accuracy: 0.9947
1263/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0161 - accuracy: 0.9947
1296/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0162 - accuracy: 0.9947
1330/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0163 - accuracy: 0.9946
1363/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0169 - accuracy: 0.9943
1395/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0170 - accuracy: 0.9943
1428/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0170 - accuracy: 0.9943
1461/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0171 - accuracy: 0.9942
1494/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0170 - accuracy: 0.9942
1527/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0170 - accuracy: 0.9942
1560/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0169 - accuracy: 0.9942
1592/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0169 - accuracy: 0.9942
1625/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0169 - accuracy: 0.9942
1658/1688 [============================&gt;.] - ETA: 0s - loss: 0.0172 - accuracy: 0.9941
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0171 - accuracy: 0.9941 - val_loss: 0.0585 - val_accuracy: 0.9867
Epoch 10/10

   1/1688 [..............................] - ETA: 2s - loss: 0.0058 - accuracy: 1.0000
  37/1688 [..............................] - ETA: 2s - loss: 0.0149 - accuracy: 0.9949
  70/1688 [&gt;.............................] - ETA: 2s - loss: 0.0120 - accuracy: 0.9960
 102/1688 [&gt;.............................] - ETA: 2s - loss: 0.0103 - accuracy: 0.9966
 136/1688 [=&gt;............................] - ETA: 2s - loss: 0.0096 - accuracy: 0.9972
 169/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0109 - accuracy: 0.9967
 202/1688 [==&gt;...........................] - ETA: 2s - loss: 0.0101 - accuracy: 0.9968
 236/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0098 - accuracy: 0.9968
 270/1688 [===&gt;..........................] - ETA: 2s - loss: 0.0097 - accuracy: 0.9969
 303/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0099 - accuracy: 0.9969
 336/1688 [====&gt;.........................] - ETA: 2s - loss: 0.0100 - accuracy: 0.9967
 369/1688 [=====&gt;........................] - ETA: 2s - loss: 0.0105 - accuracy: 0.9964
 401/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0116 - accuracy: 0.9961
 434/1688 [======&gt;.......................] - ETA: 1s - loss: 0.0114 - accuracy: 0.9963
 467/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0117 - accuracy: 0.9962
 499/1688 [=======&gt;......................] - ETA: 1s - loss: 0.0133 - accuracy: 0.9957
 532/1688 [========&gt;.....................] - ETA: 1s - loss: 0.0133 - accuracy: 0.9957
 565/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0134 - accuracy: 0.9957
 599/1688 [=========&gt;....................] - ETA: 1s - loss: 0.0139 - accuracy: 0.9954
 631/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0141 - accuracy: 0.9952
 664/1688 [==========&gt;...................] - ETA: 1s - loss: 0.0142 - accuracy: 0.9951
 697/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0145 - accuracy: 0.9950
 731/1688 [===========&gt;..................] - ETA: 1s - loss: 0.0148 - accuracy: 0.9947
 765/1688 [============&gt;.................] - ETA: 1s - loss: 0.0150 - accuracy: 0.9946
 799/1688 [=============&gt;................] - ETA: 1s - loss: 0.0154 - accuracy: 0.9945
 833/1688 [=============&gt;................] - ETA: 1s - loss: 0.0152 - accuracy: 0.9946
 866/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0158 - accuracy: 0.9944
 899/1688 [==============&gt;...............] - ETA: 1s - loss: 0.0155 - accuracy: 0.9945
 932/1688 [===============&gt;..............] - ETA: 1s - loss: 0.0156 - accuracy: 0.9944
 965/1688 [================&gt;.............] - ETA: 1s - loss: 0.0158 - accuracy: 0.9943
 998/1688 [================&gt;.............] - ETA: 1s - loss: 0.0159 - accuracy: 0.9943
1031/1688 [=================&gt;............] - ETA: 1s - loss: 0.0162 - accuracy: 0.9942
1063/1688 [=================&gt;............] - ETA: 0s - loss: 0.0164 - accuracy: 0.9942
1096/1688 [==================&gt;...........] - ETA: 0s - loss: 0.0168 - accuracy: 0.9942
1128/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0169 - accuracy: 0.9942
1162/1688 [===================&gt;..........] - ETA: 0s - loss: 0.0167 - accuracy: 0.9943
1195/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0167 - accuracy: 0.9943
1227/1688 [====================&gt;.........] - ETA: 0s - loss: 0.0168 - accuracy: 0.9943
1260/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0168 - accuracy: 0.9942
1294/1688 [=====================&gt;........] - ETA: 0s - loss: 0.0167 - accuracy: 0.9943
1327/1688 [======================&gt;.......] - ETA: 0s - loss: 0.0168 - accuracy: 0.9943
1360/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0167 - accuracy: 0.9943
1393/1688 [=======================&gt;......] - ETA: 0s - loss: 0.0172 - accuracy: 0.9940
1427/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0172 - accuracy: 0.9940
1460/1688 [========================&gt;.....] - ETA: 0s - loss: 0.0173 - accuracy: 0.9940
1493/1688 [=========================&gt;....] - ETA: 0s - loss: 0.0179 - accuracy: 0.9939
1526/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0178 - accuracy: 0.9939
1558/1688 [==========================&gt;...] - ETA: 0s - loss: 0.0179 - accuracy: 0.9938
1590/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0179 - accuracy: 0.9938
1624/1688 [===========================&gt;..] - ETA: 0s - loss: 0.0178 - accuracy: 0.9939
1657/1688 [============================&gt;.] - ETA: 0s - loss: 0.0177 - accuracy: 0.9939
1688/1688 [==============================] - 3s 2ms/step - loss: 0.0177 - accuracy: 0.9939 - val_loss: 0.0619 - val_accuracy: 0.9877
Test accuracy: 0.9854999780654907
</pre></div>
</div>
</section>
<section id="model-quantization">
<h2>4. Model quantization<a class="headerlink" href="#model-quantization" title="Permalink to this headline"></a></h2>
<p>We can now turn to quantization to get a discretized version of the model,
where the weights and activations are quantized so as to be suitable for
implementation in the Akida NSoC.</p>
<p>For this, we just have to quantize the Keras model using the
<a class="reference external" href="../../api_reference/cnn2snn_apis.html#quantize">quantize</a>
function. Here, we decide to quantize to the maximum allowed bitwidths for
the first layer weights (8-bit), the subsequent layer weights (4-bit) and the
activations (4-bit).</p>
<p>The quantized model is a Keras model where the neural layers (Conv2D, Dense)
and the ReLU layers are replaced with custom CNN2SNN quantized layers
(QuantizedConv2D, QuantizedDense, QuantizedReLU). All Keras API functions
can be applied on this new model: <code class="docutils literal notranslate"><span class="pre">summary()</span></code>, <code class="docutils literal notranslate"><span class="pre">compile()</span></code>, <code class="docutils literal notranslate"><span class="pre">fit()</span></code>. etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">quantize</span></code> function folds the batch normalization layers into
the corresponding neural layer. The new weights are computed
according to this folding operation.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">quantize</span>

<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">quantize</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span>
                           <span class="n">input_weight_quantization</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                           <span class="n">weight_quantization</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                           <span class="n">activ_quantization</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">model_quantized</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Model: &quot;sequential_56&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (QuantizedConv2D)     (None, 13, 13, 32)        320
_________________________________________________________________
re_lu (QuantizedReLU)        (None, 13, 13, 32)        0
_________________________________________________________________
separable_conv2d (QuantizedS (None, 7, 7, 64)          2400
_________________________________________________________________
re_lu_1 (QuantizedReLU)      (None, 7, 7, 64)          0
_________________________________________________________________
flatten (Flatten)            (None, 3136)              0
_________________________________________________________________
dense (QuantizedDense)       (None, 10)                31370
=================================================================
Total params: 34,090
Trainable params: 34,090
Non-trainable params: 0
_________________________________________________________________
</pre></div>
</div>
<p>Check the quantized model accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_quantized</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">model_quantized</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy after 8-4-4 quantization:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Test accuracy after 8-4-4 quantization: 0.9708999991416931
</pre></div>
</div>
<p>Since we used the maximum allowed bitwidths for weights and activations, the
accuracy of the quantized model is equivalent to the one of the base model,
but for lower bitwidth, the quantization  usually introduces a performance drop.</p>
<p>Let’s try to quantize specific layers to a lower bitwidth. The CNN2SNN
toolkit provides the
<a class="reference external" href="../../api_reference/cnn2snn_apis.html#quantize-layer">quantize_layer</a>
function: each layer can be individually quantized.</p>
<p>Here, we quantize the “re_lu_1” layer to binary activations (bitwidth=1)
and the “dense” layer with 2-bit weights.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">quantize_layer</span>

<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">quantize_layer</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">,</span> <span class="s2">&quot;re_lu_1&quot;</span><span class="p">,</span> <span class="n">bitwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">quantize_layer</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">,</span> <span class="s2">&quot;dense&quot;</span><span class="p">,</span> <span class="n">bitwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">model_quantized</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">model_quantized</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy after low bitwidth quantization:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># To recover the original model accuracy, a quantization-aware training phase</span>
<span class="c1"># is required.</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Test accuracy after low bitwidth quantization: 0.1890999972820282
</pre></div>
</div>
</section>
<section id="model-fine-tuning-quantization-aware-training">
<h2>5. Model fine tuning (quantization-aware training)<a class="headerlink" href="#model-fine-tuning-quantization-aware-training" title="Permalink to this headline"></a></h2>
<p>This quantization-aware training (fine tuning) allows to cover the
performance drop due to the quantization step.</p>
<p>Note that since this step is a fine tuning, the number of epochs can be
lowered, compared to the training from scratch of the standard model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_quantized</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">model_quantized</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy after fine tuning:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Epoch 1/5

   1/1688 [..............................] - ETA: 16:19 - loss: 2.4596 - accuracy: 0.1875
  18/1688 [..............................] - ETA: 5s - loss: 2.2238 - accuracy: 0.2066   
  37/1688 [..............................] - ETA: 4s - loss: 2.0189 - accuracy: 0.2753
  55/1688 [..............................] - ETA: 4s - loss: 1.8753 - accuracy: 0.3250
  74/1688 [&gt;.............................] - ETA: 4s - loss: 1.7025 - accuracy: 0.3809
  93/1688 [&gt;.............................] - ETA: 4s - loss: 1.5567 - accuracy: 0.4355
 111/1688 [&gt;.............................] - ETA: 4s - loss: 1.4396 - accuracy: 0.4831
 129/1688 [=&gt;............................] - ETA: 4s - loss: 1.3214 - accuracy: 0.5279
 148/1688 [=&gt;............................] - ETA: 4s - loss: 1.2337 - accuracy: 0.5663
 171/1688 [==&gt;...........................] - ETA: 4s - loss: 1.1232 - accuracy: 0.6107
 194/1688 [==&gt;...........................] - ETA: 3s - loss: 1.0421 - accuracy: 0.6442
 216/1688 [==&gt;...........................] - ETA: 3s - loss: 0.9770 - accuracy: 0.6709
 239/1688 [===&gt;..........................] - ETA: 3s - loss: 0.9291 - accuracy: 0.6935
 261/1688 [===&gt;..........................] - ETA: 3s - loss: 0.8800 - accuracy: 0.7130
 284/1688 [====&gt;.........................] - ETA: 3s - loss: 0.8369 - accuracy: 0.7315
 306/1688 [====&gt;.........................] - ETA: 3s - loss: 0.7983 - accuracy: 0.7469
 329/1688 [====&gt;.........................] - ETA: 3s - loss: 0.7643 - accuracy: 0.7597
 351/1688 [=====&gt;........................] - ETA: 3s - loss: 0.7424 - accuracy: 0.7704
 374/1688 [=====&gt;........................] - ETA: 3s - loss: 0.7122 - accuracy: 0.7815
 397/1688 [======&gt;.......................] - ETA: 3s - loss: 0.6912 - accuracy: 0.7904
 420/1688 [======&gt;.......................] - ETA: 3s - loss: 0.6679 - accuracy: 0.7994
 443/1688 [======&gt;.......................] - ETA: 3s - loss: 0.6474 - accuracy: 0.8071
 466/1688 [=======&gt;......................] - ETA: 2s - loss: 0.6235 - accuracy: 0.8149
 489/1688 [=======&gt;......................] - ETA: 2s - loss: 0.6080 - accuracy: 0.8214
 512/1688 [========&gt;.....................] - ETA: 2s - loss: 0.5920 - accuracy: 0.8277
 534/1688 [========&gt;.....................] - ETA: 2s - loss: 0.5807 - accuracy: 0.8330
 556/1688 [========&gt;.....................] - ETA: 2s - loss: 0.5714 - accuracy: 0.8375
 579/1688 [=========&gt;....................] - ETA: 2s - loss: 0.5602 - accuracy: 0.8419
 602/1688 [=========&gt;....................] - ETA: 2s - loss: 0.5515 - accuracy: 0.8459
 625/1688 [==========&gt;...................] - ETA: 2s - loss: 0.5375 - accuracy: 0.8503
 647/1688 [==========&gt;...................] - ETA: 2s - loss: 0.5295 - accuracy: 0.8539
 669/1688 [==========&gt;...................] - ETA: 2s - loss: 0.5201 - accuracy: 0.8574
 692/1688 [===========&gt;..................] - ETA: 2s - loss: 0.5152 - accuracy: 0.8607
 714/1688 [===========&gt;..................] - ETA: 2s - loss: 0.5074 - accuracy: 0.8639
 737/1688 [============&gt;.................] - ETA: 2s - loss: 0.4978 - accuracy: 0.8672
 760/1688 [============&gt;.................] - ETA: 2s - loss: 0.4903 - accuracy: 0.8699
 783/1688 [============&gt;.................] - ETA: 2s - loss: 0.4862 - accuracy: 0.8722
 806/1688 [=============&gt;................] - ETA: 2s - loss: 0.4797 - accuracy: 0.8747
 829/1688 [=============&gt;................] - ETA: 2s - loss: 0.4716 - accuracy: 0.8770
 851/1688 [==============&gt;...............] - ETA: 1s - loss: 0.4717 - accuracy: 0.8788
 873/1688 [==============&gt;...............] - ETA: 1s - loss: 0.4676 - accuracy: 0.8809
 896/1688 [==============&gt;...............] - ETA: 1s - loss: 0.4608 - accuracy: 0.8832
 919/1688 [===============&gt;..............] - ETA: 1s - loss: 0.4555 - accuracy: 0.8853
 941/1688 [===============&gt;..............] - ETA: 1s - loss: 0.4505 - accuracy: 0.8873
 964/1688 [================&gt;.............] - ETA: 1s - loss: 0.4472 - accuracy: 0.8888
 987/1688 [================&gt;.............] - ETA: 1s - loss: 0.4432 - accuracy: 0.8904
1010/1688 [================&gt;.............] - ETA: 1s - loss: 0.4406 - accuracy: 0.8920
1033/1688 [=================&gt;............] - ETA: 1s - loss: 0.4362 - accuracy: 0.8936
1055/1688 [=================&gt;............] - ETA: 1s - loss: 0.4335 - accuracy: 0.8948
1078/1688 [==================&gt;...........] - ETA: 1s - loss: 0.4295 - accuracy: 0.8965
1101/1688 [==================&gt;...........] - ETA: 1s - loss: 0.4238 - accuracy: 0.8981
1124/1688 [==================&gt;...........] - ETA: 1s - loss: 0.4206 - accuracy: 0.8996
1146/1688 [===================&gt;..........] - ETA: 1s - loss: 0.4181 - accuracy: 0.9008
1169/1688 [===================&gt;..........] - ETA: 1s - loss: 0.4128 - accuracy: 0.9022
1193/1688 [====================&gt;.........] - ETA: 1s - loss: 0.4087 - accuracy: 0.9036
1216/1688 [====================&gt;.........] - ETA: 1s - loss: 0.4051 - accuracy: 0.9049
1239/1688 [=====================&gt;........] - ETA: 1s - loss: 0.4057 - accuracy: 0.9057
1262/1688 [=====================&gt;........] - ETA: 0s - loss: 0.4040 - accuracy: 0.9069
1285/1688 [=====================&gt;........] - ETA: 0s - loss: 0.4026 - accuracy: 0.9081
1308/1688 [======================&gt;.......] - ETA: 0s - loss: 0.3986 - accuracy: 0.9093
1331/1688 [======================&gt;.......] - ETA: 0s - loss: 0.3959 - accuracy: 0.9101
1354/1688 [=======================&gt;......] - ETA: 0s - loss: 0.3953 - accuracy: 0.9111
1376/1688 [=======================&gt;......] - ETA: 0s - loss: 0.3940 - accuracy: 0.9119
1398/1688 [=======================&gt;......] - ETA: 0s - loss: 0.3912 - accuracy: 0.9128
1421/1688 [========================&gt;.....] - ETA: 0s - loss: 0.3887 - accuracy: 0.9138
1444/1688 [========================&gt;.....] - ETA: 0s - loss: 0.3867 - accuracy: 0.9146
1467/1688 [=========================&gt;....] - ETA: 0s - loss: 0.3839 - accuracy: 0.9155
1489/1688 [=========================&gt;....] - ETA: 0s - loss: 0.3811 - accuracy: 0.9164
1512/1688 [=========================&gt;....] - ETA: 0s - loss: 0.3810 - accuracy: 0.9171
1534/1688 [==========================&gt;...] - ETA: 0s - loss: 0.3796 - accuracy: 0.9179
1557/1688 [==========================&gt;...] - ETA: 0s - loss: 0.3772 - accuracy: 0.9187
1580/1688 [===========================&gt;..] - ETA: 0s - loss: 0.3758 - accuracy: 0.9194
1603/1688 [===========================&gt;..] - ETA: 0s - loss: 0.3753 - accuracy: 0.9200
1627/1688 [===========================&gt;..] - ETA: 0s - loss: 0.3725 - accuracy: 0.9207
1650/1688 [============================&gt;.] - ETA: 0s - loss: 0.3699 - accuracy: 0.9213
1673/1688 [============================&gt;.] - ETA: 0s - loss: 0.3684 - accuracy: 0.9220
1688/1688 [==============================] - 5s 2ms/step - loss: 0.3674 - accuracy: 0.9222 - val_loss: 0.2540 - val_accuracy: 0.9718
Epoch 2/5

   1/1688 [..............................] - ETA: 4s - loss: 0.0052 - accuracy: 1.0000
  23/1688 [..............................] - ETA: 3s - loss: 0.2188 - accuracy: 0.9728
  46/1688 [..............................] - ETA: 3s - loss: 0.1974 - accuracy: 0.9721
  68/1688 [&gt;.............................] - ETA: 3s - loss: 0.1962 - accuracy: 0.9752
  90/1688 [&gt;.............................] - ETA: 3s - loss: 0.1635 - accuracy: 0.9771
 112/1688 [&gt;.............................] - ETA: 3s - loss: 0.1614 - accuracy: 0.9766
 135/1688 [=&gt;............................] - ETA: 3s - loss: 0.1582 - accuracy: 0.9762
 157/1688 [=&gt;............................] - ETA: 3s - loss: 0.1643 - accuracy: 0.9757
 180/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1761 - accuracy: 0.9748
 203/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1703 - accuracy: 0.9749
 225/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1834 - accuracy: 0.9726
 247/1688 [===&gt;..........................] - ETA: 3s - loss: 0.2006 - accuracy: 0.9714
 270/1688 [===&gt;..........................] - ETA: 3s - loss: 0.2026 - accuracy: 0.9716
 293/1688 [====&gt;.........................] - ETA: 3s - loss: 0.2096 - accuracy: 0.9709
 316/1688 [====&gt;.........................] - ETA: 3s - loss: 0.2071 - accuracy: 0.9714
 339/1688 [=====&gt;........................] - ETA: 3s - loss: 0.1986 - accuracy: 0.9724
 362/1688 [=====&gt;........................] - ETA: 3s - loss: 0.1991 - accuracy: 0.9725
 385/1688 [=====&gt;........................] - ETA: 2s - loss: 0.1960 - accuracy: 0.9729
 407/1688 [======&gt;.......................] - ETA: 2s - loss: 0.2007 - accuracy: 0.9724
 430/1688 [======&gt;.......................] - ETA: 2s - loss: 0.2061 - accuracy: 0.9726
 453/1688 [=======&gt;......................] - ETA: 2s - loss: 0.2118 - accuracy: 0.9723
 476/1688 [=======&gt;......................] - ETA: 2s - loss: 0.2136 - accuracy: 0.9716
 498/1688 [=======&gt;......................] - ETA: 2s - loss: 0.2109 - accuracy: 0.9717
 521/1688 [========&gt;.....................] - ETA: 2s - loss: 0.2129 - accuracy: 0.9712
 544/1688 [========&gt;.....................] - ETA: 2s - loss: 0.2108 - accuracy: 0.9717
 567/1688 [=========&gt;....................] - ETA: 2s - loss: 0.2080 - accuracy: 0.9719
 589/1688 [=========&gt;....................] - ETA: 2s - loss: 0.2065 - accuracy: 0.9718
 612/1688 [=========&gt;....................] - ETA: 2s - loss: 0.2064 - accuracy: 0.9719
 634/1688 [==========&gt;...................] - ETA: 2s - loss: 0.2107 - accuracy: 0.9717
 657/1688 [==========&gt;...................] - ETA: 2s - loss: 0.2160 - accuracy: 0.9717
 680/1688 [===========&gt;..................] - ETA: 2s - loss: 0.2183 - accuracy: 0.9715
 703/1688 [===========&gt;..................] - ETA: 2s - loss: 0.2174 - accuracy: 0.9714
 726/1688 [===========&gt;..................] - ETA: 2s - loss: 0.2195 - accuracy: 0.9714
 748/1688 [============&gt;.................] - ETA: 2s - loss: 0.2227 - accuracy: 0.9712
 770/1688 [============&gt;.................] - ETA: 2s - loss: 0.2230 - accuracy: 0.9714
 793/1688 [=============&gt;................] - ETA: 2s - loss: 0.2220 - accuracy: 0.9715
 816/1688 [=============&gt;................] - ETA: 1s - loss: 0.2203 - accuracy: 0.9714
 839/1688 [=============&gt;................] - ETA: 1s - loss: 0.2231 - accuracy: 0.9713
 862/1688 [==============&gt;...............] - ETA: 1s - loss: 0.2234 - accuracy: 0.9711
 885/1688 [==============&gt;...............] - ETA: 1s - loss: 0.2233 - accuracy: 0.9712
 908/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2232 - accuracy: 0.9713
 930/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2259 - accuracy: 0.9712
 953/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2252 - accuracy: 0.9712
 976/1688 [================&gt;.............] - ETA: 1s - loss: 0.2261 - accuracy: 0.9712
 998/1688 [================&gt;.............] - ETA: 1s - loss: 0.2245 - accuracy: 0.9714
1020/1688 [=================&gt;............] - ETA: 1s - loss: 0.2247 - accuracy: 0.9713
1043/1688 [=================&gt;............] - ETA: 1s - loss: 0.2236 - accuracy: 0.9714
1065/1688 [=================&gt;............] - ETA: 1s - loss: 0.2259 - accuracy: 0.9712
1087/1688 [==================&gt;...........] - ETA: 1s - loss: 0.2249 - accuracy: 0.9713
1110/1688 [==================&gt;...........] - ETA: 1s - loss: 0.2239 - accuracy: 0.9713
1133/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2219 - accuracy: 0.9715
1155/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2215 - accuracy: 0.9715
1178/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2237 - accuracy: 0.9713
1201/1688 [====================&gt;.........] - ETA: 1s - loss: 0.2244 - accuracy: 0.9713
1223/1688 [====================&gt;.........] - ETA: 1s - loss: 0.2278 - accuracy: 0.9711
1244/1688 [=====================&gt;........] - ETA: 1s - loss: 0.2279 - accuracy: 0.9710
1266/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2298 - accuracy: 0.9707
1288/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2284 - accuracy: 0.9708
1310/1688 [======================&gt;.......] - ETA: 0s - loss: 0.2284 - accuracy: 0.9709
1333/1688 [======================&gt;.......] - ETA: 0s - loss: 0.2301 - accuracy: 0.9707
1356/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2305 - accuracy: 0.9708
1379/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2309 - accuracy: 0.9708
1402/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2312 - accuracy: 0.9708
1425/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2321 - accuracy: 0.9708
1448/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2325 - accuracy: 0.9708
1470/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2323 - accuracy: 0.9709
1493/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2316 - accuracy: 0.9710
1515/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2311 - accuracy: 0.9711
1538/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2297 - accuracy: 0.9712
1561/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2289 - accuracy: 0.9713
1584/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2292 - accuracy: 0.9714
1607/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2283 - accuracy: 0.9716
1630/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2280 - accuracy: 0.9716
1653/1688 [============================&gt;.] - ETA: 0s - loss: 0.2287 - accuracy: 0.9717
1675/1688 [============================&gt;.] - ETA: 0s - loss: 0.2300 - accuracy: 0.9716
1688/1688 [==============================] - 4s 2ms/step - loss: 0.2303 - accuracy: 0.9716 - val_loss: 0.2578 - val_accuracy: 0.9753
Epoch 3/5

   1/1688 [..............................] - ETA: 4s - loss: 0.4614 - accuracy: 0.8750
  24/1688 [..............................] - ETA: 3s - loss: 0.1837 - accuracy: 0.9714
  46/1688 [..............................] - ETA: 3s - loss: 0.1534 - accuracy: 0.9769
  68/1688 [&gt;.............................] - ETA: 3s - loss: 0.1602 - accuracy: 0.9766
  90/1688 [&gt;.............................] - ETA: 3s - loss: 0.1751 - accuracy: 0.9750
 113/1688 [=&gt;............................] - ETA: 3s - loss: 0.1904 - accuracy: 0.9746
 135/1688 [=&gt;............................] - ETA: 3s - loss: 0.1885 - accuracy: 0.9752
 157/1688 [=&gt;............................] - ETA: 3s - loss: 0.1769 - accuracy: 0.9765
 179/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1830 - accuracy: 0.9763
 202/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1791 - accuracy: 0.9766
 224/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1934 - accuracy: 0.9761
 247/1688 [===&gt;..........................] - ETA: 3s - loss: 0.1864 - accuracy: 0.9768
 269/1688 [===&gt;..........................] - ETA: 3s - loss: 0.1851 - accuracy: 0.9770
 292/1688 [====&gt;.........................] - ETA: 3s - loss: 0.1836 - accuracy: 0.9767
 315/1688 [====&gt;.........................] - ETA: 3s - loss: 0.1870 - accuracy: 0.9762
 337/1688 [====&gt;.........................] - ETA: 3s - loss: 0.1856 - accuracy: 0.9757
 360/1688 [=====&gt;........................] - ETA: 3s - loss: 0.1838 - accuracy: 0.9760
 383/1688 [=====&gt;........................] - ETA: 2s - loss: 0.1844 - accuracy: 0.9763
 406/1688 [======&gt;.......................] - ETA: 2s - loss: 0.1843 - accuracy: 0.9764
 429/1688 [======&gt;.......................] - ETA: 2s - loss: 0.1864 - accuracy: 0.9765
 452/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1902 - accuracy: 0.9761
 475/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1898 - accuracy: 0.9761
 496/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1946 - accuracy: 0.9757
 519/1688 [========&gt;.....................] - ETA: 2s - loss: 0.1934 - accuracy: 0.9757
 542/1688 [========&gt;.....................] - ETA: 2s - loss: 0.1987 - accuracy: 0.9753
 564/1688 [=========&gt;....................] - ETA: 2s - loss: 0.2012 - accuracy: 0.9752
 587/1688 [=========&gt;....................] - ETA: 2s - loss: 0.2020 - accuracy: 0.9754
 610/1688 [=========&gt;....................] - ETA: 2s - loss: 0.2056 - accuracy: 0.9751
 633/1688 [==========&gt;...................] - ETA: 2s - loss: 0.2078 - accuracy: 0.9750
 655/1688 [==========&gt;...................] - ETA: 2s - loss: 0.2054 - accuracy: 0.9752
 677/1688 [===========&gt;..................] - ETA: 2s - loss: 0.2031 - accuracy: 0.9754
 700/1688 [===========&gt;..................] - ETA: 2s - loss: 0.2068 - accuracy: 0.9750
 722/1688 [===========&gt;..................] - ETA: 2s - loss: 0.2076 - accuracy: 0.9749
 745/1688 [============&gt;.................] - ETA: 2s - loss: 0.2047 - accuracy: 0.9750
 768/1688 [============&gt;.................] - ETA: 2s - loss: 0.2044 - accuracy: 0.9749
 791/1688 [=============&gt;................] - ETA: 2s - loss: 0.2028 - accuracy: 0.9751
 813/1688 [=============&gt;................] - ETA: 1s - loss: 0.2029 - accuracy: 0.9752
 835/1688 [=============&gt;................] - ETA: 1s - loss: 0.2049 - accuracy: 0.9749
 858/1688 [==============&gt;...............] - ETA: 1s - loss: 0.2091 - accuracy: 0.9749
 881/1688 [==============&gt;...............] - ETA: 1s - loss: 0.2118 - accuracy: 0.9749
 903/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2144 - accuracy: 0.9746
 926/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2161 - accuracy: 0.9745
 949/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2169 - accuracy: 0.9742
 972/1688 [================&gt;.............] - ETA: 1s - loss: 0.2176 - accuracy: 0.9742
 995/1688 [================&gt;.............] - ETA: 1s - loss: 0.2165 - accuracy: 0.9744
1018/1688 [=================&gt;............] - ETA: 1s - loss: 0.2144 - accuracy: 0.9747
1040/1688 [=================&gt;............] - ETA: 1s - loss: 0.2150 - accuracy: 0.9748
1063/1688 [=================&gt;............] - ETA: 1s - loss: 0.2130 - accuracy: 0.9749
1086/1688 [==================&gt;...........] - ETA: 1s - loss: 0.2104 - accuracy: 0.9751
1109/1688 [==================&gt;...........] - ETA: 1s - loss: 0.2123 - accuracy: 0.9749
1131/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2135 - accuracy: 0.9749
1153/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2138 - accuracy: 0.9748
1176/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2143 - accuracy: 0.9747
1199/1688 [====================&gt;.........] - ETA: 1s - loss: 0.2145 - accuracy: 0.9746
1222/1688 [====================&gt;.........] - ETA: 1s - loss: 0.2175 - accuracy: 0.9744
1244/1688 [=====================&gt;........] - ETA: 1s - loss: 0.2185 - accuracy: 0.9742
1267/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2193 - accuracy: 0.9742
1290/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2191 - accuracy: 0.9742
1312/1688 [======================&gt;.......] - ETA: 0s - loss: 0.2181 - accuracy: 0.9743
1333/1688 [======================&gt;.......] - ETA: 0s - loss: 0.2180 - accuracy: 0.9744
1355/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2203 - accuracy: 0.9743
1377/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2196 - accuracy: 0.9744
1400/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2184 - accuracy: 0.9745
1423/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2177 - accuracy: 0.9745
1446/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2181 - accuracy: 0.9745
1469/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2185 - accuracy: 0.9745
1491/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2210 - accuracy: 0.9744
1514/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2214 - accuracy: 0.9744
1537/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2210 - accuracy: 0.9745
1559/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2218 - accuracy: 0.9744
1582/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2217 - accuracy: 0.9745
1605/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2210 - accuracy: 0.9745
1628/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2196 - accuracy: 0.9747
1651/1688 [============================&gt;.] - ETA: 0s - loss: 0.2211 - accuracy: 0.9746
1674/1688 [============================&gt;.] - ETA: 0s - loss: 0.2214 - accuracy: 0.9745
1688/1688 [==============================] - 4s 2ms/step - loss: 0.2205 - accuracy: 0.9746 - val_loss: 0.2874 - val_accuracy: 0.9763
Epoch 4/5

   1/1688 [..............................] - ETA: 3s - loss: 6.1605e-05 - accuracy: 1.0000
  24/1688 [..............................] - ETA: 3s - loss: 0.1231 - accuracy: 0.9792    
  47/1688 [..............................] - ETA: 3s - loss: 0.1087 - accuracy: 0.9834
  70/1688 [&gt;.............................] - ETA: 3s - loss: 0.1104 - accuracy: 0.9817
  93/1688 [&gt;.............................] - ETA: 3s - loss: 0.1557 - accuracy: 0.9788
 116/1688 [=&gt;............................] - ETA: 3s - loss: 0.1713 - accuracy: 0.9768
 138/1688 [=&gt;............................] - ETA: 3s - loss: 0.1651 - accuracy: 0.9769
 160/1688 [=&gt;............................] - ETA: 3s - loss: 0.1643 - accuracy: 0.9773
 183/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1717 - accuracy: 0.9769
 205/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1752 - accuracy: 0.9764
 228/1688 [===&gt;..........................] - ETA: 3s - loss: 0.1711 - accuracy: 0.9766
 251/1688 [===&gt;..........................] - ETA: 3s - loss: 0.1773 - accuracy: 0.9761
 274/1688 [===&gt;..........................] - ETA: 3s - loss: 0.1798 - accuracy: 0.9763
 296/1688 [====&gt;.........................] - ETA: 3s - loss: 0.1773 - accuracy: 0.9767
 318/1688 [====&gt;.........................] - ETA: 3s - loss: 0.1769 - accuracy: 0.9768
 341/1688 [=====&gt;........................] - ETA: 3s - loss: 0.1707 - accuracy: 0.9772
 364/1688 [=====&gt;........................] - ETA: 2s - loss: 0.1742 - accuracy: 0.9772
 387/1688 [=====&gt;........................] - ETA: 2s - loss: 0.1703 - accuracy: 0.9777
 409/1688 [======&gt;.......................] - ETA: 2s - loss: 0.1691 - accuracy: 0.9781
 432/1688 [======&gt;.......................] - ETA: 2s - loss: 0.1748 - accuracy: 0.9778
 455/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1759 - accuracy: 0.9777
 478/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1779 - accuracy: 0.9780
 500/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1830 - accuracy: 0.9776
 523/1688 [========&gt;.....................] - ETA: 2s - loss: 0.1812 - accuracy: 0.9777
 546/1688 [========&gt;.....................] - ETA: 2s - loss: 0.1777 - accuracy: 0.9781
 568/1688 [=========&gt;....................] - ETA: 2s - loss: 0.1810 - accuracy: 0.9777
 591/1688 [=========&gt;....................] - ETA: 2s - loss: 0.1850 - accuracy: 0.9776
 613/1688 [=========&gt;....................] - ETA: 2s - loss: 0.1860 - accuracy: 0.9776
 636/1688 [==========&gt;...................] - ETA: 2s - loss: 0.1885 - accuracy: 0.9774
 659/1688 [==========&gt;...................] - ETA: 2s - loss: 0.1935 - accuracy: 0.9769
 682/1688 [===========&gt;..................] - ETA: 2s - loss: 0.1932 - accuracy: 0.9770
 705/1688 [===========&gt;..................] - ETA: 2s - loss: 0.1928 - accuracy: 0.9770
 728/1688 [===========&gt;..................] - ETA: 2s - loss: 0.1946 - accuracy: 0.9768
 751/1688 [============&gt;.................] - ETA: 2s - loss: 0.1939 - accuracy: 0.9771
 774/1688 [============&gt;.................] - ETA: 2s - loss: 0.1934 - accuracy: 0.9771
 797/1688 [=============&gt;................] - ETA: 2s - loss: 0.1919 - accuracy: 0.9771
 820/1688 [=============&gt;................] - ETA: 1s - loss: 0.1940 - accuracy: 0.9770
 842/1688 [=============&gt;................] - ETA: 1s - loss: 0.1952 - accuracy: 0.9769
 865/1688 [==============&gt;...............] - ETA: 1s - loss: 0.1938 - accuracy: 0.9769
 887/1688 [==============&gt;...............] - ETA: 1s - loss: 0.1941 - accuracy: 0.9769
 909/1688 [===============&gt;..............] - ETA: 1s - loss: 0.1949 - accuracy: 0.9768
 932/1688 [===============&gt;..............] - ETA: 1s - loss: 0.1965 - accuracy: 0.9768
 955/1688 [===============&gt;..............] - ETA: 1s - loss: 0.1976 - accuracy: 0.9766
 978/1688 [================&gt;.............] - ETA: 1s - loss: 0.1974 - accuracy: 0.9765
1000/1688 [================&gt;.............] - ETA: 1s - loss: 0.1977 - accuracy: 0.9764
1023/1688 [=================&gt;............] - ETA: 1s - loss: 0.1974 - accuracy: 0.9765
1046/1688 [=================&gt;............] - ETA: 1s - loss: 0.1979 - accuracy: 0.9765
1069/1688 [=================&gt;............] - ETA: 1s - loss: 0.2023 - accuracy: 0.9765
1091/1688 [==================&gt;...........] - ETA: 1s - loss: 0.2027 - accuracy: 0.9764
1114/1688 [==================&gt;...........] - ETA: 1s - loss: 0.2030 - accuracy: 0.9765
1136/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2029 - accuracy: 0.9765
1158/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2030 - accuracy: 0.9763
1181/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2023 - accuracy: 0.9764
1203/1688 [====================&gt;.........] - ETA: 1s - loss: 0.2017 - accuracy: 0.9764
1226/1688 [====================&gt;.........] - ETA: 1s - loss: 0.2046 - accuracy: 0.9763
1248/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2075 - accuracy: 0.9762
1271/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2101 - accuracy: 0.9761
1293/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2107 - accuracy: 0.9760
1315/1688 [======================&gt;.......] - ETA: 0s - loss: 0.2119 - accuracy: 0.9759
1338/1688 [======================&gt;.......] - ETA: 0s - loss: 0.2107 - accuracy: 0.9761
1360/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2099 - accuracy: 0.9761
1383/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2107 - accuracy: 0.9761
1406/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2121 - accuracy: 0.9760
1429/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2133 - accuracy: 0.9759
1450/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2137 - accuracy: 0.9758
1472/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2136 - accuracy: 0.9759
1494/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2125 - accuracy: 0.9759
1517/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2132 - accuracy: 0.9758
1540/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2141 - accuracy: 0.9757
1563/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2139 - accuracy: 0.9757
1586/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2135 - accuracy: 0.9757
1609/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2153 - accuracy: 0.9756
1631/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2153 - accuracy: 0.9756
1654/1688 [============================&gt;.] - ETA: 0s - loss: 0.2154 - accuracy: 0.9757
1677/1688 [============================&gt;.] - ETA: 0s - loss: 0.2159 - accuracy: 0.9757
1688/1688 [==============================] - 4s 2ms/step - loss: 0.2153 - accuracy: 0.9758 - val_loss: 0.2722 - val_accuracy: 0.9777
Epoch 5/5

   1/1688 [..............................] - ETA: 4s - loss: 0.0024 - accuracy: 1.0000
  24/1688 [..............................] - ETA: 3s - loss: 0.2116 - accuracy: 0.9740
  47/1688 [..............................] - ETA: 3s - loss: 0.2634 - accuracy: 0.9741
  70/1688 [&gt;.............................] - ETA: 3s - loss: 0.2234 - accuracy: 0.9759
  93/1688 [&gt;.............................] - ETA: 3s - loss: 0.2188 - accuracy: 0.9761
 116/1688 [=&gt;............................] - ETA: 3s - loss: 0.2130 - accuracy: 0.9763
 138/1688 [=&gt;............................] - ETA: 3s - loss: 0.2098 - accuracy: 0.9760
 160/1688 [=&gt;............................] - ETA: 3s - loss: 0.1960 - accuracy: 0.9773
 183/1688 [==&gt;...........................] - ETA: 3s - loss: 0.1961 - accuracy: 0.9776
 205/1688 [==&gt;...........................] - ETA: 3s - loss: 0.2061 - accuracy: 0.9773
 227/1688 [===&gt;..........................] - ETA: 3s - loss: 0.2051 - accuracy: 0.9767
 250/1688 [===&gt;..........................] - ETA: 3s - loss: 0.2006 - accuracy: 0.9771
 272/1688 [===&gt;..........................] - ETA: 3s - loss: 0.1943 - accuracy: 0.9784
 294/1688 [====&gt;.........................] - ETA: 3s - loss: 0.1868 - accuracy: 0.9788
 317/1688 [====&gt;.........................] - ETA: 3s - loss: 0.1932 - accuracy: 0.9789
 340/1688 [=====&gt;........................] - ETA: 3s - loss: 0.1965 - accuracy: 0.9780
 363/1688 [=====&gt;........................] - ETA: 2s - loss: 0.2049 - accuracy: 0.9772
 385/1688 [=====&gt;........................] - ETA: 2s - loss: 0.2030 - accuracy: 0.9774
 408/1688 [======&gt;.......................] - ETA: 2s - loss: 0.2027 - accuracy: 0.9773
 430/1688 [======&gt;.......................] - ETA: 2s - loss: 0.2011 - accuracy: 0.9773
 453/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1957 - accuracy: 0.9776
 475/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1978 - accuracy: 0.9771
 498/1688 [=======&gt;......................] - ETA: 2s - loss: 0.1940 - accuracy: 0.9776
 521/1688 [========&gt;.....................] - ETA: 2s - loss: 0.1965 - accuracy: 0.9775
 544/1688 [========&gt;.....................] - ETA: 2s - loss: 0.1990 - accuracy: 0.9775
 567/1688 [=========&gt;....................] - ETA: 2s - loss: 0.1975 - accuracy: 0.9777
 590/1688 [=========&gt;....................] - ETA: 2s - loss: 0.1975 - accuracy: 0.9779
 613/1688 [=========&gt;....................] - ETA: 2s - loss: 0.2000 - accuracy: 0.9777
 636/1688 [==========&gt;...................] - ETA: 2s - loss: 0.1986 - accuracy: 0.9777
 659/1688 [==========&gt;...................] - ETA: 2s - loss: 0.1971 - accuracy: 0.9779
 681/1688 [===========&gt;..................] - ETA: 2s - loss: 0.1988 - accuracy: 0.9779
 703/1688 [===========&gt;..................] - ETA: 2s - loss: 0.1979 - accuracy: 0.9780
 726/1688 [===========&gt;..................] - ETA: 2s - loss: 0.1955 - accuracy: 0.9780
 749/1688 [============&gt;.................] - ETA: 2s - loss: 0.1944 - accuracy: 0.9783
 771/1688 [============&gt;.................] - ETA: 2s - loss: 0.1964 - accuracy: 0.9781
 794/1688 [=============&gt;................] - ETA: 2s - loss: 0.1973 - accuracy: 0.9778
 817/1688 [=============&gt;................] - ETA: 1s - loss: 0.1981 - accuracy: 0.9779
 840/1688 [=============&gt;................] - ETA: 1s - loss: 0.1980 - accuracy: 0.9780
 863/1688 [==============&gt;...............] - ETA: 1s - loss: 0.2027 - accuracy: 0.9778
 885/1688 [==============&gt;...............] - ETA: 1s - loss: 0.2029 - accuracy: 0.9778
 908/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2078 - accuracy: 0.9776
 930/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2078 - accuracy: 0.9776
 952/1688 [===============&gt;..............] - ETA: 1s - loss: 0.2067 - accuracy: 0.9775
 975/1688 [================&gt;.............] - ETA: 1s - loss: 0.2061 - accuracy: 0.9777
 998/1688 [================&gt;.............] - ETA: 1s - loss: 0.2082 - accuracy: 0.9775
1021/1688 [=================&gt;............] - ETA: 1s - loss: 0.2059 - accuracy: 0.9777
1043/1688 [=================&gt;............] - ETA: 1s - loss: 0.2029 - accuracy: 0.9779
1065/1688 [=================&gt;............] - ETA: 1s - loss: 0.2021 - accuracy: 0.9780
1087/1688 [==================&gt;...........] - ETA: 1s - loss: 0.2047 - accuracy: 0.9778
1110/1688 [==================&gt;...........] - ETA: 1s - loss: 0.2083 - accuracy: 0.9776
1133/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2069 - accuracy: 0.9777
1156/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2045 - accuracy: 0.9779
1179/1688 [===================&gt;..........] - ETA: 1s - loss: 0.2024 - accuracy: 0.9780
1202/1688 [====================&gt;.........] - ETA: 1s - loss: 0.2018 - accuracy: 0.9781
1224/1688 [====================&gt;.........] - ETA: 1s - loss: 0.2012 - accuracy: 0.9782
1247/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2022 - accuracy: 0.9778
1270/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2032 - accuracy: 0.9777
1293/1688 [=====================&gt;........] - ETA: 0s - loss: 0.2063 - accuracy: 0.9775
1316/1688 [======================&gt;.......] - ETA: 0s - loss: 0.2064 - accuracy: 0.9776
1338/1688 [======================&gt;.......] - ETA: 0s - loss: 0.2062 - accuracy: 0.9776
1361/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2063 - accuracy: 0.9777
1384/1688 [=======================&gt;......] - ETA: 0s - loss: 0.2055 - accuracy: 0.9778
1407/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2067 - accuracy: 0.9778
1430/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2083 - accuracy: 0.9777
1452/1688 [========================&gt;.....] - ETA: 0s - loss: 0.2077 - accuracy: 0.9777
1475/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2077 - accuracy: 0.9777
1498/1688 [=========================&gt;....] - ETA: 0s - loss: 0.2075 - accuracy: 0.9777
1521/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2091 - accuracy: 0.9776
1543/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2098 - accuracy: 0.9776
1566/1688 [==========================&gt;...] - ETA: 0s - loss: 0.2104 - accuracy: 0.9776
1588/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2118 - accuracy: 0.9776
1611/1688 [===========================&gt;..] - ETA: 0s - loss: 0.2110 - accuracy: 0.9777
1634/1688 [============================&gt;.] - ETA: 0s - loss: 0.2106 - accuracy: 0.9777
1657/1688 [============================&gt;.] - ETA: 0s - loss: 0.2107 - accuracy: 0.9777
1679/1688 [============================&gt;.] - ETA: 0s - loss: 0.2098 - accuracy: 0.9777
1688/1688 [==============================] - 4s 2ms/step - loss: 0.2091 - accuracy: 0.9778 - val_loss: 0.2705 - val_accuracy: 0.9800
Test accuracy after fine tuning: 0.9746999740600586
</pre></div>
</div>
</section>
<section id="model-conversion">
<h2>6. Model conversion<a class="headerlink" href="#model-conversion" title="Permalink to this headline"></a></h2>
<p>After having obtained a quantized model with satisfactory performance, it can
be converted to a model suitable to be used in the Akida NSoC in inference
mode. The <a class="reference external" href="../../api_reference/cnn2snn_apis.html#convert">convert</a>
function returns a model in Akida format, ready for the Akida NSoC or the
Akida software simulator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One needs to supply the coefficients used to rescale the input
dataset before the training - here <code class="docutils literal notranslate"><span class="pre">input_scaling</span></code>.</p>
</div>
<p>As with Keras, the summary() method provides a textual representation of the
Akida model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">convert</span>

<span class="n">model_akida</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">,</span> <span class="n">input_scaling</span><span class="o">=</span><span class="n">input_scaling</span><span class="p">)</span>
<span class="n">model_akida</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">model_akida</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">raw_x_test</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_y_test</span> <span class="o">==</span> <span class="n">results</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy after conversion:&#39;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>

<span class="c1"># For non-regression purpose</span>
<span class="k">assert</span> <span class="n">accuracy</span> <span class="o">&gt;</span> <span class="mf">0.97</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>                Model Summary
______________________________________________
Input shape  Output shape  Sequences  Layers
==============================================
[28, 28, 1]  [1, 1, 10]    1          3
______________________________________________

                  SW/conv2d-dense (Software)
______________________________________________________________
Layer (type)                  Output shape  Kernel shape
==============================================================
conv2d (InputConv.)           [13, 13, 32]  (3, 3, 1, 32)
______________________________________________________________
separable_conv2d (Sep.Conv.)  [7, 7, 64]    (3, 3, 32, 1)
______________________________________________________________
                                            (1, 1, 32, 64)
______________________________________________________________
dense (Fully.)                [1, 1, 10]    (1, 1, 3136, 10)
______________________________________________________________

Test accuracy after conversion: 0.975
</pre></div>
</div>
<p>Depending on the number of samples you run, you should find a
performance of around 98% (better results can be achieved using more
epochs for training).</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  51.977 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-cnn2snn-plot-0-cnn-flow-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/feacc23c72579af617bca35c381667de/plot_0_cnn_flow.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_0_cnn_flow.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/303bd1ef847df461f1433347bc300bd7/plot_0_cnn_flow.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_0_cnn_flow.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../general/plot_6_voc_yolo_detection.html" class="btn btn-neutral float-left" title="YOLO/PASCAL-VOC detection tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_1_advanced_cnn2snn.html" class="btn btn-neutral float-right" title="Advanced CNN2SNN tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, BrainChip Holdings Ltd. All Rights Reserved.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>