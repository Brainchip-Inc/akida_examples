

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Akida vision edge learning &mdash; Akida Examples  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CNN conversion flow tutorial" href="plot_cnn_flow.html" />
    <link rel="prev" title="Regression tutorial" href="plot_regression.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #3f51b5" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/akida.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                Akida 1.8.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#quick-installation">Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#running-examples">Running examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/user_guide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#for-beginners">For beginners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#for-users-familiar-with-deep-learning">For users familiar with deep-learning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/aee.html">Akida user guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#the-akida-execution-engine">The Akida Execution Engine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id1">1. The Spiking Neural Network model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id2">2. Input data format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id3">3. Determine training mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id4">4. Interpreting outputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#neural-network-model">Neural Network model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#specifying-the-neural-network-model">Specifying the Neural Network model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#saving-and-loading">Saving and loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#input-layer-types">Input layer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#data-processing-layer-types">Data-Processing layer types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#id5">Using Akida Unsupervised Learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#learning-constraints">Learning constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#compiling-a-layer">Compiling a layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id6">Learning parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/cnn2snn.html">CNN2SNN toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#conversion-workflow">Conversion workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#typical-training-scenario">Typical training scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#design-compatibility-constraints">Design compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#quantization-compatibility-constraints">Quantization compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#command-line-interface">Command-line interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#layers-considerations">Layers Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#supported-layer-types">Supported layer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#cnn2snn-quantization-aware-layers">CNN2SNN Quantization-aware layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#training-only-layers">Training-Only Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#first-layers">First Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#id6">Final Layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/akida_models.html">Akida models zoo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/akida_models.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/akida_models.html#command-line-interface-for-model-creation">Command-line interface for model creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/akida_models.html#command-line-interface-for-model-training">Command-line interface for model training</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#cifar10-training-and-tuning">CIFAR10 training and tuning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#utk-face-training">UTK Face training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#kws-training">KWS training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#yolo-training">YOLO training</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/akida_models.html#id1">Layer Blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#conv-block"><code class="docutils literal notranslate"><span class="pre">conv_block</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#dense-block"><code class="docutils literal notranslate"><span class="pre">dense_block</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#separable-conv-block"><code class="docutils literal notranslate"><span class="pre">separable_conv_block</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/hw_constraints.html">Hardware constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/hw_constraints.html#input-layer">Input layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/hw_constraints.html#data-processing-layers">Data-Processing layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/hw_constraints.html#convolutional-layer">Convolutional layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/hw_constraints.html#fully-connected-layer">Fully connected layer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html">Akida versions compatibility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#upgrading-models-with-legacy-quantizers">Upgrading models with legacy quantizers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/api_reference.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/aee_apis.html">Akida Execution Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#model">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#layer">Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#layerstatistics">LayerStatistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#observer">Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#inputdata">InputData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#inputconvolutional">InputConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#fullyconnected">FullyConnected</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#convolutional">Convolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#separableconvolutional">SeparableConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#dense">Dense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#sparse">Sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#coords-to-sparse">coords_to_sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#dense-to-sparse">dense_to_sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#packetize">packetize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#backend">Backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#convolutionmode">ConvolutionMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#poolingtype">PoolingType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#learningtype">LearningType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#compatibility">Compatibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/cnn2snn_apis.html">CNN2SNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#tool-functions">Tool functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantize">quantize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantize-layer">quantize_layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#convert">convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#check-model-compatibility">check_model_compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#load-quantized-model">load_quantized_model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#load-partial-weights">load_partial_weights</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizers">Quantizers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#weightquantizer">WeightQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#linearweightquantizer">LinearWeightQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#stdweightquantizer">StdWeightQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#trainablestdweightquantizer">TrainableStdWeightQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#maxquantizer">MaxQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#maxperaxisquantizer">MaxPerAxisQuantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#weightfloat">WeightFloat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantized-layers">Quantized layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedconv2d">QuantizedConv2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizeddepthwiseconv2d">QuantizedDepthwiseConv2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizeddense">QuantizedDense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedseparableconv2d">QuantizedSeparableConv2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedactivation">QuantizedActivation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#activationdiscreterelu">ActivationDiscreteRelu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedrelu">QuantizedReLU</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/akida_models_apis.html">Akida models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/akida_models_apis.html#layer-blocks">Layer blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#conv-block">conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#separable-conv-block">separable_conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#dense-block">dense_block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/akida_models_apis.html#model-zoo">Model zoo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#mobilenet">Mobilenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#ds-cnn">DS-CNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#vgg">VGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#yolo">YOLO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_gxnor_mnist.html">GXNOR/MNIST inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#load-the-pre-trained-akida-model">2. Load the pre-trained Akida model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#show-predictions-for-a-single-image">3. Show predictions for a single image</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#check-performance">4. Check performance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_regression.html">Regression tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#load-the-dataset">1. Load the dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#load-a-pre-trained-quantized-keras-model-satisfying-akida-nsoc-requirements">3. Load a pre-trained quantized Keras model satisfying Akida NSoC requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#estimate-age-on-a-single-image">5. Estimate age on a single image</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Akida vision edge learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prepare-akida-model-for-learning">2. Prepare Akida model for learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#edge-learning-with-akida">3. Edge learning with Akida</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_cnn_flow.html">CNN conversion flow tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#load-and-reshape-mnist-dataset">1. Load and reshape MNIST dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#model-definition">2. Model definition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_cnn_flow.html#model-training">3. Model training</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#model-quantization">4. Model quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#model-fine-tuning-quantization-aware-training">5. Model fine tuning (quantization-aware training)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#model-conversion">6. Model conversion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_ds_cnn_kws.html">DS-CNN/KWS inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#load-the-preprocessed-dataset">1. Load the preprocessed dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#load-a-pre-trained-quantized-keras-model-satisfying-akida-nsoc-requirements">3. Load a pre-trained quantized Keras model satisfying Akida NSoC requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#conversion-to-akida">4. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_kws.html#confusion-matrix">5. Confusion matrix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_ds_cnn_cifar10.html">DS-CNN CIFAR10 inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#create-a-keras-ds-cnn-model">2. Create a Keras DS-CNN model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#quantized-model">3. Quantized model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#pretrained-quantized-model">4. Pretrained quantized model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#conversion-to-akida">5. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_cifar10.html#convert-to-akida-model">5.1 Convert to Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_cifar10.html#check-hardware-compliancy">5.2 Check hardware compliancy</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_cifar10.html#check-performance">5.3 Check performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_cifar10.html#show-predictions-for-a-random-image">5.4 Show predictions for a random image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_advanced_cnn2snn.html">Advanced CNN2SNN tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_advanced_cnn2snn.html#design-a-cnn2snn-quantized-model">1. Design a CNN2SNN quantized model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#quantized-neural-layers">Quantized neural layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#quantized-activation-layers">Quantized activation layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#load-pre-trained-weights-from-a-native-keras-model">Load pre-trained weights from a native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#create-a-quantized-model">Create a quantized model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_advanced_cnn2snn.html#weight-quantizer-details">2. Weight Quantizer Details</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#how-a-weight-quantizer-works">How a weight quantizer works</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#how-to-create-a-custom-weight-quantizer">How to create a custom weight quantizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#why-use-a-different-quantizer">Why use a different quantizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_advanced_cnn2snn.html#quantized-activation-layer-details">3. Quantized Activation Layer Details</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#how-a-quantized-activation-works">How a quantized activation works</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#how-to-create-a-custom-quantized-activation-layer">How to create a custom quantized activation layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_advanced_cnn2snn.html#why-use-a-different-quantized-activation">Why use a different quantized activation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_edge_learning_parameters.html">Tips to set Akida learning parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_parameters.html#akida-learning-parameters">1. Akida learning parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_parameters.html#create-akida-model">2. Create Akida model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_parameters.html#estimate-the-required-number-of-weights-of-the-trainable-layer">3. Estimate the required number of weights of the trainable layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_parameters.html#estimate-the-number-of-neurons-per-class">4. Estimate the number of neurons per class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_voc_yolo_detection.html">YOLO/PASCAL-VOC detection tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_voc_yolo_detection.html#introduction">1. Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_voc_yolo_detection.html#object-detection">1.1 Object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_voc_yolo_detection.html#yolo-key-concepts">1.2 YOLO key concepts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_voc_yolo_detection.html#preprocessing-tools">2. Preprocessing tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_voc_yolo_detection.html#model-architecture">3. Model architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_voc_yolo_detection.html#training">4. Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_voc_yolo_detection.html#performance">5. Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_voc_yolo_detection.html#conversion-to-akida">6. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_voc_yolo_detection.html#convert-to-akida-model">6.1 Convert to Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_voc_yolo_detection.html#check-performance">6.1 Check performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_voc_yolo_detection.html#show-predictions-for-a-random-image">6.2 Show predictions for a random image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_transfer_learning.html">Transfer learning with MobileNet for cats vs. dogs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#transfer-learning-process">Transfer learning process</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#load-and-preprocess-data">1. Load and preprocess data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#a-load-and-split-data">1.A - Load and split data</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#b-preprocess-the-test-set">1.B - Preprocess the test set</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#c-get-labels">1.C - Get labels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#modify-a-pre-trained-base-keras-model">2. Modify a pre-trained base Keras model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#a-instantiate-a-keras-base-model">2.A - Instantiate a Keras base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#b-modify-the-network-for-the-new-task">2.B - Modify the network for the new task</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#train-the-transferred-model-for-the-new-task">3. Train the transferred model for the new task</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#quantize-the-top-layer">4 Quantize the top layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#convert-to-akida">5. Convert to Akida</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#plot-confusion-matrix">6. Plot confusion matrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_edge_learning_kws.html">Akida edge learning for keyword spotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_kws.html#edge-learning-process">1. Edge learning process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_edge_learning_kws.html#akida-model-preparation">1.1 Akida model preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_edge_learning_kws.html#offline-akida-learning">1.2 ‚ÄúOffline‚Äù Akida learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_edge_learning_kws.html#online-edge-learning">1.3 ‚ÄúOnline‚Äù edge learning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_kws.html#dataset-preparation">2. Dataset preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_kws.html#prepare-akida-model-for-learning">3. Prepare Akida model for learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_kws.html#learn-with-akida-using-the-training-set">4. Learn with Akida using the training set</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_edge_learning_kws.html#edge-learning">4. Edge learning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_mobilenet_imagenet.html">MobileNet/ImageNet inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#create-a-keras-mobilenet-model">2. Create a Keras MobileNet model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#quantized-model">3. Quantized model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#pretrained-quantized-model">4. Pretrained quantized model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#conversion-to-akida">5. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#convert-to-akida-model">5.1 Convert to Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#check-hardware-compliancy">5.2 Check hardware compliancy</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#check-performance">5.3 Check performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#show-predictions-for-a-random-image">5.4 Show predictions for a random image</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Brainchip-Inc/akida_examples/releases">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://support.brainchip.com/portal/home">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Akida Examples</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Akida examples</a> &raquo;</li>
        
      <li>Akida vision edge learning</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-plot-edge-learning-vision-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="akida-vision-edge-learning">
<span id="sphx-glr-examples-plot-edge-learning-vision-py"></span><h1>Akida vision edge learning<a class="headerlink" href="#akida-vision-edge-learning" title="Permalink to this headline">¬∂</a></h1>
<p>This tutorial demonstrates the Akida NSoC <strong>edge learning</strong> capabilities using
its built-in learning algorithm.
It focuses on an image classification example, where an existing Akida network
is re-trained to be able to classify images from 5 new classes.</p>
<p>Just a few samples (few-shot learning) of the new classes are sufficient
to augment the Akida model with extra classes, while preserving high accuracy.</p>
<p>Please refer to the <a class="reference external" href="plot_edge_learning_kws.html">keyword spotting (KWS) tutorial</a>
for edge learning documentation, parameters fine tuning and steps details.</p>
<div class="section" id="dataset-preparation">
<h2>1. Dataset preparation<a class="headerlink" href="#dataset-preparation" title="Permalink to this headline">¬∂</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow_datasets</span> <span class="k">as</span> <span class="nn">tfds</span>

<span class="c1"># Retrieve TensorFlow `coil100 &lt;https://www.tensorflow.org/datasets/catalog/coil100&gt;`__</span>
<span class="c1"># dataset</span>
<span class="n">ds</span><span class="p">,</span> <span class="n">ds_info</span> <span class="o">=</span> <span class="n">tfds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;coil100:1.*.*&#39;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">with_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds_info</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[1mDownloading and preparing dataset coil100/1.0.0 (download: 124.63 MiB, generated: Unknown size, total: 124.63 MiB) to /root/tensorflow_datasets/coil100/1.0.0...[0m

Dl Completed...: 0 url [00:00, ? url/s]

Dl Size...: 0 MiB [00:00, ? MiB/s][A


Extraction completed...: 0 file [00:00, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:00&lt;?, ? url/s]

Dl Size...: 0 MiB [00:00, ? MiB/s][A


Extraction completed...: 0 file [00:00, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:00&lt;?, ? url/s]

Dl Size...:   0%|          | 0/124 [00:00&lt;?, ? MiB/s][A


Extraction completed...: 0 file [00:00, ? file/s][A[A

Dl Size...:   1%|          | 1/124 [00:01&lt;02:29,  1.22s/ MiB][A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   1%|          | 1/124 [00:01&lt;02:29,  1.22s/ MiB][A


Extraction completed...: 0 file [00:01, ? file/s][A[A

Dl Size...:   2%|1         | 2/124 [00:01&lt;01:47,  1.13 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   2%|1         | 2/124 [00:01&lt;01:47,  1.13 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A

Dl Size...:   2%|2         | 3/124 [00:01&lt;01:20,  1.50 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   2%|2         | 3/124 [00:01&lt;01:20,  1.50 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   3%|3         | 4/124 [00:01&lt;01:20,  1.50 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   4%|4         | 5/124 [00:01&lt;01:19,  1.50 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A

Dl Size...:   5%|4         | 6/124 [00:01&lt;00:57,  2.06 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   5%|4         | 6/124 [00:01&lt;00:57,  2.06 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   6%|5         | 7/124 [00:01&lt;00:56,  2.06 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A

Dl Size...:   6%|6         | 8/124 [00:01&lt;00:41,  2.77 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   6%|6         | 8/124 [00:01&lt;00:41,  2.77 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   7%|7         | 9/124 [00:01&lt;00:41,  2.77 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A

Dl Size...:   8%|8         | 10/124 [00:01&lt;00:30,  3.68 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:01&lt;?, ? url/s]

Dl Size...:   8%|8         | 10/124 [00:01&lt;00:30,  3.68 MiB/s][A


Extraction completed...: 0 file [00:01, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:   9%|8         | 11/124 [00:02&lt;00:30,  3.68 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A

Dl Size...:  10%|9         | 12/124 [00:02&lt;00:24,  4.64 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  10%|9         | 12/124 [00:02&lt;00:24,  4.64 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  10%|#         | 13/124 [00:02&lt;00:23,  4.64 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A

Dl Size...:  11%|#1        | 14/124 [00:02&lt;00:19,  5.68 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  11%|#1        | 14/124 [00:02&lt;00:19,  5.68 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  12%|#2        | 15/124 [00:02&lt;00:19,  5.68 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A

Dl Size...:  13%|#2        | 16/124 [00:02&lt;00:15,  6.84 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  13%|#2        | 16/124 [00:02&lt;00:15,  6.84 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  14%|#3        | 17/124 [00:02&lt;00:15,  6.84 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A

Dl Size...:  15%|#4        | 18/124 [00:02&lt;00:13,  7.82 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  15%|#4        | 18/124 [00:02&lt;00:13,  7.82 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  15%|#5        | 19/124 [00:02&lt;00:13,  7.82 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A

Dl Size...:  16%|#6        | 20/124 [00:02&lt;00:11,  9.37 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  16%|#6        | 20/124 [00:02&lt;00:11,  9.37 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  17%|#6        | 21/124 [00:02&lt;00:10,  9.37 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A

Dl Size...:  18%|#7        | 22/124 [00:02&lt;00:10,  9.99 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  18%|#7        | 22/124 [00:02&lt;00:10,  9.99 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:02&lt;?, ? url/s]

Dl Size...:  19%|#8        | 23/124 [00:02&lt;00:10,  9.99 MiB/s][A


Extraction completed...: 0 file [00:02, ? file/s][A[A

Dl Size...:  19%|#9        | 24/124 [00:03&lt;00:09, 10.52 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  19%|#9        | 24/124 [00:03&lt;00:09, 10.52 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  20%|##        | 25/124 [00:03&lt;00:09, 10.52 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A

Dl Size...:  21%|##        | 26/124 [00:03&lt;00:08, 11.18 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  21%|##        | 26/124 [00:03&lt;00:08, 11.18 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  22%|##1       | 27/124 [00:03&lt;00:08, 11.18 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A

Dl Size...:  23%|##2       | 28/124 [00:03&lt;00:07, 12.40 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  23%|##2       | 28/124 [00:03&lt;00:07, 12.40 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  23%|##3       | 29/124 [00:03&lt;00:07, 12.40 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A

Dl Size...:  24%|##4       | 30/124 [00:03&lt;00:07, 12.63 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  24%|##4       | 30/124 [00:03&lt;00:07, 12.63 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  25%|##5       | 31/124 [00:03&lt;00:07, 12.63 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A

Dl Size...:  26%|##5       | 32/124 [00:03&lt;00:07, 12.46 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  26%|##5       | 32/124 [00:03&lt;00:07, 12.46 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  27%|##6       | 33/124 [00:03&lt;00:07, 12.46 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A

Dl Size...:  27%|##7       | 34/124 [00:03&lt;00:06, 13.51 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  27%|##7       | 34/124 [00:03&lt;00:06, 13.51 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  28%|##8       | 35/124 [00:03&lt;00:06, 13.51 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A

Dl Size...:  29%|##9       | 36/124 [00:03&lt;00:06, 13.11 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  29%|##9       | 36/124 [00:03&lt;00:06, 13.11 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:03&lt;?, ? url/s]

Dl Size...:  30%|##9       | 37/124 [00:03&lt;00:06, 13.11 MiB/s][A


Extraction completed...: 0 file [00:03, ? file/s][A[A

Dl Size...:  31%|###       | 38/124 [00:04&lt;00:06, 13.03 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  31%|###       | 38/124 [00:04&lt;00:06, 13.03 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  31%|###1      | 39/124 [00:04&lt;00:06, 13.03 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  32%|###2      | 40/124 [00:04&lt;00:06, 13.03 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A

Dl Size...:  33%|###3      | 41/124 [00:04&lt;00:06, 13.65 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  33%|###3      | 41/124 [00:04&lt;00:06, 13.65 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  34%|###3      | 42/124 [00:04&lt;00:06, 13.65 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A

Dl Size...:  35%|###4      | 43/124 [00:04&lt;00:06, 13.43 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  35%|###4      | 43/124 [00:04&lt;00:06, 13.43 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  35%|###5      | 44/124 [00:04&lt;00:05, 13.43 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A

Dl Size...:  36%|###6      | 45/124 [00:04&lt;00:05, 13.44 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  36%|###6      | 45/124 [00:04&lt;00:05, 13.44 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  37%|###7      | 46/124 [00:04&lt;00:05, 13.44 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A

Dl Size...:  38%|###7      | 47/124 [00:04&lt;00:05, 14.37 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  38%|###7      | 47/124 [00:04&lt;00:05, 14.37 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  39%|###8      | 48/124 [00:04&lt;00:05, 14.37 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A

Dl Size...:  40%|###9      | 49/124 [00:04&lt;00:05, 13.72 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  40%|###9      | 49/124 [00:04&lt;00:05, 13.72 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  40%|####      | 50/124 [00:04&lt;00:05, 13.72 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A

Dl Size...:  41%|####1     | 51/124 [00:04&lt;00:05, 14.52 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:04&lt;?, ? url/s]

Dl Size...:  41%|####1     | 51/124 [00:04&lt;00:05, 14.52 MiB/s][A


Extraction completed...: 0 file [00:04, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  42%|####1     | 52/124 [00:05&lt;00:04, 14.52 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A

Dl Size...:  43%|####2     | 53/124 [00:05&lt;00:05, 14.03 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  43%|####2     | 53/124 [00:05&lt;00:05, 14.03 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  44%|####3     | 54/124 [00:05&lt;00:04, 14.03 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A

Dl Size...:  44%|####4     | 55/124 [00:05&lt;00:04, 13.81 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  44%|####4     | 55/124 [00:05&lt;00:04, 13.81 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  45%|####5     | 56/124 [00:05&lt;00:04, 13.81 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A

Dl Size...:  46%|####5     | 57/124 [00:05&lt;00:04, 14.77 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  46%|####5     | 57/124 [00:05&lt;00:04, 14.77 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  47%|####6     | 58/124 [00:05&lt;00:04, 14.77 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A

Dl Size...:  48%|####7     | 59/124 [00:05&lt;00:04, 14.06 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  48%|####7     | 59/124 [00:05&lt;00:04, 14.06 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  48%|####8     | 60/124 [00:05&lt;00:04, 14.06 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A

Dl Size...:  49%|####9     | 61/124 [00:05&lt;00:04, 15.24 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  49%|####9     | 61/124 [00:05&lt;00:04, 15.24 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  50%|#####     | 62/124 [00:05&lt;00:04, 15.24 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A

Dl Size...:  51%|#####     | 63/124 [00:05&lt;00:04, 14.14 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  51%|#####     | 63/124 [00:05&lt;00:04, 14.14 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  52%|#####1    | 64/124 [00:05&lt;00:04, 14.14 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A

Dl Size...:  52%|#####2    | 65/124 [00:05&lt;00:04, 14.02 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  52%|#####2    | 65/124 [00:05&lt;00:04, 14.02 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:05&lt;?, ? url/s]

Dl Size...:  53%|#####3    | 66/124 [00:05&lt;00:04, 14.02 MiB/s][A


Extraction completed...: 0 file [00:05, ? file/s][A[A

Dl Size...:  54%|#####4    | 67/124 [00:06&lt;00:03, 15.00 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  54%|#####4    | 67/124 [00:06&lt;00:03, 15.00 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  55%|#####4    | 68/124 [00:06&lt;00:03, 15.00 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A

Dl Size...:  56%|#####5    | 69/124 [00:06&lt;00:03, 14.16 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  56%|#####5    | 69/124 [00:06&lt;00:03, 14.16 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  56%|#####6    | 70/124 [00:06&lt;00:03, 14.16 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A

Dl Size...:  57%|#####7    | 71/124 [00:06&lt;00:03, 15.21 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  57%|#####7    | 71/124 [00:06&lt;00:03, 15.21 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  58%|#####8    | 72/124 [00:06&lt;00:03, 15.21 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A

Dl Size...:  59%|#####8    | 73/124 [00:06&lt;00:03, 14.23 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  59%|#####8    | 73/124 [00:06&lt;00:03, 14.23 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  60%|#####9    | 74/124 [00:06&lt;00:03, 14.23 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A

Dl Size...:  60%|######    | 75/124 [00:06&lt;00:03, 15.44 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  60%|######    | 75/124 [00:06&lt;00:03, 15.44 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  61%|######1   | 76/124 [00:06&lt;00:03, 15.44 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A

Dl Size...:  62%|######2   | 77/124 [00:06&lt;00:03, 14.34 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  62%|######2   | 77/124 [00:06&lt;00:03, 14.34 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  63%|######2   | 78/124 [00:06&lt;00:03, 14.34 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A

Dl Size...:  64%|######3   | 79/124 [00:06&lt;00:03, 14.19 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  64%|######3   | 79/124 [00:06&lt;00:03, 14.19 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:06&lt;?, ? url/s]

Dl Size...:  65%|######4   | 80/124 [00:06&lt;00:03, 14.19 MiB/s][A


Extraction completed...: 0 file [00:06, ? file/s][A[A

Dl Size...:  65%|######5   | 81/124 [00:07&lt;00:02, 14.85 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  65%|######5   | 81/124 [00:07&lt;00:02, 14.85 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  66%|######6   | 82/124 [00:07&lt;00:02, 14.85 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A

Dl Size...:  67%|######6   | 83/124 [00:07&lt;00:02, 14.44 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  67%|######6   | 83/124 [00:07&lt;00:02, 14.44 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  68%|######7   | 84/124 [00:07&lt;00:02, 14.44 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A

Dl Size...:  69%|######8   | 85/124 [00:07&lt;00:02, 15.18 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  69%|######8   | 85/124 [00:07&lt;00:02, 15.18 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  69%|######9   | 86/124 [00:07&lt;00:02, 15.18 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A

Dl Size...:  70%|#######   | 87/124 [00:07&lt;00:02, 14.47 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  70%|#######   | 87/124 [00:07&lt;00:02, 14.47 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  71%|#######   | 88/124 [00:07&lt;00:02, 14.47 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A

Dl Size...:  72%|#######1  | 89/124 [00:07&lt;00:02, 15.34 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  72%|#######1  | 89/124 [00:07&lt;00:02, 15.34 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  73%|#######2  | 90/124 [00:07&lt;00:02, 15.34 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A

Dl Size...:  73%|#######3  | 91/124 [00:07&lt;00:02, 14.49 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  73%|#######3  | 91/124 [00:07&lt;00:02, 14.49 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  74%|#######4  | 92/124 [00:07&lt;00:02, 14.49 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A

Dl Size...:  75%|#######5  | 93/124 [00:07&lt;00:02, 14.80 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  75%|#######5  | 93/124 [00:07&lt;00:02, 14.80 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  76%|#######5  | 94/124 [00:07&lt;00:02, 14.80 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A

Dl Size...:  77%|#######6  | 95/124 [00:07&lt;00:01, 14.84 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:07&lt;?, ? url/s]

Dl Size...:  77%|#######6  | 95/124 [00:07&lt;00:01, 14.84 MiB/s][A


Extraction completed...: 0 file [00:07, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  77%|#######7  | 96/124 [00:08&lt;00:01, 14.84 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A

Dl Size...:  78%|#######8  | 97/124 [00:08&lt;00:01, 14.42 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  78%|#######8  | 97/124 [00:08&lt;00:01, 14.42 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  79%|#######9  | 98/124 [00:08&lt;00:01, 14.42 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A

Dl Size...:  80%|#######9  | 99/124 [00:08&lt;00:01, 15.04 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  80%|#######9  | 99/124 [00:08&lt;00:01, 15.04 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  81%|########  | 100/124 [00:08&lt;00:01, 15.04 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A

Dl Size...:  81%|########1 | 101/124 [00:08&lt;00:01, 14.52 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  81%|########1 | 101/124 [00:08&lt;00:01, 14.52 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  82%|########2 | 102/124 [00:08&lt;00:01, 14.52 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A

Dl Size...:  83%|########3 | 103/124 [00:08&lt;00:01, 15.46 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  83%|########3 | 103/124 [00:08&lt;00:01, 15.46 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  84%|########3 | 104/124 [00:08&lt;00:01, 15.46 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A

Dl Size...:  85%|########4 | 105/124 [00:08&lt;00:01, 14.57 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  85%|########4 | 105/124 [00:08&lt;00:01, 14.57 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  85%|########5 | 106/124 [00:08&lt;00:01, 14.57 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A

Dl Size...:  86%|########6 | 107/124 [00:08&lt;00:01, 15.44 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  86%|########6 | 107/124 [00:08&lt;00:01, 15.44 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  87%|########7 | 108/124 [00:08&lt;00:01, 15.44 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A

Dl Size...:  88%|########7 | 109/124 [00:08&lt;00:01, 14.67 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:08&lt;?, ? url/s]

Dl Size...:  88%|########7 | 109/124 [00:08&lt;00:01, 14.67 MiB/s][A


Extraction completed...: 0 file [00:08, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  89%|########8 | 110/124 [00:09&lt;00:00, 14.67 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A

Dl Size...:  90%|########9 | 111/124 [00:09&lt;00:00, 14.45 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  90%|########9 | 111/124 [00:09&lt;00:00, 14.45 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  90%|######### | 112/124 [00:09&lt;00:00, 14.45 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A

Dl Size...:  91%|#########1| 113/124 [00:09&lt;00:00, 14.96 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  91%|#########1| 113/124 [00:09&lt;00:00, 14.96 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  92%|#########1| 114/124 [00:09&lt;00:00, 14.96 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A

Dl Size...:  93%|#########2| 115/124 [00:09&lt;00:00, 14.46 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  93%|#########2| 115/124 [00:09&lt;00:00, 14.46 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  94%|#########3| 116/124 [00:09&lt;00:00, 14.46 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A

Dl Size...:  94%|#########4| 117/124 [00:09&lt;00:00, 15.09 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  94%|#########4| 117/124 [00:09&lt;00:00, 15.09 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  95%|#########5| 118/124 [00:09&lt;00:00, 15.09 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A

Dl Size...:  96%|#########5| 119/124 [00:09&lt;00:00, 14.45 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  96%|#########5| 119/124 [00:09&lt;00:00, 14.45 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  97%|#########6| 120/124 [00:09&lt;00:00, 14.45 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A

Dl Size...:  98%|#########7| 121/124 [00:09&lt;00:00, 15.44 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  98%|#########7| 121/124 [00:09&lt;00:00, 15.44 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  98%|#########8| 122/124 [00:09&lt;00:00, 15.44 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A

Dl Size...:  99%|#########9| 123/124 [00:09&lt;00:00, 14.56 MiB/s][A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...:  99%|#########9| 123/124 [00:09&lt;00:00, 14.56 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...:   0%|          | 0/1 [00:09&lt;?, ? url/s]

Dl Size...: 100%|##########| 124/124 [00:09&lt;00:00, 14.56 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...: 100%|##########| 1/1 [00:09&lt;00:00,  9.98s/ url]
Dl Completed...: 100%|##########| 1/1 [00:09&lt;00:00,  9.98s/ url]

Dl Size...: 100%|##########| 124/124 [00:09&lt;00:00, 14.56 MiB/s][A


Extraction completed...: 0 file [00:09, ? file/s][A[A
Dl Completed...: 100%|##########| 1/1 [00:09&lt;00:00,  9.98s/ url]

Dl Size...: 100%|##########| 124/124 [00:09&lt;00:00, 14.56 MiB/s][A


Extraction completed...:   0%|          | 0/1 [00:09&lt;?, ? file/s][A[A


Extraction completed...: 100%|##########| 1/1 [00:11&lt;00:00, 11.46s/ file][A[A
Dl Completed...: 100%|##########| 1/1 [00:11&lt;00:00,  9.98s/ url]

Dl Size...: 100%|##########| 124/124 [00:11&lt;00:00, 14.56 MiB/s][A


Extraction completed...: 100%|##########| 1/1 [00:11&lt;00:00, 11.46s/ file][A[A

Extraction completed...: 100%|##########| 1/1 [00:11&lt;00:00, 11.46s/ file]


Dl Size...: 100%|##########| 124/124 [00:11&lt;00:00, 10.82 MiB/s]


Dl Completed...: 100%|##########| 1/1 [00:11&lt;00:00, 11.46s/ url]

0 examples [00:00, ? examples/s]
409 examples [00:00, 4084.06 examples/s]
853 examples [00:00, 4182.26 examples/s]
1292 examples [00:00, 4241.47 examples/s]
1722 examples [00:00, 4256.39 examples/s]
2153 examples [00:00, 4270.67 examples/s]
2580 examples [00:00, 4222.81 examples/s]
3003 examples [00:00, 4224.38 examples/s]
3431 examples [00:00, 4239.27 examples/s]
3861 examples [00:00, 4254.49 examples/s]
4289 examples [00:01, 4260.75 examples/s]
4717 examples [00:01, 4266.20 examples/s]
5145 examples [00:01, 4270.05 examples/s]
5576 examples [00:01, 4280.03 examples/s]
6005 examples [00:01, 4280.18 examples/s]
6435 examples [00:01, 4284.93 examples/s]
6865 examples [00:01, 4287.61 examples/s]

Shuffling and writing examples to /root/tensorflow_datasets/coil100/1.0.0.incomplete4TKKCY/coil100-train.tfrecord

  0%|          | 0/7200 [00:00&lt;?, ? examples/s]
 97%|#########6| 6952/7200 [00:00&lt;00:00, 69519.24 examples/s]

[1mDataset coil100 downloaded and prepared to /root/tensorflow_datasets/coil100/1.0.0. Subsequent calls will reuse this data.[0m
The dataset contains 7200 color images of 100 objects
(72 images per object). The objects have a wide variety of complex geometric and reflectance characteristics.
The objects were placed on a motorized turntable against a black background.
The turntable was rotated through 360 degrees to vary object pose with respect to a fxed color camera.
Images of the objects were taken at pose intervals of   5 degrees.This corresponds to
72 poses per object
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the 5 cup objects that will be used as new classes</span>
<span class="n">object_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;obj10&#39;</span><span class="p">,</span> <span class="s1">&#39;obj16&#39;</span><span class="p">,</span> <span class="s1">&#39;obj18&#39;</span><span class="p">,</span> <span class="s1">&#39;obj25&#39;</span><span class="p">,</span> <span class="s1">&#39;obj43&#39;</span><span class="p">]</span>
<span class="n">object_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">object_ids</span><span class="p">}</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
    <span class="n">object_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">object_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">object_dict</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Display one image per selected object</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_dict</span><span class="p">))</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">object_dict</span><span class="p">:</span>
    <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">object_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="obj10, obj16, obj18, obj25, obj43" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_edge_learning_vision_001.png" />
</div>
<div class="section" id="prepare-akida-model-for-learning">
<h2>2. Prepare Akida model for learning<a class="headerlink" href="#prepare-akida-model-for-learning" title="Permalink to this headline">¬∂</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">mobilenet_edge_imagenet_pretrained</span>
<span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">convert</span>

<span class="c1"># Load a pre-trained model</span>
<span class="n">model_keras</span> <span class="o">=</span> <span class="n">mobilenet_edge_imagenet_pretrained</span><span class="p">()</span>

<span class="c1"># Convert it to akida</span>
<span class="n">model_ak</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span> <span class="n">input_scaling</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from http://data.brainchip.com/models/mobilenet_edge/mobilenet_imagenet_alpha_50_edge_iq8_wq4_aq4.h5

    8192/15810768 [..............................] - ETA: 36s
   73728/15810768 [..............................] - ETA: 16s
  270336/15810768 [..............................] - ETA: 7s 
  466944/15810768 [..............................] - ETA: 6s
  663552/15810768 [&gt;.............................] - ETA: 5s
  860160/15810768 [&gt;.............................] - ETA: 5s
 1056768/15810768 [=&gt;............................] - ETA: 5s
 1253376/15810768 [=&gt;............................] - ETA: 5s
 1449984/15810768 [=&gt;............................] - ETA: 4s
 1646592/15810768 [==&gt;...........................] - ETA: 4s
 1843200/15810768 [==&gt;...........................] - ETA: 4s
 2039808/15810768 [==&gt;...........................] - ETA: 4s
 2236416/15810768 [===&gt;..........................] - ETA: 4s
 2433024/15810768 [===&gt;..........................] - ETA: 4s
 2629632/15810768 [===&gt;..........................] - ETA: 4s
 2826240/15810768 [====&gt;.........................] - ETA: 4s
 3022848/15810768 [====&gt;.........................] - ETA: 4s
 3219456/15810768 [=====&gt;........................] - ETA: 4s
 3416064/15810768 [=====&gt;........................] - ETA: 3s
 3612672/15810768 [=====&gt;........................] - ETA: 3s
 3809280/15810768 [======&gt;.......................] - ETA: 3s
 4005888/15810768 [======&gt;.......................] - ETA: 3s
 4202496/15810768 [======&gt;.......................] - ETA: 3s
 4399104/15810768 [=======&gt;......................] - ETA: 3s
 4595712/15810768 [=======&gt;......................] - ETA: 3s
 4792320/15810768 [========&gt;.....................] - ETA: 3s
 4988928/15810768 [========&gt;.....................] - ETA: 3s
 5185536/15810768 [========&gt;.....................] - ETA: 3s
 5382144/15810768 [=========&gt;....................] - ETA: 3s
 5578752/15810768 [=========&gt;....................] - ETA: 3s
 5775360/15810768 [=========&gt;....................] - ETA: 3s
 5971968/15810768 [==========&gt;...................] - ETA: 3s
 6168576/15810768 [==========&gt;...................] - ETA: 3s
 6365184/15810768 [===========&gt;..................] - ETA: 2s
 6561792/15810768 [===========&gt;..................] - ETA: 2s
 6758400/15810768 [===========&gt;..................] - ETA: 2s
 6955008/15810768 [============&gt;.................] - ETA: 2s
 7151616/15810768 [============&gt;.................] - ETA: 2s
 7348224/15810768 [============&gt;.................] - ETA: 2s
 7544832/15810768 [=============&gt;................] - ETA: 2s
 7741440/15810768 [=============&gt;................] - ETA: 2s
 7938048/15810768 [==============&gt;...............] - ETA: 2s
 8134656/15810768 [==============&gt;...............] - ETA: 2s
 8331264/15810768 [==============&gt;...............] - ETA: 2s
 8527872/15810768 [===============&gt;..............] - ETA: 2s
 8724480/15810768 [===============&gt;..............] - ETA: 2s
 8921088/15810768 [===============&gt;..............] - ETA: 2s
 9117696/15810768 [================&gt;.............] - ETA: 2s
 9314304/15810768 [================&gt;.............] - ETA: 2s
 9510912/15810768 [=================&gt;............] - ETA: 1s
 9707520/15810768 [=================&gt;............] - ETA: 1s
 9904128/15810768 [=================&gt;............] - ETA: 1s
10100736/15810768 [==================&gt;...........] - ETA: 1s
10297344/15810768 [==================&gt;...........] - ETA: 1s
10493952/15810768 [==================&gt;...........] - ETA: 1s
10690560/15810768 [===================&gt;..........] - ETA: 1s
10887168/15810768 [===================&gt;..........] - ETA: 1s
11083776/15810768 [====================&gt;.........] - ETA: 1s
11280384/15810768 [====================&gt;.........] - ETA: 1s
11476992/15810768 [====================&gt;.........] - ETA: 1s
11673600/15810768 [=====================&gt;........] - ETA: 1s
11870208/15810768 [=====================&gt;........] - ETA: 1s
12066816/15810768 [=====================&gt;........] - ETA: 1s
12263424/15810768 [======================&gt;.......] - ETA: 1s
12460032/15810768 [======================&gt;.......] - ETA: 1s
12656640/15810768 [=======================&gt;......] - ETA: 0s
12853248/15810768 [=======================&gt;......] - ETA: 0s
13049856/15810768 [=======================&gt;......] - ETA: 0s
13246464/15810768 [========================&gt;.....] - ETA: 0s
13443072/15810768 [========================&gt;.....] - ETA: 0s
13639680/15810768 [========================&gt;.....] - ETA: 0s
13836288/15810768 [=========================&gt;....] - ETA: 0s
14032896/15810768 [=========================&gt;....] - ETA: 0s
14229504/15810768 [=========================&gt;....] - ETA: 0s
14426112/15810768 [==========================&gt;...] - ETA: 0s
14622720/15810768 [==========================&gt;...] - ETA: 0s
14819328/15810768 [===========================&gt;..] - ETA: 0s
15015936/15810768 [===========================&gt;..] - ETA: 0s
15212544/15810768 [===========================&gt;..] - ETA: 0s
15409152/15810768 [============================&gt;.] - ETA: 0s
15605760/15810768 [============================&gt;.] - ETA: 0s
15802368/15810768 [============================&gt;.] - ETA: 0s
15818752/15810768 [==============================] - 5s 0us/step
WARNING:tensorflow:No training configuration found in the save file, so the model was *not* compiled. Compile it manually.
Warning: the activation layer &#39;act_softmax&#39; will be discarded at conversion. The outputs of the Akida model will be the potentials before this activation layer.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida</span> <span class="kn">import</span> <span class="n">FullyConnected</span>

<span class="c1"># Replace the last layer by a classification layer</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_dict</span><span class="p">)</span>
<span class="n">num_neurons_per_class</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_weights</span> <span class="o">=</span> <span class="mi">350</span>
<span class="n">model_ak</span><span class="o">.</span><span class="n">pop_layer</span><span class="p">()</span>
<span class="n">layer_fc</span> <span class="o">=</span> <span class="n">FullyConnected</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;akida_edge_layer&#39;</span><span class="p">,</span>
                          <span class="n">num_neurons</span><span class="o">=</span><span class="n">num_classes</span> <span class="o">*</span> <span class="n">num_neurons_per_class</span><span class="p">,</span>
                          <span class="n">activations_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">model_ak</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layer_fc</span><span class="p">)</span>
<span class="n">model_ak</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">num_weights</span><span class="o">=</span><span class="n">num_weights</span><span class="p">,</span>
                 <span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">,</span>
                 <span class="n">learning_competition</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">model_ak</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>                                        Model Summary
_____________________________________________________________________________________________
Layer (type)                              Output shape    Kernel shape
=============================================================================================
conv_0 (InputConvolutional)               [112, 112, 16]  (3, 3, 3, 16)
_____________________________________________________________________________________________
separable_1 (SeparableConvolutional)      [112, 112, 32]  (3, 3, 16, 1), (1, 1, 16, 32)
_____________________________________________________________________________________________
separable_2 (SeparableConvolutional)      [56, 56, 64]    (3, 3, 32, 1), (1, 1, 32, 64)
_____________________________________________________________________________________________
separable_3 (SeparableConvolutional)      [56, 56, 64]    (3, 3, 64, 1), (1, 1, 64, 64)
_____________________________________________________________________________________________
separable_4 (SeparableConvolutional)      [28, 28, 128]   (3, 3, 64, 1), (1, 1, 64, 128)
_____________________________________________________________________________________________
separable_5 (SeparableConvolutional)      [28, 28, 128]   (3, 3, 128, 1), (1, 1, 128, 128)
_____________________________________________________________________________________________
separable_6 (SeparableConvolutional)      [14, 14, 256]   (3, 3, 128, 1), (1, 1, 128, 256)
_____________________________________________________________________________________________
separable_7 (SeparableConvolutional)      [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_____________________________________________________________________________________________
separable_8 (SeparableConvolutional)      [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_____________________________________________________________________________________________
separable_9 (SeparableConvolutional)      [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_____________________________________________________________________________________________
separable_10 (SeparableConvolutional)     [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_____________________________________________________________________________________________
separable_11 (SeparableConvolutional)     [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_____________________________________________________________________________________________
separable_12 (SeparableConvolutional)     [7, 7, 512]     (3, 3, 256, 1), (1, 1, 256, 512)
_____________________________________________________________________________________________
separable_13 (SeparableConvolutional)     [1, 1, 512]     (3, 3, 512, 1), (1, 1, 512, 512)
_____________________________________________________________________________________________
spike_generator (SeparableConvolutional)  [1, 1, 2048]    (3, 3, 512, 1), (1, 1, 512, 2048)
_____________________________________________________________________________________________
akida_edge_layer (FullyConnected)         [1, 1, 5]       (1, 1, 2048, 5)
_____________________________________________________________________________________________

              Learning Summary
____________________________________________
Learning Layer    # Input Conn.  # Weights
============================================
akida_edge_layer  2048           350
____________________________________________
Input shape: 224, 224, 3
Backend type: Software - 1.8.10
</pre></div>
</div>
</div>
<div class="section" id="edge-learning-with-akida">
<h2>3. Edge learning with Akida<a class="headerlink" href="#edge-learning-with-akida" title="Permalink to this headline">¬∂</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">tensorflow.image</span> <span class="kn">import</span> <span class="n">resize_with_crop_or_pad</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="c1"># Learn objects in num_shots shot(s)</span>
<span class="n">num_shots</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">object_ids</span><span class="p">)):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">train_images</span> <span class="o">=</span> <span class="n">object_dict</span><span class="p">[</span><span class="n">object_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]][:</span><span class="n">num_shots</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">train_images</span><span class="p">:</span>
        <span class="n">padded_image</span> <span class="o">=</span> <span class="n">resize_with_crop_or_pad</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
        <span class="n">model_ak</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">padded_image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Learned object </span><span class="si">{</span><span class="n">object_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> (class </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">) with </span><span class="se">\</span>
<span class="s1">            </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_images</span><span class="p">)</span><span class="si">}</span><span class="s1"> sample(s) in </span><span class="si">{</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Learned object obj10 (class 0) with             1 sample(s) in 0.16s
Learned object obj16 (class 1) with             1 sample(s) in 0.15s
Learned object obj18 (class 2) with             1 sample(s) in 0.15s
Learned object obj25 (class 3) with             1 sample(s) in 0.15s
Learned object obj43 (class 4) with             1 sample(s) in 0.15s
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statistics</span> <span class="k">as</span> <span class="nn">stat</span>

<span class="c1"># Check accuracy against remaining samples</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">object_ids</span><span class="p">)):</span>
    <span class="n">test_images</span> <span class="o">=</span> <span class="n">object_dict</span><span class="p">[</span><span class="n">object_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">num_shots</span><span class="p">:]</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_images</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_images</span><span class="p">)):</span>
        <span class="n">padded_image</span> <span class="o">=</span> <span class="n">resize_with_crop_or_pad</span><span class="p">(</span><span class="n">test_images</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
        <span class="n">predictions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_ak</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">padded_image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                                          <span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">)</span>
    <span class="n">accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_images</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy testing object </span><span class="si">{</span><span class="n">object_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> (class </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">) with </span><span class="se">\</span>
<span class="s1">            </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_images</span><span class="p">)</span><span class="si">}</span><span class="s1"> sample(s): </span><span class="si">{</span><span class="n">accuracy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

<span class="n">mean_accuracy</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean accuracy: </span><span class="si">{</span><span class="n">mean_accuracy</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

<span class="c1"># For non-regression purpose</span>
<span class="k">assert</span> <span class="n">mean_accuracy</span> <span class="o">&gt;</span> <span class="mi">98</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Accuracy testing object obj10 (class 0) with             71 sample(s): 95.77%
Accuracy testing object obj16 (class 1) with             71 sample(s): 100.00%
Accuracy testing object obj18 (class 2) with             71 sample(s): 100.00%
Accuracy testing object obj25 (class 3) with             71 sample(s): 100.00%
Accuracy testing object obj43 (class 4) with             71 sample(s): 97.18%
Mean accuracy: 98.59%
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  20.197 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-plot-edge-learning-vision-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/2de40258bfd5c55416f7190606f14755/plot_edge_learning_vision.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_edge_learning_vision.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/860aed0b6afaf7340ffa214b3ede62c2/plot_edge_learning_vision.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_edge_learning_vision.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_cnn_flow.html" class="btn btn-neutral float-right" title="CNN conversion flow tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_regression.html" class="btn btn-neutral float-left" title="Regression tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Copyright 2020, BrainChip Holdings Ltd. All Rights Reserved.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>