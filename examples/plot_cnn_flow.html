

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CNN conversion flow tutorial &mdash; Akida Examples  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="License" href="../license.html" />
    <link rel="prev" title="MobileNet/ImageNet inference" href="plot_mobilenet_imagenet.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #3f51b5" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/akida.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                Akida 1.8.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#quick-installation">Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#running-examples">Running examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/user_guide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#for-beginners">For beginners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#for-users-familiar-with-deep-learning">For users familiar with deep-learning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/aee.html">Akida user guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#the-akida-execution-engine">The Akida Execution Engine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id1">1. The Spiking Neural Network model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id2">2. Input data format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id3">3. Determine training mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id4">4. Interpreting outputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#neural-network-model">Neural Network model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#specifying-the-neural-network-model">Specifying the Neural Network model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#saving-and-loading">Saving and loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#input-layer-types">Input layer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#data-processing-layer-types">Data-Processing layer types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#id5">Using Akida Unsupervised Learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#learning-constraints">Learning constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#compiling-a-layer">Compiling a layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id6">Learning parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/cnn2snn.html">CNN2SNN toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#conversion-workflow">Conversion workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#typical-training-scenario">Typical training scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#design-compatibility-constraints">Design compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#quantization-compatibility-constraints">Quantization compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#command-line-interface">Command-line interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#layers-considerations">Layers Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#supported-layer-types">Supported layer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#cnn2snn-quantization-aware-layers">CNN2SNN Quantization-aware layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#training-only-layers">Training-Only Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#first-layers">First Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#id6">Final Layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#layer-blocks">Layer Blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#id8">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#conv-block"><code class="docutils literal notranslate"><span class="pre">conv_block</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#dense-block"><code class="docutils literal notranslate"><span class="pre">dense_block</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#separable-conv-block"><code class="docutils literal notranslate"><span class="pre">separable_conv_block</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/hw_constraints.html">Hardware constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/hw_constraints.html#input-layer">Input layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/hw_constraints.html#data-processing-layers">Data-Processing layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/hw_constraints.html#convolutional-layer">Convolutional layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/hw_constraints.html#fully-connected-layer">Fully connected layer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/api_reference.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/aee_apis.html">Akida Execution Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#model">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#layer">Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#layerstatistics">LayerStatistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#observer">Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#inputdata">InputData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#inputconvolutional">InputConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#fullyconnected">FullyConnected</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#convolutional">Convolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#separableconvolutional">SeparableConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#dense">Dense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#sparse">Sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#coords-to-sparse">coords_to_sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#dense-to-sparse">dense_to_sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#backendtype">BackendType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#convolutionmode">ConvolutionMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#poolingtype">PoolingType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#learningtype">LearningType</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/cnn2snn_apis.html">CNN2SNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantize">quantize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#convert">convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#check-model-compatibility">check_model_compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#weightquantizer">WeightQuantizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#trainableweightquantizer">TrainableWeightQuantizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#weightfloat">WeightFloat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedconv2d">QuantizedConv2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizeddepthwiseconv2d">QuantizedDepthwiseConv2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizeddense">QuantizedDense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedseparableconv2d">QuantizedSeparableConv2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#activationdiscreterelu">ActivationDiscreteRelu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedrelu">QuantizedReLU</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/akida_models_apis.html">Akida models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/akida_models_apis.html#quantization-blocks">Quantization blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#conv-block">conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#separable-conv-block">separable_conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#dense-block">dense_block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/akida_models_apis.html#model-zoo">Model zoo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#mobilenet">Mobilenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#ds-cnn">DS-CNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#vgg">VGG</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_gxnor_mnist.html">GXNOR/MNIST inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#loading-the-mnist-dataset">1. Loading the MNIST dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#look-at-some-images-from-the-test-dataset">2. Look at some images from the test dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#load-the-pre-trained-akida-model">3. Load the pre-trained Akida model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#classify-a-single-image">4. Classify a single image</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#check-performance-across-a-number-of-samples">5. Check performance across a number of samples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_regression.html">Regression tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#load-dependencies">1. Load dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#load-the-dataset">2. Load the dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#create-a-keras-model-satisfying-akida-nsoc-requirements">3. Create a Keras model satisfying Akida NSoC requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#check-performance">4. Check performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#conversion-to-akida">5. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_regression.html#convert-the-trained-keras-model-to-akida">5.1 Convert the trained Keras model to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_regression.html#check-akida-model-accuracy">5.2 Check Akida model accuracy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#estimate-age-on-a-single-image">6. Estimate age on a single image</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_ds_cnn_kws.html">DS-CNN/KWS inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#load-cnn2snn-tool-dependencies">1. Load CNN2SNN tool dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#load-the-preprocessed-dataset">2. Load the preprocessed dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#create-a-keras-model-satisfying-akida-nsoc-requirements">3. Create a Keras model satisfying Akida NSoC requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#check-performance">4. Check performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#conversion-to-akida">5. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_kws.html#convert-the-trained-keras-model-to-akida">5.1 Convert the trained Keras model to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_kws.html#check-prediction-accuracy">5.2 Check prediction accuracy</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_kws.html#confusion-matrix">5.3 Confusion matrix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html">VGG and DS-CNN/CIFAR10 inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#load-cnn2snn-tool-dependencies">1. Load CNN2SNN tool dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#load-and-reshape-cifar10-dataset">2. Load and reshape CIFAR10 dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#create-a-quantized-keras-vgg-model">3. Create a quantized Keras VGG model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#a-instantiate-keras-model">3.A Instantiate Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#b-check-performance">3.B Check performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#conversion-to-akida">4. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#a-convert-to-akida-model">4.A Convert to Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#b-check-hardware-compliancy">4.B Check hardware compliancy</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#c-check-performance">4.C Check performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#create-a-quantized-keras-ds-cnn-model">5. Create a quantized Keras DS-CNN model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#a-instantiate-keras-ds-cnn-model">5.A Instantiate Keras DS-CNN model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#id1">5.B Check performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#id2">6. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#id3">6.A Convert to Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#id4">6.B Check hardware compliancy</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#id5">6.C Check performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_vgg_ds_cnn_cifar10.html#d-show-predictions-for-a-random-image">6D. Show predictions for a random image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_transfer_learning.html">Transfer learning with MobileNet for cats vs. dogs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#transfer-learning-process">1. Transfer learning process</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#load-and-preprocess-data">2. Load and preprocess data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#a-load-and-split-data">2.A - Load and split data</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#b-preprocess-the-test-set">2.B - Preprocess the test set</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#c-get-labels">2.C - Get labels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#convert-a-quantized-keras-model-to-akida">3. Convert a quantized Keras model to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#a-instantiate-a-keras-base-model">3.A - Instantiate a Keras base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#b-modify-the-network-and-load-pre-trained-weights">3.B - Modify the network and load pre-trained weights</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#c-convert-to-akida">3.C - Convert to Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#classify-test-images">4. Classify test images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#a-classify-test-images">4.A Classify test images</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#b-compare-results">4.B Compare results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_mobilenet_imagenet.html">MobileNet/ImageNet inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#load-cnn2snn-tool-dependencies">1. Load CNN2SNN tool dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#load-test-images-from-imagenet">2. Load test images from ImageNet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#load-test-images-and-preprocess-test-images">2.1 Load test images and preprocess test images</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#load-labels">2.2 Load labels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#create-a-quantized-keras-model">3. Create a quantized Keras model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#instantiate-keras-model">3.1 Instantiate Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#check-performance-of-the-keras-model">3.2 Check performance of the Keras model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#convert-keras-model-for-akida-nsoc">4. Convert Keras model for Akida NSoC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#convert-keras-model-to-an-akida-compatible-model">4.1 Convert Keras model to an Akida compatible model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#test-performance-of-the-akida-model">4.2 Test performance of the Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#show-predictions-for-a-random-test-image">4.3 Show predictions for a random test image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CNN conversion flow tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#system-configuration">1. System configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#load-cnn2snn-tool-dependencies">1.1 Load CNN2SNN tool dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load-and-reshape-mnist-dataset">1.2 Load and reshape MNIST dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-training-parameters">1.3 Set training parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#model-creation-and-performance-check">2. Model creation and performance check</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#model-creation">2.1 Model creation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance-check">2.2 Performance check</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#model-akida-compatibility-check-and-changes">3. Model Akida-compatibility check and changes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#compatibility-check">3.1 Compatibility check</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-adaptation">3.2 Model adaptation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">3.3 Performance check</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#model-quantization-and-training">4. Model quantization and training</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quantize-the-model">4.1 Quantize the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">4.2 Performance check</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#convert-trained-model-for-akida-and-test">5. Convert trained model for Akida and test</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#final-conversion">5.1 Final conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performances-check-with-the-akida-execution-engine">5.2 Performances check with the Akida Execution Engine</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Brainchip-Inc/akida_examples/releases">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://support.brainchip.com/portal/home">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Akida Examples</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Akida examples</a> &raquo;</li>
        
      <li>CNN conversion flow tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-plot-cnn-flow-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="cnn-conversion-flow-tutorial">
<span id="sphx-glr-examples-plot-cnn-flow-py"></span><h1>CNN conversion flow tutorial<a class="headerlink" href="#cnn-conversion-flow-tutorial" title="Permalink to this headline">¶</a></h1>
<p>The CNN2SNN tool is based on Keras, TensorFlow high-level API for building and
training deep learning models.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please refer to TensorFlow  <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/models">tf.keras.models</a>
module for model creation/import details and <a class="reference external" href="https://www.tensorflow.org/guide">TensorFlow
Guide</a> for details of how
TensorFlow works.</p>
</div>
<p><strong>CNN2SNN tool</strong> allows you to <strong>convert CNN networks to SNN networks</strong>
compatible with the <strong>Akida NSoC</strong> in a few steps.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MNIST example below is light enough so you do not need a <a class="reference external" href="https://www.tensorflow.org/install/gpu">GPU</a> to run the CNN2SNN
tool.</p>
</div>
<img alt="../_images/cnn2snn_flow_small.png" src="../_images/cnn2snn_flow_small.png" />
<div class="section" id="system-configuration">
<h2>1. System configuration<a class="headerlink" href="#system-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="load-cnn2snn-tool-dependencies">
<h3>1.1 Load CNN2SNN tool dependencies<a class="headerlink" href="#load-cnn2snn-tool-dependencies" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># System imports</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>

<span class="c1"># TensorFlow imports</span>
<span class="kn">import</span> <span class="nn">tensorflow.keras.backend</span> <span class="k">as</span> <span class="nn">K</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">LearningRateScheduler</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">BatchNormalization</span><span class="p">,</span> <span class="n">MaxPooling2D</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">ReLU</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Input</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
</pre></div>
</div>
</div>
<div class="section" id="load-and-reshape-mnist-dataset">
<h3>1.2 Load and reshape MNIST dataset<a class="headerlink" href="#load-and-reshape-mnist-dataset" title="Permalink to this headline">¶</a></h3>
<p>After loading, we make 3 transformations on the dataset:</p>
<ol class="arabic simple">
<li><p>Reshape the sample content data (x values) into a num_samples x width x
height x channels matrix.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At this point, we’ll set aside the raw data for testing our
converted model in the Akida Execution Engine later</p>
</div>
<ol class="arabic simple" start="2">
<li><p>Rescale the 8-bit loaded data to the range 0-to-1 for training.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This shift makes almost no difference in the current example, but
for some datasets rescaling the absolute values (and also shifting
to zero-mean) can make a really major difference.</p>
<p>Also note that we store the scaling values <code class="docutils literal notranslate"><span class="pre">input_scaling</span></code> for
use when preparing the model for the Akida Execution Engine. The
implementation of the Akida neural network allows us to completely
skip the rescaling step (i.e. the Akida model should be fed with
the raw 8-bit values) but that does require information about what
scaling was applied prior to training - see below for more details.</p>
</div>
<p>3. Transform the loaded labels from a scalar representation (single integer
value per sample) to a one-hot vector representation, appropriate for use
with the squared hinge loss function used in the current model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Input data normalization is a common step dealing with CNN
(rationale is to keep data in a range that works with selected
optimizers, some interesting reading can be found
<a class="reference external" href="https://www.jeremyjordan.me/batch-normalization/">here</a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load MNIST dataset</span>
<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1"># Reshape x-data</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">60000</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Set aside raw test data for use with Akida Execution Engine later</span>
<span class="n">raw_x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="n">raw_y_test</span> <span class="o">=</span> <span class="n">y_test</span>

<span class="c1"># Rescale x-data</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">255</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">input_scaling</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_train</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_test</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>

<span class="c1"># Transform scalar labels to one-hot representation, scaled to +/- 1 appropriate for squared hinge loss function</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="set-training-parameters">
<h3>1.3 Set training parameters<a class="headerlink" href="#set-training-parameters" title="Permalink to this headline">¶</a></h3>
<p>Set some training parameters used across the different training sessions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set dataset relative training parameters</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>

<span class="c1"># Set the learning rate parameters</span>
<span class="n">lr_start</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">lr_end</span> <span class="o">=</span> <span class="mf">1e-4</span>
<span class="n">lr_decay</span> <span class="o">=</span> <span class="p">(</span><span class="n">lr_end</span> <span class="o">/</span> <span class="n">lr_start</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">epochs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="model-creation-and-performance-check">
<h2>2. Model creation and performance check<a class="headerlink" href="#model-creation-and-performance-check" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model-creation">
<h3>2.1 Model creation<a class="headerlink" href="#model-creation" title="Permalink to this headline">¶</a></h3>
<p>Note that at this stage, there is nothing specific to the Akida NSoC.
This start point is very much a completely standard CNN as defined
within <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras">Keras</a>.</p>
<p>An appropriate model for MNIST (inspired by <a class="reference external" href="https://arxiv.org/pdf/1705.09283.pdf">this
paper</a>) might look something
like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">img_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
           <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
           <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
           <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">data_format</span><span class="o">=</span><span class="s1">&#39;channels_last&#39;</span><span class="p">)(</span><span class="n">img_input</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ReLU</span><span class="p">(</span><span class="mf">6.</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ReLU</span><span class="p">(</span><span class="mf">6.</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ReLU</span><span class="p">(</span><span class="mf">6.</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ReLU</span><span class="p">(</span><span class="mf">6.</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model_keras</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mnistnet&#39;</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="n">lr_start</span><span class="p">)</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Model: &quot;mnistnet&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_2 (InputLayer)         [(None, 28, 28, 1)]       0
_________________________________________________________________
conv2d (Conv2D)              (None, 28, 28, 32)        800
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 14, 14, 32)        0
_________________________________________________________________
batch_normalization (BatchNo (None, 14, 14, 32)        128
_________________________________________________________________
re_lu (ReLU)                 (None, 14, 14, 32)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 14, 14, 32)        25600
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 7, 7, 32)          0
_________________________________________________________________
batch_normalization_1 (Batch (None, 7, 7, 32)          128
_________________________________________________________________
re_lu_1 (ReLU)               (None, 7, 7, 32)          0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 7, 7, 32)          25600
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 32)          128
_________________________________________________________________
re_lu_2 (ReLU)               (None, 7, 7, 32)          0
_________________________________________________________________
flatten (Flatten)            (None, 1568)              0
_________________________________________________________________
dense (Dense)                (None, 512)               802816
_________________________________________________________________
batch_normalization_3 (Batch (None, 512)               2048
_________________________________________________________________
re_lu_3 (ReLU)               (None, 512)               0
_________________________________________________________________
dense_1 (Dense)              (None, 10)                5120
=================================================================
Total params: 862,368
Trainable params: 861,152
Non-trainable params: 1,216
_________________________________________________________________
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adam optimizer is commonly used, more details can be found
<a class="reference external" href="https://arxiv.org/abs/1609.04747">here</a>.</p>
</div>
</div>
<div class="section" id="performance-check">
<h3>2.2 Performance check<a class="headerlink" href="#performance-check" title="Permalink to this headline">¶</a></h3>
<p>Before going any further, check the current model performance as a
benchmark for CNN2SNN conversion.
The created model should achieve a test accuracy a little over 99% after
5 epochs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lr_scheduler</span> <span class="o">=</span> <span class="n">LearningRateScheduler</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">lr_start</span> <span class="o">*</span> <span class="n">lr_decay</span><span class="o">**</span><span class="n">e</span><span class="p">)</span>
<span class="n">callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lr_scheduler</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span>
                          <span class="n">y_train</span><span class="p">,</span>
                          <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                          <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span>
                          <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test score:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Epoch 1/5

  1/469 [..............................] - ETA: 0s - loss: 2.2300 - accuracy: 0.0781
  3/469 [..............................] - ETA: 7s - loss: 1.5593 - accuracy: 0.4115
  5/469 [..............................] - ETA: 9s - loss: 1.1384 - accuracy: 0.5656
  7/469 [..............................] - ETA: 10s - loss: 0.8803 - accuracy: 0.6585
  9/469 [..............................] - ETA: 10s - loss: 0.7142 - accuracy: 0.7109
 11/469 [..............................] - ETA: 10s - loss: 0.6040 - accuracy: 0.7429
 13/469 [..............................] - ETA: 10s - loss: 0.5265 - accuracy: 0.7674
 15/469 [..............................] - ETA: 10s - loss: 0.4668 - accuracy: 0.7875
 17/469 [&gt;.............................] - ETA: 10s - loss: 0.4192 - accuracy: 0.8065
 19/469 [&gt;.............................] - ETA: 10s - loss: 0.3823 - accuracy: 0.8191
 21/469 [&gt;.............................] - ETA: 10s - loss: 0.3514 - accuracy: 0.8300
 23/469 [&gt;.............................] - ETA: 10s - loss: 0.3270 - accuracy: 0.8383
 25/469 [&gt;.............................] - ETA: 10s - loss: 0.3053 - accuracy: 0.8466
 27/469 [&gt;.............................] - ETA: 10s - loss: 0.2859 - accuracy: 0.8545
 29/469 [&gt;.............................] - ETA: 10s - loss: 0.2701 - accuracy: 0.8594
 31/469 [&gt;.............................] - ETA: 10s - loss: 0.2557 - accuracy: 0.8652
 33/469 [=&gt;............................] - ETA: 10s - loss: 0.2423 - accuracy: 0.8710
 35/469 [=&gt;............................] - ETA: 10s - loss: 0.2307 - accuracy: 0.8759
 37/469 [=&gt;............................] - ETA: 10s - loss: 0.2205 - accuracy: 0.8803
 39/469 [=&gt;............................] - ETA: 10s - loss: 0.2107 - accuracy: 0.8848
 41/469 [=&gt;............................] - ETA: 10s - loss: 0.2025 - accuracy: 0.8880
 43/469 [=&gt;............................] - ETA: 10s - loss: 0.1943 - accuracy: 0.8919
 45/469 [=&gt;............................] - ETA: 10s - loss: 0.1872 - accuracy: 0.8951
 47/469 [==&gt;...........................] - ETA: 10s - loss: 0.1807 - accuracy: 0.8984
 49/469 [==&gt;...........................] - ETA: 10s - loss: 0.1738 - accuracy: 0.9023
 51/469 [==&gt;...........................] - ETA: 10s - loss: 0.1681 - accuracy: 0.9044
 53/469 [==&gt;...........................] - ETA: 10s - loss: 0.1628 - accuracy: 0.9070
 55/469 [==&gt;...........................] - ETA: 10s - loss: 0.1577 - accuracy: 0.9091
 57/469 [==&gt;...........................] - ETA: 10s - loss: 0.1528 - accuracy: 0.9116
 60/469 [==&gt;...........................] - ETA: 10s - loss: 0.1465 - accuracy: 0.9142
 62/469 [==&gt;...........................] - ETA: 10s - loss: 0.1423 - accuracy: 0.9162
 64/469 [===&gt;..........................] - ETA: 10s - loss: 0.1387 - accuracy: 0.9176
 66/469 [===&gt;..........................] - ETA: 10s - loss: 0.1354 - accuracy: 0.9189
 68/469 [===&gt;..........................] - ETA: 10s - loss: 0.1322 - accuracy: 0.9205
 70/469 [===&gt;..........................] - ETA: 9s - loss: 0.1294 - accuracy: 0.9218 
 72/469 [===&gt;..........................] - ETA: 9s - loss: 0.1266 - accuracy: 0.9230
 74/469 [===&gt;..........................] - ETA: 9s - loss: 0.1238 - accuracy: 0.9243
 76/469 [===&gt;..........................] - ETA: 9s - loss: 0.1210 - accuracy: 0.9259
 78/469 [===&gt;..........................] - ETA: 9s - loss: 0.1183 - accuracy: 0.9273
 80/469 [====&gt;.........................] - ETA: 9s - loss: 0.1159 - accuracy: 0.9285
 82/469 [====&gt;.........................] - ETA: 9s - loss: 0.1136 - accuracy: 0.9296
 84/469 [====&gt;.........................] - ETA: 9s - loss: 0.1115 - accuracy: 0.9305
 86/469 [====&gt;.........................] - ETA: 9s - loss: 0.1094 - accuracy: 0.9316
 88/469 [====&gt;.........................] - ETA: 9s - loss: 0.1077 - accuracy: 0.9325
 90/469 [====&gt;.........................] - ETA: 9s - loss: 0.1060 - accuracy: 0.9332
 92/469 [====&gt;.........................] - ETA: 9s - loss: 0.1043 - accuracy: 0.9338
 94/469 [=====&gt;........................] - ETA: 9s - loss: 0.1028 - accuracy: 0.9343
 96/469 [=====&gt;........................] - ETA: 9s - loss: 0.1011 - accuracy: 0.9348
 98/469 [=====&gt;........................] - ETA: 9s - loss: 0.0996 - accuracy: 0.9358
100/469 [=====&gt;........................] - ETA: 9s - loss: 0.0980 - accuracy: 0.9368
102/469 [=====&gt;........................] - ETA: 9s - loss: 0.0964 - accuracy: 0.9379
104/469 [=====&gt;........................] - ETA: 9s - loss: 0.0948 - accuracy: 0.9388
107/469 [=====&gt;........................] - ETA: 9s - loss: 0.0927 - accuracy: 0.9398
109/469 [=====&gt;........................] - ETA: 9s - loss: 0.0914 - accuracy: 0.9404
112/469 [======&gt;.......................] - ETA: 8s - loss: 0.0895 - accuracy: 0.9413
114/469 [======&gt;.......................] - ETA: 8s - loss: 0.0882 - accuracy: 0.9421
116/469 [======&gt;.......................] - ETA: 8s - loss: 0.0871 - accuracy: 0.9428
118/469 [======&gt;.......................] - ETA: 8s - loss: 0.0860 - accuracy: 0.9435
120/469 [======&gt;.......................] - ETA: 8s - loss: 0.0848 - accuracy: 0.9441
122/469 [======&gt;.......................] - ETA: 8s - loss: 0.0838 - accuracy: 0.9447
124/469 [======&gt;.......................] - ETA: 8s - loss: 0.0827 - accuracy: 0.9454
126/469 [=======&gt;......................] - ETA: 8s - loss: 0.0818 - accuracy: 0.9458
128/469 [=======&gt;......................] - ETA: 8s - loss: 0.0807 - accuracy: 0.9464
130/469 [=======&gt;......................] - ETA: 8s - loss: 0.0798 - accuracy: 0.9468
132/469 [=======&gt;......................] - ETA: 8s - loss: 0.0789 - accuracy: 0.9473
134/469 [=======&gt;......................] - ETA: 8s - loss: 0.0781 - accuracy: 0.9478
137/469 [=======&gt;......................] - ETA: 8s - loss: 0.0770 - accuracy: 0.9483
139/469 [=======&gt;......................] - ETA: 8s - loss: 0.0762 - accuracy: 0.9487
141/469 [========&gt;.....................] - ETA: 8s - loss: 0.0754 - accuracy: 0.9491
143/469 [========&gt;.....................] - ETA: 8s - loss: 0.0746 - accuracy: 0.9495
145/469 [========&gt;.....................] - ETA: 8s - loss: 0.0738 - accuracy: 0.9501
147/469 [========&gt;.....................] - ETA: 8s - loss: 0.0733 - accuracy: 0.9504
149/469 [========&gt;.....................] - ETA: 8s - loss: 0.0726 - accuracy: 0.9508
151/469 [========&gt;.....................] - ETA: 8s - loss: 0.0719 - accuracy: 0.9512
153/469 [========&gt;.....................] - ETA: 7s - loss: 0.0713 - accuracy: 0.9515
155/469 [========&gt;.....................] - ETA: 7s - loss: 0.0706 - accuracy: 0.9519
157/469 [=========&gt;....................] - ETA: 7s - loss: 0.0699 - accuracy: 0.9523
160/469 [=========&gt;....................] - ETA: 7s - loss: 0.0691 - accuracy: 0.9526
162/469 [=========&gt;....................] - ETA: 7s - loss: 0.0684 - accuracy: 0.9531
164/469 [=========&gt;....................] - ETA: 7s - loss: 0.0678 - accuracy: 0.9533
166/469 [=========&gt;....................] - ETA: 7s - loss: 0.0673 - accuracy: 0.9536
168/469 [=========&gt;....................] - ETA: 7s - loss: 0.0666 - accuracy: 0.9540
170/469 [=========&gt;....................] - ETA: 7s - loss: 0.0662 - accuracy: 0.9542
172/469 [==========&gt;...................] - ETA: 7s - loss: 0.0657 - accuracy: 0.9544
175/469 [==========&gt;...................] - ETA: 7s - loss: 0.0648 - accuracy: 0.9548
177/469 [==========&gt;...................] - ETA: 7s - loss: 0.0642 - accuracy: 0.9552
179/469 [==========&gt;...................] - ETA: 7s - loss: 0.0638 - accuracy: 0.9553
182/469 [==========&gt;...................] - ETA: 7s - loss: 0.0631 - accuracy: 0.9557
184/469 [==========&gt;...................] - ETA: 7s - loss: 0.0626 - accuracy: 0.9560
186/469 [==========&gt;...................] - ETA: 7s - loss: 0.0621 - accuracy: 0.9563
188/469 [===========&gt;..................] - ETA: 7s - loss: 0.0616 - accuracy: 0.9566
190/469 [===========&gt;..................] - ETA: 7s - loss: 0.0610 - accuracy: 0.9570
192/469 [===========&gt;..................] - ETA: 6s - loss: 0.0606 - accuracy: 0.9572
194/469 [===========&gt;..................] - ETA: 6s - loss: 0.0602 - accuracy: 0.9574
196/469 [===========&gt;..................] - ETA: 6s - loss: 0.0598 - accuracy: 0.9576
198/469 [===========&gt;..................] - ETA: 6s - loss: 0.0595 - accuracy: 0.9576
200/469 [===========&gt;..................] - ETA: 6s - loss: 0.0590 - accuracy: 0.9580
202/469 [===========&gt;..................] - ETA: 6s - loss: 0.0586 - accuracy: 0.9582
204/469 [============&gt;.................] - ETA: 6s - loss: 0.0582 - accuracy: 0.9583
206/469 [============&gt;.................] - ETA: 6s - loss: 0.0578 - accuracy: 0.9586
208/469 [============&gt;.................] - ETA: 6s - loss: 0.0574 - accuracy: 0.9589
210/469 [============&gt;.................] - ETA: 6s - loss: 0.0571 - accuracy: 0.9592
212/469 [============&gt;.................] - ETA: 6s - loss: 0.0568 - accuracy: 0.9593
214/469 [============&gt;.................] - ETA: 6s - loss: 0.0564 - accuracy: 0.9595
216/469 [============&gt;.................] - ETA: 6s - loss: 0.0561 - accuracy: 0.9597
218/469 [============&gt;.................] - ETA: 6s - loss: 0.0557 - accuracy: 0.9600
220/469 [=============&gt;................] - ETA: 6s - loss: 0.0553 - accuracy: 0.9601
222/469 [=============&gt;................] - ETA: 6s - loss: 0.0550 - accuracy: 0.9604
224/469 [=============&gt;................] - ETA: 6s - loss: 0.0546 - accuracy: 0.9606
226/469 [=============&gt;................] - ETA: 6s - loss: 0.0542 - accuracy: 0.9609
228/469 [=============&gt;................] - ETA: 6s - loss: 0.0539 - accuracy: 0.9611
231/469 [=============&gt;................] - ETA: 6s - loss: 0.0534 - accuracy: 0.9613
233/469 [=============&gt;................] - ETA: 5s - loss: 0.0531 - accuracy: 0.9615
235/469 [==============&gt;...............] - ETA: 5s - loss: 0.0527 - accuracy: 0.9617
237/469 [==============&gt;...............] - ETA: 5s - loss: 0.0525 - accuracy: 0.9617
239/469 [==============&gt;...............] - ETA: 5s - loss: 0.0521 - accuracy: 0.9620
241/469 [==============&gt;...............] - ETA: 5s - loss: 0.0518 - accuracy: 0.9621
243/469 [==============&gt;...............] - ETA: 5s - loss: 0.0515 - accuracy: 0.9623
245/469 [==============&gt;...............] - ETA: 5s - loss: 0.0512 - accuracy: 0.9624
247/469 [==============&gt;...............] - ETA: 5s - loss: 0.0509 - accuracy: 0.9626
249/469 [==============&gt;...............] - ETA: 5s - loss: 0.0506 - accuracy: 0.9628
251/469 [===============&gt;..............] - ETA: 5s - loss: 0.0502 - accuracy: 0.9631
253/469 [===============&gt;..............] - ETA: 5s - loss: 0.0499 - accuracy: 0.9633
256/469 [===============&gt;..............] - ETA: 5s - loss: 0.0495 - accuracy: 0.9635
258/469 [===============&gt;..............] - ETA: 5s - loss: 0.0492 - accuracy: 0.9637
260/469 [===============&gt;..............] - ETA: 5s - loss: 0.0490 - accuracy: 0.9638
263/469 [===============&gt;..............] - ETA: 5s - loss: 0.0486 - accuracy: 0.9639
265/469 [===============&gt;..............] - ETA: 5s - loss: 0.0484 - accuracy: 0.9640
267/469 [================&gt;.............] - ETA: 5s - loss: 0.0481 - accuracy: 0.9642
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0478 - accuracy: 0.9644
271/469 [================&gt;.............] - ETA: 5s - loss: 0.0476 - accuracy: 0.9646
273/469 [================&gt;.............] - ETA: 4s - loss: 0.0474 - accuracy: 0.9647
276/469 [================&gt;.............] - ETA: 4s - loss: 0.0470 - accuracy: 0.9648
278/469 [================&gt;.............] - ETA: 4s - loss: 0.0467 - accuracy: 0.9650
280/469 [================&gt;.............] - ETA: 4s - loss: 0.0466 - accuracy: 0.9651
282/469 [=================&gt;............] - ETA: 4s - loss: 0.0464 - accuracy: 0.9653
284/469 [=================&gt;............] - ETA: 4s - loss: 0.0461 - accuracy: 0.9654
286/469 [=================&gt;............] - ETA: 4s - loss: 0.0459 - accuracy: 0.9655
288/469 [=================&gt;............] - ETA: 4s - loss: 0.0456 - accuracy: 0.9657
290/469 [=================&gt;............] - ETA: 4s - loss: 0.0454 - accuracy: 0.9659
292/469 [=================&gt;............] - ETA: 4s - loss: 0.0451 - accuracy: 0.9661
294/469 [=================&gt;............] - ETA: 4s - loss: 0.0449 - accuracy: 0.9663
296/469 [=================&gt;............] - ETA: 4s - loss: 0.0447 - accuracy: 0.9665
299/469 [==================&gt;...........] - ETA: 4s - loss: 0.0444 - accuracy: 0.9666
301/469 [==================&gt;...........] - ETA: 4s - loss: 0.0442 - accuracy: 0.9667
304/469 [==================&gt;...........] - ETA: 4s - loss: 0.0440 - accuracy: 0.9668
306/469 [==================&gt;...........] - ETA: 4s - loss: 0.0437 - accuracy: 0.9670
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0434 - accuracy: 0.9673
311/469 [==================&gt;...........] - ETA: 3s - loss: 0.0433 - accuracy: 0.9673
313/469 [===================&gt;..........] - ETA: 3s - loss: 0.0431 - accuracy: 0.9674
315/469 [===================&gt;..........] - ETA: 3s - loss: 0.0428 - accuracy: 0.9676
317/469 [===================&gt;..........] - ETA: 3s - loss: 0.0427 - accuracy: 0.9676
319/469 [===================&gt;..........] - ETA: 3s - loss: 0.0425 - accuracy: 0.9677
321/469 [===================&gt;..........] - ETA: 3s - loss: 0.0423 - accuracy: 0.9677
323/469 [===================&gt;..........] - ETA: 3s - loss: 0.0421 - accuracy: 0.9678
325/469 [===================&gt;..........] - ETA: 3s - loss: 0.0420 - accuracy: 0.9679
327/469 [===================&gt;..........] - ETA: 3s - loss: 0.0418 - accuracy: 0.9680
329/469 [====================&gt;.........] - ETA: 3s - loss: 0.0416 - accuracy: 0.9682
331/469 [====================&gt;.........] - ETA: 3s - loss: 0.0414 - accuracy: 0.9683
333/469 [====================&gt;.........] - ETA: 3s - loss: 0.0412 - accuracy: 0.9684
335/469 [====================&gt;.........] - ETA: 3s - loss: 0.0411 - accuracy: 0.9684
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0410 - accuracy: 0.9685
340/469 [====================&gt;.........] - ETA: 3s - loss: 0.0407 - accuracy: 0.9687
342/469 [====================&gt;.........] - ETA: 3s - loss: 0.0405 - accuracy: 0.9688
344/469 [=====================&gt;........] - ETA: 3s - loss: 0.0403 - accuracy: 0.9689
346/469 [=====================&gt;........] - ETA: 3s - loss: 0.0402 - accuracy: 0.9690
348/469 [=====================&gt;........] - ETA: 3s - loss: 0.0400 - accuracy: 0.9691
350/469 [=====================&gt;........] - ETA: 3s - loss: 0.0398 - accuracy: 0.9692
352/469 [=====================&gt;........] - ETA: 2s - loss: 0.0397 - accuracy: 0.9693
354/469 [=====================&gt;........] - ETA: 2s - loss: 0.0396 - accuracy: 0.9693
356/469 [=====================&gt;........] - ETA: 2s - loss: 0.0395 - accuracy: 0.9694
358/469 [=====================&gt;........] - ETA: 2s - loss: 0.0394 - accuracy: 0.9694
360/469 [======================&gt;.......] - ETA: 2s - loss: 0.0392 - accuracy: 0.9696
363/469 [======================&gt;.......] - ETA: 2s - loss: 0.0390 - accuracy: 0.9696
366/469 [======================&gt;.......] - ETA: 2s - loss: 0.0388 - accuracy: 0.9698
368/469 [======================&gt;.......] - ETA: 2s - loss: 0.0386 - accuracy: 0.9699
370/469 [======================&gt;.......] - ETA: 2s - loss: 0.0385 - accuracy: 0.9700
372/469 [======================&gt;.......] - ETA: 2s - loss: 0.0384 - accuracy: 0.9701
374/469 [======================&gt;.......] - ETA: 2s - loss: 0.0383 - accuracy: 0.9701
376/469 [=======================&gt;......] - ETA: 2s - loss: 0.0381 - accuracy: 0.9702
378/469 [=======================&gt;......] - ETA: 2s - loss: 0.0380 - accuracy: 0.9703
381/469 [=======================&gt;......] - ETA: 2s - loss: 0.0378 - accuracy: 0.9705
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0376 - accuracy: 0.9707
385/469 [=======================&gt;......] - ETA: 2s - loss: 0.0375 - accuracy: 0.9708
387/469 [=======================&gt;......] - ETA: 2s - loss: 0.0373 - accuracy: 0.9709
389/469 [=======================&gt;......] - ETA: 2s - loss: 0.0372 - accuracy: 0.9709
391/469 [========================&gt;.....] - ETA: 1s - loss: 0.0371 - accuracy: 0.9710
393/469 [========================&gt;.....] - ETA: 1s - loss: 0.0370 - accuracy: 0.9711
395/469 [========================&gt;.....] - ETA: 1s - loss: 0.0369 - accuracy: 0.9711
397/469 [========================&gt;.....] - ETA: 1s - loss: 0.0367 - accuracy: 0.9713
399/469 [========================&gt;.....] - ETA: 1s - loss: 0.0366 - accuracy: 0.9714
401/469 [========================&gt;.....] - ETA: 1s - loss: 0.0365 - accuracy: 0.9714
403/469 [========================&gt;.....] - ETA: 1s - loss: 0.0364 - accuracy: 0.9715
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0364 - accuracy: 0.9715
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0362 - accuracy: 0.9716
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0361 - accuracy: 0.9717
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0360 - accuracy: 0.9718
413/469 [=========================&gt;....] - ETA: 1s - loss: 0.0359 - accuracy: 0.9718
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0358 - accuracy: 0.9719
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0357 - accuracy: 0.9720
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0356 - accuracy: 0.9721
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0355 - accuracy: 0.9721
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0353 - accuracy: 0.9722
425/469 [==========================&gt;...] - ETA: 1s - loss: 0.0352 - accuracy: 0.9723
427/469 [==========================&gt;...] - ETA: 1s - loss: 0.0351 - accuracy: 0.9724
429/469 [==========================&gt;...] - ETA: 1s - loss: 0.0350 - accuracy: 0.9724
431/469 [==========================&gt;...] - ETA: 0s - loss: 0.0349 - accuracy: 0.9725
434/469 [==========================&gt;...] - ETA: 0s - loss: 0.0348 - accuracy: 0.9726
436/469 [==========================&gt;...] - ETA: 0s - loss: 0.0347 - accuracy: 0.9726
438/469 [===========================&gt;..] - ETA: 0s - loss: 0.0346 - accuracy: 0.9727
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0344 - accuracy: 0.9728
444/469 [===========================&gt;..] - ETA: 0s - loss: 0.0342 - accuracy: 0.9729
446/469 [===========================&gt;..] - ETA: 0s - loss: 0.0341 - accuracy: 0.9730
448/469 [===========================&gt;..] - ETA: 0s - loss: 0.0340 - accuracy: 0.9730
450/469 [===========================&gt;..] - ETA: 0s - loss: 0.0339 - accuracy: 0.9731
452/469 [===========================&gt;..] - ETA: 0s - loss: 0.0339 - accuracy: 0.9731
454/469 [============================&gt;.] - ETA: 0s - loss: 0.0338 - accuracy: 0.9732
456/469 [============================&gt;.] - ETA: 0s - loss: 0.0337 - accuracy: 0.9733
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0335 - accuracy: 0.9734
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0334 - accuracy: 0.9735
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0333 - accuracy: 0.9735
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0333 - accuracy: 0.9736
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0331 - accuracy: 0.9737
469/469 [==============================] - 12s 27ms/step - loss: 0.0331 - accuracy: 0.9737 - val_loss: 0.1500 - val_accuracy: 0.8238 - lr: 0.0010
Epoch 2/5

  1/469 [..............................] - ETA: 0s - loss: 0.0025 - accuracy: 1.0000
  3/469 [..............................] - ETA: 8s - loss: 0.0034 - accuracy: 0.9974
  5/469 [..............................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9953
  7/469 [..............................] - ETA: 10s - loss: 0.0055 - accuracy: 0.9944
  9/469 [..............................] - ETA: 10s - loss: 0.0054 - accuracy: 0.9948
 12/469 [..............................] - ETA: 10s - loss: 0.0068 - accuracy: 0.9928
 14/469 [..............................] - ETA: 10s - loss: 0.0069 - accuracy: 0.9922
 17/469 [&gt;.............................] - ETA: 10s - loss: 0.0070 - accuracy: 0.9913
 19/469 [&gt;.............................] - ETA: 10s - loss: 0.0069 - accuracy: 0.9918
 21/469 [&gt;.............................] - ETA: 10s - loss: 0.0067 - accuracy: 0.9922
 24/469 [&gt;.............................] - ETA: 10s - loss: 0.0065 - accuracy: 0.9922
 27/469 [&gt;.............................] - ETA: 10s - loss: 0.0065 - accuracy: 0.9922
 29/469 [&gt;.............................] - ETA: 10s - loss: 0.0064 - accuracy: 0.9925
 31/469 [&gt;.............................] - ETA: 10s - loss: 0.0065 - accuracy: 0.9922
 33/469 [=&gt;............................] - ETA: 10s - loss: 0.0066 - accuracy: 0.9922
 35/469 [=&gt;............................] - ETA: 10s - loss: 0.0066 - accuracy: 0.9922
 37/469 [=&gt;............................] - ETA: 10s - loss: 0.0066 - accuracy: 0.9920
 40/469 [=&gt;............................] - ETA: 10s - loss: 0.0065 - accuracy: 0.9922
 42/469 [=&gt;............................] - ETA: 10s - loss: 0.0063 - accuracy: 0.9924
 44/469 [=&gt;............................] - ETA: 10s - loss: 0.0064 - accuracy: 0.9924
 46/469 [=&gt;............................] - ETA: 10s - loss: 0.0064 - accuracy: 0.9924
 48/469 [==&gt;...........................] - ETA: 10s - loss: 0.0065 - accuracy: 0.9922
 50/469 [==&gt;...........................] - ETA: 10s - loss: 0.0062 - accuracy: 0.9925
 52/469 [==&gt;...........................] - ETA: 10s - loss: 0.0062 - accuracy: 0.9926
 54/469 [==&gt;...........................] - ETA: 10s - loss: 0.0062 - accuracy: 0.9926
 56/469 [==&gt;...........................] - ETA: 10s - loss: 0.0060 - accuracy: 0.9929
 59/469 [==&gt;...........................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9930
 62/469 [==&gt;...........................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9929
 64/469 [===&gt;..........................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9932
 66/469 [===&gt;..........................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9929
 68/469 [===&gt;..........................] - ETA: 9s - loss: 0.0059 - accuracy: 0.9930 
 71/469 [===&gt;..........................] - ETA: 9s - loss: 0.0059 - accuracy: 0.9930
 73/469 [===&gt;..........................] - ETA: 9s - loss: 0.0058 - accuracy: 0.9930
 75/469 [===&gt;..........................] - ETA: 9s - loss: 0.0058 - accuracy: 0.9931
 77/469 [===&gt;..........................] - ETA: 9s - loss: 0.0058 - accuracy: 0.9932
 80/469 [====&gt;.........................] - ETA: 9s - loss: 0.0057 - accuracy: 0.9933
 82/469 [====&gt;.........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9934
 84/469 [====&gt;.........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9935
 86/469 [====&gt;.........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9936
 88/469 [====&gt;.........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9935
 90/469 [====&gt;.........................] - ETA: 9s - loss: 0.0055 - accuracy: 0.9935
 92/469 [====&gt;.........................] - ETA: 9s - loss: 0.0055 - accuracy: 0.9935
 94/469 [=====&gt;........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9936
 96/469 [=====&gt;........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9937
 98/469 [=====&gt;........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9937
100/469 [=====&gt;........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9937
102/469 [=====&gt;........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9938
104/469 [=====&gt;........................] - ETA: 9s - loss: 0.0055 - accuracy: 0.9938
106/469 [=====&gt;........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9937
108/469 [=====&gt;........................] - ETA: 9s - loss: 0.0056 - accuracy: 0.9937
110/469 [======&gt;.......................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9937
112/469 [======&gt;.......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9938
114/469 [======&gt;.......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9938
116/469 [======&gt;.......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9939
118/469 [======&gt;.......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9938
120/469 [======&gt;.......................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9937
122/469 [======&gt;.......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9939
124/469 [======&gt;.......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9939
126/469 [=======&gt;......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9940
128/469 [=======&gt;......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9940
130/469 [=======&gt;......................] - ETA: 8s - loss: 0.0056 - accuracy: 0.9940
132/469 [=======&gt;......................] - ETA: 8s - loss: 0.0055 - accuracy: 0.9941
134/469 [=======&gt;......................] - ETA: 8s - loss: 0.0054 - accuracy: 0.9942
136/469 [=======&gt;......................] - ETA: 8s - loss: 0.0054 - accuracy: 0.9943
138/469 [=======&gt;......................] - ETA: 8s - loss: 0.0053 - accuracy: 0.9943
140/469 [=======&gt;......................] - ETA: 8s - loss: 0.0053 - accuracy: 0.9943
142/469 [========&gt;.....................] - ETA: 8s - loss: 0.0053 - accuracy: 0.9942
144/469 [========&gt;.....................] - ETA: 8s - loss: 0.0053 - accuracy: 0.9942
146/469 [========&gt;.....................] - ETA: 8s - loss: 0.0053 - accuracy: 0.9943
149/469 [========&gt;.....................] - ETA: 8s - loss: 0.0053 - accuracy: 0.9942
151/469 [========&gt;.....................] - ETA: 7s - loss: 0.0052 - accuracy: 0.9943
153/469 [========&gt;.....................] - ETA: 7s - loss: 0.0052 - accuracy: 0.9942
155/469 [========&gt;.....................] - ETA: 7s - loss: 0.0052 - accuracy: 0.9943
157/469 [=========&gt;....................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9941
160/469 [=========&gt;....................] - ETA: 7s - loss: 0.0052 - accuracy: 0.9941
162/469 [=========&gt;....................] - ETA: 7s - loss: 0.0052 - accuracy: 0.9942
164/469 [=========&gt;....................] - ETA: 7s - loss: 0.0052 - accuracy: 0.9942
166/469 [=========&gt;....................] - ETA: 7s - loss: 0.0052 - accuracy: 0.9942
168/469 [=========&gt;....................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9941
170/469 [=========&gt;....................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9941
172/469 [==========&gt;...................] - ETA: 7s - loss: 0.0052 - accuracy: 0.9942
174/469 [==========&gt;...................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9941
176/469 [==========&gt;...................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9941
178/469 [==========&gt;...................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9941
180/469 [==========&gt;...................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9941
182/469 [==========&gt;...................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9942
184/469 [==========&gt;...................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9941
187/469 [==========&gt;...................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9942
189/469 [===========&gt;..................] - ETA: 7s - loss: 0.0053 - accuracy: 0.9940
191/469 [===========&gt;..................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9940
194/469 [===========&gt;..................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9940
196/469 [===========&gt;..................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9940
198/469 [===========&gt;..................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9940
200/469 [===========&gt;..................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
202/469 [===========&gt;..................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
204/469 [============&gt;.................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
206/469 [============&gt;.................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
208/469 [============&gt;.................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9940
210/469 [============&gt;.................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9939
212/469 [============&gt;.................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9939
214/469 [============&gt;.................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9939
216/469 [============&gt;.................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9939
218/469 [============&gt;.................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9939
220/469 [=============&gt;................] - ETA: 6s - loss: 0.0054 - accuracy: 0.9940
222/469 [=============&gt;................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
224/469 [=============&gt;................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
226/469 [=============&gt;................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
228/469 [=============&gt;................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
230/469 [=============&gt;................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9941
232/469 [=============&gt;................] - ETA: 5s - loss: 0.0053 - accuracy: 0.9941
234/469 [=============&gt;................] - ETA: 5s - loss: 0.0053 - accuracy: 0.9940
236/469 [==============&gt;...............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9941
238/469 [==============&gt;...............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9941
240/469 [==============&gt;...............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9941
242/469 [==============&gt;...............] - ETA: 5s - loss: 0.0054 - accuracy: 0.9940
244/469 [==============&gt;...............] - ETA: 5s - loss: 0.0054 - accuracy: 0.9940
246/469 [==============&gt;...............] - ETA: 5s - loss: 0.0054 - accuracy: 0.9940
248/469 [==============&gt;...............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9940
250/469 [==============&gt;...............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9941
252/469 [===============&gt;..............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9941
255/469 [===============&gt;..............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9941
257/469 [===============&gt;..............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9942
259/469 [===============&gt;..............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9942
261/469 [===============&gt;..............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9942
263/469 [===============&gt;..............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9941
266/469 [================&gt;.............] - ETA: 5s - loss: 0.0052 - accuracy: 0.9942
268/469 [================&gt;.............] - ETA: 5s - loss: 0.0052 - accuracy: 0.9942
270/469 [================&gt;.............] - ETA: 5s - loss: 0.0053 - accuracy: 0.9942
273/469 [================&gt;.............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
275/469 [================&gt;.............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
277/469 [================&gt;.............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
279/469 [================&gt;.............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
281/469 [================&gt;.............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9943
283/469 [=================&gt;............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9943
286/469 [=================&gt;............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
288/469 [=================&gt;............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
291/469 [=================&gt;............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
293/469 [=================&gt;............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9943
295/469 [=================&gt;............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9943
297/469 [=================&gt;............] - ETA: 4s - loss: 0.0052 - accuracy: 0.9943
299/469 [==================&gt;...........] - ETA: 4s - loss: 0.0052 - accuracy: 0.9943
301/469 [==================&gt;...........] - ETA: 4s - loss: 0.0052 - accuracy: 0.9943
303/469 [==================&gt;...........] - ETA: 4s - loss: 0.0052 - accuracy: 0.9943
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0052 - accuracy: 0.9942
311/469 [==================&gt;...........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
313/469 [===================&gt;..........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
315/469 [===================&gt;..........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
317/469 [===================&gt;..........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
320/469 [===================&gt;..........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9942
322/469 [===================&gt;..........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9942
324/469 [===================&gt;..........] - ETA: 3s - loss: 0.0051 - accuracy: 0.9942
326/469 [===================&gt;..........] - ETA: 3s - loss: 0.0051 - accuracy: 0.9942
328/469 [===================&gt;..........] - ETA: 3s - loss: 0.0051 - accuracy: 0.9942
330/469 [====================&gt;.........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9942
332/469 [====================&gt;.........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
334/469 [====================&gt;.........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
336/469 [====================&gt;.........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
338/469 [====================&gt;.........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
340/469 [====================&gt;.........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
342/469 [====================&gt;.........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
344/469 [=====================&gt;........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
346/469 [=====================&gt;........] - ETA: 3s - loss: 0.0052 - accuracy: 0.9941
348/469 [=====================&gt;........] - ETA: 3s - loss: 0.0051 - accuracy: 0.9942
350/469 [=====================&gt;........] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
352/469 [=====================&gt;........] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
354/469 [=====================&gt;........] - ETA: 2s - loss: 0.0052 - accuracy: 0.9942
357/469 [=====================&gt;........] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
360/469 [======================&gt;.......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
363/469 [======================&gt;.......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
365/469 [======================&gt;.......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
367/469 [======================&gt;.......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
370/469 [======================&gt;.......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
372/469 [======================&gt;.......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
374/469 [======================&gt;.......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
376/469 [=======================&gt;......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
378/469 [=======================&gt;......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9941
380/469 [=======================&gt;......] - ETA: 2s - loss: 0.0052 - accuracy: 0.9940
382/469 [=======================&gt;......] - ETA: 2s - loss: 0.0053 - accuracy: 0.9940
384/469 [=======================&gt;......] - ETA: 2s - loss: 0.0053 - accuracy: 0.9940
386/469 [=======================&gt;......] - ETA: 2s - loss: 0.0053 - accuracy: 0.9939
388/469 [=======================&gt;......] - ETA: 2s - loss: 0.0053 - accuracy: 0.9940
390/469 [=======================&gt;......] - ETA: 1s - loss: 0.0053 - accuracy: 0.9939
392/469 [========================&gt;.....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9939
394/469 [========================&gt;.....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9939
396/469 [========================&gt;.....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9939
398/469 [========================&gt;.....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
400/469 [========================&gt;.....] - ETA: 1s - loss: 0.0052 - accuracy: 0.9940
402/469 [========================&gt;.....] - ETA: 1s - loss: 0.0052 - accuracy: 0.9940
404/469 [========================&gt;.....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
412/469 [=========================&gt;....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
414/469 [=========================&gt;....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0053 - accuracy: 0.9939
425/469 [==========================&gt;...] - ETA: 1s - loss: 0.0053 - accuracy: 0.9940
427/469 [==========================&gt;...] - ETA: 1s - loss: 0.0054 - accuracy: 0.9939
430/469 [==========================&gt;...] - ETA: 0s - loss: 0.0054 - accuracy: 0.9939
432/469 [==========================&gt;...] - ETA: 0s - loss: 0.0054 - accuracy: 0.9940
434/469 [==========================&gt;...] - ETA: 0s - loss: 0.0054 - accuracy: 0.9940
436/469 [==========================&gt;...] - ETA: 0s - loss: 0.0054 - accuracy: 0.9940
438/469 [===========================&gt;..] - ETA: 0s - loss: 0.0054 - accuracy: 0.9939
440/469 [===========================&gt;..] - ETA: 0s - loss: 0.0054 - accuracy: 0.9939
442/469 [===========================&gt;..] - ETA: 0s - loss: 0.0054 - accuracy: 0.9940
444/469 [===========================&gt;..] - ETA: 0s - loss: 0.0054 - accuracy: 0.9939
446/469 [===========================&gt;..] - ETA: 0s - loss: 0.0054 - accuracy: 0.9940
448/469 [===========================&gt;..] - ETA: 0s - loss: 0.0054 - accuracy: 0.9939
450/469 [===========================&gt;..] - ETA: 0s - loss: 0.0055 - accuracy: 0.9939
452/469 [===========================&gt;..] - ETA: 0s - loss: 0.0055 - accuracy: 0.9939
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0055 - accuracy: 0.9939
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0055 - accuracy: 0.9939
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0055 - accuracy: 0.9939
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0055 - accuracy: 0.9939
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0055 - accuracy: 0.9939
466/469 [============================&gt;.] - ETA: 0s - loss: 0.0055 - accuracy: 0.9938
468/469 [============================&gt;.] - ETA: 0s - loss: 0.0055 - accuracy: 0.9939
469/469 [==============================] - 12s 26ms/step - loss: 0.0055 - accuracy: 0.9939 - val_loss: 0.0081 - val_accuracy: 0.9912 - lr: 6.3096e-04
Epoch 3/5

  1/469 [..............................] - ETA: 0s - loss: 0.0036 - accuracy: 0.9922
  3/469 [..............................] - ETA: 7s - loss: 0.0047 - accuracy: 0.9948
  5/469 [..............................] - ETA: 9s - loss: 0.0036 - accuracy: 0.9969
  7/469 [..............................] - ETA: 10s - loss: 0.0043 - accuracy: 0.9967
  9/469 [..............................] - ETA: 10s - loss: 0.0040 - accuracy: 0.9965
 12/469 [..............................] - ETA: 10s - loss: 0.0037 - accuracy: 0.9967
 14/469 [..............................] - ETA: 10s - loss: 0.0036 - accuracy: 0.9967
 16/469 [&gt;.............................] - ETA: 10s - loss: 0.0034 - accuracy: 0.9966
 19/469 [&gt;.............................] - ETA: 10s - loss: 0.0031 - accuracy: 0.9971
 21/469 [&gt;.............................] - ETA: 10s - loss: 0.0029 - accuracy: 0.9974
 24/469 [&gt;.............................] - ETA: 10s - loss: 0.0031 - accuracy: 0.9974
 26/469 [&gt;.............................] - ETA: 10s - loss: 0.0030 - accuracy: 0.9976
 28/469 [&gt;.............................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9978
 31/469 [&gt;.............................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9977
 33/469 [=&gt;............................] - ETA: 10s - loss: 0.0029 - accuracy: 0.9976
 35/469 [=&gt;............................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9978
 37/469 [=&gt;............................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9979
 39/469 [=&gt;............................] - ETA: 10s - loss: 0.0029 - accuracy: 0.9980
 41/469 [=&gt;............................] - ETA: 10s - loss: 0.0029 - accuracy: 0.9979
 43/469 [=&gt;............................] - ETA: 10s - loss: 0.0030 - accuracy: 0.9978
 45/469 [=&gt;............................] - ETA: 10s - loss: 0.0030 - accuracy: 0.9979
 47/469 [==&gt;...........................] - ETA: 10s - loss: 0.0029 - accuracy: 0.9980
 49/469 [==&gt;...........................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9981
 51/469 [==&gt;...........................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9982
 53/469 [==&gt;...........................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9982
 55/469 [==&gt;...........................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9979
 57/469 [==&gt;...........................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9978
 59/469 [==&gt;...........................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9977
 62/469 [==&gt;...........................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9977
 65/469 [===&gt;..........................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9978
 68/469 [===&gt;..........................] - ETA: 9s - loss: 0.0027 - accuracy: 0.9979 
 70/469 [===&gt;..........................] - ETA: 9s - loss: 0.0027 - accuracy: 0.9979
 72/469 [===&gt;..........................] - ETA: 9s - loss: 0.0027 - accuracy: 0.9978
 74/469 [===&gt;..........................] - ETA: 9s - loss: 0.0027 - accuracy: 0.9978
 76/469 [===&gt;..........................] - ETA: 9s - loss: 0.0027 - accuracy: 0.9978
 78/469 [===&gt;..........................] - ETA: 9s - loss: 0.0027 - accuracy: 0.9979
 80/469 [====&gt;.........................] - ETA: 9s - loss: 0.0026 - accuracy: 0.9979
 82/469 [====&gt;.........................] - ETA: 9s - loss: 0.0026 - accuracy: 0.9980
 84/469 [====&gt;.........................] - ETA: 9s - loss: 0.0025 - accuracy: 0.9980
 87/469 [====&gt;.........................] - ETA: 9s - loss: 0.0026 - accuracy: 0.9980
 89/469 [====&gt;.........................] - ETA: 9s - loss: 0.0026 - accuracy: 0.9981
 91/469 [====&gt;.........................] - ETA: 9s - loss: 0.0025 - accuracy: 0.9981
 93/469 [====&gt;.........................] - ETA: 9s - loss: 0.0025 - accuracy: 0.9982
 96/469 [=====&gt;........................] - ETA: 9s - loss: 0.0025 - accuracy: 0.9982
 99/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9983
101/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9983
103/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9983
105/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9983
107/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9982
109/469 [=====&gt;........................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9983
111/469 [======&gt;.......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9983
113/469 [======&gt;.......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9983
115/469 [======&gt;.......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9983
117/469 [======&gt;.......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9983
120/469 [======&gt;.......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9982
123/469 [======&gt;.......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9982
125/469 [======&gt;.......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9983
127/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9982
129/469 [=======&gt;......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9982
131/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9982
133/469 [=======&gt;......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9982
136/469 [=======&gt;......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9982
138/469 [=======&gt;......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9982
140/469 [=======&gt;......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9982
142/469 [========&gt;.....................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9982
144/469 [========&gt;.....................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9981
146/469 [========&gt;.....................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9981
149/469 [========&gt;.....................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9980
151/469 [========&gt;.....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
153/469 [========&gt;.....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9981
155/469 [========&gt;.....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
157/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
159/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
161/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
164/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
166/469 [=========&gt;....................] - ETA: 7s - loss: 0.0025 - accuracy: 0.9979
168/469 [=========&gt;....................] - ETA: 7s - loss: 0.0025 - accuracy: 0.9980
170/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
173/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
175/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
177/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9981
179/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9981
181/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
183/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
185/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9979
187/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
189/469 [===========&gt;..................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9980
192/469 [===========&gt;..................] - ETA: 6s - loss: 0.0024 - accuracy: 0.9980
195/469 [===========&gt;..................] - ETA: 6s - loss: 0.0024 - accuracy: 0.9980
197/469 [===========&gt;..................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
199/469 [===========&gt;..................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
201/469 [===========&gt;..................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
203/469 [===========&gt;..................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
205/469 [============&gt;.................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
208/469 [============&gt;.................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9980
210/469 [============&gt;.................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9980
212/469 [============&gt;.................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9980
214/469 [============&gt;.................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
216/469 [============&gt;.................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
218/469 [============&gt;.................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
220/469 [=============&gt;................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
222/469 [=============&gt;................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
224/469 [=============&gt;................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
226/469 [=============&gt;................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
228/469 [=============&gt;................] - ETA: 6s - loss: 0.0023 - accuracy: 0.9981
231/469 [=============&gt;................] - ETA: 5s - loss: 0.0023 - accuracy: 0.9982
233/469 [=============&gt;................] - ETA: 5s - loss: 0.0023 - accuracy: 0.9982
236/469 [==============&gt;...............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
239/469 [==============&gt;...............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
241/469 [==============&gt;...............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
243/469 [==============&gt;...............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
245/469 [==============&gt;...............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
247/469 [==============&gt;...............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
250/469 [==============&gt;...............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9982
252/469 [===============&gt;..............] - ETA: 5s - loss: 0.0022 - accuracy: 0.9981
254/469 [===============&gt;..............] - ETA: 5s - loss: 0.0022 - accuracy: 0.9981
256/469 [===============&gt;..............] - ETA: 5s - loss: 0.0022 - accuracy: 0.9981
258/469 [===============&gt;..............] - ETA: 5s - loss: 0.0022 - accuracy: 0.9981
260/469 [===============&gt;..............] - ETA: 5s - loss: 0.0022 - accuracy: 0.9981
262/469 [===============&gt;..............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
264/469 [===============&gt;..............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
266/469 [================&gt;.............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9981
268/469 [================&gt;.............] - ETA: 5s - loss: 0.0023 - accuracy: 0.9980
270/469 [================&gt;.............] - ETA: 4s - loss: 0.0023 - accuracy: 0.9981
272/469 [================&gt;.............] - ETA: 4s - loss: 0.0023 - accuracy: 0.9981
274/469 [================&gt;.............] - ETA: 4s - loss: 0.0023 - accuracy: 0.9981
276/469 [================&gt;.............] - ETA: 4s - loss: 0.0023 - accuracy: 0.9981
278/469 [================&gt;.............] - ETA: 4s - loss: 0.0023 - accuracy: 0.9981
280/469 [================&gt;.............] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
282/469 [=================&gt;............] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
284/469 [=================&gt;............] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
287/469 [=================&gt;............] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
290/469 [=================&gt;............] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
292/469 [=================&gt;............] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
294/469 [=================&gt;............] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
296/469 [=================&gt;............] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
298/469 [==================&gt;...........] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
300/469 [==================&gt;...........] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
302/469 [==================&gt;...........] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0024 - accuracy: 0.9980
311/469 [==================&gt;...........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
313/469 [===================&gt;..........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
315/469 [===================&gt;..........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
317/469 [===================&gt;..........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
319/469 [===================&gt;..........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
321/469 [===================&gt;..........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
323/469 [===================&gt;..........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
326/469 [===================&gt;..........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
328/469 [===================&gt;..........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
331/469 [====================&gt;.........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9979
334/469 [====================&gt;.........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
336/469 [====================&gt;.........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
338/469 [====================&gt;.........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
340/469 [====================&gt;.........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
342/469 [====================&gt;.........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
344/469 [=====================&gt;........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9980
346/469 [=====================&gt;........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9979
349/469 [=====================&gt;........] - ETA: 3s - loss: 0.0024 - accuracy: 0.9979
351/469 [=====================&gt;........] - ETA: 2s - loss: 0.0024 - accuracy: 0.9979
353/469 [=====================&gt;........] - ETA: 2s - loss: 0.0024 - accuracy: 0.9979
355/469 [=====================&gt;........] - ETA: 2s - loss: 0.0024 - accuracy: 0.9979
357/469 [=====================&gt;........] - ETA: 2s - loss: 0.0024 - accuracy: 0.9979
359/469 [=====================&gt;........] - ETA: 2s - loss: 0.0024 - accuracy: 0.9979
361/469 [======================&gt;.......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9979
363/469 [======================&gt;.......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
365/469 [======================&gt;.......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
368/469 [======================&gt;.......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
371/469 [======================&gt;.......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
373/469 [======================&gt;.......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
375/469 [======================&gt;.......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
377/469 [=======================&gt;......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
380/469 [=======================&gt;......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
382/469 [=======================&gt;......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
384/469 [=======================&gt;......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
386/469 [=======================&gt;......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
388/469 [=======================&gt;......] - ETA: 2s - loss: 0.0024 - accuracy: 0.9978
390/469 [=======================&gt;......] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
392/469 [========================&gt;.....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
395/469 [========================&gt;.....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
398/469 [========================&gt;.....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
400/469 [========================&gt;.....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
402/469 [========================&gt;.....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
404/469 [========================&gt;.....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9979
413/469 [=========================&gt;....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9979
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9979
420/469 [=========================&gt;....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9979
422/469 [=========================&gt;....] - ETA: 1s - loss: 0.0024 - accuracy: 0.9979
424/469 [==========================&gt;...] - ETA: 1s - loss: 0.0024 - accuracy: 0.9979
426/469 [==========================&gt;...] - ETA: 1s - loss: 0.0024 - accuracy: 0.9979
428/469 [==========================&gt;...] - ETA: 1s - loss: 0.0024 - accuracy: 0.9978
430/469 [==========================&gt;...] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
433/469 [==========================&gt;...] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
435/469 [==========================&gt;...] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
439/469 [===========================&gt;..] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0024 - accuracy: 0.9978
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0024 - accuracy: 0.9978
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0025 - accuracy: 0.9978
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0024 - accuracy: 0.9978
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0025 - accuracy: 0.9978
456/469 [============================&gt;.] - ETA: 0s - loss: 0.0024 - accuracy: 0.9978
458/469 [============================&gt;.] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
460/469 [============================&gt;.] - ETA: 0s - loss: 0.0024 - accuracy: 0.9978
462/469 [============================&gt;.] - ETA: 0s - loss: 0.0024 - accuracy: 0.9979
464/469 [============================&gt;.] - ETA: 0s - loss: 0.0024 - accuracy: 0.9978
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0024 - accuracy: 0.9978
469/469 [==============================] - 12s 26ms/step - loss: 0.0025 - accuracy: 0.9979 - val_loss: 0.0065 - val_accuracy: 0.9925 - lr: 3.9811e-04
Epoch 4/5

  1/469 [..............................] - ETA: 0s - loss: 0.0013 - accuracy: 1.0000
  3/469 [..............................] - ETA: 7s - loss: 0.0014 - accuracy: 1.0000
  5/469 [..............................] - ETA: 9s - loss: 0.0020 - accuracy: 0.9984
  7/469 [..............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9989
  9/469 [..............................] - ETA: 10s - loss: 0.0020 - accuracy: 0.9991
 11/469 [..............................] - ETA: 10s - loss: 0.0020 - accuracy: 0.9993
 13/469 [..............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9994
 15/469 [..............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9995
 17/469 [&gt;.............................] - ETA: 10s - loss: 0.0015 - accuracy: 0.9995
 19/469 [&gt;.............................] - ETA: 10s - loss: 0.0015 - accuracy: 0.9996
 21/469 [&gt;.............................] - ETA: 10s - loss: 0.0015 - accuracy: 0.9996
 23/469 [&gt;.............................] - ETA: 10s - loss: 0.0015 - accuracy: 0.9997
 25/469 [&gt;.............................] - ETA: 10s - loss: 0.0014 - accuracy: 0.9997
 27/469 [&gt;.............................] - ETA: 10s - loss: 0.0014 - accuracy: 0.9997
 29/469 [&gt;.............................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9997
 31/469 [&gt;.............................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9997
 33/469 [=&gt;............................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9998
 35/469 [=&gt;............................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9998
 38/469 [=&gt;............................] - ETA: 10s - loss: 0.0014 - accuracy: 0.9996
 40/469 [=&gt;............................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9996
 43/469 [=&gt;............................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9996
 45/469 [=&gt;............................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9997
 47/469 [==&gt;...........................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9997
 49/469 [==&gt;...........................] - ETA: 10s - loss: 0.0013 - accuracy: 0.9997
 51/469 [==&gt;...........................] - ETA: 10s - loss: 0.0012 - accuracy: 0.9997
 53/469 [==&gt;...........................] - ETA: 10s - loss: 0.0012 - accuracy: 0.9997
 56/469 [==&gt;...........................] - ETA: 10s - loss: 0.0012 - accuracy: 0.9997
 58/469 [==&gt;...........................] - ETA: 10s - loss: 0.0012 - accuracy: 0.9997
 61/469 [==&gt;...........................] - ETA: 10s - loss: 0.0011 - accuracy: 0.9997
 64/469 [===&gt;..........................] - ETA: 10s - loss: 0.0011 - accuracy: 0.9998
 66/469 [===&gt;..........................] - ETA: 9s - loss: 0.0011 - accuracy: 0.9998 
 68/469 [===&gt;..........................] - ETA: 9s - loss: 0.0011 - accuracy: 0.9998
 70/469 [===&gt;..........................] - ETA: 9s - loss: 0.0011 - accuracy: 0.9998
 73/469 [===&gt;..........................] - ETA: 9s - loss: 0.0011 - accuracy: 0.9998
 75/469 [===&gt;..........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9998
 78/469 [===&gt;..........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9998
 80/469 [====&gt;.........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9998
 82/469 [====&gt;.........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9998
 84/469 [====&gt;.........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9998
 87/469 [====&gt;.........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9998
 90/469 [====&gt;.........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9997
 92/469 [====&gt;.........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9997
 94/469 [=====&gt;........................] - ETA: 9s - loss: 0.0011 - accuracy: 0.9998
 96/469 [=====&gt;........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9998
 98/469 [=====&gt;........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9998
100/469 [=====&gt;........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9997
102/469 [=====&gt;........................] - ETA: 9s - loss: 0.0010 - accuracy: 0.9997
104/469 [=====&gt;........................] - ETA: 9s - loss: 0.0011 - accuracy: 0.9996
106/469 [=====&gt;........................] - ETA: 9s - loss: 0.0011 - accuracy: 0.9996
108/469 [=====&gt;........................] - ETA: 9s - loss: 0.0011 - accuracy: 0.9996
110/469 [======&gt;.......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9996
112/469 [======&gt;.......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9996
114/469 [======&gt;.......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9995
116/469 [======&gt;.......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9995
118/469 [======&gt;.......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9995
121/469 [======&gt;.......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9995
123/469 [======&gt;.......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
125/469 [======&gt;.......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
127/469 [=======&gt;......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
130/469 [=======&gt;......................] - ETA: 8s - loss: 0.0012 - accuracy: 0.9993
132/469 [=======&gt;......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9993
134/469 [=======&gt;......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
136/469 [=======&gt;......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
138/469 [=======&gt;......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
140/469 [=======&gt;......................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
142/469 [========&gt;.....................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
144/469 [========&gt;.....................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
146/469 [========&gt;.....................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
148/469 [========&gt;.....................] - ETA: 8s - loss: 0.0012 - accuracy: 0.9994
150/469 [========&gt;.....................] - ETA: 8s - loss: 0.0011 - accuracy: 0.9994
152/469 [========&gt;.....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
155/469 [========&gt;.....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
157/469 [=========&gt;....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
160/469 [=========&gt;....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
162/469 [=========&gt;....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
164/469 [=========&gt;....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
166/469 [=========&gt;....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
169/469 [=========&gt;....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
171/469 [=========&gt;....................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
173/469 [==========&gt;...................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
175/469 [==========&gt;...................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
178/469 [==========&gt;...................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
180/469 [==========&gt;...................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
182/469 [==========&gt;...................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9994
184/469 [==========&gt;...................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9993
186/469 [==========&gt;...................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9993
188/469 [===========&gt;..................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9993
190/469 [===========&gt;..................] - ETA: 7s - loss: 0.0011 - accuracy: 0.9993
192/469 [===========&gt;..................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
194/469 [===========&gt;..................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
196/469 [===========&gt;..................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
198/469 [===========&gt;..................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
200/469 [===========&gt;..................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
203/469 [===========&gt;..................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
205/469 [============&gt;.................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
207/469 [============&gt;.................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
209/469 [============&gt;.................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
211/469 [============&gt;.................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
213/469 [============&gt;.................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
215/469 [============&gt;.................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
217/469 [============&gt;.................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
219/469 [=============&gt;................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
222/469 [=============&gt;................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
224/469 [=============&gt;................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
226/469 [=============&gt;................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
229/469 [=============&gt;................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
231/469 [=============&gt;................] - ETA: 6s - loss: 0.0011 - accuracy: 0.9993
233/469 [=============&gt;................] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
235/469 [==============&gt;...............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
238/469 [==============&gt;...............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
241/469 [==============&gt;...............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
243/469 [==============&gt;...............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
245/469 [==============&gt;...............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
247/469 [==============&gt;...............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
249/469 [==============&gt;...............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
251/469 [===============&gt;..............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
253/469 [===============&gt;..............] - ETA: 5s - loss: 0.0012 - accuracy: 0.9993
255/469 [===============&gt;..............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
258/469 [===============&gt;..............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
260/469 [===============&gt;..............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
262/469 [===============&gt;..............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
264/469 [===============&gt;..............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
266/469 [================&gt;.............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
268/469 [================&gt;.............] - ETA: 5s - loss: 0.0011 - accuracy: 0.9993
271/469 [================&gt;.............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
273/469 [================&gt;.............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
275/469 [================&gt;.............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
277/469 [================&gt;.............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
279/469 [================&gt;.............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
281/469 [================&gt;.............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
283/469 [=================&gt;............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
285/469 [=================&gt;............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
287/469 [=================&gt;............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
289/469 [=================&gt;............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
292/469 [=================&gt;............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
294/469 [=================&gt;............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
296/469 [=================&gt;............] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
298/469 [==================&gt;...........] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
300/469 [==================&gt;...........] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
302/469 [==================&gt;...........] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
304/469 [==================&gt;...........] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
306/469 [==================&gt;...........] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
308/469 [==================&gt;...........] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
310/469 [==================&gt;...........] - ETA: 4s - loss: 0.0011 - accuracy: 0.9993
312/469 [==================&gt;...........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
314/469 [===================&gt;..........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
316/469 [===================&gt;..........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
318/469 [===================&gt;..........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
320/469 [===================&gt;..........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
322/469 [===================&gt;..........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
325/469 [===================&gt;..........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
327/469 [===================&gt;..........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
329/469 [====================&gt;.........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
331/469 [====================&gt;.........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
334/469 [====================&gt;.........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
336/469 [====================&gt;.........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
338/469 [====================&gt;.........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
340/469 [====================&gt;.........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
342/469 [====================&gt;.........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
344/469 [=====================&gt;........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
346/469 [=====================&gt;........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
348/469 [=====================&gt;........] - ETA: 3s - loss: 0.0011 - accuracy: 0.9993
351/469 [=====================&gt;........] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
354/469 [=====================&gt;........] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
356/469 [=====================&gt;........] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
359/469 [=====================&gt;........] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
361/469 [======================&gt;.......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
363/469 [======================&gt;.......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
366/469 [======================&gt;.......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
368/469 [======================&gt;.......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
370/469 [======================&gt;.......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
372/469 [======================&gt;.......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
374/469 [======================&gt;.......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
376/469 [=======================&gt;......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
378/469 [=======================&gt;......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
380/469 [=======================&gt;......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
382/469 [=======================&gt;......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
384/469 [=======================&gt;......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
386/469 [=======================&gt;......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
388/469 [=======================&gt;......] - ETA: 2s - loss: 0.0011 - accuracy: 0.9993
390/469 [=======================&gt;......] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
392/469 [========================&gt;.....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
394/469 [========================&gt;.....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
396/469 [========================&gt;.....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
398/469 [========================&gt;.....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
400/469 [========================&gt;.....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
402/469 [========================&gt;.....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
408/469 [=========================&gt;....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
410/469 [=========================&gt;....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
412/469 [=========================&gt;....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
414/469 [=========================&gt;....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9993
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9992
420/469 [=========================&gt;....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9992
422/469 [=========================&gt;....] - ETA: 1s - loss: 0.0011 - accuracy: 0.9992
424/469 [==========================&gt;...] - ETA: 1s - loss: 0.0011 - accuracy: 0.9992
426/469 [==========================&gt;...] - ETA: 1s - loss: 0.0011 - accuracy: 0.9992
428/469 [==========================&gt;...] - ETA: 1s - loss: 0.0011 - accuracy: 0.9992
430/469 [==========================&gt;...] - ETA: 0s - loss: 0.0011 - accuracy: 0.9992
432/469 [==========================&gt;...] - ETA: 0s - loss: 0.0011 - accuracy: 0.9992
434/469 [==========================&gt;...] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
436/469 [==========================&gt;...] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
438/469 [===========================&gt;..] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
440/469 [===========================&gt;..] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
462/469 [============================&gt;.] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
464/469 [============================&gt;.] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
466/469 [============================&gt;.] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
468/469 [============================&gt;.] - ETA: 0s - loss: 0.0012 - accuracy: 0.9992
469/469 [==============================] - 12s 26ms/step - loss: 0.0012 - accuracy: 0.9992 - val_loss: 0.0059 - val_accuracy: 0.9927 - lr: 2.5119e-04
Epoch 5/5

  1/469 [..............................] - ETA: 0s - loss: 2.3871e-05 - accuracy: 1.0000
  3/469 [..............................] - ETA: 7s - loss: 3.5702e-04 - accuracy: 1.0000
  5/469 [..............................] - ETA: 9s - loss: 4.8846e-04 - accuracy: 1.0000
  7/469 [..............................] - ETA: 9s - loss: 5.1777e-04 - accuracy: 1.0000
  9/469 [..............................] - ETA: 10s - loss: 4.6985e-04 - accuracy: 1.0000
 11/469 [..............................] - ETA: 10s - loss: 4.8284e-04 - accuracy: 1.0000
 13/469 [..............................] - ETA: 10s - loss: 5.7844e-04 - accuracy: 1.0000
 15/469 [..............................] - ETA: 10s - loss: 5.6491e-04 - accuracy: 1.0000
 17/469 [&gt;.............................] - ETA: 10s - loss: 6.2586e-04 - accuracy: 1.0000
 19/469 [&gt;.............................] - ETA: 10s - loss: 6.9250e-04 - accuracy: 1.0000
 21/469 [&gt;.............................] - ETA: 10s - loss: 6.8547e-04 - accuracy: 1.0000
 23/469 [&gt;.............................] - ETA: 10s - loss: 6.7046e-04 - accuracy: 1.0000
 26/469 [&gt;.............................] - ETA: 10s - loss: 6.8556e-04 - accuracy: 1.0000
 28/469 [&gt;.............................] - ETA: 10s - loss: 6.9100e-04 - accuracy: 1.0000
 30/469 [&gt;.............................] - ETA: 10s - loss: 7.6427e-04 - accuracy: 1.0000
 32/469 [=&gt;............................] - ETA: 10s - loss: 7.4496e-04 - accuracy: 1.0000
 34/469 [=&gt;............................] - ETA: 10s - loss: 7.0884e-04 - accuracy: 1.0000
 36/469 [=&gt;............................] - ETA: 10s - loss: 6.8851e-04 - accuracy: 1.0000
 38/469 [=&gt;............................] - ETA: 10s - loss: 6.6182e-04 - accuracy: 1.0000
 40/469 [=&gt;............................] - ETA: 10s - loss: 6.5329e-04 - accuracy: 1.0000
 42/469 [=&gt;............................] - ETA: 10s - loss: 6.3927e-04 - accuracy: 1.0000
 44/469 [=&gt;............................] - ETA: 10s - loss: 6.5396e-04 - accuracy: 1.0000
 46/469 [=&gt;............................] - ETA: 10s - loss: 6.5680e-04 - accuracy: 1.0000
 48/469 [==&gt;...........................] - ETA: 10s - loss: 6.3264e-04 - accuracy: 1.0000
 51/469 [==&gt;...........................] - ETA: 10s - loss: 6.6309e-04 - accuracy: 1.0000
 53/469 [==&gt;...........................] - ETA: 10s - loss: 6.5669e-04 - accuracy: 1.0000
 55/469 [==&gt;...........................] - ETA: 10s - loss: 6.7163e-04 - accuracy: 1.0000
 57/469 [==&gt;...........................] - ETA: 10s - loss: 6.5883e-04 - accuracy: 1.0000
 59/469 [==&gt;...........................] - ETA: 10s - loss: 7.3494e-04 - accuracy: 0.9999
 61/469 [==&gt;...........................] - ETA: 10s - loss: 7.2095e-04 - accuracy: 0.9999
 63/469 [===&gt;..........................] - ETA: 10s - loss: 7.2619e-04 - accuracy: 0.9999
 65/469 [===&gt;..........................] - ETA: 10s - loss: 7.0814e-04 - accuracy: 0.9999
 68/469 [===&gt;..........................] - ETA: 10s - loss: 6.9604e-04 - accuracy: 0.9999
 70/469 [===&gt;..........................] - ETA: 9s - loss: 7.1578e-04 - accuracy: 0.9998 
 73/469 [===&gt;..........................] - ETA: 9s - loss: 7.0425e-04 - accuracy: 0.9998
 75/469 [===&gt;..........................] - ETA: 9s - loss: 7.0047e-04 - accuracy: 0.9998
 77/469 [===&gt;..........................] - ETA: 9s - loss: 7.0336e-04 - accuracy: 0.9998
 79/469 [====&gt;.........................] - ETA: 9s - loss: 6.9721e-04 - accuracy: 0.9998
 81/469 [====&gt;.........................] - ETA: 9s - loss: 6.8142e-04 - accuracy: 0.9998
 83/469 [====&gt;.........................] - ETA: 9s - loss: 6.8048e-04 - accuracy: 0.9998
 86/469 [====&gt;.........................] - ETA: 9s - loss: 6.8006e-04 - accuracy: 0.9998
 89/469 [====&gt;.........................] - ETA: 9s - loss: 6.8417e-04 - accuracy: 0.9998
 91/469 [====&gt;.........................] - ETA: 9s - loss: 7.1026e-04 - accuracy: 0.9997
 93/469 [====&gt;.........................] - ETA: 9s - loss: 7.0153e-04 - accuracy: 0.9997
 95/469 [=====&gt;........................] - ETA: 9s - loss: 7.1355e-04 - accuracy: 0.9998
 97/469 [=====&gt;........................] - ETA: 9s - loss: 7.0306e-04 - accuracy: 0.9998
 99/469 [=====&gt;........................] - ETA: 9s - loss: 6.9943e-04 - accuracy: 0.9998
101/469 [=====&gt;........................] - ETA: 9s - loss: 6.8731e-04 - accuracy: 0.9998
103/469 [=====&gt;........................] - ETA: 9s - loss: 6.7825e-04 - accuracy: 0.9998
105/469 [=====&gt;........................] - ETA: 9s - loss: 6.8119e-04 - accuracy: 0.9998
107/469 [=====&gt;........................] - ETA: 9s - loss: 7.1378e-04 - accuracy: 0.9997
109/469 [=====&gt;........................] - ETA: 9s - loss: 7.2167e-04 - accuracy: 0.9997
111/469 [======&gt;.......................] - ETA: 8s - loss: 7.1948e-04 - accuracy: 0.9997
113/469 [======&gt;.......................] - ETA: 8s - loss: 7.1646e-04 - accuracy: 0.9997
115/469 [======&gt;.......................] - ETA: 8s - loss: 7.3782e-04 - accuracy: 0.9997
117/469 [======&gt;.......................] - ETA: 8s - loss: 7.3239e-04 - accuracy: 0.9997
119/469 [======&gt;.......................] - ETA: 8s - loss: 7.2822e-04 - accuracy: 0.9997
121/469 [======&gt;.......................] - ETA: 8s - loss: 7.2759e-04 - accuracy: 0.9997
123/469 [======&gt;.......................] - ETA: 8s - loss: 7.1809e-04 - accuracy: 0.9997
126/469 [=======&gt;......................] - ETA: 8s - loss: 7.2862e-04 - accuracy: 0.9998
128/469 [=======&gt;......................] - ETA: 8s - loss: 7.2272e-04 - accuracy: 0.9998
131/469 [=======&gt;......................] - ETA: 8s - loss: 7.1272e-04 - accuracy: 0.9998
133/469 [=======&gt;......................] - ETA: 8s - loss: 7.0325e-04 - accuracy: 0.9998
135/469 [=======&gt;......................] - ETA: 8s - loss: 6.9959e-04 - accuracy: 0.9998
137/469 [=======&gt;......................] - ETA: 8s - loss: 7.0742e-04 - accuracy: 0.9998
139/469 [=======&gt;......................] - ETA: 8s - loss: 7.0021e-04 - accuracy: 0.9998
141/469 [========&gt;.....................] - ETA: 8s - loss: 6.9349e-04 - accuracy: 0.9998
143/469 [========&gt;.....................] - ETA: 8s - loss: 6.9149e-04 - accuracy: 0.9998
145/469 [========&gt;.....................] - ETA: 8s - loss: 6.8713e-04 - accuracy: 0.9998
148/469 [========&gt;.....................] - ETA: 8s - loss: 6.7816e-04 - accuracy: 0.9998
150/469 [========&gt;.....................] - ETA: 8s - loss: 6.7971e-04 - accuracy: 0.9998
152/469 [========&gt;.....................] - ETA: 7s - loss: 6.9202e-04 - accuracy: 0.9998
155/469 [========&gt;.....................] - ETA: 7s - loss: 6.8613e-04 - accuracy: 0.9998
157/469 [=========&gt;....................] - ETA: 7s - loss: 6.7877e-04 - accuracy: 0.9998
159/469 [=========&gt;....................] - ETA: 7s - loss: 6.7471e-04 - accuracy: 0.9998
161/469 [=========&gt;....................] - ETA: 7s - loss: 6.7324e-04 - accuracy: 0.9998
163/469 [=========&gt;....................] - ETA: 7s - loss: 6.6917e-04 - accuracy: 0.9998
165/469 [=========&gt;....................] - ETA: 7s - loss: 6.6311e-04 - accuracy: 0.9998
167/469 [=========&gt;....................] - ETA: 7s - loss: 6.5810e-04 - accuracy: 0.9998
169/469 [=========&gt;....................] - ETA: 7s - loss: 6.5547e-04 - accuracy: 0.9998
172/469 [==========&gt;...................] - ETA: 7s - loss: 6.7932e-04 - accuracy: 0.9998
175/469 [==========&gt;...................] - ETA: 7s - loss: 6.7411e-04 - accuracy: 0.9998
178/469 [==========&gt;...................] - ETA: 7s - loss: 6.6559e-04 - accuracy: 0.9998
180/469 [==========&gt;...................] - ETA: 7s - loss: 6.6036e-04 - accuracy: 0.9998
182/469 [==========&gt;...................] - ETA: 7s - loss: 6.5325e-04 - accuracy: 0.9998
184/469 [==========&gt;...................] - ETA: 7s - loss: 6.5598e-04 - accuracy: 0.9998
186/469 [==========&gt;...................] - ETA: 7s - loss: 6.6011e-04 - accuracy: 0.9998
188/469 [===========&gt;..................] - ETA: 7s - loss: 6.6587e-04 - accuracy: 0.9998
190/469 [===========&gt;..................] - ETA: 7s - loss: 6.7131e-04 - accuracy: 0.9998
192/469 [===========&gt;..................] - ETA: 6s - loss: 6.6475e-04 - accuracy: 0.9998
195/469 [===========&gt;..................] - ETA: 6s - loss: 6.7245e-04 - accuracy: 0.9997
197/469 [===========&gt;..................] - ETA: 6s - loss: 6.7207e-04 - accuracy: 0.9997
199/469 [===========&gt;..................] - ETA: 6s - loss: 6.7742e-04 - accuracy: 0.9997
201/469 [===========&gt;..................] - ETA: 6s - loss: 6.8006e-04 - accuracy: 0.9997
204/469 [============&gt;.................] - ETA: 6s - loss: 6.9115e-04 - accuracy: 0.9997
206/469 [============&gt;.................] - ETA: 6s - loss: 6.8628e-04 - accuracy: 0.9997
208/469 [============&gt;.................] - ETA: 6s - loss: 6.9281e-04 - accuracy: 0.9997
211/469 [============&gt;.................] - ETA: 6s - loss: 6.8988e-04 - accuracy: 0.9997
214/469 [============&gt;.................] - ETA: 6s - loss: 6.8885e-04 - accuracy: 0.9997
216/469 [============&gt;.................] - ETA: 6s - loss: 6.8340e-04 - accuracy: 0.9997
218/469 [============&gt;.................] - ETA: 6s - loss: 6.8205e-04 - accuracy: 0.9997
220/469 [=============&gt;................] - ETA: 6s - loss: 6.8067e-04 - accuracy: 0.9997
222/469 [=============&gt;................] - ETA: 6s - loss: 6.8550e-04 - accuracy: 0.9997
224/469 [=============&gt;................] - ETA: 6s - loss: 6.8188e-04 - accuracy: 0.9997
227/469 [=============&gt;................] - ETA: 6s - loss: 7.0408e-04 - accuracy: 0.9997
229/469 [=============&gt;................] - ETA: 6s - loss: 7.0240e-04 - accuracy: 0.9997
231/469 [=============&gt;................] - ETA: 5s - loss: 7.0243e-04 - accuracy: 0.9997
233/469 [=============&gt;................] - ETA: 5s - loss: 6.9846e-04 - accuracy: 0.9997
235/469 [==============&gt;...............] - ETA: 5s - loss: 6.9642e-04 - accuracy: 0.9997
237/469 [==============&gt;...............] - ETA: 5s - loss: 6.9222e-04 - accuracy: 0.9997
239/469 [==============&gt;...............] - ETA: 5s - loss: 6.8908e-04 - accuracy: 0.9997
242/469 [==============&gt;...............] - ETA: 5s - loss: 6.8986e-04 - accuracy: 0.9997
244/469 [==============&gt;...............] - ETA: 5s - loss: 6.8577e-04 - accuracy: 0.9997
246/469 [==============&gt;...............] - ETA: 5s - loss: 6.8687e-04 - accuracy: 0.9997
248/469 [==============&gt;...............] - ETA: 5s - loss: 6.8810e-04 - accuracy: 0.9997
250/469 [==============&gt;...............] - ETA: 5s - loss: 6.8571e-04 - accuracy: 0.9997
252/469 [===============&gt;..............] - ETA: 5s - loss: 6.8393e-04 - accuracy: 0.9997
254/469 [===============&gt;..............] - ETA: 5s - loss: 6.8119e-04 - accuracy: 0.9997
256/469 [===============&gt;..............] - ETA: 5s - loss: 6.9056e-04 - accuracy: 0.9997
258/469 [===============&gt;..............] - ETA: 5s - loss: 6.9097e-04 - accuracy: 0.9997
260/469 [===============&gt;..............] - ETA: 5s - loss: 6.9277e-04 - accuracy: 0.9997
262/469 [===============&gt;..............] - ETA: 5s - loss: 6.9005e-04 - accuracy: 0.9997
264/469 [===============&gt;..............] - ETA: 5s - loss: 6.9173e-04 - accuracy: 0.9997
266/469 [================&gt;.............] - ETA: 5s - loss: 6.9164e-04 - accuracy: 0.9997
268/469 [================&gt;.............] - ETA: 5s - loss: 6.8931e-04 - accuracy: 0.9997
270/469 [================&gt;.............] - ETA: 5s - loss: 6.9482e-04 - accuracy: 0.9997
273/469 [================&gt;.............] - ETA: 4s - loss: 6.9117e-04 - accuracy: 0.9997
275/469 [================&gt;.............] - ETA: 4s - loss: 6.9206e-04 - accuracy: 0.9997
277/469 [================&gt;.............] - ETA: 4s - loss: 6.8984e-04 - accuracy: 0.9997
279/469 [================&gt;.............] - ETA: 4s - loss: 6.8720e-04 - accuracy: 0.9997
281/469 [================&gt;.............] - ETA: 4s - loss: 6.8454e-04 - accuracy: 0.9997
284/469 [=================&gt;............] - ETA: 4s - loss: 6.7934e-04 - accuracy: 0.9997
286/469 [=================&gt;............] - ETA: 4s - loss: 6.7643e-04 - accuracy: 0.9997
289/469 [=================&gt;............] - ETA: 4s - loss: 6.8252e-04 - accuracy: 0.9997
291/469 [=================&gt;............] - ETA: 4s - loss: 6.9172e-04 - accuracy: 0.9997
294/469 [=================&gt;............] - ETA: 4s - loss: 6.9015e-04 - accuracy: 0.9997
297/469 [=================&gt;............] - ETA: 4s - loss: 6.8912e-04 - accuracy: 0.9997
299/469 [==================&gt;...........] - ETA: 4s - loss: 6.8656e-04 - accuracy: 0.9997
301/469 [==================&gt;...........] - ETA: 4s - loss: 6.8465e-04 - accuracy: 0.9997
303/469 [==================&gt;...........] - ETA: 4s - loss: 6.8376e-04 - accuracy: 0.9997
305/469 [==================&gt;...........] - ETA: 4s - loss: 6.8426e-04 - accuracy: 0.9997
307/469 [==================&gt;...........] - ETA: 4s - loss: 6.8309e-04 - accuracy: 0.9997
309/469 [==================&gt;...........] - ETA: 4s - loss: 6.9175e-04 - accuracy: 0.9996
311/469 [==================&gt;...........] - ETA: 3s - loss: 6.9147e-04 - accuracy: 0.9996
313/469 [===================&gt;..........] - ETA: 3s - loss: 6.8844e-04 - accuracy: 0.9997
315/469 [===================&gt;..........] - ETA: 3s - loss: 6.8465e-04 - accuracy: 0.9997
317/469 [===================&gt;..........] - ETA: 3s - loss: 6.9224e-04 - accuracy: 0.9996
319/469 [===================&gt;..........] - ETA: 3s - loss: 6.8933e-04 - accuracy: 0.9996
322/469 [===================&gt;..........] - ETA: 3s - loss: 6.9638e-04 - accuracy: 0.9996
324/469 [===================&gt;..........] - ETA: 3s - loss: 6.9427e-04 - accuracy: 0.9996
326/469 [===================&gt;..........] - ETA: 3s - loss: 6.9166e-04 - accuracy: 0.9996
328/469 [===================&gt;..........] - ETA: 3s - loss: 6.8984e-04 - accuracy: 0.9996
330/469 [====================&gt;.........] - ETA: 3s - loss: 6.8619e-04 - accuracy: 0.9996
332/469 [====================&gt;.........] - ETA: 3s - loss: 6.8353e-04 - accuracy: 0.9996
335/469 [====================&gt;.........] - ETA: 3s - loss: 6.8273e-04 - accuracy: 0.9997
337/469 [====================&gt;.........] - ETA: 3s - loss: 6.8589e-04 - accuracy: 0.9997
339/469 [====================&gt;.........] - ETA: 3s - loss: 6.9370e-04 - accuracy: 0.9996
341/469 [====================&gt;.........] - ETA: 3s - loss: 6.9315e-04 - accuracy: 0.9996
343/469 [====================&gt;.........] - ETA: 3s - loss: 6.8950e-04 - accuracy: 0.9996
345/469 [=====================&gt;........] - ETA: 3s - loss: 6.8896e-04 - accuracy: 0.9996
347/469 [=====================&gt;........] - ETA: 3s - loss: 6.8641e-04 - accuracy: 0.9996
350/469 [=====================&gt;........] - ETA: 2s - loss: 7.0033e-04 - accuracy: 0.9996
352/469 [=====================&gt;........] - ETA: 2s - loss: 6.9792e-04 - accuracy: 0.9996
355/469 [=====================&gt;........] - ETA: 2s - loss: 7.0232e-04 - accuracy: 0.9996
357/469 [=====================&gt;........] - ETA: 2s - loss: 7.0147e-04 - accuracy: 0.9996
359/469 [=====================&gt;........] - ETA: 2s - loss: 7.0326e-04 - accuracy: 0.9996
362/469 [======================&gt;.......] - ETA: 2s - loss: 7.0316e-04 - accuracy: 0.9996
364/469 [======================&gt;.......] - ETA: 2s - loss: 7.0645e-04 - accuracy: 0.9996
366/469 [======================&gt;.......] - ETA: 2s - loss: 7.0734e-04 - accuracy: 0.9996
368/469 [======================&gt;.......] - ETA: 2s - loss: 7.0758e-04 - accuracy: 0.9996
370/469 [======================&gt;.......] - ETA: 2s - loss: 7.0578e-04 - accuracy: 0.9996
372/469 [======================&gt;.......] - ETA: 2s - loss: 7.0364e-04 - accuracy: 0.9996
374/469 [======================&gt;.......] - ETA: 2s - loss: 7.0410e-04 - accuracy: 0.9996
376/469 [=======================&gt;......] - ETA: 2s - loss: 7.0510e-04 - accuracy: 0.9996
378/469 [=======================&gt;......] - ETA: 2s - loss: 7.0278e-04 - accuracy: 0.9996
380/469 [=======================&gt;......] - ETA: 2s - loss: 7.0142e-04 - accuracy: 0.9997
382/469 [=======================&gt;......] - ETA: 2s - loss: 6.9899e-04 - accuracy: 0.9997
384/469 [=======================&gt;......] - ETA: 2s - loss: 7.0055e-04 - accuracy: 0.9997
386/469 [=======================&gt;......] - ETA: 2s - loss: 6.9930e-04 - accuracy: 0.9997
388/469 [=======================&gt;......] - ETA: 2s - loss: 6.9625e-04 - accuracy: 0.9997
390/469 [=======================&gt;......] - ETA: 1s - loss: 7.0557e-04 - accuracy: 0.9996
392/469 [========================&gt;.....] - ETA: 1s - loss: 7.0330e-04 - accuracy: 0.9996
395/469 [========================&gt;.....] - ETA: 1s - loss: 7.0179e-04 - accuracy: 0.9996
398/469 [========================&gt;.....] - ETA: 1s - loss: 7.0002e-04 - accuracy: 0.9996
400/469 [========================&gt;.....] - ETA: 1s - loss: 6.9881e-04 - accuracy: 0.9996
402/469 [========================&gt;.....] - ETA: 1s - loss: 7.0385e-04 - accuracy: 0.9997
404/469 [========================&gt;.....] - ETA: 1s - loss: 7.0359e-04 - accuracy: 0.9997
406/469 [========================&gt;.....] - ETA: 1s - loss: 7.0172e-04 - accuracy: 0.9997
408/469 [=========================&gt;....] - ETA: 1s - loss: 7.0057e-04 - accuracy: 0.9997
411/469 [=========================&gt;....] - ETA: 1s - loss: 6.9769e-04 - accuracy: 0.9997
413/469 [=========================&gt;....] - ETA: 1s - loss: 6.9687e-04 - accuracy: 0.9997
416/469 [=========================&gt;....] - ETA: 1s - loss: 6.9626e-04 - accuracy: 0.9997
418/469 [=========================&gt;....] - ETA: 1s - loss: 7.0003e-04 - accuracy: 0.9997
420/469 [=========================&gt;....] - ETA: 1s - loss: 6.9887e-04 - accuracy: 0.9997
422/469 [=========================&gt;....] - ETA: 1s - loss: 6.9721e-04 - accuracy: 0.9997
424/469 [==========================&gt;...] - ETA: 1s - loss: 6.9436e-04 - accuracy: 0.9997
426/469 [==========================&gt;...] - ETA: 1s - loss: 6.9331e-04 - accuracy: 0.9997
428/469 [==========================&gt;...] - ETA: 1s - loss: 6.9113e-04 - accuracy: 0.9997
430/469 [==========================&gt;...] - ETA: 0s - loss: 6.8941e-04 - accuracy: 0.9997
432/469 [==========================&gt;...] - ETA: 0s - loss: 6.8969e-04 - accuracy: 0.9997
434/469 [==========================&gt;...] - ETA: 0s - loss: 6.8820e-04 - accuracy: 0.9997
436/469 [==========================&gt;...] - ETA: 0s - loss: 6.9209e-04 - accuracy: 0.9997
438/469 [===========================&gt;..] - ETA: 0s - loss: 6.9021e-04 - accuracy: 0.9997
440/469 [===========================&gt;..] - ETA: 0s - loss: 6.8839e-04 - accuracy: 0.9997
442/469 [===========================&gt;..] - ETA: 0s - loss: 6.8744e-04 - accuracy: 0.9997
444/469 [===========================&gt;..] - ETA: 0s - loss: 6.8566e-04 - accuracy: 0.9997
447/469 [===========================&gt;..] - ETA: 0s - loss: 6.8597e-04 - accuracy: 0.9997
449/469 [===========================&gt;..] - ETA: 0s - loss: 6.8368e-04 - accuracy: 0.9997
451/469 [===========================&gt;..] - ETA: 0s - loss: 6.8394e-04 - accuracy: 0.9997
453/469 [===========================&gt;..] - ETA: 0s - loss: 6.8097e-04 - accuracy: 0.9997
455/469 [============================&gt;.] - ETA: 0s - loss: 6.7867e-04 - accuracy: 0.9997
457/469 [============================&gt;.] - ETA: 0s - loss: 6.7899e-04 - accuracy: 0.9997
459/469 [============================&gt;.] - ETA: 0s - loss: 6.7853e-04 - accuracy: 0.9997
461/469 [============================&gt;.] - ETA: 0s - loss: 6.7630e-04 - accuracy: 0.9997
463/469 [============================&gt;.] - ETA: 0s - loss: 6.7751e-04 - accuracy: 0.9997
465/469 [============================&gt;.] - ETA: 0s - loss: 6.7686e-04 - accuracy: 0.9997
467/469 [============================&gt;.] - ETA: 0s - loss: 6.7534e-04 - accuracy: 0.9997
469/469 [==============================] - 12s 26ms/step - loss: 6.7641e-04 - accuracy: 0.9997 - val_loss: 0.0049 - val_accuracy: 0.9942 - lr: 1.5849e-04
Test score: 0.004884888418018818
Test accuracy: 0.9941999912261963
</pre></div>
</div>
</div>
</div>
<div class="section" id="model-akida-compatibility-check-and-changes">
<h2>3. Model Akida-compatibility check and changes<a class="headerlink" href="#model-akida-compatibility-check-and-changes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="compatibility-check">
<h3>3.1 Compatibility check<a class="headerlink" href="#compatibility-check" title="Permalink to this headline">¶</a></h3>
<p>The first step is to ensure that the model as defined doesn’t include
any layers or operations that aren’t Akida-compatible (please refer to
the <a class="reference external" href="../user_guide/cnn2snn.html">CNN2SNN toolkit</a> documentation for full
details):</p>
<ul class="simple">
<li><p>Standard Conv2D and Dense layers are supported (note that
there is currently no support for skip, recursive and parallel layers).</p></li>
<li><p>Each of these trainable core layers except for the last one must be followed
by an Activation layer.</p></li>
<li><p>All blocks can optionally include a BatchNormalization layer.</p></li>
<li><p>Convolutional blocks can optionally include a MaxPooling type layer.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This configuration of layers (Conv/Dense + BatchNormalization +
Activation) constitutes the basic building block of
Akida-compatible models and is widely used in deep learning.</p>
</div>
<p>If the model defined is not fully compatible with the Akida NSoC,
substitutes will be needed for the relevant layers/operations
(guidelines included in the documentation).</p>
</div>
<div class="section" id="model-adaptation">
<h3>3.2 Model adaptation<a class="headerlink" href="#model-adaptation" title="Permalink to this headline">¶</a></h3>
<p>As noted above, the basic building blocks of Akida compatible models
actually comprise a trio of layers: Conv/Dense + BatchNormalization +
Activation (with, optionally, pooling). The CNN2SNN tool provides a set
of functions that simplify using these building blocks, and subsequently
enable easy application of Brainchip’s custom quantization functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models.quantization_blocks</span> <span class="kn">import</span> <span class="n">conv_block</span><span class="p">,</span> <span class="n">dense_block</span>
</pre></div>
</div>
<p>The following code illustrates how to express the MNIST model defined
above using the functions provided by Brainchip. A couple of points to
avoid confusion when you look through it:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">weight_quantization</span></code> in each block isn’t used here, but will be used
later to apply a quantization method to the model weights.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">block_id</span></code> is just used for naming the layers, and will be good
practice in enabling reloading of partially trained models in more advanced
training cases.</p></li>
<li><p>Note that in the final block, we set the nonlinearity
<code class="docutils literal notranslate"><span class="pre">activ_quantization</span></code> to <code class="docutils literal notranslate"><span class="pre">None</span></code>. In that case, the block has no
Activation layer, and the output is simply the output from the
BatchNormalization layer.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Removes all the nodes left over from the previous model and free memory</span>
<span class="n">K</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>

<span class="c1"># Define the model.</span>
<span class="c1"># The commented code shows the sets of layers in the original definition</span>
<span class="c1"># that are being replaced by the provided conv_block and dense_blocks here</span>

<span class="n">img_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># x = Conv2D(filters=32,</span>
<span class="c1">#            kernel_size=(5, 5),</span>
<span class="c1">#            padding=&#39;same&#39;,</span>
<span class="c1">#            use_bias=False,</span>
<span class="c1">#            data_format=&#39;channels_last&#39;)(img_input)</span>
<span class="c1"># x = MaxPooling2D(pool_size=(2, 2), strides=(2, 2), padding=&#39;same&#39;)(x)</span>
<span class="c1"># x = BatchNormalization()(x)</span>
<span class="c1"># x = ReLU(6.)(x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span>
               <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
               <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
               <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
               <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv_0&#39;</span><span class="p">,</span>
               <span class="n">pooling</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
               <span class="n">add_batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># x = Conv2D(filters=32,</span>
<span class="c1">#            kernel_size=(5, 5),</span>
<span class="c1">#            padding=&#39;same&#39;,</span>
<span class="c1">#            use_bias=False)(x)</span>
<span class="c1"># x = MaxPooling2D(pool_size=(2, 2), strides=(2, 2), padding=&#39;same&#39;)(x)</span>
<span class="c1"># x = BatchNormalization()(x)</span>
<span class="c1"># x = ReLU(6.)(x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
               <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
               <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
               <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
               <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv_1&#39;</span><span class="p">,</span>
               <span class="n">pooling</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
               <span class="n">add_batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># x = Conv2D(filters=32,</span>
<span class="c1">#            kernel_size=(5, 5),</span>
<span class="c1">#            padding=&#39;same&#39;,</span>
<span class="c1">#            use_bias=False)(x)</span>
<span class="c1"># x = BatchNormalization()(x)</span>
<span class="c1"># x = ReLU(6.)(x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
               <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
               <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
               <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
               <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv_2&#39;</span><span class="p">,</span>
               <span class="n">add_batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># x = Dense(512,</span>
<span class="c1">#           use_bias=False)(x)</span>
<span class="c1"># x = BatchNormalization()(x)</span>
<span class="c1"># x = ReLU(6.)(x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">dense_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                <span class="n">units</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dense_2&#39;</span><span class="p">,</span>
                <span class="n">add_batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># x = Dense(10,</span>
<span class="c1">#           use_bias=False)(x)</span>
<span class="c1"># x = BatchNormalization()(x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">dense_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                <span class="n">units</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dense_3&#39;</span><span class="p">,</span>
                <span class="n">activ_quantization</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">model_keras</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mnistnet&#39;</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="n">lr_start</span><span class="p">)</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Model: &quot;mnistnet&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         [(None, 28, 28, 1)]       0
_________________________________________________________________
conv_0 (QuantizedConv2D)     (None, 28, 28, 32)        800
_________________________________________________________________
conv_0_maxpool (MaxPooling2D (None, 14, 14, 32)        0
_________________________________________________________________
conv_0_BN (BatchNormalizatio (None, 14, 14, 32)        128
_________________________________________________________________
conv_0_relu (ReLU)           (None, 14, 14, 32)        0
_________________________________________________________________
conv_1 (QuantizedConv2D)     (None, 14, 14, 32)        25600
_________________________________________________________________
conv_1_maxpool (MaxPooling2D (None, 7, 7, 32)          0
_________________________________________________________________
conv_1_BN (BatchNormalizatio (None, 7, 7, 32)          128
_________________________________________________________________
conv_1_relu (ReLU)           (None, 7, 7, 32)          0
_________________________________________________________________
conv_2 (QuantizedConv2D)     (None, 7, 7, 32)          25600
_________________________________________________________________
conv_2_BN (BatchNormalizatio (None, 7, 7, 32)          128
_________________________________________________________________
conv_2_relu (ReLU)           (None, 7, 7, 32)          0
_________________________________________________________________
flatten (Flatten)            (None, 1568)              0
_________________________________________________________________
dense_2 (QuantizedDense)     (None, 512)               802816
_________________________________________________________________
dense_2_BN (BatchNormalizati (None, 512)               2048
_________________________________________________________________
dense_2_relu (ReLU)          (None, 512)               0
_________________________________________________________________
dense_3 (QuantizedDense)     (None, 10)                5120
=================================================================
Total params: 862,368
Trainable params: 861,152
Non-trainable params: 1,216
_________________________________________________________________
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3>3.3 Performance check<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Check modifed model performance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lr_scheduler</span> <span class="o">=</span> <span class="n">LearningRateScheduler</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">lr_start</span> <span class="o">*</span> <span class="n">lr_decay</span><span class="o">**</span><span class="n">e</span><span class="p">)</span>
<span class="n">callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lr_scheduler</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span>
                          <span class="n">y_train</span><span class="p">,</span>
                          <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                          <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span>
                          <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test score:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Epoch 1/5

  1/469 [..............................] - ETA: 0s - loss: 2.1258 - accuracy: 0.0938
  3/469 [..............................] - ETA: 7s - loss: 1.4931 - accuracy: 0.4297
  6/469 [..............................] - ETA: 9s - loss: 0.9817 - accuracy: 0.6302
  8/469 [..............................] - ETA: 10s - loss: 0.7899 - accuracy: 0.6797
 11/469 [..............................] - ETA: 10s - loss: 0.6072 - accuracy: 0.7344
 13/469 [..............................] - ETA: 10s - loss: 0.5305 - accuracy: 0.7566
 15/469 [..............................] - ETA: 10s - loss: 0.4735 - accuracy: 0.7740
 18/469 [&gt;.............................] - ETA: 10s - loss: 0.4046 - accuracy: 0.8012
 20/469 [&gt;.............................] - ETA: 10s - loss: 0.3720 - accuracy: 0.8145
 22/469 [&gt;.............................] - ETA: 10s - loss: 0.3450 - accuracy: 0.8232
 25/469 [&gt;.............................] - ETA: 10s - loss: 0.3087 - accuracy: 0.8384
 27/469 [&gt;.............................] - ETA: 10s - loss: 0.2894 - accuracy: 0.8466
 29/469 [&gt;.............................] - ETA: 10s - loss: 0.2729 - accuracy: 0.8534
 31/469 [&gt;.............................] - ETA: 10s - loss: 0.2571 - accuracy: 0.8606
 33/469 [=&gt;............................] - ETA: 10s - loss: 0.2442 - accuracy: 0.8655
 35/469 [=&gt;............................] - ETA: 10s - loss: 0.2333 - accuracy: 0.8703
 37/469 [=&gt;............................] - ETA: 10s - loss: 0.2225 - accuracy: 0.8756
 39/469 [=&gt;............................] - ETA: 10s - loss: 0.2131 - accuracy: 0.8802
 41/469 [=&gt;............................] - ETA: 10s - loss: 0.2043 - accuracy: 0.8838
 43/469 [=&gt;............................] - ETA: 10s - loss: 0.1961 - accuracy: 0.8875
 45/469 [=&gt;............................] - ETA: 10s - loss: 0.1893 - accuracy: 0.8901
 47/469 [==&gt;...........................] - ETA: 10s - loss: 0.1833 - accuracy: 0.8931
 49/469 [==&gt;...........................] - ETA: 10s - loss: 0.1769 - accuracy: 0.8962
 51/469 [==&gt;...........................] - ETA: 10s - loss: 0.1711 - accuracy: 0.8987
 53/469 [==&gt;...........................] - ETA: 10s - loss: 0.1658 - accuracy: 0.9014
 55/469 [==&gt;...........................] - ETA: 10s - loss: 0.1607 - accuracy: 0.9040
 57/469 [==&gt;...........................] - ETA: 10s - loss: 0.1559 - accuracy: 0.9064
 59/469 [==&gt;...........................] - ETA: 10s - loss: 0.1518 - accuracy: 0.9076
 62/469 [==&gt;...........................] - ETA: 10s - loss: 0.1464 - accuracy: 0.9099
 65/469 [===&gt;..........................] - ETA: 10s - loss: 0.1411 - accuracy: 0.9130
 68/469 [===&gt;..........................] - ETA: 9s - loss: 0.1359 - accuracy: 0.9156 
 71/469 [===&gt;..........................] - ETA: 9s - loss: 0.1312 - accuracy: 0.9182
 73/469 [===&gt;..........................] - ETA: 9s - loss: 0.1282 - accuracy: 0.9196
 75/469 [===&gt;..........................] - ETA: 9s - loss: 0.1254 - accuracy: 0.9211
 77/469 [===&gt;..........................] - ETA: 9s - loss: 0.1230 - accuracy: 0.9222
 79/469 [====&gt;.........................] - ETA: 9s - loss: 0.1205 - accuracy: 0.9236
 81/469 [====&gt;.........................] - ETA: 9s - loss: 0.1181 - accuracy: 0.9248
 83/469 [====&gt;.........................] - ETA: 9s - loss: 0.1161 - accuracy: 0.9257
 85/469 [====&gt;.........................] - ETA: 9s - loss: 0.1139 - accuracy: 0.9267
 87/469 [====&gt;.........................] - ETA: 9s - loss: 0.1120 - accuracy: 0.9275
 89/469 [====&gt;.........................] - ETA: 9s - loss: 0.1101 - accuracy: 0.9285
 92/469 [====&gt;.........................] - ETA: 9s - loss: 0.1075 - accuracy: 0.9296
 94/469 [=====&gt;........................] - ETA: 9s - loss: 0.1057 - accuracy: 0.9304
 96/469 [=====&gt;........................] - ETA: 9s - loss: 0.1038 - accuracy: 0.9317
 98/469 [=====&gt;........................] - ETA: 9s - loss: 0.1023 - accuracy: 0.9324
100/469 [=====&gt;........................] - ETA: 9s - loss: 0.1009 - accuracy: 0.9328
102/469 [=====&gt;........................] - ETA: 9s - loss: 0.0992 - accuracy: 0.9337
104/469 [=====&gt;........................] - ETA: 9s - loss: 0.0979 - accuracy: 0.9345
106/469 [=====&gt;........................] - ETA: 9s - loss: 0.0965 - accuracy: 0.9353
108/469 [=====&gt;........................] - ETA: 9s - loss: 0.0950 - accuracy: 0.9360
110/469 [======&gt;.......................] - ETA: 8s - loss: 0.0937 - accuracy: 0.9366
112/469 [======&gt;.......................] - ETA: 8s - loss: 0.0924 - accuracy: 0.9374
115/469 [======&gt;.......................] - ETA: 8s - loss: 0.0906 - accuracy: 0.9383
117/469 [======&gt;.......................] - ETA: 8s - loss: 0.0893 - accuracy: 0.9390
119/469 [======&gt;.......................] - ETA: 8s - loss: 0.0883 - accuracy: 0.9395
121/469 [======&gt;.......................] - ETA: 8s - loss: 0.0870 - accuracy: 0.9403
123/469 [======&gt;.......................] - ETA: 8s - loss: 0.0859 - accuracy: 0.9410
125/469 [======&gt;.......................] - ETA: 8s - loss: 0.0848 - accuracy: 0.9416
127/469 [=======&gt;......................] - ETA: 8s - loss: 0.0838 - accuracy: 0.9420
129/469 [=======&gt;......................] - ETA: 8s - loss: 0.0832 - accuracy: 0.9423
131/469 [=======&gt;......................] - ETA: 8s - loss: 0.0823 - accuracy: 0.9427
134/469 [=======&gt;......................] - ETA: 8s - loss: 0.0811 - accuracy: 0.9434
136/469 [=======&gt;......................] - ETA: 8s - loss: 0.0803 - accuracy: 0.9437
138/469 [=======&gt;......................] - ETA: 8s - loss: 0.0796 - accuracy: 0.9442
140/469 [=======&gt;......................] - ETA: 8s - loss: 0.0787 - accuracy: 0.9446
142/469 [========&gt;.....................] - ETA: 8s - loss: 0.0778 - accuracy: 0.9452
144/469 [========&gt;.....................] - ETA: 8s - loss: 0.0771 - accuracy: 0.9457
146/469 [========&gt;.....................] - ETA: 8s - loss: 0.0764 - accuracy: 0.9460
148/469 [========&gt;.....................] - ETA: 8s - loss: 0.0756 - accuracy: 0.9463
150/469 [========&gt;.....................] - ETA: 7s - loss: 0.0749 - accuracy: 0.9467
152/469 [========&gt;.....................] - ETA: 7s - loss: 0.0742 - accuracy: 0.9470
155/469 [========&gt;.....................] - ETA: 7s - loss: 0.0731 - accuracy: 0.9477
157/469 [=========&gt;....................] - ETA: 7s - loss: 0.0724 - accuracy: 0.9482
160/469 [=========&gt;....................] - ETA: 7s - loss: 0.0714 - accuracy: 0.9488
162/469 [=========&gt;....................] - ETA: 7s - loss: 0.0707 - accuracy: 0.9492
164/469 [=========&gt;....................] - ETA: 7s - loss: 0.0700 - accuracy: 0.9497
166/469 [=========&gt;....................] - ETA: 7s - loss: 0.0694 - accuracy: 0.9500
168/469 [=========&gt;....................] - ETA: 7s - loss: 0.0687 - accuracy: 0.9505
170/469 [=========&gt;....................] - ETA: 7s - loss: 0.0681 - accuracy: 0.9510
172/469 [==========&gt;...................] - ETA: 7s - loss: 0.0676 - accuracy: 0.9512
174/469 [==========&gt;...................] - ETA: 7s - loss: 0.0670 - accuracy: 0.9516
177/469 [==========&gt;...................] - ETA: 7s - loss: 0.0661 - accuracy: 0.9522
179/469 [==========&gt;...................] - ETA: 7s - loss: 0.0655 - accuracy: 0.9526
181/469 [==========&gt;...................] - ETA: 7s - loss: 0.0649 - accuracy: 0.9529
184/469 [==========&gt;...................] - ETA: 7s - loss: 0.0642 - accuracy: 0.9533
186/469 [==========&gt;...................] - ETA: 7s - loss: 0.0637 - accuracy: 0.9536
188/469 [===========&gt;..................] - ETA: 7s - loss: 0.0632 - accuracy: 0.9539
190/469 [===========&gt;..................] - ETA: 7s - loss: 0.0627 - accuracy: 0.9543
192/469 [===========&gt;..................] - ETA: 6s - loss: 0.0622 - accuracy: 0.9544
194/469 [===========&gt;..................] - ETA: 6s - loss: 0.0617 - accuracy: 0.9547
196/469 [===========&gt;..................] - ETA: 6s - loss: 0.0612 - accuracy: 0.9550
198/469 [===========&gt;..................] - ETA: 6s - loss: 0.0607 - accuracy: 0.9554
200/469 [===========&gt;..................] - ETA: 6s - loss: 0.0602 - accuracy: 0.9557
202/469 [===========&gt;..................] - ETA: 6s - loss: 0.0598 - accuracy: 0.9560
204/469 [============&gt;.................] - ETA: 6s - loss: 0.0595 - accuracy: 0.9560
206/469 [============&gt;.................] - ETA: 6s - loss: 0.0591 - accuracy: 0.9562
208/469 [============&gt;.................] - ETA: 6s - loss: 0.0587 - accuracy: 0.9564
211/469 [============&gt;.................] - ETA: 6s - loss: 0.0581 - accuracy: 0.9568
213/469 [============&gt;.................] - ETA: 6s - loss: 0.0577 - accuracy: 0.9569
215/469 [============&gt;.................] - ETA: 6s - loss: 0.0574 - accuracy: 0.9572
218/469 [============&gt;.................] - ETA: 6s - loss: 0.0568 - accuracy: 0.9575
220/469 [=============&gt;................] - ETA: 6s - loss: 0.0564 - accuracy: 0.9578
222/469 [=============&gt;................] - ETA: 6s - loss: 0.0560 - accuracy: 0.9581
225/469 [=============&gt;................] - ETA: 6s - loss: 0.0554 - accuracy: 0.9584
227/469 [=============&gt;................] - ETA: 6s - loss: 0.0551 - accuracy: 0.9586
229/469 [=============&gt;................] - ETA: 6s - loss: 0.0547 - accuracy: 0.9589
231/469 [=============&gt;................] - ETA: 5s - loss: 0.0543 - accuracy: 0.9591
233/469 [=============&gt;................] - ETA: 5s - loss: 0.0541 - accuracy: 0.9593
235/469 [==============&gt;...............] - ETA: 5s - loss: 0.0537 - accuracy: 0.9595
237/469 [==============&gt;...............] - ETA: 5s - loss: 0.0534 - accuracy: 0.9597
239/469 [==============&gt;...............] - ETA: 5s - loss: 0.0532 - accuracy: 0.9597
241/469 [==============&gt;...............] - ETA: 5s - loss: 0.0528 - accuracy: 0.9599
243/469 [==============&gt;...............] - ETA: 5s - loss: 0.0525 - accuracy: 0.9601
245/469 [==============&gt;...............] - ETA: 5s - loss: 0.0523 - accuracy: 0.9602
247/469 [==============&gt;...............] - ETA: 5s - loss: 0.0519 - accuracy: 0.9605
249/469 [==============&gt;...............] - ETA: 5s - loss: 0.0516 - accuracy: 0.9607
251/469 [===============&gt;..............] - ETA: 5s - loss: 0.0513 - accuracy: 0.9610
253/469 [===============&gt;..............] - ETA: 5s - loss: 0.0510 - accuracy: 0.9612
255/469 [===============&gt;..............] - ETA: 5s - loss: 0.0508 - accuracy: 0.9612
258/469 [===============&gt;..............] - ETA: 5s - loss: 0.0504 - accuracy: 0.9614
260/469 [===============&gt;..............] - ETA: 5s - loss: 0.0502 - accuracy: 0.9616
262/469 [===============&gt;..............] - ETA: 5s - loss: 0.0500 - accuracy: 0.9617
264/469 [===============&gt;..............] - ETA: 5s - loss: 0.0498 - accuracy: 0.9619
266/469 [================&gt;.............] - ETA: 5s - loss: 0.0495 - accuracy: 0.9621
268/469 [================&gt;.............] - ETA: 5s - loss: 0.0493 - accuracy: 0.9622
270/469 [================&gt;.............] - ETA: 5s - loss: 0.0491 - accuracy: 0.9622
273/469 [================&gt;.............] - ETA: 4s - loss: 0.0488 - accuracy: 0.9624
275/469 [================&gt;.............] - ETA: 4s - loss: 0.0486 - accuracy: 0.9626
277/469 [================&gt;.............] - ETA: 4s - loss: 0.0483 - accuracy: 0.9628
279/469 [================&gt;.............] - ETA: 4s - loss: 0.0481 - accuracy: 0.9630
281/469 [================&gt;.............] - ETA: 4s - loss: 0.0478 - accuracy: 0.9631
283/469 [=================&gt;............] - ETA: 4s - loss: 0.0477 - accuracy: 0.9632
285/469 [=================&gt;............] - ETA: 4s - loss: 0.0474 - accuracy: 0.9633
287/469 [=================&gt;............] - ETA: 4s - loss: 0.0472 - accuracy: 0.9634
289/469 [=================&gt;............] - ETA: 4s - loss: 0.0469 - accuracy: 0.9636
291/469 [=================&gt;............] - ETA: 4s - loss: 0.0467 - accuracy: 0.9638
293/469 [=================&gt;............] - ETA: 4s - loss: 0.0465 - accuracy: 0.9639
296/469 [=================&gt;............] - ETA: 4s - loss: 0.0461 - accuracy: 0.9641
299/469 [==================&gt;...........] - ETA: 4s - loss: 0.0458 - accuracy: 0.9643
301/469 [==================&gt;...........] - ETA: 4s - loss: 0.0456 - accuracy: 0.9644
303/469 [==================&gt;...........] - ETA: 4s - loss: 0.0454 - accuracy: 0.9645
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0451 - accuracy: 0.9647
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0449 - accuracy: 0.9648
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0447 - accuracy: 0.9649
311/469 [==================&gt;...........] - ETA: 3s - loss: 0.0444 - accuracy: 0.9651
313/469 [===================&gt;..........] - ETA: 3s - loss: 0.0443 - accuracy: 0.9653
315/469 [===================&gt;..........] - ETA: 3s - loss: 0.0440 - accuracy: 0.9654
318/469 [===================&gt;..........] - ETA: 3s - loss: 0.0439 - accuracy: 0.9655
320/469 [===================&gt;..........] - ETA: 3s - loss: 0.0437 - accuracy: 0.9657
322/469 [===================&gt;..........] - ETA: 3s - loss: 0.0435 - accuracy: 0.9658
324/469 [===================&gt;..........] - ETA: 3s - loss: 0.0433 - accuracy: 0.9659
326/469 [===================&gt;..........] - ETA: 3s - loss: 0.0432 - accuracy: 0.9661
328/469 [===================&gt;..........] - ETA: 3s - loss: 0.0430 - accuracy: 0.9662
330/469 [====================&gt;.........] - ETA: 3s - loss: 0.0428 - accuracy: 0.9664
332/469 [====================&gt;.........] - ETA: 3s - loss: 0.0426 - accuracy: 0.9665
334/469 [====================&gt;.........] - ETA: 3s - loss: 0.0425 - accuracy: 0.9666
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0423 - accuracy: 0.9667
339/469 [====================&gt;.........] - ETA: 3s - loss: 0.0421 - accuracy: 0.9669
342/469 [====================&gt;.........] - ETA: 3s - loss: 0.0418 - accuracy: 0.9671
344/469 [=====================&gt;........] - ETA: 3s - loss: 0.0416 - accuracy: 0.9671
346/469 [=====================&gt;........] - ETA: 3s - loss: 0.0415 - accuracy: 0.9672
348/469 [=====================&gt;........] - ETA: 3s - loss: 0.0413 - accuracy: 0.9674
350/469 [=====================&gt;........] - ETA: 3s - loss: 0.0411 - accuracy: 0.9675
352/469 [=====================&gt;........] - ETA: 2s - loss: 0.0409 - accuracy: 0.9676
354/469 [=====================&gt;........] - ETA: 2s - loss: 0.0408 - accuracy: 0.9677
357/469 [=====================&gt;........] - ETA: 2s - loss: 0.0405 - accuracy: 0.9678
359/469 [=====================&gt;........] - ETA: 2s - loss: 0.0405 - accuracy: 0.9679
361/469 [======================&gt;.......] - ETA: 2s - loss: 0.0403 - accuracy: 0.9679
363/469 [======================&gt;.......] - ETA: 2s - loss: 0.0402 - accuracy: 0.9680
365/469 [======================&gt;.......] - ETA: 2s - loss: 0.0400 - accuracy: 0.9681
367/469 [======================&gt;.......] - ETA: 2s - loss: 0.0399 - accuracy: 0.9681
370/469 [======================&gt;.......] - ETA: 2s - loss: 0.0398 - accuracy: 0.9682
372/469 [======================&gt;.......] - ETA: 2s - loss: 0.0396 - accuracy: 0.9683
374/469 [======================&gt;.......] - ETA: 2s - loss: 0.0395 - accuracy: 0.9684
376/469 [=======================&gt;......] - ETA: 2s - loss: 0.0393 - accuracy: 0.9686
378/469 [=======================&gt;......] - ETA: 2s - loss: 0.0391 - accuracy: 0.9687
380/469 [=======================&gt;......] - ETA: 2s - loss: 0.0390 - accuracy: 0.9688
382/469 [=======================&gt;......] - ETA: 2s - loss: 0.0389 - accuracy: 0.9688
384/469 [=======================&gt;......] - ETA: 2s - loss: 0.0388 - accuracy: 0.9690
386/469 [=======================&gt;......] - ETA: 2s - loss: 0.0387 - accuracy: 0.9690
388/469 [=======================&gt;......] - ETA: 2s - loss: 0.0385 - accuracy: 0.9691
390/469 [=======================&gt;......] - ETA: 1s - loss: 0.0384 - accuracy: 0.9692
392/469 [========================&gt;.....] - ETA: 1s - loss: 0.0382 - accuracy: 0.9693
394/469 [========================&gt;.....] - ETA: 1s - loss: 0.0381 - accuracy: 0.9694
396/469 [========================&gt;.....] - ETA: 1s - loss: 0.0380 - accuracy: 0.9695
398/469 [========================&gt;.....] - ETA: 1s - loss: 0.0378 - accuracy: 0.9696
401/469 [========================&gt;.....] - ETA: 1s - loss: 0.0377 - accuracy: 0.9696
403/469 [========================&gt;.....] - ETA: 1s - loss: 0.0376 - accuracy: 0.9697
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0374 - accuracy: 0.9698
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0373 - accuracy: 0.9699
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0372 - accuracy: 0.9700
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0371 - accuracy: 0.9700
414/469 [=========================&gt;....] - ETA: 1s - loss: 0.0369 - accuracy: 0.9702
416/469 [=========================&gt;....] - ETA: 1s - loss: 0.0368 - accuracy: 0.9702
418/469 [=========================&gt;....] - ETA: 1s - loss: 0.0366 - accuracy: 0.9703
420/469 [=========================&gt;....] - ETA: 1s - loss: 0.0366 - accuracy: 0.9704
422/469 [=========================&gt;....] - ETA: 1s - loss: 0.0364 - accuracy: 0.9705
424/469 [==========================&gt;...] - ETA: 1s - loss: 0.0363 - accuracy: 0.9706
426/469 [==========================&gt;...] - ETA: 1s - loss: 0.0362 - accuracy: 0.9707
428/469 [==========================&gt;...] - ETA: 1s - loss: 0.0361 - accuracy: 0.9708
430/469 [==========================&gt;...] - ETA: 0s - loss: 0.0360 - accuracy: 0.9708
432/469 [==========================&gt;...] - ETA: 0s - loss: 0.0359 - accuracy: 0.9709
434/469 [==========================&gt;...] - ETA: 0s - loss: 0.0358 - accuracy: 0.9709
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0357 - accuracy: 0.9710
439/469 [===========================&gt;..] - ETA: 0s - loss: 0.0356 - accuracy: 0.9710
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0355 - accuracy: 0.9711
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0354 - accuracy: 0.9712
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0353 - accuracy: 0.9712
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0352 - accuracy: 0.9713
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0351 - accuracy: 0.9714
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0350 - accuracy: 0.9715
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0349 - accuracy: 0.9716
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0348 - accuracy: 0.9717
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0347 - accuracy: 0.9717
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0346 - accuracy: 0.9716
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0346 - accuracy: 0.9717
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0344 - accuracy: 0.9718
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0343 - accuracy: 0.9719
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0342 - accuracy: 0.9720
469/469 [==============================] - 12s 26ms/step - loss: 0.0341 - accuracy: 0.9721 - val_loss: 0.0495 - val_accuracy: 0.9403 - lr: 0.0010
Epoch 2/5

  1/469 [..............................] - ETA: 0s - loss: 0.0087 - accuracy: 0.9922
  3/469 [..............................] - ETA: 7s - loss: 0.0084 - accuracy: 0.9922
  6/469 [..............................] - ETA: 9s - loss: 0.0091 - accuracy: 0.9922
  8/469 [..............................] - ETA: 10s - loss: 0.0088 - accuracy: 0.9912
 10/469 [..............................] - ETA: 10s - loss: 0.0080 - accuracy: 0.9922
 12/469 [..............................] - ETA: 10s - loss: 0.0080 - accuracy: 0.9915
 14/469 [..............................] - ETA: 10s - loss: 0.0075 - accuracy: 0.9916
 16/469 [&gt;.............................] - ETA: 10s - loss: 0.0070 - accuracy: 0.9922
 19/469 [&gt;.............................] - ETA: 10s - loss: 0.0074 - accuracy: 0.9914
 21/469 [&gt;.............................] - ETA: 10s - loss: 0.0077 - accuracy: 0.9911
 23/469 [&gt;.............................] - ETA: 10s - loss: 0.0080 - accuracy: 0.9908
 25/469 [&gt;.............................] - ETA: 10s - loss: 0.0077 - accuracy: 0.9916
 27/469 [&gt;.............................] - ETA: 10s - loss: 0.0075 - accuracy: 0.9916
 30/469 [&gt;.............................] - ETA: 10s - loss: 0.0070 - accuracy: 0.9922
 32/469 [=&gt;............................] - ETA: 10s - loss: 0.0068 - accuracy: 0.9922
 34/469 [=&gt;............................] - ETA: 10s - loss: 0.0066 - accuracy: 0.9924
 36/469 [=&gt;............................] - ETA: 10s - loss: 0.0064 - accuracy: 0.9926
 38/469 [=&gt;............................] - ETA: 10s - loss: 0.0063 - accuracy: 0.9926
 40/469 [=&gt;............................] - ETA: 10s - loss: 0.0065 - accuracy: 0.9926
 42/469 [=&gt;............................] - ETA: 10s - loss: 0.0064 - accuracy: 0.9927
 44/469 [=&gt;............................] - ETA: 10s - loss: 0.0063 - accuracy: 0.9929
 47/469 [==&gt;...........................] - ETA: 10s - loss: 0.0064 - accuracy: 0.9930
 50/469 [==&gt;...........................] - ETA: 10s - loss: 0.0065 - accuracy: 0.9927
 52/469 [==&gt;...........................] - ETA: 10s - loss: 0.0064 - accuracy: 0.9928
 55/469 [==&gt;...........................] - ETA: 10s - loss: 0.0062 - accuracy: 0.9932
 57/469 [==&gt;...........................] - ETA: 10s - loss: 0.0062 - accuracy: 0.9930
 60/469 [==&gt;...........................] - ETA: 10s - loss: 0.0061 - accuracy: 0.9932
 62/469 [==&gt;...........................] - ETA: 10s - loss: 0.0060 - accuracy: 0.9934
 64/469 [===&gt;..........................] - ETA: 10s - loss: 0.0061 - accuracy: 0.9935
 66/469 [===&gt;..........................] - ETA: 10s - loss: 0.0062 - accuracy: 0.9935
 68/469 [===&gt;..........................] - ETA: 9s - loss: 0.0062 - accuracy: 0.9935 
 70/469 [===&gt;..........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9936
 72/469 [===&gt;..........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9937
 74/469 [===&gt;..........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9935
 76/469 [===&gt;..........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9936
 78/469 [===&gt;..........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9937
 81/469 [====&gt;.........................] - ETA: 9s - loss: 0.0065 - accuracy: 0.9936
 84/469 [====&gt;.........................] - ETA: 9s - loss: 0.0064 - accuracy: 0.9937
 86/469 [====&gt;.........................] - ETA: 9s - loss: 0.0063 - accuracy: 0.9938
 88/469 [====&gt;.........................] - ETA: 9s - loss: 0.0062 - accuracy: 0.9940
 90/469 [====&gt;.........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9940
 92/469 [====&gt;.........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9940
 94/469 [=====&gt;........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9939
 96/469 [=====&gt;........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9940
 98/469 [=====&gt;........................] - ETA: 9s - loss: 0.0060 - accuracy: 0.9941
100/469 [=====&gt;........................] - ETA: 9s - loss: 0.0060 - accuracy: 0.9941
102/469 [=====&gt;........................] - ETA: 9s - loss: 0.0059 - accuracy: 0.9942
104/469 [=====&gt;........................] - ETA: 9s - loss: 0.0060 - accuracy: 0.9941
106/469 [=====&gt;........................] - ETA: 9s - loss: 0.0060 - accuracy: 0.9940
108/469 [=====&gt;........................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9940
110/469 [======&gt;.......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9940
112/469 [======&gt;.......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9940
115/469 [======&gt;.......................] - ETA: 8s - loss: 0.0061 - accuracy: 0.9940
117/469 [======&gt;.......................] - ETA: 8s - loss: 0.0061 - accuracy: 0.9940
119/469 [======&gt;.......................] - ETA: 8s - loss: 0.0061 - accuracy: 0.9940
121/469 [======&gt;.......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9941
123/469 [======&gt;.......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9942
125/469 [======&gt;.......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9942
128/469 [=======&gt;......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9943
131/469 [=======&gt;......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9943
133/469 [=======&gt;......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9942
136/469 [=======&gt;......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9943
138/469 [=======&gt;......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9942
140/469 [=======&gt;......................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9943
142/469 [========&gt;.....................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9941
144/469 [========&gt;.....................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9941
146/469 [========&gt;.....................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9941
148/469 [========&gt;.....................] - ETA: 8s - loss: 0.0060 - accuracy: 0.9941
150/469 [========&gt;.....................] - ETA: 8s - loss: 0.0059 - accuracy: 0.9942
152/469 [========&gt;.....................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9942
154/469 [========&gt;.....................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9942
156/469 [========&gt;.....................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9942
158/469 [=========&gt;....................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9943
160/469 [=========&gt;....................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9942
162/469 [=========&gt;....................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9942
164/469 [=========&gt;....................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9943
167/469 [=========&gt;....................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9942
170/469 [=========&gt;....................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9943
172/469 [==========&gt;...................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9943
174/469 [==========&gt;...................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9943
177/469 [==========&gt;...................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9943
179/469 [==========&gt;...................] - ETA: 7s - loss: 0.0057 - accuracy: 0.9944
181/469 [==========&gt;...................] - ETA: 7s - loss: 0.0057 - accuracy: 0.9944
183/469 [==========&gt;...................] - ETA: 7s - loss: 0.0057 - accuracy: 0.9944
186/469 [==========&gt;...................] - ETA: 7s - loss: 0.0057 - accuracy: 0.9944
188/469 [===========&gt;..................] - ETA: 7s - loss: 0.0057 - accuracy: 0.9944
190/469 [===========&gt;..................] - ETA: 7s - loss: 0.0057 - accuracy: 0.9944
192/469 [===========&gt;..................] - ETA: 6s - loss: 0.0058 - accuracy: 0.9944
195/469 [===========&gt;..................] - ETA: 6s - loss: 0.0058 - accuracy: 0.9943
197/469 [===========&gt;..................] - ETA: 6s - loss: 0.0058 - accuracy: 0.9942
199/469 [===========&gt;..................] - ETA: 6s - loss: 0.0058 - accuracy: 0.9942
201/469 [===========&gt;..................] - ETA: 6s - loss: 0.0058 - accuracy: 0.9941
204/469 [============&gt;.................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
206/469 [============&gt;.................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
208/469 [============&gt;.................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9941
210/469 [============&gt;.................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
212/469 [============&gt;.................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9943
214/469 [============&gt;.................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
216/469 [============&gt;.................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
218/469 [============&gt;.................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9943
220/469 [=============&gt;................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
222/469 [=============&gt;................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9943
224/469 [=============&gt;................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
227/469 [=============&gt;................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
229/469 [=============&gt;................] - ETA: 6s - loss: 0.0057 - accuracy: 0.9942
231/469 [=============&gt;................] - ETA: 5s - loss: 0.0057 - accuracy: 0.9941
234/469 [=============&gt;................] - ETA: 5s - loss: 0.0057 - accuracy: 0.9941
237/469 [==============&gt;...............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9941
239/469 [==============&gt;...............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9941
242/469 [==============&gt;...............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9941
244/469 [==============&gt;...............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9941
246/469 [==============&gt;...............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9942
248/469 [==============&gt;...............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9942
250/469 [==============&gt;...............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9942
253/469 [===============&gt;..............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9943
256/469 [===============&gt;..............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9942
258/469 [===============&gt;..............] - ETA: 5s - loss: 0.0058 - accuracy: 0.9942
260/469 [===============&gt;..............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9942
262/469 [===============&gt;..............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9942
265/469 [===============&gt;..............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9943
267/469 [================&gt;.............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9943
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9943
271/469 [================&gt;.............] - ETA: 4s - loss: 0.0056 - accuracy: 0.9943
273/469 [================&gt;.............] - ETA: 4s - loss: 0.0057 - accuracy: 0.9943
275/469 [================&gt;.............] - ETA: 4s - loss: 0.0056 - accuracy: 0.9943
277/469 [================&gt;.............] - ETA: 4s - loss: 0.0057 - accuracy: 0.9943
279/469 [================&gt;.............] - ETA: 4s - loss: 0.0056 - accuracy: 0.9943
281/469 [================&gt;.............] - ETA: 4s - loss: 0.0056 - accuracy: 0.9944
283/469 [=================&gt;............] - ETA: 4s - loss: 0.0056 - accuracy: 0.9943
285/469 [=================&gt;............] - ETA: 4s - loss: 0.0056 - accuracy: 0.9943
287/469 [=================&gt;............] - ETA: 4s - loss: 0.0056 - accuracy: 0.9943
290/469 [=================&gt;............] - ETA: 4s - loss: 0.0056 - accuracy: 0.9943
293/469 [=================&gt;............] - ETA: 4s - loss: 0.0057 - accuracy: 0.9941
295/469 [=================&gt;............] - ETA: 4s - loss: 0.0058 - accuracy: 0.9940
297/469 [=================&gt;............] - ETA: 4s - loss: 0.0057 - accuracy: 0.9941
299/469 [==================&gt;...........] - ETA: 4s - loss: 0.0058 - accuracy: 0.9940
301/469 [==================&gt;...........] - ETA: 4s - loss: 0.0057 - accuracy: 0.9941
304/469 [==================&gt;...........] - ETA: 4s - loss: 0.0057 - accuracy: 0.9941
306/469 [==================&gt;...........] - ETA: 4s - loss: 0.0057 - accuracy: 0.9941
308/469 [==================&gt;...........] - ETA: 4s - loss: 0.0057 - accuracy: 0.9940
310/469 [==================&gt;...........] - ETA: 4s - loss: 0.0057 - accuracy: 0.9941
312/469 [==================&gt;...........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
314/469 [===================&gt;..........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
316/469 [===================&gt;..........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
319/469 [===================&gt;..........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
321/469 [===================&gt;..........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
323/469 [===================&gt;..........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
325/469 [===================&gt;..........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
327/469 [===================&gt;..........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
329/469 [====================&gt;.........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9940
331/469 [====================&gt;.........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9941
333/469 [====================&gt;.........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9940
335/469 [====================&gt;.........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9940
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9940
339/469 [====================&gt;.........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9939
341/469 [====================&gt;.........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9940
343/469 [====================&gt;.........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9940
345/469 [=====================&gt;........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9940
347/469 [=====================&gt;........] - ETA: 3s - loss: 0.0057 - accuracy: 0.9940
349/469 [=====================&gt;........] - ETA: 3s - loss: 0.0058 - accuracy: 0.9940
351/469 [=====================&gt;........] - ETA: 2s - loss: 0.0057 - accuracy: 0.9940
353/469 [=====================&gt;........] - ETA: 2s - loss: 0.0057 - accuracy: 0.9940
355/469 [=====================&gt;........] - ETA: 2s - loss: 0.0057 - accuracy: 0.9940
357/469 [=====================&gt;........] - ETA: 2s - loss: 0.0058 - accuracy: 0.9940
360/469 [======================&gt;.......] - ETA: 2s - loss: 0.0057 - accuracy: 0.9941
362/469 [======================&gt;.......] - ETA: 2s - loss: 0.0057 - accuracy: 0.9941
364/469 [======================&gt;.......] - ETA: 2s - loss: 0.0057 - accuracy: 0.9941
366/469 [======================&gt;.......] - ETA: 2s - loss: 0.0057 - accuracy: 0.9941
368/469 [======================&gt;.......] - ETA: 2s - loss: 0.0057 - accuracy: 0.9941
371/469 [======================&gt;.......] - ETA: 2s - loss: 0.0057 - accuracy: 0.9941
373/469 [======================&gt;.......] - ETA: 2s - loss: 0.0057 - accuracy: 0.9940
376/469 [=======================&gt;......] - ETA: 2s - loss: 0.0058 - accuracy: 0.9939
378/469 [=======================&gt;......] - ETA: 2s - loss: 0.0058 - accuracy: 0.9939
380/469 [=======================&gt;......] - ETA: 2s - loss: 0.0058 - accuracy: 0.9939
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0058 - accuracy: 0.9939
386/469 [=======================&gt;......] - ETA: 2s - loss: 0.0058 - accuracy: 0.9939
388/469 [=======================&gt;......] - ETA: 2s - loss: 0.0058 - accuracy: 0.9938
390/469 [=======================&gt;......] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
392/469 [========================&gt;.....] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
395/469 [========================&gt;.....] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
397/469 [========================&gt;.....] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
399/469 [========================&gt;.....] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
402/469 [========================&gt;.....] - ETA: 1s - loss: 0.0057 - accuracy: 0.9939
404/469 [========================&gt;.....] - ETA: 1s - loss: 0.0057 - accuracy: 0.9939
406/469 [========================&gt;.....] - ETA: 1s - loss: 0.0057 - accuracy: 0.9939
408/469 [=========================&gt;....] - ETA: 1s - loss: 0.0057 - accuracy: 0.9939
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
413/469 [=========================&gt;....] - ETA: 1s - loss: 0.0057 - accuracy: 0.9939
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0057 - accuracy: 0.9938
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0058 - accuracy: 0.9938
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0057 - accuracy: 0.9939
426/469 [==========================&gt;...] - ETA: 1s - loss: 0.0057 - accuracy: 0.9939
428/469 [==========================&gt;...] - ETA: 1s - loss: 0.0057 - accuracy: 0.9939
430/469 [==========================&gt;...] - ETA: 0s - loss: 0.0057 - accuracy: 0.9939
432/469 [==========================&gt;...] - ETA: 0s - loss: 0.0057 - accuracy: 0.9939
434/469 [==========================&gt;...] - ETA: 0s - loss: 0.0058 - accuracy: 0.9938
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0058 - accuracy: 0.9938
439/469 [===========================&gt;..] - ETA: 0s - loss: 0.0058 - accuracy: 0.9938
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0057 - accuracy: 0.9939
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0057 - accuracy: 0.9938
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0058 - accuracy: 0.9938
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0058 - accuracy: 0.9938
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0057 - accuracy: 0.9938
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0057 - accuracy: 0.9938
454/469 [============================&gt;.] - ETA: 0s - loss: 0.0058 - accuracy: 0.9937
456/469 [============================&gt;.] - ETA: 0s - loss: 0.0058 - accuracy: 0.9937
458/469 [============================&gt;.] - ETA: 0s - loss: 0.0058 - accuracy: 0.9937
460/469 [============================&gt;.] - ETA: 0s - loss: 0.0058 - accuracy: 0.9937
462/469 [============================&gt;.] - ETA: 0s - loss: 0.0058 - accuracy: 0.9937
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0058 - accuracy: 0.9937
468/469 [============================&gt;.] - ETA: 0s - loss: 0.0058 - accuracy: 0.9937
469/469 [==============================] - 12s 26ms/step - loss: 0.0058 - accuracy: 0.9937 - val_loss: 0.0071 - val_accuracy: 0.9919 - lr: 6.3096e-04
Epoch 3/5

  1/469 [..............................] - ETA: 0s - loss: 0.0015 - accuracy: 1.0000
  4/469 [..............................] - ETA: 8s - loss: 0.0027 - accuracy: 0.9980
  6/469 [..............................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9987
  8/469 [..............................] - ETA: 10s - loss: 0.0025 - accuracy: 0.9980
 11/469 [..............................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9986
 13/469 [..............................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9976
 15/469 [..............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9979
 17/469 [&gt;.............................] - ETA: 10s - loss: 0.0028 - accuracy: 0.9972
 19/469 [&gt;.............................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9975
 21/469 [&gt;.............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9978
 23/469 [&gt;.............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9976
 25/469 [&gt;.............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9978
 27/469 [&gt;.............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9977
 30/469 [&gt;.............................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9977
 32/469 [=&gt;............................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9976
 34/469 [=&gt;............................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9977
 37/469 [=&gt;............................] - ETA: 10s - loss: 0.0027 - accuracy: 0.9977
 39/469 [=&gt;............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9978
 41/469 [=&gt;............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9979
 44/469 [=&gt;............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9979
 46/469 [=&gt;............................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9978
 48/469 [==&gt;...........................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9977
 50/469 [==&gt;...........................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9978
 52/469 [==&gt;...........................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9976
 54/469 [==&gt;...........................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9977
 56/469 [==&gt;...........................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9978
 58/469 [==&gt;...........................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9977
 60/469 [==&gt;...........................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9978
 62/469 [==&gt;...........................] - ETA: 10s - loss: 0.0026 - accuracy: 0.9976
 64/469 [===&gt;..........................] - ETA: 10s - loss: 0.0025 - accuracy: 0.9977
 66/469 [===&gt;..........................] - ETA: 10s - loss: 0.0025 - accuracy: 0.9976
 68/469 [===&gt;..........................] - ETA: 9s - loss: 0.0026 - accuracy: 0.9975 
 70/469 [===&gt;..........................] - ETA: 9s - loss: 0.0026 - accuracy: 0.9975
 72/469 [===&gt;..........................] - ETA: 9s - loss: 0.0025 - accuracy: 0.9976
 74/469 [===&gt;..........................] - ETA: 9s - loss: 0.0025 - accuracy: 0.9977
 76/469 [===&gt;..........................] - ETA: 9s - loss: 0.0025 - accuracy: 0.9977
 78/469 [===&gt;..........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9978
 80/469 [====&gt;.........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9979
 82/469 [====&gt;.........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9979
 84/469 [====&gt;.........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9980
 86/469 [====&gt;.........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9979
 88/469 [====&gt;.........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9979
 90/469 [====&gt;.........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9979
 92/469 [====&gt;.........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9980
 94/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9979
 96/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9978
 98/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9978
100/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9978
102/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9978
104/469 [=====&gt;........................] - ETA: 9s - loss: 0.0024 - accuracy: 0.9978
106/469 [=====&gt;........................] - ETA: 9s - loss: 0.0023 - accuracy: 0.9979
108/469 [=====&gt;........................] - ETA: 9s - loss: 0.0023 - accuracy: 0.9979
111/469 [======&gt;.......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9979
113/469 [======&gt;.......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9979
115/469 [======&gt;.......................] - ETA: 8s - loss: 0.0023 - accuracy: 0.9979
118/469 [======&gt;.......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9977
120/469 [======&gt;.......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9978
123/469 [======&gt;.......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9978
126/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9979
129/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9979
131/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9979
133/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9979
135/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9979
137/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9979
139/469 [=======&gt;......................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9979
141/469 [========&gt;.....................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9978
143/469 [========&gt;.....................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9978
145/469 [========&gt;.....................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9978
147/469 [========&gt;.....................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9978
149/469 [========&gt;.....................] - ETA: 8s - loss: 0.0024 - accuracy: 0.9977
151/469 [========&gt;.....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
154/469 [========&gt;.....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
156/469 [========&gt;.....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9977
158/469 [=========&gt;....................] - ETA: 7s - loss: 0.0025 - accuracy: 0.9977
160/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
163/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
165/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
168/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
170/469 [=========&gt;....................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
172/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
174/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
176/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9977
178/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9978
180/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9977
182/469 [==========&gt;...................] - ETA: 7s - loss: 0.0025 - accuracy: 0.9977
184/469 [==========&gt;...................] - ETA: 7s - loss: 0.0024 - accuracy: 0.9977
187/469 [==========&gt;...................] - ETA: 7s - loss: 0.0025 - accuracy: 0.9977
190/469 [===========&gt;..................] - ETA: 6s - loss: 0.0024 - accuracy: 0.9977
192/469 [===========&gt;..................] - ETA: 6s - loss: 0.0024 - accuracy: 0.9977
194/469 [===========&gt;..................] - ETA: 6s - loss: 0.0024 - accuracy: 0.9977
196/469 [===========&gt;..................] - ETA: 6s - loss: 0.0024 - accuracy: 0.9978
198/469 [===========&gt;..................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9977
200/469 [===========&gt;..................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9977
203/469 [===========&gt;..................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9977
205/469 [============&gt;.................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
207/469 [============&gt;.................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
209/469 [============&gt;.................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
211/469 [============&gt;.................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
213/469 [============&gt;.................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
215/469 [============&gt;.................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
217/469 [============&gt;.................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
219/469 [=============&gt;................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
221/469 [=============&gt;................] - ETA: 6s - loss: 0.0024 - accuracy: 0.9977
223/469 [=============&gt;................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9977
226/469 [=============&gt;................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9975
228/469 [=============&gt;................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9975
230/469 [=============&gt;................] - ETA: 6s - loss: 0.0025 - accuracy: 0.9976
233/469 [=============&gt;................] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
235/469 [==============&gt;...............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
238/469 [==============&gt;...............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
241/469 [==============&gt;...............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
243/469 [==============&gt;...............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
245/469 [==============&gt;...............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
247/469 [==============&gt;...............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
249/469 [==============&gt;...............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
251/469 [===============&gt;..............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
253/469 [===============&gt;..............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
255/469 [===============&gt;..............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
257/469 [===============&gt;..............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
259/469 [===============&gt;..............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
261/469 [===============&gt;..............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
263/469 [===============&gt;..............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
265/469 [===============&gt;..............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
267/469 [================&gt;.............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9975
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0025 - accuracy: 0.9974
272/469 [================&gt;.............] - ETA: 4s - loss: 0.0025 - accuracy: 0.9974
274/469 [================&gt;.............] - ETA: 4s - loss: 0.0025 - accuracy: 0.9974
276/469 [================&gt;.............] - ETA: 4s - loss: 0.0025 - accuracy: 0.9974
278/469 [================&gt;.............] - ETA: 4s - loss: 0.0025 - accuracy: 0.9974
280/469 [================&gt;.............] - ETA: 4s - loss: 0.0025 - accuracy: 0.9974
282/469 [=================&gt;............] - ETA: 4s - loss: 0.0025 - accuracy: 0.9975
284/469 [=================&gt;............] - ETA: 4s - loss: 0.0025 - accuracy: 0.9974
286/469 [=================&gt;............] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
289/469 [=================&gt;............] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
292/469 [=================&gt;............] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
294/469 [=================&gt;............] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
296/469 [=================&gt;............] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
298/469 [==================&gt;...........] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
300/469 [==================&gt;...........] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
302/469 [==================&gt;...........] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
304/469 [==================&gt;...........] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
306/469 [==================&gt;...........] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
308/469 [==================&gt;...........] - ETA: 4s - loss: 0.0026 - accuracy: 0.9974
311/469 [==================&gt;...........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9974
313/469 [===================&gt;..........] - ETA: 3s - loss: 0.0027 - accuracy: 0.9973
315/469 [===================&gt;..........] - ETA: 3s - loss: 0.0027 - accuracy: 0.9973
317/469 [===================&gt;..........] - ETA: 3s - loss: 0.0027 - accuracy: 0.9973
319/469 [===================&gt;..........] - ETA: 3s - loss: 0.0027 - accuracy: 0.9974
321/469 [===================&gt;..........] - ETA: 3s - loss: 0.0027 - accuracy: 0.9973
323/469 [===================&gt;..........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9974
325/469 [===================&gt;..........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9974
327/469 [===================&gt;..........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9973
329/469 [====================&gt;.........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9974
332/469 [====================&gt;.........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9974
335/469 [====================&gt;.........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9973
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9974
340/469 [====================&gt;.........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9973
342/469 [====================&gt;.........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9973
344/469 [=====================&gt;........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9973
346/469 [=====================&gt;........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9973
349/469 [=====================&gt;........] - ETA: 3s - loss: 0.0026 - accuracy: 0.9973
351/469 [=====================&gt;........] - ETA: 2s - loss: 0.0027 - accuracy: 0.9973
353/469 [=====================&gt;........] - ETA: 2s - loss: 0.0027 - accuracy: 0.9973
355/469 [=====================&gt;........] - ETA: 2s - loss: 0.0026 - accuracy: 0.9973
357/469 [=====================&gt;........] - ETA: 2s - loss: 0.0026 - accuracy: 0.9973
359/469 [=====================&gt;........] - ETA: 2s - loss: 0.0026 - accuracy: 0.9973
362/469 [======================&gt;.......] - ETA: 2s - loss: 0.0026 - accuracy: 0.9973
364/469 [======================&gt;.......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9973
366/469 [======================&gt;.......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
369/469 [======================&gt;.......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
371/469 [======================&gt;.......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
373/469 [======================&gt;.......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
375/469 [======================&gt;.......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
377/469 [=======================&gt;......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
379/469 [=======================&gt;......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
381/469 [=======================&gt;......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
385/469 [=======================&gt;......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
387/469 [=======================&gt;......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
389/469 [=======================&gt;......] - ETA: 2s - loss: 0.0027 - accuracy: 0.9972
391/469 [========================&gt;.....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
393/469 [========================&gt;.....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
395/469 [========================&gt;.....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
397/469 [========================&gt;.....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
400/469 [========================&gt;.....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
402/469 [========================&gt;.....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
404/469 [========================&gt;.....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
406/469 [========================&gt;.....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
412/469 [=========================&gt;....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
414/469 [=========================&gt;....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
416/469 [=========================&gt;....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
418/469 [=========================&gt;....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9973
420/469 [=========================&gt;....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9973
422/469 [=========================&gt;....] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
424/469 [==========================&gt;...] - ETA: 1s - loss: 0.0027 - accuracy: 0.9973
426/469 [==========================&gt;...] - ETA: 1s - loss: 0.0027 - accuracy: 0.9973
428/469 [==========================&gt;...] - ETA: 1s - loss: 0.0027 - accuracy: 0.9972
430/469 [==========================&gt;...] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
432/469 [==========================&gt;...] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
434/469 [==========================&gt;...] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
436/469 [==========================&gt;...] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
438/469 [===========================&gt;..] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0027 - accuracy: 0.9973
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0027 - accuracy: 0.9972
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0027 - accuracy: 0.9972
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0028 - accuracy: 0.9972
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0028 - accuracy: 0.9972
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0028 - accuracy: 0.9972
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0028 - accuracy: 0.9972
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0027 - accuracy: 0.9972
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0027 - accuracy: 0.9972
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0027 - accuracy: 0.9972
469/469 [==============================] - 12s 26ms/step - loss: 0.0027 - accuracy: 0.9972 - val_loss: 0.0072 - val_accuracy: 0.9920 - lr: 3.9811e-04
Epoch 4/5

  1/469 [..............................] - ETA: 0s - loss: 6.2977e-04 - accuracy: 1.0000
  3/469 [..............................] - ETA: 7s - loss: 0.0016 - accuracy: 1.0000    
  5/469 [..............................] - ETA: 9s - loss: 0.0011 - accuracy: 1.0000
  8/469 [..............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9990
 10/469 [..............................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9992
 12/469 [..............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9987
 15/469 [..............................] - ETA: 10s - loss: 0.0018 - accuracy: 0.9984
 17/469 [&gt;.............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9986
 20/469 [&gt;.............................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9988
 22/469 [&gt;.............................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9986
 24/469 [&gt;.............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9984
 26/469 [&gt;.............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9985
 28/469 [&gt;.............................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9986
 30/469 [&gt;.............................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9987
 32/469 [=&gt;............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9983
 34/469 [=&gt;............................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9984
 36/469 [=&gt;............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9983
 38/469 [=&gt;............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9984
 40/469 [=&gt;............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9982
 42/469 [=&gt;............................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9983
 44/469 [=&gt;............................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9984
 47/469 [==&gt;...........................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9983
 49/469 [==&gt;...........................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9984
 51/469 [==&gt;...........................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9985
 53/469 [==&gt;...........................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9984
 55/469 [==&gt;...........................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9983
 57/469 [==&gt;...........................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9984
 59/469 [==&gt;...........................] - ETA: 10s - loss: 0.0016 - accuracy: 0.9984
 62/469 [==&gt;...........................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9984
 64/469 [===&gt;..........................] - ETA: 10s - loss: 0.0017 - accuracy: 0.9984
 66/469 [===&gt;..........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985 
 68/469 [===&gt;..........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985
 71/469 [===&gt;..........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985
 73/469 [===&gt;..........................] - ETA: 9s - loss: 0.0017 - accuracy: 0.9984
 75/469 [===&gt;..........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9984
 77/469 [===&gt;..........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985
 79/469 [====&gt;.........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985
 81/469 [====&gt;.........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9986
 83/469 [====&gt;.........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9986
 86/469 [====&gt;.........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985
 88/469 [====&gt;.........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9986
 90/469 [====&gt;.........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985
 93/469 [====&gt;.........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9986
 95/469 [=====&gt;........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9986
 97/469 [=====&gt;........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9986
100/469 [=====&gt;........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9986
103/469 [=====&gt;........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985
105/469 [=====&gt;........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9985
108/469 [=====&gt;........................] - ETA: 9s - loss: 0.0016 - accuracy: 0.9986
111/469 [======&gt;.......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9986
113/469 [======&gt;.......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9985
115/469 [======&gt;.......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9986
117/469 [======&gt;.......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9985
119/469 [======&gt;.......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9985
122/469 [======&gt;.......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9985
124/469 [======&gt;.......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9986
126/469 [=======&gt;......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9986
128/469 [=======&gt;......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9986
130/469 [=======&gt;......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9986
132/469 [=======&gt;......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9986
134/469 [=======&gt;......................] - ETA: 8s - loss: 0.0016 - accuracy: 0.9987
136/469 [=======&gt;......................] - ETA: 8s - loss: 0.0015 - accuracy: 0.9987
138/469 [=======&gt;......................] - ETA: 8s - loss: 0.0015 - accuracy: 0.9987
140/469 [=======&gt;......................] - ETA: 8s - loss: 0.0015 - accuracy: 0.9987
142/469 [========&gt;.....................] - ETA: 8s - loss: 0.0015 - accuracy: 0.9987
145/469 [========&gt;.....................] - ETA: 8s - loss: 0.0015 - accuracy: 0.9987
148/469 [========&gt;.....................] - ETA: 8s - loss: 0.0015 - accuracy: 0.9987
150/469 [========&gt;.....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9987
152/469 [========&gt;.....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9988
154/469 [========&gt;.....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9988
156/469 [========&gt;.....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9988
158/469 [=========&gt;....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9988
160/469 [=========&gt;....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9988
162/469 [=========&gt;....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9987
164/469 [=========&gt;....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9987
166/469 [=========&gt;....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9987
168/469 [=========&gt;....................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9987
170/469 [=========&gt;....................] - ETA: 7s - loss: 0.0016 - accuracy: 0.9986
173/469 [==========&gt;...................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9986
175/469 [==========&gt;...................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9987
177/469 [==========&gt;...................] - ETA: 7s - loss: 0.0015 - accuracy: 0.9986
180/469 [==========&gt;...................] - ETA: 7s - loss: 0.0016 - accuracy: 0.9986
183/469 [==========&gt;...................] - ETA: 7s - loss: 0.0016 - accuracy: 0.9986
185/469 [==========&gt;...................] - ETA: 7s - loss: 0.0016 - accuracy: 0.9986
187/469 [==========&gt;...................] - ETA: 7s - loss: 0.0016 - accuracy: 0.9985
189/469 [===========&gt;..................] - ETA: 7s - loss: 0.0016 - accuracy: 0.9986
191/469 [===========&gt;..................] - ETA: 6s - loss: 0.0016 - accuracy: 0.9986
193/469 [===========&gt;..................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9986
195/469 [===========&gt;..................] - ETA: 6s - loss: 0.0016 - accuracy: 0.9985
197/469 [===========&gt;..................] - ETA: 6s - loss: 0.0016 - accuracy: 0.9985
199/469 [===========&gt;..................] - ETA: 6s - loss: 0.0016 - accuracy: 0.9985
201/469 [===========&gt;..................] - ETA: 6s - loss: 0.0016 - accuracy: 0.9985
203/469 [===========&gt;..................] - ETA: 6s - loss: 0.0016 - accuracy: 0.9985
205/469 [============&gt;.................] - ETA: 6s - loss: 0.0016 - accuracy: 0.9985
207/469 [============&gt;.................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
209/469 [============&gt;.................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
211/469 [============&gt;.................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
213/469 [============&gt;.................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
215/469 [============&gt;.................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
217/469 [============&gt;.................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9986
220/469 [=============&gt;................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
223/469 [=============&gt;................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9986
226/469 [=============&gt;................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
228/469 [=============&gt;................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
230/469 [=============&gt;................] - ETA: 6s - loss: 0.0015 - accuracy: 0.9985
232/469 [=============&gt;................] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
234/469 [=============&gt;................] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
236/469 [==============&gt;...............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
239/469 [==============&gt;...............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
241/469 [==============&gt;...............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
243/469 [==============&gt;...............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
245/469 [==============&gt;...............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
247/469 [==============&gt;...............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
249/469 [==============&gt;...............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
251/469 [===============&gt;..............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
254/469 [===============&gt;..............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
256/469 [===============&gt;..............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
258/469 [===============&gt;..............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9985
260/469 [===============&gt;..............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9986
262/469 [===============&gt;..............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9986
265/469 [===============&gt;..............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9986
267/469 [================&gt;.............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9986
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0015 - accuracy: 0.9986
272/469 [================&gt;.............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9986
274/469 [================&gt;.............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9986
276/469 [================&gt;.............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9986
278/469 [================&gt;.............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9986
280/469 [================&gt;.............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9986
283/469 [=================&gt;............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9986
285/469 [=================&gt;............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
287/469 [=================&gt;............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
289/469 [=================&gt;............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
291/469 [=================&gt;............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
294/469 [=================&gt;............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
296/469 [=================&gt;............] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
298/469 [==================&gt;...........] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
300/469 [==================&gt;...........] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
303/469 [==================&gt;...........] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0014 - accuracy: 0.9987
312/469 [==================&gt;...........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
315/469 [===================&gt;..........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
317/469 [===================&gt;..........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
319/469 [===================&gt;..........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
321/469 [===================&gt;..........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
323/469 [===================&gt;..........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
325/469 [===================&gt;..........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
327/469 [===================&gt;..........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
329/469 [====================&gt;.........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
331/469 [====================&gt;.........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
333/469 [====================&gt;.........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
335/469 [====================&gt;.........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9986
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
340/469 [====================&gt;.........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
342/469 [====================&gt;.........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
344/469 [=====================&gt;........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
346/469 [=====================&gt;........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
348/469 [=====================&gt;........] - ETA: 3s - loss: 0.0014 - accuracy: 0.9987
350/469 [=====================&gt;........] - ETA: 2s - loss: 0.0014 - accuracy: 0.9987
352/469 [=====================&gt;........] - ETA: 2s - loss: 0.0014 - accuracy: 0.9987
354/469 [=====================&gt;........] - ETA: 2s - loss: 0.0014 - accuracy: 0.9987
356/469 [=====================&gt;........] - ETA: 2s - loss: 0.0014 - accuracy: 0.9987
358/469 [=====================&gt;........] - ETA: 2s - loss: 0.0014 - accuracy: 0.9987
360/469 [======================&gt;.......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9987
362/469 [======================&gt;.......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9987
364/469 [======================&gt;.......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
366/469 [======================&gt;.......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
368/469 [======================&gt;.......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
370/469 [======================&gt;.......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
372/469 [======================&gt;.......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
374/469 [======================&gt;.......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
376/469 [=======================&gt;......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
378/469 [=======================&gt;......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
381/469 [=======================&gt;......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
386/469 [=======================&gt;......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
388/469 [=======================&gt;......] - ETA: 2s - loss: 0.0014 - accuracy: 0.9988
390/469 [=======================&gt;......] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
393/469 [========================&gt;.....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
395/469 [========================&gt;.....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
397/469 [========================&gt;.....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
399/469 [========================&gt;.....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
401/469 [========================&gt;.....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
403/469 [========================&gt;.....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
408/469 [=========================&gt;....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
410/469 [=========================&gt;....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
412/469 [=========================&gt;....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
426/469 [==========================&gt;...] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
428/469 [==========================&gt;...] - ETA: 1s - loss: 0.0014 - accuracy: 0.9988
430/469 [==========================&gt;...] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
432/469 [==========================&gt;...] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
435/469 [==========================&gt;...] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
440/469 [===========================&gt;..] - ETA: 0s - loss: 0.0014 - accuracy: 0.9988
442/469 [===========================&gt;..] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0014 - accuracy: 0.9988
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0014 - accuracy: 0.9988
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0014 - accuracy: 0.9988
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0014 - accuracy: 0.9988
454/469 [============================&gt;.] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
456/469 [============================&gt;.] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
458/469 [============================&gt;.] - ETA: 0s - loss: 0.0014 - accuracy: 0.9988
460/469 [============================&gt;.] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
462/469 [============================&gt;.] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
464/469 [============================&gt;.] - ETA: 0s - loss: 0.0014 - accuracy: 0.9988
466/469 [============================&gt;.] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
468/469 [============================&gt;.] - ETA: 0s - loss: 0.0014 - accuracy: 0.9987
469/469 [==============================] - 12s 26ms/step - loss: 0.0014 - accuracy: 0.9987 - val_loss: 0.0045 - val_accuracy: 0.9945 - lr: 2.5119e-04
Epoch 5/5

  1/469 [..............................] - ETA: 0s - loss: 8.3333e-04 - accuracy: 1.0000
  3/469 [..............................] - ETA: 7s - loss: 0.0010 - accuracy: 1.0000    
  5/469 [..............................] - ETA: 9s - loss: 8.9223e-04 - accuracy: 1.0000
  8/469 [..............................] - ETA: 10s - loss: 0.0012 - accuracy: 0.9990   
 10/469 [..............................] - ETA: 10s - loss: 0.0011 - accuracy: 0.9992
 13/469 [..............................] - ETA: 10s - loss: 9.6140e-04 - accuracy: 0.9994
 15/469 [..............................] - ETA: 10s - loss: 0.0011 - accuracy: 0.9990    
 18/469 [&gt;.............................] - ETA: 10s - loss: 9.3720e-04 - accuracy: 0.9991
 20/469 [&gt;.............................] - ETA: 10s - loss: 8.8430e-04 - accuracy: 0.9992
 22/469 [&gt;.............................] - ETA: 10s - loss: 8.5425e-04 - accuracy: 0.9993
 25/469 [&gt;.............................] - ETA: 10s - loss: 8.0952e-04 - accuracy: 0.9994
 27/469 [&gt;.............................] - ETA: 10s - loss: 9.8929e-04 - accuracy: 0.9988
 29/469 [&gt;.............................] - ETA: 10s - loss: 9.5347e-04 - accuracy: 0.9989
 31/469 [&gt;.............................] - ETA: 10s - loss: 9.7375e-04 - accuracy: 0.9990
 33/469 [=&gt;............................] - ETA: 10s - loss: 9.5551e-04 - accuracy: 0.9991
 36/469 [=&gt;............................] - ETA: 10s - loss: 9.7798e-04 - accuracy: 0.9991
 38/469 [=&gt;............................] - ETA: 10s - loss: 9.7220e-04 - accuracy: 0.9992
 40/469 [=&gt;............................] - ETA: 10s - loss: 9.4531e-04 - accuracy: 0.9992
 42/469 [=&gt;............................] - ETA: 10s - loss: 9.2236e-04 - accuracy: 0.9993
 44/469 [=&gt;............................] - ETA: 10s - loss: 9.1435e-04 - accuracy: 0.9993
 46/469 [=&gt;............................] - ETA: 10s - loss: 8.7735e-04 - accuracy: 0.9993
 48/469 [==&gt;...........................] - ETA: 10s - loss: 8.5495e-04 - accuracy: 0.9993
 50/469 [==&gt;...........................] - ETA: 10s - loss: 8.6674e-04 - accuracy: 0.9992
 52/469 [==&gt;...........................] - ETA: 10s - loss: 8.3419e-04 - accuracy: 0.9992
 55/469 [==&gt;...........................] - ETA: 10s - loss: 8.0447e-04 - accuracy: 0.9993
 58/469 [==&gt;...........................] - ETA: 10s - loss: 7.9335e-04 - accuracy: 0.9993
 60/469 [==&gt;...........................] - ETA: 10s - loss: 7.8335e-04 - accuracy: 0.9993
 62/469 [==&gt;...........................] - ETA: 10s - loss: 8.3884e-04 - accuracy: 0.9992
 65/469 [===&gt;..........................] - ETA: 9s - loss: 8.3709e-04 - accuracy: 0.9993 
 67/469 [===&gt;..........................] - ETA: 9s - loss: 8.3156e-04 - accuracy: 0.9993
 69/469 [===&gt;..........................] - ETA: 9s - loss: 8.1231e-04 - accuracy: 0.9993
 71/469 [===&gt;..........................] - ETA: 9s - loss: 8.1441e-04 - accuracy: 0.9993
 73/469 [===&gt;..........................] - ETA: 9s - loss: 8.0418e-04 - accuracy: 0.9994
 76/469 [===&gt;..........................] - ETA: 9s - loss: 7.9086e-04 - accuracy: 0.9994
 78/469 [===&gt;..........................] - ETA: 9s - loss: 7.8392e-04 - accuracy: 0.9994
 80/469 [====&gt;.........................] - ETA: 9s - loss: 7.6697e-04 - accuracy: 0.9994
 83/469 [====&gt;.........................] - ETA: 9s - loss: 7.9951e-04 - accuracy: 0.9993
 85/469 [====&gt;.........................] - ETA: 9s - loss: 7.8612e-04 - accuracy: 0.9994
 87/469 [====&gt;.........................] - ETA: 9s - loss: 7.6988e-04 - accuracy: 0.9994
 89/469 [====&gt;.........................] - ETA: 9s - loss: 7.6010e-04 - accuracy: 0.9994
 91/469 [====&gt;.........................] - ETA: 9s - loss: 7.4376e-04 - accuracy: 0.9994
 93/469 [====&gt;.........................] - ETA: 9s - loss: 7.2988e-04 - accuracy: 0.9994
 95/469 [=====&gt;........................] - ETA: 9s - loss: 7.3169e-04 - accuracy: 0.9994
 97/469 [=====&gt;........................] - ETA: 9s - loss: 7.2706e-04 - accuracy: 0.9994
 99/469 [=====&gt;........................] - ETA: 9s - loss: 7.3240e-04 - accuracy: 0.9994
101/469 [=====&gt;........................] - ETA: 9s - loss: 7.4072e-04 - accuracy: 0.9995
103/469 [=====&gt;........................] - ETA: 9s - loss: 7.2946e-04 - accuracy: 0.9995
105/469 [=====&gt;........................] - ETA: 9s - loss: 7.5647e-04 - accuracy: 0.9994
107/469 [=====&gt;........................] - ETA: 9s - loss: 7.4440e-04 - accuracy: 0.9994
109/469 [=====&gt;........................] - ETA: 8s - loss: 7.3517e-04 - accuracy: 0.9994
111/469 [======&gt;.......................] - ETA: 8s - loss: 7.3160e-04 - accuracy: 0.9994
114/469 [======&gt;.......................] - ETA: 8s - loss: 7.3157e-04 - accuracy: 0.9994
116/469 [======&gt;.......................] - ETA: 8s - loss: 7.3592e-04 - accuracy: 0.9994
118/469 [======&gt;.......................] - ETA: 8s - loss: 7.3385e-04 - accuracy: 0.9994
120/469 [======&gt;.......................] - ETA: 8s - loss: 7.5619e-04 - accuracy: 0.9994
122/469 [======&gt;.......................] - ETA: 8s - loss: 7.4588e-04 - accuracy: 0.9994
124/469 [======&gt;.......................] - ETA: 8s - loss: 7.3561e-04 - accuracy: 0.9994
126/469 [=======&gt;......................] - ETA: 8s - loss: 7.3662e-04 - accuracy: 0.9994
128/469 [=======&gt;......................] - ETA: 8s - loss: 7.3094e-04 - accuracy: 0.9995
130/469 [=======&gt;......................] - ETA: 8s - loss: 7.3243e-04 - accuracy: 0.9995
132/469 [=======&gt;......................] - ETA: 8s - loss: 7.2765e-04 - accuracy: 0.9995
134/469 [=======&gt;......................] - ETA: 8s - loss: 7.2203e-04 - accuracy: 0.9995
136/469 [=======&gt;......................] - ETA: 8s - loss: 7.2178e-04 - accuracy: 0.9995
138/469 [=======&gt;......................] - ETA: 8s - loss: 7.1547e-04 - accuracy: 0.9995
140/469 [=======&gt;......................] - ETA: 8s - loss: 7.2125e-04 - accuracy: 0.9995
142/469 [========&gt;.....................] - ETA: 8s - loss: 7.1228e-04 - accuracy: 0.9995
144/469 [========&gt;.....................] - ETA: 8s - loss: 7.1135e-04 - accuracy: 0.9995
146/469 [========&gt;.....................] - ETA: 8s - loss: 7.0271e-04 - accuracy: 0.9995
149/469 [========&gt;.....................] - ETA: 8s - loss: 7.0111e-04 - accuracy: 0.9995
151/469 [========&gt;.....................] - ETA: 7s - loss: 7.0498e-04 - accuracy: 0.9995
153/469 [========&gt;.....................] - ETA: 7s - loss: 7.0097e-04 - accuracy: 0.9995
155/469 [========&gt;.....................] - ETA: 7s - loss: 6.9490e-04 - accuracy: 0.9995
157/469 [=========&gt;....................] - ETA: 7s - loss: 6.9172e-04 - accuracy: 0.9995
159/469 [=========&gt;....................] - ETA: 7s - loss: 6.9537e-04 - accuracy: 0.9995
162/469 [=========&gt;....................] - ETA: 7s - loss: 6.9113e-04 - accuracy: 0.9995
164/469 [=========&gt;....................] - ETA: 7s - loss: 6.9844e-04 - accuracy: 0.9995
166/469 [=========&gt;....................] - ETA: 7s - loss: 6.9421e-04 - accuracy: 0.9995
169/469 [=========&gt;....................] - ETA: 7s - loss: 6.8857e-04 - accuracy: 0.9995
171/469 [=========&gt;....................] - ETA: 7s - loss: 6.9005e-04 - accuracy: 0.9995
174/469 [==========&gt;...................] - ETA: 7s - loss: 6.9147e-04 - accuracy: 0.9996
176/469 [==========&gt;...................] - ETA: 7s - loss: 6.9244e-04 - accuracy: 0.9996
178/469 [==========&gt;...................] - ETA: 7s - loss: 6.9047e-04 - accuracy: 0.9996
180/469 [==========&gt;...................] - ETA: 7s - loss: 6.9842e-04 - accuracy: 0.9996
182/469 [==========&gt;...................] - ETA: 7s - loss: 6.9106e-04 - accuracy: 0.9996
184/469 [==========&gt;...................] - ETA: 7s - loss: 6.8736e-04 - accuracy: 0.9996
186/469 [==========&gt;...................] - ETA: 7s - loss: 6.8245e-04 - accuracy: 0.9996
188/469 [===========&gt;..................] - ETA: 7s - loss: 6.8422e-04 - accuracy: 0.9996
190/469 [===========&gt;..................] - ETA: 7s - loss: 6.8299e-04 - accuracy: 0.9996
192/469 [===========&gt;..................] - ETA: 6s - loss: 6.7827e-04 - accuracy: 0.9996
194/469 [===========&gt;..................] - ETA: 6s - loss: 6.7514e-04 - accuracy: 0.9996
196/469 [===========&gt;..................] - ETA: 6s - loss: 6.9115e-04 - accuracy: 0.9996
198/469 [===========&gt;..................] - ETA: 6s - loss: 6.8943e-04 - accuracy: 0.9996
200/469 [===========&gt;..................] - ETA: 6s - loss: 6.8780e-04 - accuracy: 0.9996
202/469 [===========&gt;..................] - ETA: 6s - loss: 6.8938e-04 - accuracy: 0.9996
204/469 [============&gt;.................] - ETA: 6s - loss: 6.9139e-04 - accuracy: 0.9996
206/469 [============&gt;.................] - ETA: 6s - loss: 6.9249e-04 - accuracy: 0.9996
208/469 [============&gt;.................] - ETA: 6s - loss: 6.9389e-04 - accuracy: 0.9996
210/469 [============&gt;.................] - ETA: 6s - loss: 6.9197e-04 - accuracy: 0.9996
212/469 [============&gt;.................] - ETA: 6s - loss: 6.8727e-04 - accuracy: 0.9996
214/469 [============&gt;.................] - ETA: 6s - loss: 6.8485e-04 - accuracy: 0.9996
216/469 [============&gt;.................] - ETA: 6s - loss: 6.8560e-04 - accuracy: 0.9996
218/469 [============&gt;.................] - ETA: 6s - loss: 6.8618e-04 - accuracy: 0.9996
220/469 [=============&gt;................] - ETA: 6s - loss: 6.8641e-04 - accuracy: 0.9996
222/469 [=============&gt;................] - ETA: 6s - loss: 6.8173e-04 - accuracy: 0.9996
225/469 [=============&gt;................] - ETA: 6s - loss: 6.8461e-04 - accuracy: 0.9996
228/469 [=============&gt;................] - ETA: 6s - loss: 6.8308e-04 - accuracy: 0.9996
231/469 [=============&gt;................] - ETA: 5s - loss: 6.8312e-04 - accuracy: 0.9996
233/469 [=============&gt;................] - ETA: 5s - loss: 6.8226e-04 - accuracy: 0.9996
235/469 [==============&gt;...............] - ETA: 5s - loss: 6.8457e-04 - accuracy: 0.9996
237/469 [==============&gt;...............] - ETA: 5s - loss: 6.8881e-04 - accuracy: 0.9996
240/469 [==============&gt;...............] - ETA: 5s - loss: 6.8594e-04 - accuracy: 0.9996
242/469 [==============&gt;...............] - ETA: 5s - loss: 6.8391e-04 - accuracy: 0.9996
244/469 [==============&gt;...............] - ETA: 5s - loss: 6.8066e-04 - accuracy: 0.9996
246/469 [==============&gt;...............] - ETA: 5s - loss: 6.7590e-04 - accuracy: 0.9997
248/469 [==============&gt;...............] - ETA: 5s - loss: 6.7224e-04 - accuracy: 0.9997
250/469 [==============&gt;...............] - ETA: 5s - loss: 6.6936e-04 - accuracy: 0.9997
252/469 [===============&gt;..............] - ETA: 5s - loss: 6.6800e-04 - accuracy: 0.9997
254/469 [===============&gt;..............] - ETA: 5s - loss: 6.7097e-04 - accuracy: 0.9997
256/469 [===============&gt;..............] - ETA: 5s - loss: 6.7389e-04 - accuracy: 0.9997
258/469 [===============&gt;..............] - ETA: 5s - loss: 6.7710e-04 - accuracy: 0.9997
260/469 [===============&gt;..............] - ETA: 5s - loss: 6.8533e-04 - accuracy: 0.9996
262/469 [===============&gt;..............] - ETA: 5s - loss: 6.8285e-04 - accuracy: 0.9996
264/469 [===============&gt;..............] - ETA: 5s - loss: 6.7998e-04 - accuracy: 0.9996
266/469 [================&gt;.............] - ETA: 5s - loss: 6.8631e-04 - accuracy: 0.9996
269/469 [================&gt;.............] - ETA: 5s - loss: 6.8357e-04 - accuracy: 0.9997
271/469 [================&gt;.............] - ETA: 4s - loss: 6.8241e-04 - accuracy: 0.9997
273/469 [================&gt;.............] - ETA: 4s - loss: 6.7977e-04 - accuracy: 0.9997
275/469 [================&gt;.............] - ETA: 4s - loss: 6.7937e-04 - accuracy: 0.9997
277/469 [================&gt;.............] - ETA: 4s - loss: 6.7678e-04 - accuracy: 0.9997
280/469 [================&gt;.............] - ETA: 4s - loss: 6.7804e-04 - accuracy: 0.9997
282/469 [=================&gt;............] - ETA: 4s - loss: 6.7356e-04 - accuracy: 0.9997
285/469 [=================&gt;............] - ETA: 4s - loss: 6.8067e-04 - accuracy: 0.9997
287/469 [=================&gt;............] - ETA: 4s - loss: 6.7918e-04 - accuracy: 0.9997
289/469 [=================&gt;............] - ETA: 4s - loss: 6.7475e-04 - accuracy: 0.9997
292/469 [=================&gt;............] - ETA: 4s - loss: 6.7348e-04 - accuracy: 0.9997
295/469 [=================&gt;............] - ETA: 4s - loss: 6.6907e-04 - accuracy: 0.9997
297/469 [=================&gt;............] - ETA: 4s - loss: 6.8101e-04 - accuracy: 0.9997
299/469 [==================&gt;...........] - ETA: 4s - loss: 6.7798e-04 - accuracy: 0.9997
301/469 [==================&gt;...........] - ETA: 4s - loss: 6.7617e-04 - accuracy: 0.9997
303/469 [==================&gt;...........] - ETA: 4s - loss: 6.7685e-04 - accuracy: 0.9997
305/469 [==================&gt;...........] - ETA: 4s - loss: 6.7441e-04 - accuracy: 0.9997
307/469 [==================&gt;...........] - ETA: 4s - loss: 6.8137e-04 - accuracy: 0.9997
309/469 [==================&gt;...........] - ETA: 4s - loss: 6.8190e-04 - accuracy: 0.9997
311/469 [==================&gt;...........] - ETA: 3s - loss: 6.8178e-04 - accuracy: 0.9997
313/469 [===================&gt;..........] - ETA: 3s - loss: 6.8209e-04 - accuracy: 0.9997
315/469 [===================&gt;..........] - ETA: 3s - loss: 6.8136e-04 - accuracy: 0.9997
318/469 [===================&gt;..........] - ETA: 3s - loss: 6.7896e-04 - accuracy: 0.9997
320/469 [===================&gt;..........] - ETA: 3s - loss: 6.7605e-04 - accuracy: 0.9997
322/469 [===================&gt;..........] - ETA: 3s - loss: 6.7336e-04 - accuracy: 0.9997
324/469 [===================&gt;..........] - ETA: 3s - loss: 6.8011e-04 - accuracy: 0.9997
326/469 [===================&gt;..........] - ETA: 3s - loss: 6.8137e-04 - accuracy: 0.9997
329/469 [====================&gt;.........] - ETA: 3s - loss: 6.8519e-04 - accuracy: 0.9997
331/469 [====================&gt;.........] - ETA: 3s - loss: 6.8760e-04 - accuracy: 0.9996
333/469 [====================&gt;.........] - ETA: 3s - loss: 6.8789e-04 - accuracy: 0.9996
335/469 [====================&gt;.........] - ETA: 3s - loss: 6.8763e-04 - accuracy: 0.9997
338/469 [====================&gt;.........] - ETA: 3s - loss: 6.8600e-04 - accuracy: 0.9997
340/469 [====================&gt;.........] - ETA: 3s - loss: 6.8297e-04 - accuracy: 0.9997
343/469 [====================&gt;.........] - ETA: 3s - loss: 6.7983e-04 - accuracy: 0.9997
346/469 [=====================&gt;........] - ETA: 3s - loss: 6.8052e-04 - accuracy: 0.9997
348/469 [=====================&gt;........] - ETA: 3s - loss: 6.7956e-04 - accuracy: 0.9997
351/469 [=====================&gt;........] - ETA: 2s - loss: 6.8173e-04 - accuracy: 0.9996
353/469 [=====================&gt;........] - ETA: 2s - loss: 6.8292e-04 - accuracy: 0.9996
355/469 [=====================&gt;........] - ETA: 2s - loss: 6.8581e-04 - accuracy: 0.9996
357/469 [=====================&gt;........] - ETA: 2s - loss: 6.8532e-04 - accuracy: 0.9996
359/469 [=====================&gt;........] - ETA: 2s - loss: 6.8197e-04 - accuracy: 0.9997
361/469 [======================&gt;.......] - ETA: 2s - loss: 6.8254e-04 - accuracy: 0.9997
363/469 [======================&gt;.......] - ETA: 2s - loss: 6.9144e-04 - accuracy: 0.9997
365/469 [======================&gt;.......] - ETA: 2s - loss: 6.9192e-04 - accuracy: 0.9997
368/469 [======================&gt;.......] - ETA: 2s - loss: 6.9335e-04 - accuracy: 0.9997
370/469 [======================&gt;.......] - ETA: 2s - loss: 6.9537e-04 - accuracy: 0.9997
373/469 [======================&gt;.......] - ETA: 2s - loss: 6.9362e-04 - accuracy: 0.9997
375/469 [======================&gt;.......] - ETA: 2s - loss: 6.9521e-04 - accuracy: 0.9997
378/469 [=======================&gt;......] - ETA: 2s - loss: 6.9426e-04 - accuracy: 0.9997
381/469 [=======================&gt;......] - ETA: 2s - loss: 6.9674e-04 - accuracy: 0.9997
383/469 [=======================&gt;......] - ETA: 2s - loss: 6.9540e-04 - accuracy: 0.9997
386/469 [=======================&gt;......] - ETA: 2s - loss: 7.0954e-04 - accuracy: 0.9997
388/469 [=======================&gt;......] - ETA: 2s - loss: 7.1057e-04 - accuracy: 0.9997
390/469 [=======================&gt;......] - ETA: 1s - loss: 7.0855e-04 - accuracy: 0.9997
392/469 [========================&gt;.....] - ETA: 1s - loss: 7.0788e-04 - accuracy: 0.9997
394/469 [========================&gt;.....] - ETA: 1s - loss: 7.0540e-04 - accuracy: 0.9997
396/469 [========================&gt;.....] - ETA: 1s - loss: 7.1818e-04 - accuracy: 0.9996
398/469 [========================&gt;.....] - ETA: 1s - loss: 7.2294e-04 - accuracy: 0.9996
400/469 [========================&gt;.....] - ETA: 1s - loss: 7.2613e-04 - accuracy: 0.9996
403/469 [========================&gt;.....] - ETA: 1s - loss: 7.3716e-04 - accuracy: 0.9996
406/469 [========================&gt;.....] - ETA: 1s - loss: 7.3653e-04 - accuracy: 0.9996
409/469 [=========================&gt;....] - ETA: 1s - loss: 7.4036e-04 - accuracy: 0.9996
411/469 [=========================&gt;....] - ETA: 1s - loss: 7.4349e-04 - accuracy: 0.9996
413/469 [=========================&gt;....] - ETA: 1s - loss: 7.4413e-04 - accuracy: 0.9996
415/469 [=========================&gt;....] - ETA: 1s - loss: 7.4242e-04 - accuracy: 0.9996
417/469 [=========================&gt;....] - ETA: 1s - loss: 7.4045e-04 - accuracy: 0.9996
419/469 [=========================&gt;....] - ETA: 1s - loss: 7.4025e-04 - accuracy: 0.9996
421/469 [=========================&gt;....] - ETA: 1s - loss: 7.5963e-04 - accuracy: 0.9996
423/469 [==========================&gt;...] - ETA: 1s - loss: 7.6342e-04 - accuracy: 0.9996
425/469 [==========================&gt;...] - ETA: 1s - loss: 7.6250e-04 - accuracy: 0.9996
427/469 [==========================&gt;...] - ETA: 1s - loss: 7.5911e-04 - accuracy: 0.9996
430/469 [==========================&gt;...] - ETA: 0s - loss: 7.6163e-04 - accuracy: 0.9996
432/469 [==========================&gt;...] - ETA: 0s - loss: 7.6156e-04 - accuracy: 0.9996
435/469 [==========================&gt;...] - ETA: 0s - loss: 7.6497e-04 - accuracy: 0.9996
437/469 [==========================&gt;...] - ETA: 0s - loss: 7.6621e-04 - accuracy: 0.9996
439/469 [===========================&gt;..] - ETA: 0s - loss: 7.6338e-04 - accuracy: 0.9996
442/469 [===========================&gt;..] - ETA: 0s - loss: 7.6071e-04 - accuracy: 0.9996
444/469 [===========================&gt;..] - ETA: 0s - loss: 7.6106e-04 - accuracy: 0.9996
446/469 [===========================&gt;..] - ETA: 0s - loss: 7.5913e-04 - accuracy: 0.9996
448/469 [===========================&gt;..] - ETA: 0s - loss: 7.6057e-04 - accuracy: 0.9996
450/469 [===========================&gt;..] - ETA: 0s - loss: 7.5944e-04 - accuracy: 0.9996
452/469 [===========================&gt;..] - ETA: 0s - loss: 7.5897e-04 - accuracy: 0.9996
454/469 [============================&gt;.] - ETA: 0s - loss: 7.5756e-04 - accuracy: 0.9996
456/469 [============================&gt;.] - ETA: 0s - loss: 7.5886e-04 - accuracy: 0.9996
458/469 [============================&gt;.] - ETA: 0s - loss: 7.5594e-04 - accuracy: 0.9996
461/469 [============================&gt;.] - ETA: 0s - loss: 7.5289e-04 - accuracy: 0.9996
463/469 [============================&gt;.] - ETA: 0s - loss: 7.5414e-04 - accuracy: 0.9996
465/469 [============================&gt;.] - ETA: 0s - loss: 7.5090e-04 - accuracy: 0.9996
467/469 [============================&gt;.] - ETA: 0s - loss: 7.5015e-04 - accuracy: 0.9996
469/469 [==============================] - 12s 26ms/step - loss: 7.4771e-04 - accuracy: 0.9996 - val_loss: 0.0045 - val_accuracy: 0.9942 - lr: 1.5849e-04
Test score: 0.004506327677518129
Test accuracy: 0.9941999912261963
</pre></div>
</div>
<p>Saving the model weights as <code class="docutils literal notranslate"><span class="pre">mnistnet_act_fp_wgt_fp.hdf5</span></code> to reload
them as init weights for the quantization step:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is not mandatory but helps with training speed.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">temp_dir</span> <span class="o">=</span> <span class="n">TemporaryDirectory</span><span class="p">()</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;mnistnet_act_fp_wgt_fp.hdf5&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="model-quantization-and-training">
<h2>4. Model quantization and training<a class="headerlink" href="#model-quantization-and-training" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quantize-the-model">
<h3>4.1 Quantize the model<a class="headerlink" href="#quantize-the-model" title="Permalink to this headline">¶</a></h3>
<p>We can now turn to training a discretized version of the model, where
the weights and activations are quantized so as to be suitable for
implementation in the Akida NSoC.</p>
<p>For this, we just have to change very slightly the definition of the
model used above, changing just the values of <code class="docutils literal notranslate"><span class="pre">weight_quantization</span></code>
and <code class="docutils literal notranslate"><span class="pre">activ_quantization</span></code> used for the blocks (but still with no output
nonlinearity for the final block). Additionally, we’ll initialise the
model using the set of pre-trained weights that we just saved (not so
important here, but for more complex datasets can make a huge difference
both to the accuracy level ultimately achieved and to the speed of
convergence).</p>
<p>Note that, for more challenging datasets, it may also be useful to make
stepwise changes towards a fully quantized model - e.g. by first
training with only the activations quantized, re-saving, and then adding
the quantized weights. Additionally, the toolkit documentation describes
how one can go further, optimizing the degree of sparsity in the model
to reduce computational cost while maintaining accuracy. In this first
example however, we’ll stick to a one step conversion (mainly because
the MNIST dataset simply isn’t complex enough to see the benefit of the
advanced techniques).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Removes all the nodes left over from the previous model and free memory</span>
<span class="n">K</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>

<span class="n">img_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span>
               <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
               <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
               <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
               <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv_0&#39;</span><span class="p">,</span>
               <span class="n">weight_quantization</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">activ_quantization</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">pooling</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
               <span class="n">add_batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
               <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
               <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
               <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
               <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv_1&#39;</span><span class="p">,</span>
               <span class="n">weight_quantization</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">activ_quantization</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">pooling</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
               <span class="n">add_batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">conv_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
               <span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
               <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
               <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
               <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv_2&#39;</span><span class="p">,</span>
               <span class="n">weight_quantization</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">activ_quantization</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">add_batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">dense_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                <span class="n">units</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dense_2&#39;</span><span class="p">,</span>
                <span class="n">weight_quantization</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">activ_quantization</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">add_batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">dense_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                <span class="n">units</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dense_3&#39;</span><span class="p">,</span>
                <span class="n">weight_quantization</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">activ_quantization</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">model_keras</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mnistnet_quantized&#39;</span><span class="p">)</span>
<span class="n">lr_start</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="n">lr_start</span><span class="p">)</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># Reload previously computed weights as init weights for the quantization step</span>
<span class="n">load_status</span> <span class="o">=</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;mnistnet_act_fp_wgt_fp.hdf5&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Model: &quot;mnistnet_quantized&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         [(None, 28, 28, 1)]       0
_________________________________________________________________
conv_0 (QuantizedConv2D)     (None, 28, 28, 32)        800
_________________________________________________________________
conv_0_maxpool (MaxPooling2D (None, 14, 14, 32)        0
_________________________________________________________________
conv_0_BN (BatchNormalizatio (None, 14, 14, 32)        128
_________________________________________________________________
conv_0_relu (ActivationDiscr (None, 14, 14, 32)        0
_________________________________________________________________
conv_1 (QuantizedConv2D)     (None, 14, 14, 32)        25600
_________________________________________________________________
conv_1_maxpool (MaxPooling2D (None, 7, 7, 32)          0
_________________________________________________________________
conv_1_BN (BatchNormalizatio (None, 7, 7, 32)          128
_________________________________________________________________
conv_1_relu (ActivationDiscr (None, 7, 7, 32)          0
_________________________________________________________________
conv_2 (QuantizedConv2D)     (None, 7, 7, 32)          25600
_________________________________________________________________
conv_2_BN (BatchNormalizatio (None, 7, 7, 32)          128
_________________________________________________________________
conv_2_relu (ActivationDiscr (None, 7, 7, 32)          0
_________________________________________________________________
flatten (Flatten)            (None, 1568)              0
_________________________________________________________________
dense_2 (QuantizedDense)     (None, 512)               802816
_________________________________________________________________
dense_2_BN (BatchNormalizati (None, 512)               2048
_________________________________________________________________
dense_2_relu (ActivationDisc (None, 512)               0
_________________________________________________________________
dense_3 (QuantizedDense)     (None, 10)                5120
=================================================================
Total params: 862,368
Trainable params: 861,152
Non-trainable params: 1,216
_________________________________________________________________
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>4.2 Performance check<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Re-train and save the quantized model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lr_scheduler</span> <span class="o">=</span> <span class="n">LearningRateScheduler</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">lr_start</span> <span class="o">*</span> <span class="n">lr_decay</span><span class="o">**</span><span class="n">e</span><span class="p">)</span>
<span class="n">callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lr_scheduler</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span>
                          <span class="n">y_train</span><span class="p">,</span>
                          <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                          <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span>
                          <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test score:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Epoch 1/5

  1/469 [..............................] - ETA: 0s - loss: 0.1591 - accuracy: 0.7734
  3/469 [..............................] - ETA: 9s - loss: 0.1164 - accuracy: 0.8646
  5/469 [..............................] - ETA: 11s - loss: 0.1044 - accuracy: 0.8875
  7/469 [..............................] - ETA: 11s - loss: 0.0956 - accuracy: 0.8962
  9/469 [..............................] - ETA: 12s - loss: 0.0895 - accuracy: 0.8984
 11/469 [..............................] - ETA: 12s - loss: 0.0810 - accuracy: 0.9062
 13/469 [..............................] - ETA: 12s - loss: 0.0781 - accuracy: 0.9075
 15/469 [..............................] - ETA: 12s - loss: 0.0721 - accuracy: 0.9161
 17/469 [&gt;.............................] - ETA: 12s - loss: 0.0682 - accuracy: 0.9200
 19/469 [&gt;.............................] - ETA: 12s - loss: 0.0641 - accuracy: 0.9239
 21/469 [&gt;.............................] - ETA: 12s - loss: 0.0622 - accuracy: 0.9271
 23/469 [&gt;.............................] - ETA: 12s - loss: 0.0598 - accuracy: 0.9297
 25/469 [&gt;.............................] - ETA: 12s - loss: 0.0578 - accuracy: 0.9316
 27/469 [&gt;.............................] - ETA: 12s - loss: 0.0560 - accuracy: 0.9343
 29/469 [&gt;.............................] - ETA: 12s - loss: 0.0542 - accuracy: 0.9367
 31/469 [&gt;.............................] - ETA: 12s - loss: 0.0526 - accuracy: 0.9383
 33/469 [=&gt;............................] - ETA: 12s - loss: 0.0509 - accuracy: 0.9406
 35/469 [=&gt;............................] - ETA: 12s - loss: 0.0495 - accuracy: 0.9417
 37/469 [=&gt;............................] - ETA: 12s - loss: 0.0484 - accuracy: 0.9434
 39/469 [=&gt;............................] - ETA: 12s - loss: 0.0475 - accuracy: 0.9445
 41/469 [=&gt;............................] - ETA: 12s - loss: 0.0463 - accuracy: 0.9463
 43/469 [=&gt;............................] - ETA: 12s - loss: 0.0452 - accuracy: 0.9479
 45/469 [=&gt;............................] - ETA: 12s - loss: 0.0439 - accuracy: 0.9495
 47/469 [==&gt;...........................] - ETA: 12s - loss: 0.0430 - accuracy: 0.9501
 49/469 [==&gt;...........................] - ETA: 12s - loss: 0.0420 - accuracy: 0.9512
 51/469 [==&gt;...........................] - ETA: 12s - loss: 0.0412 - accuracy: 0.9524
 53/469 [==&gt;...........................] - ETA: 12s - loss: 0.0407 - accuracy: 0.9522
 55/469 [==&gt;...........................] - ETA: 12s - loss: 0.0403 - accuracy: 0.9530
 57/469 [==&gt;...........................] - ETA: 12s - loss: 0.0393 - accuracy: 0.9542
 59/469 [==&gt;...........................] - ETA: 12s - loss: 0.0383 - accuracy: 0.9555
 61/469 [==&gt;...........................] - ETA: 11s - loss: 0.0375 - accuracy: 0.9568
 63/469 [===&gt;..........................] - ETA: 11s - loss: 0.0370 - accuracy: 0.9577
 65/469 [===&gt;..........................] - ETA: 11s - loss: 0.0368 - accuracy: 0.9582
 67/469 [===&gt;..........................] - ETA: 11s - loss: 0.0363 - accuracy: 0.9587
 69/469 [===&gt;..........................] - ETA: 11s - loss: 0.0357 - accuracy: 0.9594
 71/469 [===&gt;..........................] - ETA: 11s - loss: 0.0354 - accuracy: 0.9594
 73/469 [===&gt;..........................] - ETA: 11s - loss: 0.0351 - accuracy: 0.9594
 75/469 [===&gt;..........................] - ETA: 11s - loss: 0.0352 - accuracy: 0.9592
 77/469 [===&gt;..........................] - ETA: 11s - loss: 0.0348 - accuracy: 0.9599
 79/469 [====&gt;.........................] - ETA: 11s - loss: 0.0346 - accuracy: 0.9600
 81/469 [====&gt;.........................] - ETA: 11s - loss: 0.0344 - accuracy: 0.9600
 83/469 [====&gt;.........................] - ETA: 11s - loss: 0.0342 - accuracy: 0.9601
 85/469 [====&gt;.........................] - ETA: 11s - loss: 0.0339 - accuracy: 0.9605
 87/469 [====&gt;.........................] - ETA: 11s - loss: 0.0337 - accuracy: 0.9608
 89/469 [====&gt;.........................] - ETA: 11s - loss: 0.0333 - accuracy: 0.9613
 91/469 [====&gt;.........................] - ETA: 11s - loss: 0.0332 - accuracy: 0.9615
 93/469 [====&gt;.........................] - ETA: 11s - loss: 0.0328 - accuracy: 0.9619
 95/469 [=====&gt;........................] - ETA: 11s - loss: 0.0326 - accuracy: 0.9623
 97/469 [=====&gt;........................] - ETA: 11s - loss: 0.0323 - accuracy: 0.9625
 99/469 [=====&gt;........................] - ETA: 10s - loss: 0.0321 - accuracy: 0.9626
101/469 [=====&gt;........................] - ETA: 10s - loss: 0.0319 - accuracy: 0.9627
103/469 [=====&gt;........................] - ETA: 10s - loss: 0.0317 - accuracy: 0.9631
105/469 [=====&gt;........................] - ETA: 10s - loss: 0.0314 - accuracy: 0.9633
107/469 [=====&gt;........................] - ETA: 10s - loss: 0.0314 - accuracy: 0.9633
109/469 [=====&gt;........................] - ETA: 10s - loss: 0.0310 - accuracy: 0.9638
111/469 [======&gt;.......................] - ETA: 10s - loss: 0.0310 - accuracy: 0.9640
113/469 [======&gt;.......................] - ETA: 10s - loss: 0.0307 - accuracy: 0.9644
115/469 [======&gt;.......................] - ETA: 10s - loss: 0.0306 - accuracy: 0.9647
117/469 [======&gt;.......................] - ETA: 10s - loss: 0.0303 - accuracy: 0.9651
119/469 [======&gt;.......................] - ETA: 10s - loss: 0.0300 - accuracy: 0.9654
121/469 [======&gt;.......................] - ETA: 10s - loss: 0.0296 - accuracy: 0.9658
123/469 [======&gt;.......................] - ETA: 10s - loss: 0.0293 - accuracy: 0.9663
125/469 [======&gt;.......................] - ETA: 10s - loss: 0.0293 - accuracy: 0.9664
127/469 [=======&gt;......................] - ETA: 10s - loss: 0.0292 - accuracy: 0.9667
129/469 [=======&gt;......................] - ETA: 10s - loss: 0.0290 - accuracy: 0.9668
131/469 [=======&gt;......................] - ETA: 10s - loss: 0.0288 - accuracy: 0.9670
133/469 [=======&gt;......................] - ETA: 10s - loss: 0.0286 - accuracy: 0.9674
135/469 [=======&gt;......................] - ETA: 9s - loss: 0.0284 - accuracy: 0.9677 
137/469 [=======&gt;......................] - ETA: 9s - loss: 0.0283 - accuracy: 0.9678
139/469 [=======&gt;......................] - ETA: 9s - loss: 0.0282 - accuracy: 0.9680
141/469 [========&gt;.....................] - ETA: 9s - loss: 0.0279 - accuracy: 0.9683
143/469 [========&gt;.....................] - ETA: 9s - loss: 0.0279 - accuracy: 0.9683
145/469 [========&gt;.....................] - ETA: 9s - loss: 0.0277 - accuracy: 0.9686
147/469 [========&gt;.....................] - ETA: 9s - loss: 0.0276 - accuracy: 0.9688
149/469 [========&gt;.....................] - ETA: 9s - loss: 0.0273 - accuracy: 0.9691
151/469 [========&gt;.....................] - ETA: 9s - loss: 0.0274 - accuracy: 0.9692
153/469 [========&gt;.....................] - ETA: 9s - loss: 0.0272 - accuracy: 0.9694
155/469 [========&gt;.....................] - ETA: 9s - loss: 0.0272 - accuracy: 0.9694
157/469 [=========&gt;....................] - ETA: 9s - loss: 0.0270 - accuracy: 0.9696
159/469 [=========&gt;....................] - ETA: 9s - loss: 0.0269 - accuracy: 0.9697
161/469 [=========&gt;....................] - ETA: 9s - loss: 0.0268 - accuracy: 0.9698
163/469 [=========&gt;....................] - ETA: 9s - loss: 0.0268 - accuracy: 0.9696
165/469 [=========&gt;....................] - ETA: 9s - loss: 0.0267 - accuracy: 0.9697
167/469 [=========&gt;....................] - ETA: 9s - loss: 0.0266 - accuracy: 0.9698
169/469 [=========&gt;....................] - ETA: 8s - loss: 0.0266 - accuracy: 0.9697
171/469 [=========&gt;....................] - ETA: 8s - loss: 0.0264 - accuracy: 0.9700
173/469 [==========&gt;...................] - ETA: 8s - loss: 0.0263 - accuracy: 0.9701
175/469 [==========&gt;...................] - ETA: 8s - loss: 0.0262 - accuracy: 0.9703
177/469 [==========&gt;...................] - ETA: 8s - loss: 0.0260 - accuracy: 0.9704
179/469 [==========&gt;...................] - ETA: 8s - loss: 0.0260 - accuracy: 0.9704
181/469 [==========&gt;...................] - ETA: 8s - loss: 0.0260 - accuracy: 0.9704
183/469 [==========&gt;...................] - ETA: 8s - loss: 0.0259 - accuracy: 0.9706
185/469 [==========&gt;...................] - ETA: 8s - loss: 0.0259 - accuracy: 0.9707
187/469 [==========&gt;...................] - ETA: 8s - loss: 0.0258 - accuracy: 0.9709
189/469 [===========&gt;..................] - ETA: 8s - loss: 0.0258 - accuracy: 0.9709
191/469 [===========&gt;..................] - ETA: 8s - loss: 0.0258 - accuracy: 0.9710
193/469 [===========&gt;..................] - ETA: 8s - loss: 0.0258 - accuracy: 0.9709
195/469 [===========&gt;..................] - ETA: 8s - loss: 0.0258 - accuracy: 0.9707
197/469 [===========&gt;..................] - ETA: 8s - loss: 0.0258 - accuracy: 0.9708
199/469 [===========&gt;..................] - ETA: 8s - loss: 0.0257 - accuracy: 0.9708
201/469 [===========&gt;..................] - ETA: 7s - loss: 0.0258 - accuracy: 0.9706
203/469 [===========&gt;..................] - ETA: 7s - loss: 0.0258 - accuracy: 0.9706
205/469 [============&gt;.................] - ETA: 7s - loss: 0.0256 - accuracy: 0.9708
207/469 [============&gt;.................] - ETA: 7s - loss: 0.0255 - accuracy: 0.9710
209/469 [============&gt;.................] - ETA: 7s - loss: 0.0254 - accuracy: 0.9711
211/469 [============&gt;.................] - ETA: 7s - loss: 0.0253 - accuracy: 0.9712
213/469 [============&gt;.................] - ETA: 7s - loss: 0.0252 - accuracy: 0.9714
215/469 [============&gt;.................] - ETA: 7s - loss: 0.0251 - accuracy: 0.9714
217/469 [============&gt;.................] - ETA: 7s - loss: 0.0250 - accuracy: 0.9716
219/469 [=============&gt;................] - ETA: 7s - loss: 0.0249 - accuracy: 0.9716
221/469 [=============&gt;................] - ETA: 7s - loss: 0.0248 - accuracy: 0.9718
223/469 [=============&gt;................] - ETA: 7s - loss: 0.0247 - accuracy: 0.9718
225/469 [=============&gt;................] - ETA: 7s - loss: 0.0246 - accuracy: 0.9720
227/469 [=============&gt;................] - ETA: 7s - loss: 0.0246 - accuracy: 0.9719
229/469 [=============&gt;................] - ETA: 7s - loss: 0.0245 - accuracy: 0.9719
231/469 [=============&gt;................] - ETA: 7s - loss: 0.0244 - accuracy: 0.9720
233/469 [=============&gt;................] - ETA: 7s - loss: 0.0242 - accuracy: 0.9722
235/469 [==============&gt;...............] - ETA: 6s - loss: 0.0241 - accuracy: 0.9722
237/469 [==============&gt;...............] - ETA: 6s - loss: 0.0240 - accuracy: 0.9723
239/469 [==============&gt;...............] - ETA: 6s - loss: 0.0239 - accuracy: 0.9724
241/469 [==============&gt;...............] - ETA: 6s - loss: 0.0238 - accuracy: 0.9725
243/469 [==============&gt;...............] - ETA: 6s - loss: 0.0238 - accuracy: 0.9726
245/469 [==============&gt;...............] - ETA: 6s - loss: 0.0237 - accuracy: 0.9727
247/469 [==============&gt;...............] - ETA: 6s - loss: 0.0236 - accuracy: 0.9729
249/469 [==============&gt;...............] - ETA: 6s - loss: 0.0236 - accuracy: 0.9728
251/469 [===============&gt;..............] - ETA: 6s - loss: 0.0235 - accuracy: 0.9730
253/469 [===============&gt;..............] - ETA: 6s - loss: 0.0234 - accuracy: 0.9730
255/469 [===============&gt;..............] - ETA: 6s - loss: 0.0233 - accuracy: 0.9731
257/469 [===============&gt;..............] - ETA: 6s - loss: 0.0232 - accuracy: 0.9733
259/469 [===============&gt;..............] - ETA: 6s - loss: 0.0231 - accuracy: 0.9735
261/469 [===============&gt;..............] - ETA: 6s - loss: 0.0230 - accuracy: 0.9736
263/469 [===============&gt;..............] - ETA: 6s - loss: 0.0230 - accuracy: 0.9737
265/469 [===============&gt;..............] - ETA: 6s - loss: 0.0230 - accuracy: 0.9736
267/469 [================&gt;.............] - ETA: 6s - loss: 0.0229 - accuracy: 0.9738
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0228 - accuracy: 0.9739
271/469 [================&gt;.............] - ETA: 5s - loss: 0.0227 - accuracy: 0.9740
273/469 [================&gt;.............] - ETA: 5s - loss: 0.0226 - accuracy: 0.9741
275/469 [================&gt;.............] - ETA: 5s - loss: 0.0225 - accuracy: 0.9742
277/469 [================&gt;.............] - ETA: 5s - loss: 0.0225 - accuracy: 0.9742
279/469 [================&gt;.............] - ETA: 5s - loss: 0.0224 - accuracy: 0.9743
281/469 [================&gt;.............] - ETA: 5s - loss: 0.0223 - accuracy: 0.9744
283/469 [=================&gt;............] - ETA: 5s - loss: 0.0222 - accuracy: 0.9744
285/469 [=================&gt;............] - ETA: 5s - loss: 0.0222 - accuracy: 0.9744
287/469 [=================&gt;............] - ETA: 5s - loss: 0.0222 - accuracy: 0.9745
289/469 [=================&gt;............] - ETA: 5s - loss: 0.0221 - accuracy: 0.9746
291/469 [=================&gt;............] - ETA: 5s - loss: 0.0221 - accuracy: 0.9745
293/469 [=================&gt;............] - ETA: 5s - loss: 0.0221 - accuracy: 0.9746
295/469 [=================&gt;............] - ETA: 5s - loss: 0.0220 - accuracy: 0.9746
297/469 [=================&gt;............] - ETA: 5s - loss: 0.0219 - accuracy: 0.9747
299/469 [==================&gt;...........] - ETA: 5s - loss: 0.0218 - accuracy: 0.9748
301/469 [==================&gt;...........] - ETA: 5s - loss: 0.0219 - accuracy: 0.9747
303/469 [==================&gt;...........] - ETA: 4s - loss: 0.0218 - accuracy: 0.9748
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0217 - accuracy: 0.9749
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0217 - accuracy: 0.9750
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0217 - accuracy: 0.9749
311/469 [==================&gt;...........] - ETA: 4s - loss: 0.0216 - accuracy: 0.9750
313/469 [===================&gt;..........] - ETA: 4s - loss: 0.0216 - accuracy: 0.9750
315/469 [===================&gt;..........] - ETA: 4s - loss: 0.0215 - accuracy: 0.9751
317/469 [===================&gt;..........] - ETA: 4s - loss: 0.0215 - accuracy: 0.9751
319/469 [===================&gt;..........] - ETA: 4s - loss: 0.0214 - accuracy: 0.9752
321/469 [===================&gt;..........] - ETA: 4s - loss: 0.0214 - accuracy: 0.9752
323/469 [===================&gt;..........] - ETA: 4s - loss: 0.0213 - accuracy: 0.9753
325/469 [===================&gt;..........] - ETA: 4s - loss: 0.0213 - accuracy: 0.9754
327/469 [===================&gt;..........] - ETA: 4s - loss: 0.0212 - accuracy: 0.9755
329/469 [====================&gt;.........] - ETA: 4s - loss: 0.0212 - accuracy: 0.9755
331/469 [====================&gt;.........] - ETA: 4s - loss: 0.0212 - accuracy: 0.9755
333/469 [====================&gt;.........] - ETA: 4s - loss: 0.0211 - accuracy: 0.9756
335/469 [====================&gt;.........] - ETA: 3s - loss: 0.0211 - accuracy: 0.9755
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0211 - accuracy: 0.9756
339/469 [====================&gt;.........] - ETA: 3s - loss: 0.0211 - accuracy: 0.9755
341/469 [====================&gt;.........] - ETA: 3s - loss: 0.0210 - accuracy: 0.9756
343/469 [====================&gt;.........] - ETA: 3s - loss: 0.0210 - accuracy: 0.9756
345/469 [=====================&gt;........] - ETA: 3s - loss: 0.0211 - accuracy: 0.9755
347/469 [=====================&gt;........] - ETA: 3s - loss: 0.0211 - accuracy: 0.9755
349/469 [=====================&gt;........] - ETA: 3s - loss: 0.0210 - accuracy: 0.9755
351/469 [=====================&gt;........] - ETA: 3s - loss: 0.0210 - accuracy: 0.9755
353/469 [=====================&gt;........] - ETA: 3s - loss: 0.0210 - accuracy: 0.9755
355/469 [=====================&gt;........] - ETA: 3s - loss: 0.0209 - accuracy: 0.9756
357/469 [=====================&gt;........] - ETA: 3s - loss: 0.0209 - accuracy: 0.9756
359/469 [=====================&gt;........] - ETA: 3s - loss: 0.0209 - accuracy: 0.9756
361/469 [======================&gt;.......] - ETA: 3s - loss: 0.0209 - accuracy: 0.9757
363/469 [======================&gt;.......] - ETA: 3s - loss: 0.0208 - accuracy: 0.9757
365/469 [======================&gt;.......] - ETA: 3s - loss: 0.0208 - accuracy: 0.9757
367/469 [======================&gt;.......] - ETA: 3s - loss: 0.0208 - accuracy: 0.9758
369/469 [======================&gt;.......] - ETA: 2s - loss: 0.0207 - accuracy: 0.9758
371/469 [======================&gt;.......] - ETA: 2s - loss: 0.0207 - accuracy: 0.9759
373/469 [======================&gt;.......] - ETA: 2s - loss: 0.0206 - accuracy: 0.9759
375/469 [======================&gt;.......] - ETA: 2s - loss: 0.0206 - accuracy: 0.9760
377/469 [=======================&gt;......] - ETA: 2s - loss: 0.0205 - accuracy: 0.9761
379/469 [=======================&gt;......] - ETA: 2s - loss: 0.0205 - accuracy: 0.9761
381/469 [=======================&gt;......] - ETA: 2s - loss: 0.0205 - accuracy: 0.9761
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0204 - accuracy: 0.9762
385/469 [=======================&gt;......] - ETA: 2s - loss: 0.0203 - accuracy: 0.9763
387/469 [=======================&gt;......] - ETA: 2s - loss: 0.0203 - accuracy: 0.9763
389/469 [=======================&gt;......] - ETA: 2s - loss: 0.0202 - accuracy: 0.9763
391/469 [========================&gt;.....] - ETA: 2s - loss: 0.0202 - accuracy: 0.9764
393/469 [========================&gt;.....] - ETA: 2s - loss: 0.0202 - accuracy: 0.9764
395/469 [========================&gt;.....] - ETA: 2s - loss: 0.0202 - accuracy: 0.9765
397/469 [========================&gt;.....] - ETA: 2s - loss: 0.0201 - accuracy: 0.9766
399/469 [========================&gt;.....] - ETA: 2s - loss: 0.0201 - accuracy: 0.9766
401/469 [========================&gt;.....] - ETA: 2s - loss: 0.0201 - accuracy: 0.9766
403/469 [========================&gt;.....] - ETA: 1s - loss: 0.0201 - accuracy: 0.9766
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0200 - accuracy: 0.9766
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0200 - accuracy: 0.9767
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0200 - accuracy: 0.9767
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0200 - accuracy: 0.9766
413/469 [=========================&gt;....] - ETA: 1s - loss: 0.0200 - accuracy: 0.9767
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0200 - accuracy: 0.9767
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0199 - accuracy: 0.9767
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0200 - accuracy: 0.9766
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0200 - accuracy: 0.9766
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0199 - accuracy: 0.9766
425/469 [==========================&gt;...] - ETA: 1s - loss: 0.0200 - accuracy: 0.9766
427/469 [==========================&gt;...] - ETA: 1s - loss: 0.0199 - accuracy: 0.9766
429/469 [==========================&gt;...] - ETA: 1s - loss: 0.0199 - accuracy: 0.9766
431/469 [==========================&gt;...] - ETA: 1s - loss: 0.0199 - accuracy: 0.9767
433/469 [==========================&gt;...] - ETA: 1s - loss: 0.0198 - accuracy: 0.9767
435/469 [==========================&gt;...] - ETA: 1s - loss: 0.0198 - accuracy: 0.9767
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0198 - accuracy: 0.9767
439/469 [===========================&gt;..] - ETA: 0s - loss: 0.0198 - accuracy: 0.9767
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0198 - accuracy: 0.9768
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0198 - accuracy: 0.9767
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0198 - accuracy: 0.9768
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0198 - accuracy: 0.9768
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0197 - accuracy: 0.9768
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0197 - accuracy: 0.9769
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0197 - accuracy: 0.9769
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0197 - accuracy: 0.9769
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0196 - accuracy: 0.9770
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0196 - accuracy: 0.9770
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0196 - accuracy: 0.9771
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0195 - accuracy: 0.9772
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0195 - accuracy: 0.9772
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0195 - accuracy: 0.9772
469/469 [==============================] - ETA: 0s - loss: 0.0194 - accuracy: 0.9773
469/469 [==============================] - 15s 31ms/step - loss: 0.0194 - accuracy: 0.9773 - val_loss: 0.0151 - val_accuracy: 0.9819 - lr: 0.0010
Epoch 2/5

  1/469 [..............................] - ETA: 0s - loss: 0.0055 - accuracy: 1.0000
  3/469 [..............................] - ETA: 9s - loss: 0.0095 - accuracy: 0.9922
  5/469 [..............................] - ETA: 11s - loss: 0.0100 - accuracy: 0.9906
  7/469 [..............................] - ETA: 11s - loss: 0.0104 - accuracy: 0.9900
  9/469 [..............................] - ETA: 12s - loss: 0.0103 - accuracy: 0.9896
 11/469 [..............................] - ETA: 12s - loss: 0.0101 - accuracy: 0.9893
 13/469 [..............................] - ETA: 12s - loss: 0.0101 - accuracy: 0.9892
 15/469 [..............................] - ETA: 12s - loss: 0.0110 - accuracy: 0.9875
 17/469 [&gt;.............................] - ETA: 12s - loss: 0.0105 - accuracy: 0.9881
 19/469 [&gt;.............................] - ETA: 12s - loss: 0.0104 - accuracy: 0.9881
 21/469 [&gt;.............................] - ETA: 12s - loss: 0.0101 - accuracy: 0.9888
 23/469 [&gt;.............................] - ETA: 12s - loss: 0.0096 - accuracy: 0.9898
 25/469 [&gt;.............................] - ETA: 12s - loss: 0.0094 - accuracy: 0.9897
 27/469 [&gt;.............................] - ETA: 12s - loss: 0.0098 - accuracy: 0.9890
 29/469 [&gt;.............................] - ETA: 12s - loss: 0.0095 - accuracy: 0.9898
 31/469 [&gt;.............................] - ETA: 12s - loss: 0.0092 - accuracy: 0.9902
 33/469 [=&gt;............................] - ETA: 12s - loss: 0.0093 - accuracy: 0.9901
 35/469 [=&gt;............................] - ETA: 12s - loss: 0.0091 - accuracy: 0.9904
 37/469 [=&gt;............................] - ETA: 12s - loss: 0.0091 - accuracy: 0.9905
 39/469 [=&gt;............................] - ETA: 12s - loss: 0.0090 - accuracy: 0.9904
 41/469 [=&gt;............................] - ETA: 12s - loss: 0.0091 - accuracy: 0.9899
 43/469 [=&gt;............................] - ETA: 12s - loss: 0.0092 - accuracy: 0.9895
 45/469 [=&gt;............................] - ETA: 12s - loss: 0.0093 - accuracy: 0.9891
 47/469 [==&gt;...........................] - ETA: 12s - loss: 0.0097 - accuracy: 0.9887
 49/469 [==&gt;...........................] - ETA: 12s - loss: 0.0101 - accuracy: 0.9884
 51/469 [==&gt;...........................] - ETA: 12s - loss: 0.0103 - accuracy: 0.9881
 53/469 [==&gt;...........................] - ETA: 12s - loss: 0.0104 - accuracy: 0.9878
 55/469 [==&gt;...........................] - ETA: 12s - loss: 0.0102 - accuracy: 0.9879
 57/469 [==&gt;...........................] - ETA: 12s - loss: 0.0100 - accuracy: 0.9881
 59/469 [==&gt;...........................] - ETA: 12s - loss: 0.0099 - accuracy: 0.9883
 61/469 [==&gt;...........................] - ETA: 12s - loss: 0.0100 - accuracy: 0.9882
 63/469 [===&gt;..........................] - ETA: 11s - loss: 0.0100 - accuracy: 0.9883
 65/469 [===&gt;..........................] - ETA: 11s - loss: 0.0099 - accuracy: 0.9885
 67/469 [===&gt;..........................] - ETA: 11s - loss: 0.0099 - accuracy: 0.9885
 69/469 [===&gt;..........................] - ETA: 11s - loss: 0.0098 - accuracy: 0.9886
 71/469 [===&gt;..........................] - ETA: 11s - loss: 0.0097 - accuracy: 0.9888
 73/469 [===&gt;..........................] - ETA: 11s - loss: 0.0098 - accuracy: 0.9888
 75/469 [===&gt;..........................] - ETA: 11s - loss: 0.0097 - accuracy: 0.9887
 77/469 [===&gt;..........................] - ETA: 11s - loss: 0.0096 - accuracy: 0.9889
 79/469 [====&gt;.........................] - ETA: 11s - loss: 0.0094 - accuracy: 0.9892
 81/469 [====&gt;.........................] - ETA: 11s - loss: 0.0096 - accuracy: 0.9891
 83/469 [====&gt;.........................] - ETA: 11s - loss: 0.0095 - accuracy: 0.9892
 85/469 [====&gt;.........................] - ETA: 11s - loss: 0.0095 - accuracy: 0.9892
 87/469 [====&gt;.........................] - ETA: 11s - loss: 0.0095 - accuracy: 0.9891
 89/469 [====&gt;.........................] - ETA: 11s - loss: 0.0095 - accuracy: 0.9890
 91/469 [====&gt;.........................] - ETA: 11s - loss: 0.0095 - accuracy: 0.9892
 93/469 [====&gt;.........................] - ETA: 11s - loss: 0.0095 - accuracy: 0.9892
 95/469 [=====&gt;........................] - ETA: 11s - loss: 0.0094 - accuracy: 0.9892
 97/469 [=====&gt;........................] - ETA: 11s - loss: 0.0096 - accuracy: 0.9890
 99/469 [=====&gt;........................] - ETA: 10s - loss: 0.0094 - accuracy: 0.9892
101/469 [=====&gt;........................] - ETA: 10s - loss: 0.0095 - accuracy: 0.9890
103/469 [=====&gt;........................] - ETA: 10s - loss: 0.0095 - accuracy: 0.9890
105/469 [=====&gt;........................] - ETA: 10s - loss: 0.0095 - accuracy: 0.9891
107/469 [=====&gt;........................] - ETA: 10s - loss: 0.0094 - accuracy: 0.9890
109/469 [=====&gt;........................] - ETA: 10s - loss: 0.0093 - accuracy: 0.9892
111/469 [======&gt;.......................] - ETA: 10s - loss: 0.0095 - accuracy: 0.9890
113/469 [======&gt;.......................] - ETA: 10s - loss: 0.0094 - accuracy: 0.9891
115/469 [======&gt;.......................] - ETA: 10s - loss: 0.0094 - accuracy: 0.9890
117/469 [======&gt;.......................] - ETA: 10s - loss: 0.0093 - accuracy: 0.9892
119/469 [======&gt;.......................] - ETA: 10s - loss: 0.0093 - accuracy: 0.9892
121/469 [======&gt;.......................] - ETA: 10s - loss: 0.0094 - accuracy: 0.9891
123/469 [======&gt;.......................] - ETA: 10s - loss: 0.0095 - accuracy: 0.9890
125/469 [======&gt;.......................] - ETA: 10s - loss: 0.0096 - accuracy: 0.9889
127/469 [=======&gt;......................] - ETA: 10s - loss: 0.0095 - accuracy: 0.9889
129/469 [=======&gt;......................] - ETA: 10s - loss: 0.0095 - accuracy: 0.9890
131/469 [=======&gt;......................] - ETA: 10s - loss: 0.0095 - accuracy: 0.9889
133/469 [=======&gt;......................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9887 
135/469 [=======&gt;......................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
137/469 [=======&gt;......................] - ETA: 9s - loss: 0.0095 - accuracy: 0.9888
139/469 [=======&gt;......................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
141/469 [========&gt;.....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
143/469 [========&gt;.....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9887
145/469 [========&gt;.....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9887
147/469 [========&gt;.....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
149/469 [========&gt;.....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
151/469 [========&gt;.....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
153/469 [========&gt;.....................] - ETA: 9s - loss: 0.0095 - accuracy: 0.9887
155/469 [========&gt;.....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
157/469 [=========&gt;....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
159/469 [=========&gt;....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9886
161/469 [=========&gt;....................] - ETA: 9s - loss: 0.0095 - accuracy: 0.9887
163/469 [=========&gt;....................] - ETA: 9s - loss: 0.0096 - accuracy: 0.9885
165/469 [=========&gt;....................] - ETA: 9s - loss: 0.0097 - accuracy: 0.9884
167/469 [=========&gt;....................] - ETA: 8s - loss: 0.0097 - accuracy: 0.9885
169/469 [=========&gt;....................] - ETA: 8s - loss: 0.0096 - accuracy: 0.9887
171/469 [=========&gt;....................] - ETA: 8s - loss: 0.0096 - accuracy: 0.9887
173/469 [==========&gt;...................] - ETA: 8s - loss: 0.0095 - accuracy: 0.9888
175/469 [==========&gt;...................] - ETA: 8s - loss: 0.0094 - accuracy: 0.9888
177/469 [==========&gt;...................] - ETA: 8s - loss: 0.0094 - accuracy: 0.9888
179/469 [==========&gt;...................] - ETA: 8s - loss: 0.0094 - accuracy: 0.9888
181/469 [==========&gt;...................] - ETA: 8s - loss: 0.0094 - accuracy: 0.9889
183/469 [==========&gt;...................] - ETA: 8s - loss: 0.0094 - accuracy: 0.9889
185/469 [==========&gt;...................] - ETA: 8s - loss: 0.0095 - accuracy: 0.9888
187/469 [==========&gt;...................] - ETA: 8s - loss: 0.0095 - accuracy: 0.9888
189/469 [===========&gt;..................] - ETA: 8s - loss: 0.0095 - accuracy: 0.9888
191/469 [===========&gt;..................] - ETA: 8s - loss: 0.0095 - accuracy: 0.9888
193/469 [===========&gt;..................] - ETA: 8s - loss: 0.0096 - accuracy: 0.9887
195/469 [===========&gt;..................] - ETA: 8s - loss: 0.0096 - accuracy: 0.9886
197/469 [===========&gt;..................] - ETA: 8s - loss: 0.0096 - accuracy: 0.9887
199/469 [===========&gt;..................] - ETA: 8s - loss: 0.0095 - accuracy: 0.9887
201/469 [===========&gt;..................] - ETA: 7s - loss: 0.0095 - accuracy: 0.9887
203/469 [===========&gt;..................] - ETA: 7s - loss: 0.0096 - accuracy: 0.9886
205/469 [============&gt;.................] - ETA: 7s - loss: 0.0095 - accuracy: 0.9886
207/469 [============&gt;.................] - ETA: 7s - loss: 0.0095 - accuracy: 0.9886
209/469 [============&gt;.................] - ETA: 7s - loss: 0.0094 - accuracy: 0.9887
211/469 [============&gt;.................] - ETA: 7s - loss: 0.0094 - accuracy: 0.9888
213/469 [============&gt;.................] - ETA: 7s - loss: 0.0094 - accuracy: 0.9887
215/469 [============&gt;.................] - ETA: 7s - loss: 0.0093 - accuracy: 0.9888
217/469 [============&gt;.................] - ETA: 7s - loss: 0.0094 - accuracy: 0.9888
219/469 [=============&gt;................] - ETA: 7s - loss: 0.0093 - accuracy: 0.9888
221/469 [=============&gt;................] - ETA: 7s - loss: 0.0093 - accuracy: 0.9888
223/469 [=============&gt;................] - ETA: 7s - loss: 0.0093 - accuracy: 0.9888
225/469 [=============&gt;................] - ETA: 7s - loss: 0.0094 - accuracy: 0.9887
227/469 [=============&gt;................] - ETA: 7s - loss: 0.0094 - accuracy: 0.9887
229/469 [=============&gt;................] - ETA: 7s - loss: 0.0095 - accuracy: 0.9887
231/469 [=============&gt;................] - ETA: 7s - loss: 0.0095 - accuracy: 0.9886
233/469 [=============&gt;................] - ETA: 7s - loss: 0.0095 - accuracy: 0.9886
235/469 [==============&gt;...............] - ETA: 6s - loss: 0.0095 - accuracy: 0.9886
237/469 [==============&gt;...............] - ETA: 6s - loss: 0.0095 - accuracy: 0.9886
239/469 [==============&gt;...............] - ETA: 6s - loss: 0.0095 - accuracy: 0.9887
241/469 [==============&gt;...............] - ETA: 6s - loss: 0.0095 - accuracy: 0.9888
243/469 [==============&gt;...............] - ETA: 6s - loss: 0.0095 - accuracy: 0.9887
245/469 [==============&gt;...............] - ETA: 6s - loss: 0.0095 - accuracy: 0.9888
247/469 [==============&gt;...............] - ETA: 6s - loss: 0.0096 - accuracy: 0.9887
249/469 [==============&gt;...............] - ETA: 6s - loss: 0.0096 - accuracy: 0.9886
251/469 [===============&gt;..............] - ETA: 6s - loss: 0.0097 - accuracy: 0.9886
253/469 [===============&gt;..............] - ETA: 6s - loss: 0.0098 - accuracy: 0.9885
255/469 [===============&gt;..............] - ETA: 6s - loss: 0.0098 - accuracy: 0.9885
257/469 [===============&gt;..............] - ETA: 6s - loss: 0.0098 - accuracy: 0.9885
259/469 [===============&gt;..............] - ETA: 6s - loss: 0.0099 - accuracy: 0.9884
261/469 [===============&gt;..............] - ETA: 6s - loss: 0.0098 - accuracy: 0.9884
263/469 [===============&gt;..............] - ETA: 6s - loss: 0.0098 - accuracy: 0.9884
265/469 [===============&gt;..............] - ETA: 6s - loss: 0.0098 - accuracy: 0.9884
267/469 [================&gt;.............] - ETA: 6s - loss: 0.0098 - accuracy: 0.9885
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0098 - accuracy: 0.9885
271/469 [================&gt;.............] - ETA: 5s - loss: 0.0098 - accuracy: 0.9885
273/469 [================&gt;.............] - ETA: 5s - loss: 0.0098 - accuracy: 0.9885
275/469 [================&gt;.............] - ETA: 5s - loss: 0.0098 - accuracy: 0.9885
277/469 [================&gt;.............] - ETA: 5s - loss: 0.0098 - accuracy: 0.9885
279/469 [================&gt;.............] - ETA: 5s - loss: 0.0097 - accuracy: 0.9885
281/469 [================&gt;.............] - ETA: 5s - loss: 0.0097 - accuracy: 0.9886
283/469 [=================&gt;............] - ETA: 5s - loss: 0.0097 - accuracy: 0.9886
285/469 [=================&gt;............] - ETA: 5s - loss: 0.0097 - accuracy: 0.9886
287/469 [=================&gt;............] - ETA: 5s - loss: 0.0097 - accuracy: 0.9886
289/469 [=================&gt;............] - ETA: 5s - loss: 0.0097 - accuracy: 0.9887
291/469 [=================&gt;............] - ETA: 5s - loss: 0.0097 - accuracy: 0.9887
293/469 [=================&gt;............] - ETA: 5s - loss: 0.0096 - accuracy: 0.9887
295/469 [=================&gt;............] - ETA: 5s - loss: 0.0096 - accuracy: 0.9887
297/469 [=================&gt;............] - ETA: 5s - loss: 0.0096 - accuracy: 0.9888
299/469 [==================&gt;...........] - ETA: 5s - loss: 0.0096 - accuracy: 0.9888
301/469 [==================&gt;...........] - ETA: 5s - loss: 0.0096 - accuracy: 0.9888
303/469 [==================&gt;...........] - ETA: 4s - loss: 0.0096 - accuracy: 0.9888
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0096 - accuracy: 0.9887
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0096 - accuracy: 0.9887
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0096 - accuracy: 0.9887
311/469 [==================&gt;...........] - ETA: 4s - loss: 0.0096 - accuracy: 0.9887
313/469 [===================&gt;..........] - ETA: 4s - loss: 0.0096 - accuracy: 0.9887
315/469 [===================&gt;..........] - ETA: 4s - loss: 0.0096 - accuracy: 0.9888
317/469 [===================&gt;..........] - ETA: 4s - loss: 0.0096 - accuracy: 0.9888
319/469 [===================&gt;..........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9889
321/469 [===================&gt;..........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9889
323/469 [===================&gt;..........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9889
325/469 [===================&gt;..........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9889
327/469 [===================&gt;..........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9889
329/469 [====================&gt;.........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9889
331/469 [====================&gt;.........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9889
333/469 [====================&gt;.........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9888
335/469 [====================&gt;.........] - ETA: 4s - loss: 0.0095 - accuracy: 0.9888
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0096 - accuracy: 0.9888
339/469 [====================&gt;.........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9888
341/469 [====================&gt;.........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9888
343/469 [====================&gt;.........] - ETA: 3s - loss: 0.0096 - accuracy: 0.9888
345/469 [=====================&gt;........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9888
347/469 [=====================&gt;........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9888
349/469 [=====================&gt;........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9889
351/469 [=====================&gt;........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9889
353/469 [=====================&gt;........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9889
355/469 [=====================&gt;........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9889
357/469 [=====================&gt;........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9890
359/469 [=====================&gt;........] - ETA: 3s - loss: 0.0095 - accuracy: 0.9889
361/469 [======================&gt;.......] - ETA: 3s - loss: 0.0094 - accuracy: 0.9890
363/469 [======================&gt;.......] - ETA: 3s - loss: 0.0095 - accuracy: 0.9889
365/469 [======================&gt;.......] - ETA: 3s - loss: 0.0095 - accuracy: 0.9888
367/469 [======================&gt;.......] - ETA: 3s - loss: 0.0095 - accuracy: 0.9889
369/469 [======================&gt;.......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9888
371/469 [======================&gt;.......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9888
373/469 [======================&gt;.......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9888
375/469 [======================&gt;.......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9888
377/469 [=======================&gt;......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9888
379/469 [=======================&gt;......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9888
381/469 [=======================&gt;......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9889
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0094 - accuracy: 0.9889
385/469 [=======================&gt;......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9889
387/469 [=======================&gt;......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9889
389/469 [=======================&gt;......] - ETA: 2s - loss: 0.0095 - accuracy: 0.9889
391/469 [========================&gt;.....] - ETA: 2s - loss: 0.0095 - accuracy: 0.9889
393/469 [========================&gt;.....] - ETA: 2s - loss: 0.0094 - accuracy: 0.9889
395/469 [========================&gt;.....] - ETA: 2s - loss: 0.0094 - accuracy: 0.9889
397/469 [========================&gt;.....] - ETA: 2s - loss: 0.0094 - accuracy: 0.9889
399/469 [========================&gt;.....] - ETA: 2s - loss: 0.0094 - accuracy: 0.9889
401/469 [========================&gt;.....] - ETA: 2s - loss: 0.0094 - accuracy: 0.9889
403/469 [========================&gt;.....] - ETA: 1s - loss: 0.0095 - accuracy: 0.9889
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0094 - accuracy: 0.9889
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0094 - accuracy: 0.9889
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0095 - accuracy: 0.9889
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0095 - accuracy: 0.9889
413/469 [=========================&gt;....] - ETA: 1s - loss: 0.0094 - accuracy: 0.9889
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0094 - accuracy: 0.9890
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0094 - accuracy: 0.9890
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0094 - accuracy: 0.9890
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0094 - accuracy: 0.9890
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0094 - accuracy: 0.9890
425/469 [==========================&gt;...] - ETA: 1s - loss: 0.0094 - accuracy: 0.9890
427/469 [==========================&gt;...] - ETA: 1s - loss: 0.0094 - accuracy: 0.9891
429/469 [==========================&gt;...] - ETA: 1s - loss: 0.0094 - accuracy: 0.9891
431/469 [==========================&gt;...] - ETA: 1s - loss: 0.0094 - accuracy: 0.9891
433/469 [==========================&gt;...] - ETA: 1s - loss: 0.0094 - accuracy: 0.9890
435/469 [==========================&gt;...] - ETA: 1s - loss: 0.0094 - accuracy: 0.9890
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0094 - accuracy: 0.9890
439/469 [===========================&gt;..] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0094 - accuracy: 0.9889
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0094 - accuracy: 0.9890
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0092 - accuracy: 0.9890
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
469/469 [==============================] - ETA: 0s - loss: 0.0093 - accuracy: 0.9890
469/469 [==============================] - 15s 31ms/step - loss: 0.0093 - accuracy: 0.9890 - val_loss: 0.0124 - val_accuracy: 0.9842 - lr: 6.3096e-04
Epoch 3/5

  1/469 [..............................] - ETA: 0s - loss: 0.0066 - accuracy: 0.9922
  3/469 [..............................] - ETA: 9s - loss: 0.0041 - accuracy: 0.9948
  5/469 [..............................] - ETA: 11s - loss: 0.0045 - accuracy: 0.9953
  7/469 [..............................] - ETA: 11s - loss: 0.0053 - accuracy: 0.9944
  9/469 [..............................] - ETA: 12s - loss: 0.0053 - accuracy: 0.9939
 11/469 [..............................] - ETA: 12s - loss: 0.0066 - accuracy: 0.9922
 13/469 [..............................] - ETA: 12s - loss: 0.0061 - accuracy: 0.9934
 15/469 [..............................] - ETA: 12s - loss: 0.0069 - accuracy: 0.9922
 17/469 [&gt;.............................] - ETA: 12s - loss: 0.0070 - accuracy: 0.9922
 19/469 [&gt;.............................] - ETA: 12s - loss: 0.0070 - accuracy: 0.9918
 21/469 [&gt;.............................] - ETA: 12s - loss: 0.0065 - accuracy: 0.9926
 23/469 [&gt;.............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9925
 25/469 [&gt;.............................] - ETA: 12s - loss: 0.0068 - accuracy: 0.9919
 27/469 [&gt;.............................] - ETA: 12s - loss: 0.0065 - accuracy: 0.9925
 29/469 [&gt;.............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9916
 31/469 [&gt;.............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9919
 33/469 [=&gt;............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9917
 35/469 [=&gt;............................] - ETA: 12s - loss: 0.0068 - accuracy: 0.9915
 37/469 [=&gt;............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9916
 39/469 [=&gt;............................] - ETA: 12s - loss: 0.0068 - accuracy: 0.9914
 41/469 [=&gt;............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9914
 43/469 [=&gt;............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9913
 45/469 [=&gt;............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9915
 47/469 [==&gt;...........................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9917
 49/469 [==&gt;...........................] - ETA: 12s - loss: 0.0066 - accuracy: 0.9917
 51/469 [==&gt;...........................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9919
 53/469 [==&gt;...........................] - ETA: 12s - loss: 0.0069 - accuracy: 0.9917
 55/469 [==&gt;...........................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9920
 57/469 [==&gt;...........................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9919
 59/469 [==&gt;...........................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9919
 61/469 [==&gt;...........................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9921
 63/469 [===&gt;..........................] - ETA: 11s - loss: 0.0065 - accuracy: 0.9923
 65/469 [===&gt;..........................] - ETA: 11s - loss: 0.0065 - accuracy: 0.9924
 67/469 [===&gt;..........................] - ETA: 11s - loss: 0.0066 - accuracy: 0.9922
 69/469 [===&gt;..........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9921
 71/469 [===&gt;..........................] - ETA: 11s - loss: 0.0066 - accuracy: 0.9923
 73/469 [===&gt;..........................] - ETA: 11s - loss: 0.0065 - accuracy: 0.9923
 75/469 [===&gt;..........................] - ETA: 11s - loss: 0.0065 - accuracy: 0.9924
 77/469 [===&gt;..........................] - ETA: 11s - loss: 0.0065 - accuracy: 0.9925
 79/469 [====&gt;.........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9923
 81/469 [====&gt;.........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9924
 83/469 [====&gt;.........................] - ETA: 11s - loss: 0.0066 - accuracy: 0.9925
 85/469 [====&gt;.........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9923
 87/469 [====&gt;.........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9923
 89/469 [====&gt;.........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9923
 91/469 [====&gt;.........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9924
 93/469 [====&gt;.........................] - ETA: 11s - loss: 0.0068 - accuracy: 0.9922
 95/469 [=====&gt;........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9922
 97/469 [=====&gt;........................] - ETA: 11s - loss: 0.0067 - accuracy: 0.9923
 99/469 [=====&gt;........................] - ETA: 11s - loss: 0.0068 - accuracy: 0.9920
101/469 [=====&gt;........................] - ETA: 10s - loss: 0.0067 - accuracy: 0.9921
103/469 [=====&gt;........................] - ETA: 10s - loss: 0.0067 - accuracy: 0.9921
105/469 [=====&gt;........................] - ETA: 10s - loss: 0.0066 - accuracy: 0.9922
107/469 [=====&gt;........................] - ETA: 10s - loss: 0.0066 - accuracy: 0.9923
109/469 [=====&gt;........................] - ETA: 10s - loss: 0.0067 - accuracy: 0.9922
111/469 [======&gt;.......................] - ETA: 10s - loss: 0.0066 - accuracy: 0.9923
113/469 [======&gt;.......................] - ETA: 10s - loss: 0.0067 - accuracy: 0.9923
115/469 [======&gt;.......................] - ETA: 10s - loss: 0.0067 - accuracy: 0.9923
117/469 [======&gt;.......................] - ETA: 10s - loss: 0.0068 - accuracy: 0.9921
119/469 [======&gt;.......................] - ETA: 10s - loss: 0.0067 - accuracy: 0.9922
121/469 [======&gt;.......................] - ETA: 10s - loss: 0.0066 - accuracy: 0.9923
123/469 [======&gt;.......................] - ETA: 10s - loss: 0.0067 - accuracy: 0.9923
125/469 [======&gt;.......................] - ETA: 10s - loss: 0.0068 - accuracy: 0.9919
127/469 [=======&gt;......................] - ETA: 10s - loss: 0.0069 - accuracy: 0.9918
129/469 [=======&gt;......................] - ETA: 10s - loss: 0.0069 - accuracy: 0.9919
131/469 [=======&gt;......................] - ETA: 10s - loss: 0.0068 - accuracy: 0.9921
133/469 [=======&gt;......................] - ETA: 10s - loss: 0.0068 - accuracy: 0.9921
135/469 [=======&gt;......................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918 
137/469 [=======&gt;......................] - ETA: 9s - loss: 0.0070 - accuracy: 0.9916
139/469 [=======&gt;......................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9917
141/469 [========&gt;.....................] - ETA: 9s - loss: 0.0070 - accuracy: 0.9917
143/469 [========&gt;.....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918
145/469 [========&gt;.....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918
147/469 [========&gt;.....................] - ETA: 9s - loss: 0.0070 - accuracy: 0.9918
149/469 [========&gt;.....................] - ETA: 9s - loss: 0.0070 - accuracy: 0.9917
151/469 [========&gt;.....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918
153/469 [========&gt;.....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9917
155/469 [========&gt;.....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918
157/469 [=========&gt;....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918
159/469 [=========&gt;....................] - ETA: 9s - loss: 0.0068 - accuracy: 0.9919
161/469 [=========&gt;....................] - ETA: 9s - loss: 0.0068 - accuracy: 0.9918
163/469 [=========&gt;....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918
165/469 [=========&gt;....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918
167/469 [=========&gt;....................] - ETA: 9s - loss: 0.0069 - accuracy: 0.9918
169/469 [=========&gt;....................] - ETA: 8s - loss: 0.0069 - accuracy: 0.9918
171/469 [=========&gt;....................] - ETA: 8s - loss: 0.0069 - accuracy: 0.9918
173/469 [==========&gt;...................] - ETA: 8s - loss: 0.0069 - accuracy: 0.9918
175/469 [==========&gt;...................] - ETA: 8s - loss: 0.0069 - accuracy: 0.9918
177/469 [==========&gt;...................] - ETA: 8s - loss: 0.0069 - accuracy: 0.9917
179/469 [==========&gt;...................] - ETA: 8s - loss: 0.0069 - accuracy: 0.9917
181/469 [==========&gt;...................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9917
183/469 [==========&gt;...................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9916
185/469 [==========&gt;...................] - ETA: 8s - loss: 0.0069 - accuracy: 0.9917
187/469 [==========&gt;...................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9916
189/469 [===========&gt;..................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9917
191/469 [===========&gt;..................] - ETA: 8s - loss: 0.0069 - accuracy: 0.9917
193/469 [===========&gt;..................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9917
195/469 [===========&gt;..................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9917
197/469 [===========&gt;..................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9917
199/469 [===========&gt;..................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9918
201/469 [===========&gt;..................] - ETA: 8s - loss: 0.0070 - accuracy: 0.9918
203/469 [===========&gt;..................] - ETA: 7s - loss: 0.0070 - accuracy: 0.9918
205/469 [============&gt;.................] - ETA: 7s - loss: 0.0069 - accuracy: 0.9919
207/469 [============&gt;.................] - ETA: 7s - loss: 0.0070 - accuracy: 0.9918
209/469 [============&gt;.................] - ETA: 7s - loss: 0.0070 - accuracy: 0.9918
211/469 [============&gt;.................] - ETA: 7s - loss: 0.0070 - accuracy: 0.9918
213/469 [============&gt;.................] - ETA: 7s - loss: 0.0069 - accuracy: 0.9918
215/469 [============&gt;.................] - ETA: 7s - loss: 0.0070 - accuracy: 0.9918
217/469 [============&gt;.................] - ETA: 7s - loss: 0.0069 - accuracy: 0.9918
219/469 [=============&gt;................] - ETA: 7s - loss: 0.0069 - accuracy: 0.9919
221/469 [=============&gt;................] - ETA: 7s - loss: 0.0068 - accuracy: 0.9919
223/469 [=============&gt;................] - ETA: 7s - loss: 0.0069 - accuracy: 0.9918
225/469 [=============&gt;................] - ETA: 7s - loss: 0.0069 - accuracy: 0.9918
227/469 [=============&gt;................] - ETA: 7s - loss: 0.0068 - accuracy: 0.9918
229/469 [=============&gt;................] - ETA: 7s - loss: 0.0068 - accuracy: 0.9918
231/469 [=============&gt;................] - ETA: 7s - loss: 0.0068 - accuracy: 0.9918
233/469 [=============&gt;................] - ETA: 7s - loss: 0.0068 - accuracy: 0.9919
235/469 [==============&gt;...............] - ETA: 7s - loss: 0.0068 - accuracy: 0.9919
237/469 [==============&gt;...............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9918
239/469 [==============&gt;...............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9919
241/469 [==============&gt;...............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9918
243/469 [==============&gt;...............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9919
245/469 [==============&gt;...............] - ETA: 6s - loss: 0.0069 - accuracy: 0.9919
247/469 [==============&gt;...............] - ETA: 6s - loss: 0.0069 - accuracy: 0.9920
249/469 [==============&gt;...............] - ETA: 6s - loss: 0.0069 - accuracy: 0.9920
251/469 [===============&gt;..............] - ETA: 6s - loss: 0.0069 - accuracy: 0.9920
253/469 [===============&gt;..............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9921
255/469 [===============&gt;..............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9921
257/469 [===============&gt;..............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9921
259/469 [===============&gt;..............] - ETA: 6s - loss: 0.0069 - accuracy: 0.9920
261/469 [===============&gt;..............] - ETA: 6s - loss: 0.0069 - accuracy: 0.9920
263/469 [===============&gt;..............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9920
265/469 [===============&gt;..............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9921
267/469 [================&gt;.............] - ETA: 6s - loss: 0.0068 - accuracy: 0.9920
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0068 - accuracy: 0.9920
271/469 [================&gt;.............] - ETA: 5s - loss: 0.0068 - accuracy: 0.9921
273/469 [================&gt;.............] - ETA: 5s - loss: 0.0068 - accuracy: 0.9921
275/469 [================&gt;.............] - ETA: 5s - loss: 0.0068 - accuracy: 0.9921
277/469 [================&gt;.............] - ETA: 5s - loss: 0.0068 - accuracy: 0.9920
279/469 [================&gt;.............] - ETA: 5s - loss: 0.0068 - accuracy: 0.9920
281/469 [================&gt;.............] - ETA: 5s - loss: 0.0068 - accuracy: 0.9920
283/469 [=================&gt;............] - ETA: 5s - loss: 0.0069 - accuracy: 0.9920
285/469 [=================&gt;............] - ETA: 5s - loss: 0.0069 - accuracy: 0.9920
287/469 [=================&gt;............] - ETA: 5s - loss: 0.0069 - accuracy: 0.9920
289/469 [=================&gt;............] - ETA: 5s - loss: 0.0069 - accuracy: 0.9919
291/469 [=================&gt;............] - ETA: 5s - loss: 0.0070 - accuracy: 0.9919
293/469 [=================&gt;............] - ETA: 5s - loss: 0.0069 - accuracy: 0.9919
295/469 [=================&gt;............] - ETA: 5s - loss: 0.0070 - accuracy: 0.9919
297/469 [=================&gt;............] - ETA: 5s - loss: 0.0070 - accuracy: 0.9918
299/469 [==================&gt;...........] - ETA: 5s - loss: 0.0070 - accuracy: 0.9918
301/469 [==================&gt;...........] - ETA: 5s - loss: 0.0070 - accuracy: 0.9918
303/469 [==================&gt;...........] - ETA: 4s - loss: 0.0070 - accuracy: 0.9918
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0070 - accuracy: 0.9918
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0070 - accuracy: 0.9918
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0070 - accuracy: 0.9918
311/469 [==================&gt;...........] - ETA: 4s - loss: 0.0070 - accuracy: 0.9918
313/469 [===================&gt;..........] - ETA: 4s - loss: 0.0070 - accuracy: 0.9918
315/469 [===================&gt;..........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9917
317/469 [===================&gt;..........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9917
319/469 [===================&gt;..........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9917
321/469 [===================&gt;..........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9917
323/469 [===================&gt;..........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9916
325/469 [===================&gt;..........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9916
327/469 [===================&gt;..........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9916
329/469 [====================&gt;.........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9916
331/469 [====================&gt;.........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9916
333/469 [====================&gt;.........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9917
335/469 [====================&gt;.........] - ETA: 4s - loss: 0.0071 - accuracy: 0.9917
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9917
339/469 [====================&gt;.........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9917
341/469 [====================&gt;.........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9917
343/469 [====================&gt;.........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9917
345/469 [=====================&gt;........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9916
347/469 [=====================&gt;........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9916
349/469 [=====================&gt;........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9916
351/469 [=====================&gt;........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9915
353/469 [=====================&gt;........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9916
355/469 [=====================&gt;........] - ETA: 3s - loss: 0.0071 - accuracy: 0.9915
357/469 [=====================&gt;........] - ETA: 3s - loss: 0.0072 - accuracy: 0.9915
359/469 [=====================&gt;........] - ETA: 3s - loss: 0.0072 - accuracy: 0.9915
361/469 [======================&gt;.......] - ETA: 3s - loss: 0.0072 - accuracy: 0.9915
363/469 [======================&gt;.......] - ETA: 3s - loss: 0.0072 - accuracy: 0.9913
365/469 [======================&gt;.......] - ETA: 3s - loss: 0.0072 - accuracy: 0.9914
367/469 [======================&gt;.......] - ETA: 3s - loss: 0.0072 - accuracy: 0.9914
369/469 [======================&gt;.......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
371/469 [======================&gt;.......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
373/469 [======================&gt;.......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
375/469 [======================&gt;.......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
377/469 [=======================&gt;......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
379/469 [=======================&gt;......] - ETA: 2s - loss: 0.0071 - accuracy: 0.9915
381/469 [=======================&gt;......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9913
385/469 [=======================&gt;......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
387/469 [=======================&gt;......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
389/469 [=======================&gt;......] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
391/469 [========================&gt;.....] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
393/469 [========================&gt;.....] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
395/469 [========================&gt;.....] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
397/469 [========================&gt;.....] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
399/469 [========================&gt;.....] - ETA: 2s - loss: 0.0072 - accuracy: 0.9914
401/469 [========================&gt;.....] - ETA: 2s - loss: 0.0072 - accuracy: 0.9913
403/469 [========================&gt;.....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9913
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9913
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9913
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9912
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9913
413/469 [=========================&gt;....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9913
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9913
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9913
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0072 - accuracy: 0.9913
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0073 - accuracy: 0.9913
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0073 - accuracy: 0.9912
425/469 [==========================&gt;...] - ETA: 1s - loss: 0.0073 - accuracy: 0.9912
427/469 [==========================&gt;...] - ETA: 1s - loss: 0.0073 - accuracy: 0.9912
429/469 [==========================&gt;...] - ETA: 1s - loss: 0.0073 - accuracy: 0.9912
431/469 [==========================&gt;...] - ETA: 1s - loss: 0.0073 - accuracy: 0.9912
433/469 [==========================&gt;...] - ETA: 1s - loss: 0.0073 - accuracy: 0.9912
435/469 [==========================&gt;...] - ETA: 1s - loss: 0.0073 - accuracy: 0.9912
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0073 - accuracy: 0.9912
439/469 [===========================&gt;..] - ETA: 0s - loss: 0.0073 - accuracy: 0.9912
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0073 - accuracy: 0.9912
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0073 - accuracy: 0.9912
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0073 - accuracy: 0.9912
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0073 - accuracy: 0.9911
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0073 - accuracy: 0.9912
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0073 - accuracy: 0.9911
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0073 - accuracy: 0.9911
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0073 - accuracy: 0.9911
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0073 - accuracy: 0.9911
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0073 - accuracy: 0.9911
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0074 - accuracy: 0.9910
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0074 - accuracy: 0.9910
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0074 - accuracy: 0.9910
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0074 - accuracy: 0.9910
469/469 [==============================] - ETA: 0s - loss: 0.0074 - accuracy: 0.9911
469/469 [==============================] - 15s 31ms/step - loss: 0.0074 - accuracy: 0.9911 - val_loss: 0.0090 - val_accuracy: 0.9883 - lr: 3.9811e-04
Epoch 4/5

  1/469 [..............................] - ETA: 0s - loss: 0.0175 - accuracy: 0.9844
  3/469 [..............................] - ETA: 9s - loss: 0.0159 - accuracy: 0.9818
  5/469 [..............................] - ETA: 11s - loss: 0.0114 - accuracy: 0.9875
  7/469 [..............................] - ETA: 11s - loss: 0.0087 - accuracy: 0.9911
  9/469 [..............................] - ETA: 12s - loss: 0.0076 - accuracy: 0.9931
 11/469 [..............................] - ETA: 12s - loss: 0.0074 - accuracy: 0.9929
 13/469 [..............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9940
 15/469 [..............................] - ETA: 12s - loss: 0.0063 - accuracy: 0.9943
 17/469 [&gt;.............................] - ETA: 12s - loss: 0.0062 - accuracy: 0.9945
 19/469 [&gt;.............................] - ETA: 12s - loss: 0.0073 - accuracy: 0.9930
 21/469 [&gt;.............................] - ETA: 12s - loss: 0.0073 - accuracy: 0.9926
 23/469 [&gt;.............................] - ETA: 12s - loss: 0.0073 - accuracy: 0.9922
 25/469 [&gt;.............................] - ETA: 12s - loss: 0.0077 - accuracy: 0.9919
 27/469 [&gt;.............................] - ETA: 12s - loss: 0.0073 - accuracy: 0.9925
 29/469 [&gt;.............................] - ETA: 12s - loss: 0.0072 - accuracy: 0.9927
 31/469 [&gt;.............................] - ETA: 12s - loss: 0.0070 - accuracy: 0.9932
 33/469 [=&gt;............................] - ETA: 12s - loss: 0.0070 - accuracy: 0.9929
 35/469 [=&gt;............................] - ETA: 12s - loss: 0.0068 - accuracy: 0.9931
 37/469 [=&gt;............................] - ETA: 12s - loss: 0.0069 - accuracy: 0.9928
 39/469 [=&gt;............................] - ETA: 12s - loss: 0.0070 - accuracy: 0.9924
 41/469 [=&gt;............................] - ETA: 12s - loss: 0.0069 - accuracy: 0.9926
 43/469 [=&gt;............................] - ETA: 12s - loss: 0.0068 - accuracy: 0.9927
 45/469 [=&gt;............................] - ETA: 12s - loss: 0.0067 - accuracy: 0.9931
 47/469 [==&gt;...........................] - ETA: 12s - loss: 0.0066 - accuracy: 0.9930
 49/469 [==&gt;...........................] - ETA: 12s - loss: 0.0066 - accuracy: 0.9930
 51/469 [==&gt;...........................] - ETA: 12s - loss: 0.0066 - accuracy: 0.9928
 53/469 [==&gt;...........................] - ETA: 12s - loss: 0.0065 - accuracy: 0.9931
 55/469 [==&gt;...........................] - ETA: 12s - loss: 0.0063 - accuracy: 0.9933
 57/469 [==&gt;...........................] - ETA: 12s - loss: 0.0063 - accuracy: 0.9933
 59/469 [==&gt;...........................] - ETA: 12s - loss: 0.0063 - accuracy: 0.9932
 61/469 [==&gt;...........................] - ETA: 12s - loss: 0.0062 - accuracy: 0.9933
 63/469 [===&gt;..........................] - ETA: 11s - loss: 0.0061 - accuracy: 0.9936
 65/469 [===&gt;..........................] - ETA: 11s - loss: 0.0060 - accuracy: 0.9936
 67/469 [===&gt;..........................] - ETA: 11s - loss: 0.0060 - accuracy: 0.9937
 69/469 [===&gt;..........................] - ETA: 11s - loss: 0.0059 - accuracy: 0.9939
 71/469 [===&gt;..........................] - ETA: 11s - loss: 0.0059 - accuracy: 0.9938
 73/469 [===&gt;..........................] - ETA: 11s - loss: 0.0059 - accuracy: 0.9939
 75/469 [===&gt;..........................] - ETA: 11s - loss: 0.0059 - accuracy: 0.9941
 77/469 [===&gt;..........................] - ETA: 11s - loss: 0.0058 - accuracy: 0.9941
 79/469 [====&gt;.........................] - ETA: 11s - loss: 0.0058 - accuracy: 0.9941
 81/469 [====&gt;.........................] - ETA: 11s - loss: 0.0057 - accuracy: 0.9942
 83/469 [====&gt;.........................] - ETA: 11s - loss: 0.0058 - accuracy: 0.9938
 85/469 [====&gt;.........................] - ETA: 11s - loss: 0.0058 - accuracy: 0.9939
 87/469 [====&gt;.........................] - ETA: 11s - loss: 0.0058 - accuracy: 0.9939
 89/469 [====&gt;.........................] - ETA: 11s - loss: 0.0060 - accuracy: 0.9939
 91/469 [====&gt;.........................] - ETA: 11s - loss: 0.0060 - accuracy: 0.9938
 93/469 [====&gt;.........................] - ETA: 11s - loss: 0.0059 - accuracy: 0.9939
 95/469 [=====&gt;........................] - ETA: 11s - loss: 0.0059 - accuracy: 0.9938
 97/469 [=====&gt;........................] - ETA: 11s - loss: 0.0059 - accuracy: 0.9938
 99/469 [=====&gt;........................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9938
101/469 [=====&gt;........................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9938
103/469 [=====&gt;........................] - ETA: 10s - loss: 0.0058 - accuracy: 0.9938
105/469 [=====&gt;........................] - ETA: 10s - loss: 0.0058 - accuracy: 0.9938
107/469 [=====&gt;........................] - ETA: 10s - loss: 0.0058 - accuracy: 0.9939
109/469 [=====&gt;........................] - ETA: 10s - loss: 0.0058 - accuracy: 0.9939
111/469 [======&gt;.......................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9939
113/469 [======&gt;.......................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9939
115/469 [======&gt;.......................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9939
117/469 [======&gt;.......................] - ETA: 10s - loss: 0.0060 - accuracy: 0.9939
119/469 [======&gt;.......................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9940
121/469 [======&gt;.......................] - ETA: 10s - loss: 0.0060 - accuracy: 0.9938
123/469 [======&gt;.......................] - ETA: 10s - loss: 0.0060 - accuracy: 0.9936
125/469 [======&gt;.......................] - ETA: 10s - loss: 0.0060 - accuracy: 0.9937
127/469 [=======&gt;......................] - ETA: 10s - loss: 0.0059 - accuracy: 0.9937
129/469 [=======&gt;......................] - ETA: 10s - loss: 0.0061 - accuracy: 0.9936
131/469 [=======&gt;......................] - ETA: 10s - loss: 0.0061 - accuracy: 0.9934
133/469 [=======&gt;......................] - ETA: 9s - loss: 0.0060 - accuracy: 0.9934 
135/469 [=======&gt;......................] - ETA: 9s - loss: 0.0060 - accuracy: 0.9935
137/469 [=======&gt;......................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9934
139/469 [=======&gt;......................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9934
141/469 [========&gt;.....................] - ETA: 9s - loss: 0.0061 - accuracy: 0.9933
143/469 [========&gt;.....................] - ETA: 9s - loss: 0.0060 - accuracy: 0.9933
145/469 [========&gt;.....................] - ETA: 9s - loss: 0.0060 - accuracy: 0.9934
147/469 [========&gt;.....................] - ETA: 9s - loss: 0.0059 - accuracy: 0.9935
149/469 [========&gt;.....................] - ETA: 9s - loss: 0.0059 - accuracy: 0.9935
151/469 [========&gt;.....................] - ETA: 9s - loss: 0.0059 - accuracy: 0.9935
153/469 [========&gt;.....................] - ETA: 9s - loss: 0.0059 - accuracy: 0.9936
155/469 [========&gt;.....................] - ETA: 9s - loss: 0.0059 - accuracy: 0.9935
157/469 [=========&gt;....................] - ETA: 9s - loss: 0.0058 - accuracy: 0.9936
159/469 [=========&gt;....................] - ETA: 9s - loss: 0.0058 - accuracy: 0.9937
161/469 [=========&gt;....................] - ETA: 9s - loss: 0.0058 - accuracy: 0.9936
163/469 [=========&gt;....................] - ETA: 9s - loss: 0.0058 - accuracy: 0.9936
165/469 [=========&gt;....................] - ETA: 9s - loss: 0.0058 - accuracy: 0.9935
167/469 [=========&gt;....................] - ETA: 8s - loss: 0.0058 - accuracy: 0.9935
169/469 [=========&gt;....................] - ETA: 8s - loss: 0.0058 - accuracy: 0.9935
171/469 [=========&gt;....................] - ETA: 8s - loss: 0.0058 - accuracy: 0.9935
173/469 [==========&gt;...................] - ETA: 8s - loss: 0.0058 - accuracy: 0.9935
175/469 [==========&gt;...................] - ETA: 8s - loss: 0.0058 - accuracy: 0.9935
177/469 [==========&gt;...................] - ETA: 8s - loss: 0.0058 - accuracy: 0.9936
179/469 [==========&gt;...................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
181/469 [==========&gt;...................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
183/469 [==========&gt;...................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
185/469 [==========&gt;...................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
187/469 [==========&gt;...................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
189/469 [===========&gt;..................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
191/469 [===========&gt;..................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9935
193/469 [===========&gt;..................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
195/469 [===========&gt;..................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
197/469 [===========&gt;..................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
199/469 [===========&gt;..................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9936
201/469 [===========&gt;..................] - ETA: 8s - loss: 0.0057 - accuracy: 0.9935
203/469 [===========&gt;..................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9935
205/469 [============&gt;.................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9935
207/469 [============&gt;.................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9934
209/469 [============&gt;.................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9935
211/469 [============&gt;.................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9935
213/469 [============&gt;.................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9935
215/469 [============&gt;.................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9935
217/469 [============&gt;.................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9935
219/469 [=============&gt;................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9934
221/469 [=============&gt;................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9934
223/469 [=============&gt;................] - ETA: 7s - loss: 0.0059 - accuracy: 0.9934
225/469 [=============&gt;................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9934
227/469 [=============&gt;................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9934
229/469 [=============&gt;................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9934
231/469 [=============&gt;................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9934
233/469 [=============&gt;................] - ETA: 7s - loss: 0.0058 - accuracy: 0.9934
235/469 [==============&gt;...............] - ETA: 7s - loss: 0.0058 - accuracy: 0.9934
237/469 [==============&gt;...............] - ETA: 6s - loss: 0.0058 - accuracy: 0.9934
239/469 [==============&gt;...............] - ETA: 6s - loss: 0.0058 - accuracy: 0.9934
241/469 [==============&gt;...............] - ETA: 6s - loss: 0.0058 - accuracy: 0.9934
243/469 [==============&gt;...............] - ETA: 6s - loss: 0.0058 - accuracy: 0.9934
245/469 [==============&gt;...............] - ETA: 6s - loss: 0.0058 - accuracy: 0.9934
247/469 [==============&gt;...............] - ETA: 6s - loss: 0.0058 - accuracy: 0.9934
249/469 [==============&gt;...............] - ETA: 6s - loss: 0.0058 - accuracy: 0.9934
251/469 [===============&gt;..............] - ETA: 6s - loss: 0.0058 - accuracy: 0.9935
253/469 [===============&gt;..............] - ETA: 6s - loss: 0.0057 - accuracy: 0.9935
255/469 [===============&gt;..............] - ETA: 6s - loss: 0.0057 - accuracy: 0.9935
257/469 [===============&gt;..............] - ETA: 6s - loss: 0.0057 - accuracy: 0.9935
259/469 [===============&gt;..............] - ETA: 6s - loss: 0.0057 - accuracy: 0.9935
261/469 [===============&gt;..............] - ETA: 6s - loss: 0.0057 - accuracy: 0.9936
263/469 [===============&gt;..............] - ETA: 6s - loss: 0.0057 - accuracy: 0.9936
265/469 [===============&gt;..............] - ETA: 6s - loss: 0.0057 - accuracy: 0.9935
267/469 [================&gt;.............] - ETA: 6s - loss: 0.0056 - accuracy: 0.9936
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9935
271/469 [================&gt;.............] - ETA: 5s - loss: 0.0057 - accuracy: 0.9935
273/469 [================&gt;.............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9936
275/469 [================&gt;.............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9936
277/469 [================&gt;.............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9936
279/469 [================&gt;.............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9936
281/469 [================&gt;.............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9936
283/469 [=================&gt;............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9937
285/469 [=================&gt;............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9936
287/469 [=================&gt;............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9937
289/469 [=================&gt;............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9936
291/469 [=================&gt;............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9937
293/469 [=================&gt;............] - ETA: 5s - loss: 0.0056 - accuracy: 0.9937
295/469 [=================&gt;............] - ETA: 5s - loss: 0.0055 - accuracy: 0.9937
297/469 [=================&gt;............] - ETA: 5s - loss: 0.0055 - accuracy: 0.9937
299/469 [==================&gt;...........] - ETA: 5s - loss: 0.0055 - accuracy: 0.9937
301/469 [==================&gt;...........] - ETA: 5s - loss: 0.0055 - accuracy: 0.9937
303/469 [==================&gt;...........] - ETA: 4s - loss: 0.0055 - accuracy: 0.9937
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0055 - accuracy: 0.9937
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0055 - accuracy: 0.9937
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0055 - accuracy: 0.9937
311/469 [==================&gt;...........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9936
313/469 [===================&gt;..........] - ETA: 4s - loss: 0.0055 - accuracy: 0.9936
315/469 [===================&gt;..........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9936
317/469 [===================&gt;..........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9935
319/469 [===================&gt;..........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9935
321/469 [===================&gt;..........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9935
323/469 [===================&gt;..........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9936
325/469 [===================&gt;..........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9935
327/469 [===================&gt;..........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9935
329/469 [====================&gt;.........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9935
331/469 [====================&gt;.........] - ETA: 4s - loss: 0.0056 - accuracy: 0.9936
333/469 [====================&gt;.........] - ETA: 4s - loss: 0.0055 - accuracy: 0.9936
335/469 [====================&gt;.........] - ETA: 4s - loss: 0.0055 - accuracy: 0.9936
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0055 - accuracy: 0.9936
339/469 [====================&gt;.........] - ETA: 3s - loss: 0.0056 - accuracy: 0.9936
341/469 [====================&gt;.........] - ETA: 3s - loss: 0.0055 - accuracy: 0.9936
343/469 [====================&gt;.........] - ETA: 3s - loss: 0.0055 - accuracy: 0.9936
345/469 [=====================&gt;........] - ETA: 3s - loss: 0.0055 - accuracy: 0.9937
347/469 [=====================&gt;........] - ETA: 3s - loss: 0.0055 - accuracy: 0.9937
349/469 [=====================&gt;........] - ETA: 3s - loss: 0.0055 - accuracy: 0.9936
351/469 [=====================&gt;........] - ETA: 3s - loss: 0.0055 - accuracy: 0.9936
353/469 [=====================&gt;........] - ETA: 3s - loss: 0.0055 - accuracy: 0.9937
355/469 [=====================&gt;........] - ETA: 3s - loss: 0.0056 - accuracy: 0.9936
357/469 [=====================&gt;........] - ETA: 3s - loss: 0.0056 - accuracy: 0.9936
359/469 [=====================&gt;........] - ETA: 3s - loss: 0.0056 - accuracy: 0.9935
361/469 [======================&gt;.......] - ETA: 3s - loss: 0.0056 - accuracy: 0.9936
363/469 [======================&gt;.......] - ETA: 3s - loss: 0.0056 - accuracy: 0.9936
365/469 [======================&gt;.......] - ETA: 3s - loss: 0.0056 - accuracy: 0.9936
367/469 [======================&gt;.......] - ETA: 3s - loss: 0.0055 - accuracy: 0.9936
369/469 [======================&gt;.......] - ETA: 2s - loss: 0.0056 - accuracy: 0.9936
371/469 [======================&gt;.......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
373/469 [======================&gt;.......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
375/469 [======================&gt;.......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
377/469 [=======================&gt;......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
379/469 [=======================&gt;......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
381/469 [=======================&gt;......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
385/469 [=======================&gt;......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
387/469 [=======================&gt;......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
389/469 [=======================&gt;......] - ETA: 2s - loss: 0.0055 - accuracy: 0.9936
391/469 [========================&gt;.....] - ETA: 2s - loss: 0.0056 - accuracy: 0.9935
393/469 [========================&gt;.....] - ETA: 2s - loss: 0.0056 - accuracy: 0.9935
395/469 [========================&gt;.....] - ETA: 2s - loss: 0.0056 - accuracy: 0.9935
397/469 [========================&gt;.....] - ETA: 2s - loss: 0.0056 - accuracy: 0.9935
399/469 [========================&gt;.....] - ETA: 2s - loss: 0.0056 - accuracy: 0.9935
401/469 [========================&gt;.....] - ETA: 2s - loss: 0.0056 - accuracy: 0.9935
403/469 [========================&gt;.....] - ETA: 1s - loss: 0.0056 - accuracy: 0.9935
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0056 - accuracy: 0.9935
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0056 - accuracy: 0.9935
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0056 - accuracy: 0.9935
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0056 - accuracy: 0.9935
413/469 [=========================&gt;....] - ETA: 1s - loss: 0.0056 - accuracy: 0.9935
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0056 - accuracy: 0.9936
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0055 - accuracy: 0.9936
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0055 - accuracy: 0.9936
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0056 - accuracy: 0.9936
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0055 - accuracy: 0.9936
425/469 [==========================&gt;...] - ETA: 1s - loss: 0.0056 - accuracy: 0.9936
427/469 [==========================&gt;...] - ETA: 1s - loss: 0.0056 - accuracy: 0.9935
429/469 [==========================&gt;...] - ETA: 1s - loss: 0.0056 - accuracy: 0.9936
431/469 [==========================&gt;...] - ETA: 1s - loss: 0.0056 - accuracy: 0.9935
433/469 [==========================&gt;...] - ETA: 1s - loss: 0.0056 - accuracy: 0.9936
435/469 [==========================&gt;...] - ETA: 1s - loss: 0.0055 - accuracy: 0.9936
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0055 - accuracy: 0.9936
439/469 [===========================&gt;..] - ETA: 0s - loss: 0.0055 - accuracy: 0.9936
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0055 - accuracy: 0.9936
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0055 - accuracy: 0.9936
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0056 - accuracy: 0.9936
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0056 - accuracy: 0.9936
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0056 - accuracy: 0.9936
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0056 - accuracy: 0.9936
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0056 - accuracy: 0.9935
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0056 - accuracy: 0.9935
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0056 - accuracy: 0.9936
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0056 - accuracy: 0.9935
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0056 - accuracy: 0.9935
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0056 - accuracy: 0.9935
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0056 - accuracy: 0.9935
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0056 - accuracy: 0.9935
469/469 [==============================] - ETA: 0s - loss: 0.0056 - accuracy: 0.9935
469/469 [==============================] - 15s 31ms/step - loss: 0.0056 - accuracy: 0.9935 - val_loss: 0.0071 - val_accuracy: 0.9900 - lr: 2.5119e-04
Epoch 5/5

  1/469 [..............................] - ETA: 0s - loss: 0.0034 - accuracy: 0.9922
  3/469 [..............................] - ETA: 9s - loss: 0.0021 - accuracy: 0.9974
  5/469 [..............................] - ETA: 11s - loss: 0.0019 - accuracy: 0.9984
  7/469 [..............................] - ETA: 11s - loss: 0.0019 - accuracy: 0.9989
  9/469 [..............................] - ETA: 12s - loss: 0.0029 - accuracy: 0.9974
 11/469 [..............................] - ETA: 12s - loss: 0.0032 - accuracy: 0.9957
 13/469 [..............................] - ETA: 12s - loss: 0.0033 - accuracy: 0.9958
 15/469 [..............................] - ETA: 12s - loss: 0.0036 - accuracy: 0.9953
 17/469 [&gt;.............................] - ETA: 12s - loss: 0.0036 - accuracy: 0.9949
 19/469 [&gt;.............................] - ETA: 12s - loss: 0.0038 - accuracy: 0.9951
 21/469 [&gt;.............................] - ETA: 12s - loss: 0.0036 - accuracy: 0.9952
 23/469 [&gt;.............................] - ETA: 12s - loss: 0.0035 - accuracy: 0.9956
 25/469 [&gt;.............................] - ETA: 12s - loss: 0.0040 - accuracy: 0.9950
 27/469 [&gt;.............................] - ETA: 12s - loss: 0.0041 - accuracy: 0.9951
 29/469 [&gt;.............................] - ETA: 12s - loss: 0.0048 - accuracy: 0.9943
 31/469 [&gt;.............................] - ETA: 12s - loss: 0.0048 - accuracy: 0.9945
 33/469 [=&gt;............................] - ETA: 12s - loss: 0.0048 - accuracy: 0.9943
 35/469 [=&gt;............................] - ETA: 12s - loss: 0.0047 - accuracy: 0.9944
 37/469 [=&gt;............................] - ETA: 12s - loss: 0.0048 - accuracy: 0.9939
 39/469 [=&gt;............................] - ETA: 12s - loss: 0.0048 - accuracy: 0.9940
 41/469 [=&gt;............................] - ETA: 12s - loss: 0.0048 - accuracy: 0.9939
 43/469 [=&gt;............................] - ETA: 12s - loss: 0.0050 - accuracy: 0.9938
 45/469 [=&gt;............................] - ETA: 12s - loss: 0.0048 - accuracy: 0.9941
 47/469 [==&gt;...........................] - ETA: 12s - loss: 0.0048 - accuracy: 0.9942
 49/469 [==&gt;...........................] - ETA: 12s - loss: 0.0046 - accuracy: 0.9944
 51/469 [==&gt;...........................] - ETA: 12s - loss: 0.0045 - accuracy: 0.9946
 53/469 [==&gt;...........................] - ETA: 12s - loss: 0.0045 - accuracy: 0.9948
 55/469 [==&gt;...........................] - ETA: 12s - loss: 0.0045 - accuracy: 0.9949
 57/469 [==&gt;...........................] - ETA: 12s - loss: 0.0044 - accuracy: 0.9951
 59/469 [==&gt;...........................] - ETA: 12s - loss: 0.0044 - accuracy: 0.9950
 61/469 [==&gt;...........................] - ETA: 12s - loss: 0.0044 - accuracy: 0.9950
 63/469 [===&gt;..........................] - ETA: 11s - loss: 0.0042 - accuracy: 0.9952
 65/469 [===&gt;..........................] - ETA: 11s - loss: 0.0042 - accuracy: 0.9953
 67/469 [===&gt;..........................] - ETA: 11s - loss: 0.0041 - accuracy: 0.9952
 69/469 [===&gt;..........................] - ETA: 11s - loss: 0.0042 - accuracy: 0.9951
 71/469 [===&gt;..........................] - ETA: 11s - loss: 0.0042 - accuracy: 0.9952
 73/469 [===&gt;..........................] - ETA: 11s - loss: 0.0041 - accuracy: 0.9953
 75/469 [===&gt;..........................] - ETA: 11s - loss: 0.0041 - accuracy: 0.9954
 77/469 [===&gt;..........................] - ETA: 11s - loss: 0.0042 - accuracy: 0.9952
 79/469 [====&gt;.........................] - ETA: 11s - loss: 0.0042 - accuracy: 0.9953
 81/469 [====&gt;.........................] - ETA: 11s - loss: 0.0041 - accuracy: 0.9954
 83/469 [====&gt;.........................] - ETA: 11s - loss: 0.0041 - accuracy: 0.9954
 85/469 [====&gt;.........................] - ETA: 11s - loss: 0.0040 - accuracy: 0.9955
 87/469 [====&gt;.........................] - ETA: 11s - loss: 0.0040 - accuracy: 0.9955
 89/469 [====&gt;.........................] - ETA: 11s - loss: 0.0040 - accuracy: 0.9954
 91/469 [====&gt;.........................] - ETA: 11s - loss: 0.0040 - accuracy: 0.9954
 93/469 [====&gt;.........................] - ETA: 11s - loss: 0.0041 - accuracy: 0.9952
 95/469 [=====&gt;........................] - ETA: 11s - loss: 0.0042 - accuracy: 0.9950
 97/469 [=====&gt;........................] - ETA: 11s - loss: 0.0042 - accuracy: 0.9950
 99/469 [=====&gt;........................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9951
101/469 [=====&gt;........................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9951
103/469 [=====&gt;........................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9952
105/469 [=====&gt;........................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9952
107/469 [=====&gt;........................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9953
109/469 [=====&gt;........................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9953
111/469 [======&gt;.......................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9954
113/469 [======&gt;.......................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9954
115/469 [======&gt;.......................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9953
117/469 [======&gt;.......................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9953
119/469 [======&gt;.......................] - ETA: 10s - loss: 0.0041 - accuracy: 0.9953
121/469 [======&gt;.......................] - ETA: 10s - loss: 0.0042 - accuracy: 0.9952
123/469 [======&gt;.......................] - ETA: 10s - loss: 0.0042 - accuracy: 0.9952
125/469 [======&gt;.......................] - ETA: 10s - loss: 0.0042 - accuracy: 0.9952
127/469 [=======&gt;......................] - ETA: 10s - loss: 0.0043 - accuracy: 0.9950
129/469 [=======&gt;......................] - ETA: 10s - loss: 0.0043 - accuracy: 0.9950
131/469 [=======&gt;......................] - ETA: 10s - loss: 0.0042 - accuracy: 0.9951
133/469 [=======&gt;......................] - ETA: 10s - loss: 0.0042 - accuracy: 0.9951
135/469 [=======&gt;......................] - ETA: 9s - loss: 0.0042 - accuracy: 0.9950 
137/469 [=======&gt;......................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9949
139/469 [=======&gt;......................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9949
141/469 [========&gt;.....................] - ETA: 9s - loss: 0.0044 - accuracy: 0.9949
143/469 [========&gt;.....................] - ETA: 9s - loss: 0.0044 - accuracy: 0.9949
145/469 [========&gt;.....................] - ETA: 9s - loss: 0.0044 - accuracy: 0.9949
147/469 [========&gt;.....................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9949
149/469 [========&gt;.....................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9949
151/469 [========&gt;.....................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9949
153/469 [========&gt;.....................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9949
155/469 [========&gt;.....................] - ETA: 9s - loss: 0.0042 - accuracy: 0.9950
157/469 [=========&gt;....................] - ETA: 9s - loss: 0.0042 - accuracy: 0.9950
159/469 [=========&gt;....................] - ETA: 9s - loss: 0.0042 - accuracy: 0.9950
161/469 [=========&gt;....................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9950
163/469 [=========&gt;....................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9950
165/469 [=========&gt;....................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9949
167/469 [=========&gt;....................] - ETA: 9s - loss: 0.0043 - accuracy: 0.9949
169/469 [=========&gt;....................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9950
171/469 [=========&gt;....................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
173/469 [==========&gt;...................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
175/469 [==========&gt;...................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
177/469 [==========&gt;...................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
179/469 [==========&gt;...................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9952
181/469 [==========&gt;...................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
183/469 [==========&gt;...................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
185/469 [==========&gt;...................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
187/469 [==========&gt;...................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
189/469 [===========&gt;..................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
191/469 [===========&gt;..................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9952
193/469 [===========&gt;..................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
195/469 [===========&gt;..................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
197/469 [===========&gt;..................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9951
199/469 [===========&gt;..................] - ETA: 8s - loss: 0.0043 - accuracy: 0.9950
201/469 [===========&gt;..................] - ETA: 7s - loss: 0.0043 - accuracy: 0.9949
203/469 [===========&gt;..................] - ETA: 7s - loss: 0.0043 - accuracy: 0.9950
205/469 [============&gt;.................] - ETA: 7s - loss: 0.0043 - accuracy: 0.9950
207/469 [============&gt;.................] - ETA: 7s - loss: 0.0043 - accuracy: 0.9950
209/469 [============&gt;.................] - ETA: 7s - loss: 0.0043 - accuracy: 0.9950
211/469 [============&gt;.................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9950
213/469 [============&gt;.................] - ETA: 7s - loss: 0.0043 - accuracy: 0.9950
215/469 [============&gt;.................] - ETA: 7s - loss: 0.0043 - accuracy: 0.9950
217/469 [============&gt;.................] - ETA: 7s - loss: 0.0043 - accuracy: 0.9951
219/469 [=============&gt;................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9951
221/469 [=============&gt;................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9952
223/469 [=============&gt;................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9952
225/469 [=============&gt;................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9952
227/469 [=============&gt;................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9952
229/469 [=============&gt;................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9952
231/469 [=============&gt;................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9952
233/469 [=============&gt;................] - ETA: 7s - loss: 0.0042 - accuracy: 0.9952
235/469 [==============&gt;...............] - ETA: 6s - loss: 0.0042 - accuracy: 0.9952
237/469 [==============&gt;...............] - ETA: 6s - loss: 0.0042 - accuracy: 0.9952
239/469 [==============&gt;...............] - ETA: 6s - loss: 0.0042 - accuracy: 0.9952
241/469 [==============&gt;...............] - ETA: 6s - loss: 0.0042 - accuracy: 0.9952
243/469 [==============&gt;...............] - ETA: 6s - loss: 0.0042 - accuracy: 0.9952
245/469 [==============&gt;...............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9952
247/469 [==============&gt;...............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9953
249/469 [==============&gt;...............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9952
251/469 [===============&gt;..............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9952
253/469 [===============&gt;..............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9952
255/469 [===============&gt;..............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9952
257/469 [===============&gt;..............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9952
259/469 [===============&gt;..............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9952
261/469 [===============&gt;..............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9953
263/469 [===============&gt;..............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9953
265/469 [===============&gt;..............] - ETA: 6s - loss: 0.0041 - accuracy: 0.9953
267/469 [================&gt;.............] - ETA: 6s - loss: 0.0040 - accuracy: 0.9954
269/469 [================&gt;.............] - ETA: 5s - loss: 0.0040 - accuracy: 0.9954
271/469 [================&gt;.............] - ETA: 5s - loss: 0.0040 - accuracy: 0.9954
273/469 [================&gt;.............] - ETA: 5s - loss: 0.0040 - accuracy: 0.9954
275/469 [================&gt;.............] - ETA: 5s - loss: 0.0040 - accuracy: 0.9955
277/469 [================&gt;.............] - ETA: 5s - loss: 0.0040 - accuracy: 0.9955
279/469 [================&gt;.............] - ETA: 5s - loss: 0.0040 - accuracy: 0.9954
281/469 [================&gt;.............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9954
283/469 [=================&gt;............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9954
285/469 [=================&gt;............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9954
287/469 [=================&gt;............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9953
289/469 [=================&gt;............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9953
291/469 [=================&gt;............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9953
293/469 [=================&gt;............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9953
295/469 [=================&gt;............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9954
297/469 [=================&gt;............] - ETA: 5s - loss: 0.0041 - accuracy: 0.9953
299/469 [==================&gt;...........] - ETA: 5s - loss: 0.0041 - accuracy: 0.9954
301/469 [==================&gt;...........] - ETA: 5s - loss: 0.0041 - accuracy: 0.9954
303/469 [==================&gt;...........] - ETA: 4s - loss: 0.0041 - accuracy: 0.9954
305/469 [==================&gt;...........] - ETA: 4s - loss: 0.0041 - accuracy: 0.9954
307/469 [==================&gt;...........] - ETA: 4s - loss: 0.0041 - accuracy: 0.9954
309/469 [==================&gt;...........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9954
311/469 [==================&gt;...........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
313/469 [===================&gt;..........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
315/469 [===================&gt;..........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
317/469 [===================&gt;..........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
319/469 [===================&gt;..........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
321/469 [===================&gt;..........] - ETA: 4s - loss: 0.0041 - accuracy: 0.9955
323/469 [===================&gt;..........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
325/469 [===================&gt;..........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
327/469 [===================&gt;..........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
329/469 [====================&gt;.........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
331/469 [====================&gt;.........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
333/469 [====================&gt;.........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
335/469 [====================&gt;.........] - ETA: 4s - loss: 0.0040 - accuracy: 0.9955
337/469 [====================&gt;.........] - ETA: 3s - loss: 0.0040 - accuracy: 0.9955
339/469 [====================&gt;.........] - ETA: 3s - loss: 0.0041 - accuracy: 0.9954
341/469 [====================&gt;.........] - ETA: 3s - loss: 0.0040 - accuracy: 0.9954
343/469 [====================&gt;.........] - ETA: 3s - loss: 0.0040 - accuracy: 0.9954
345/469 [=====================&gt;........] - ETA: 3s - loss: 0.0040 - accuracy: 0.9954
347/469 [=====================&gt;........] - ETA: 3s - loss: 0.0041 - accuracy: 0.9953
349/469 [=====================&gt;........] - ETA: 3s - loss: 0.0040 - accuracy: 0.9953
351/469 [=====================&gt;........] - ETA: 3s - loss: 0.0040 - accuracy: 0.9953
353/469 [=====================&gt;........] - ETA: 3s - loss: 0.0040 - accuracy: 0.9954
355/469 [=====================&gt;........] - ETA: 3s - loss: 0.0040 - accuracy: 0.9953
357/469 [=====================&gt;........] - ETA: 3s - loss: 0.0041 - accuracy: 0.9953
359/469 [=====================&gt;........] - ETA: 3s - loss: 0.0041 - accuracy: 0.9953
361/469 [======================&gt;.......] - ETA: 3s - loss: 0.0041 - accuracy: 0.9953
363/469 [======================&gt;.......] - ETA: 3s - loss: 0.0041 - accuracy: 0.9953
365/469 [======================&gt;.......] - ETA: 3s - loss: 0.0041 - accuracy: 0.9953
367/469 [======================&gt;.......] - ETA: 3s - loss: 0.0041 - accuracy: 0.9953
369/469 [======================&gt;.......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9953
371/469 [======================&gt;.......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9953
373/469 [======================&gt;.......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
375/469 [======================&gt;.......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
377/469 [=======================&gt;......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
379/469 [=======================&gt;......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
381/469 [=======================&gt;......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
383/469 [=======================&gt;......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9953
385/469 [=======================&gt;......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9953
387/469 [=======================&gt;......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
389/469 [=======================&gt;......] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
391/469 [========================&gt;.....] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
393/469 [========================&gt;.....] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
395/469 [========================&gt;.....] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
397/469 [========================&gt;.....] - ETA: 2s - loss: 0.0041 - accuracy: 0.9953
399/469 [========================&gt;.....] - ETA: 2s - loss: 0.0041 - accuracy: 0.9952
401/469 [========================&gt;.....] - ETA: 2s - loss: 0.0042 - accuracy: 0.9952
403/469 [========================&gt;.....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9952
405/469 [========================&gt;.....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9952
407/469 [=========================&gt;....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9952
409/469 [=========================&gt;....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9952
411/469 [=========================&gt;....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9952
413/469 [=========================&gt;....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9952
415/469 [=========================&gt;....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9952
417/469 [=========================&gt;....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9952
419/469 [=========================&gt;....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9951
421/469 [=========================&gt;....] - ETA: 1s - loss: 0.0042 - accuracy: 0.9951
423/469 [==========================&gt;...] - ETA: 1s - loss: 0.0042 - accuracy: 0.9951
425/469 [==========================&gt;...] - ETA: 1s - loss: 0.0043 - accuracy: 0.9951
427/469 [==========================&gt;...] - ETA: 1s - loss: 0.0042 - accuracy: 0.9951
429/469 [==========================&gt;...] - ETA: 1s - loss: 0.0042 - accuracy: 0.9951
431/469 [==========================&gt;...] - ETA: 1s - loss: 0.0043 - accuracy: 0.9951
433/469 [==========================&gt;...] - ETA: 1s - loss: 0.0043 - accuracy: 0.9951
435/469 [==========================&gt;...] - ETA: 1s - loss: 0.0043 - accuracy: 0.9951
437/469 [==========================&gt;...] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
439/469 [===========================&gt;..] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
441/469 [===========================&gt;..] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
443/469 [===========================&gt;..] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
445/469 [===========================&gt;..] - ETA: 0s - loss: 0.0043 - accuracy: 0.9952
447/469 [===========================&gt;..] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
449/469 [===========================&gt;..] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
451/469 [===========================&gt;..] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
453/469 [===========================&gt;..] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
455/469 [============================&gt;.] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
457/469 [============================&gt;.] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
459/469 [============================&gt;.] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
461/469 [============================&gt;.] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
463/469 [============================&gt;.] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
465/469 [============================&gt;.] - ETA: 0s - loss: 0.0043 - accuracy: 0.9951
467/469 [============================&gt;.] - ETA: 0s - loss: 0.0043 - accuracy: 0.9950
469/469 [==============================] - ETA: 0s - loss: 0.0043 - accuracy: 0.9950
469/469 [==============================] - 15s 31ms/step - loss: 0.0043 - accuracy: 0.9950 - val_loss: 0.0085 - val_accuracy: 0.9894 - lr: 1.5849e-04
Test score: 0.008540679700672626
Test accuracy: 0.9894999861717224
</pre></div>
</div>
</div>
</div>
<div class="section" id="convert-trained-model-for-akida-and-test">
<h2>5. Convert trained model for Akida and test<a class="headerlink" href="#convert-trained-model-for-akida-and-test" title="Permalink to this headline">¶</a></h2>
<div class="section" id="final-conversion">
<h3>5.1 Final conversion<a class="headerlink" href="#final-conversion" title="Permalink to this headline">¶</a></h3>
<p>Convert the quantized model to a version suitable to be used in the Akida NSoC
in inference mode:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One needs to supply the coefficients used to rescale the input
dataset before the training - here <code class="docutils literal notranslate"><span class="pre">input_scaling</span></code>.</p>
</div>
<p>As with Keras, the summary() method provides a textual representation of the
model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">convert</span>

<span class="n">model_akida</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span> <span class="n">input_scaling</span><span class="o">=</span><span class="n">input_scaling</span><span class="p">)</span>
<span class="n">model_akida</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>                        Model Summary
______________________________________________________________
Layer (type)                 Output shape  Kernel shape
==============================================================
conv_0 (InputConvolutional)  [14, 14, 32]  (5, 5, 1, 32)
______________________________________________________________
conv_1 (Convolutional)       [7, 7, 32]    (5, 5, 32, 32)
______________________________________________________________
conv_2 (Convolutional)       [7, 7, 32]    (5, 5, 32, 32)
______________________________________________________________
dense_2 (FullyConnected)     [1, 1, 512]   (1, 1, 1568, 512)
______________________________________________________________
dense_3 (FullyConnected)     [1, 1, 10]    (1, 1, 512, 10)
______________________________________________________________
Input shape: 28, 28, 1
Backend type: Software - 1.8.7
</pre></div>
</div>
</div>
<div class="section" id="performances-check-with-the-akida-execution-engine">
<h3>5.2 Performances check with the Akida Execution Engine<a class="headerlink" href="#performances-check-with-the-akida-execution-engine" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num_samples</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">model_akida</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">raw_x_test</span><span class="p">[:</span><span class="n">num_samples</span><span class="p">])</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">raw_y_test</span><span class="p">[:</span><span class="n">num_samples</span><span class="p">],</span> <span class="n">results</span><span class="p">[:</span><span class="n">num_samples</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">accuracy</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>

<span class="c1"># For non-regression purpose</span>
<span class="k">assert</span> <span class="n">accuracy</span> <span class="o">&gt;</span> <span class="mf">0.95</span>

<span class="c1"># Print model statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model statistics&quot;</span><span class="p">)</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">model_akida</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span>
<span class="n">model_akida</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">raw_x_test</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Accuracy: 98.60%
Model statistics
Layer (type)                  output sparsity
conv_0 (InputConvolutional)   0.86
Layer (type)                  input sparsity      output sparsity     ops
conv_1 (Convolutional)        0.86                0.77                712680
Layer (type)                  input sparsity      output sparsity     ops
conv_2 (Convolutional)        0.77                0.69                285440
Layer (type)                  input sparsity      output sparsity     ops
dense_2 (FullyConnected)      0.69                0.67                248806
Layer (type)                  input sparsity      output sparsity     ops
dense_3 (FullyConnected)      0.67                0.00                1670
</pre></div>
</div>
<p>Depending on the number of samples you run, you should find a
performance of around 99% (better results can be achieved using more
epochs for training).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Akida-compatible model first layer type is <code class="docutils literal notranslate"><span class="pre">InputConvolutional</span></code>
and holds underlying data to spike conversion (please refer to
<a class="reference external" href="../user_guide/aee.html">Akida Execution Engine documentation</a> for more details).</p>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 3 minutes  23.212 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-plot-cnn-flow-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5e3bf4dfd4795a473358be232d14448e/plot_cnn_flow.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_cnn_flow.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/7d452896f8a0cf5503747c045ac9c320/plot_cnn_flow.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_cnn_flow.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../license.html" class="btn btn-neutral float-right" title="License" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_mobilenet_imagenet.html" class="btn btn-neutral float-left" title="MobileNet/ImageNet inference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Copyright 2020, BrainChip Holdings Ltd. All Rights Reserved.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>