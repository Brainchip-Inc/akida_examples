<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vision transformers &mdash; Akida Examples  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Advanced QuantizeML tutorial" href="../quantization/plot_0_advanced_quantizeml.html" />
    <link rel="prev" title="Segmentation tutorial" href="plot_6_segmentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #989898" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/MetaTF_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Akida, 2nd Generation
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#supported-configurations">Supported configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#quick-installation">Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#running-examples">Running examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/user_guide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/akida.html">Akida user guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#programming-interface">Programming interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#the-akida-model">The Akida Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#akida-layers">Akida layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#model-hardware-mapping">Model Hardware Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#devices">Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#model-mapping">Model mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#advanced-mapping-details-and-hardware-devices-usage">Advanced Mapping Details and Hardware Devices Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#performance-measurement">Performance measurement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#using-akida-edge-learning">Using Akida Edge learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#learning-constraints">Learning constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#compiling-a-layer">Compiling a layer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quantizeml.html">QuantizeML toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#the-fixedpoint-representation">The FixedPoint representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#quantization-flow">Quantization flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#compatibility-constraints">Compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#model-loading">Model loading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#command-line-interface">Command line interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#quantize-cli">quantize CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#config-cli">config CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#check-cli">check CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#insert-rescaling-cli">insert_rescaling CLI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#supported-layer-types">Supported layer types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/cnn2snn.html">CNN2SNN toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#conversion-flow">Conversion flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#conversion-compatibility">Conversion compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#command-line-interface">Command-line interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#handling-akida-1-0-and-akida-2-0-specificities">Handling Akida 1.0 and Akida 2.0 specificities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#legacy-quantization-api">Legacy quantization API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#typical-quantization-scenario">Typical quantization scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#design-compatibility-constraints">Design compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#id3">Command-line interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#layers-considerations">Layers Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/akida_models.html">Akida models zoo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-creation">Command-line interface for model creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-training">Command-line interface for model training</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#kws-training">KWS training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#akidanet-training">AkidaNet training</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-evaluation">Command-line interface for model evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-to-evaluate-model-macs">Command-line interface to evaluate model MACS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#id1">Layer Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#handling-akida-1-0-and-akida-2-0-specificities">Handling Akida 1.0 and Akida 2.0 specificities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hw_constraints.html">Hardware constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#inputconvolutional">InputConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#convolutional">Convolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#separableconvolutional">SeparableConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#fullyconnected">FullyConnected</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/api_reference.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/akida_apis.html">Akida runtime</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#model">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#layer">Layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id1">Layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#mapping">Mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#akida-v1-layers">Akida V1 layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#akida-v2-layers">Akida V2 layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#layer-parameters">Layer parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#layertype">LayerType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#padding">Padding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#pooltype">PoolType</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#optimizers">Optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#sequence">Sequence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id2">Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#backendtype">BackendType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#pass">Pass</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#device">Device</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id3">Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#hwversion">HwVersion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#hwdevice">HWDevice</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id4">HWDevice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#socdriver">SocDriver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#clockmode">ClockMode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#powermeter">PowerMeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#np">NP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#tools">Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#sparsity">Sparsity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#compatibility">Compatibility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html">CNN2SNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#akida-version">Akida version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#conversion">Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#legacy-quantization-api">Legacy quantization API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#utils">Utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#calibration">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#transforms">Transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#constraint">Constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantization">Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizers">Quantizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantized-layers">Quantized layers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/quantizeml_apis.html">QuantizeML</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#layers">Layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#reshaping">Reshaping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#activations">Activations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#attention">Attention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#normalization">Normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#convolution">Convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#depthwise-convolution">Depthwise convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#separable-convolution">Separable convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#dense">Dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#skip-connection">Skip connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#pooling">Pooling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#shiftmax">Shiftmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#transformers">Transformers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#rescaling">Rescaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#dropout">Dropout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantizers">Quantizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantization-parameters">Quantization parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#calibration">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#recording">Recording</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#models">Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#transforms">Transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantization">Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#id1">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#utils">Utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#tensors">Tensors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#qtensor">QTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#fixedpoint">FixedPoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#qfloat">QFloat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/akida_models_apis.html">Akida models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#layer-blocks">Layer blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#cnn-blocks">CNN blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transformers-blocks">Transformers blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transposed-blocks">Transposed blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#detection-block">Detection block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#helpers">Helpers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#gamma-constraint">Gamma constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#unfusing-separableconvolutional">Unfusing SeparableConvolutional</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#extract-samples">Extract samples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#knowledge-distillation">Knowledge distillation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#macs">MACS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#model-i-o">Model I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#utils">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#model-zoo">Model zoo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#akidanet">AkidaNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#mobilenet">Mobilenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#ds-cnn">DS-CNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#vgg">VGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#yolo">YOLO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#pointnet">PointNet++</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#gxnor">GXNOR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#centernet">CenterNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#akidaunet">AkidaUNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transformers">Transformers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#general-examples">General examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_0_global_workflow.html">Global Akida workflow tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#create-and-train">1. Create and train</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#quantize">2. Quantize</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#convert">3. Convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#gxnor-mnist">4. GXNOR/MNIST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_1_akidanet_imagenet.html">AkidaNet/ImageNet inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#pretrained-quantized-model">2. Pretrained quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#conversion-to-akida">3. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#hardware-mapping-and-performance">4. Hardware mapping and performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_2_ds_cnn_kws.html">DS-CNN/KWS inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-the-preprocessed-dataset">1. Load the preprocessed dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#confusion-matrix">5. Confusion matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_3_regression.html">Age estimation (regression) example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-the-utkface-dataset">1. Load the UTKFace Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#estimate-age-on-a-single-image">5. Estimate age on a single image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_4_transfer_learning.html">Transfer learning with AkidaNet for PlantVillage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#transfer-learning-process">Transfer learning process</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#get-a-trained-akidanet-base-model">2. Get a trained AkidaNet base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#add-a-classification-head-to-the-model">3. Add a classification head to the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#freeze-the-base-model">4. Freeze the base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#train-for-a-few-epochs">5. Train for a few epochs</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#quantize-the-model">6. Quantize the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#compute-accuracy">7. Compute accuracy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_5_voc_yolo_detection.html">YOLO/PASCAL-VOC detection tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#introduction">1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#preprocessing-tools">2. Preprocessing tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#model-architecture">3. Model architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#training">4. Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#performance">5. Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#conversion-to-akida">6. Conversion to Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_6_segmentation.html">Segmentation tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-the-dataset">1. Load the dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#segment-a-single-image">5. Segment a single image</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Vision transformers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-a-transformer-model">2. Create a transformer model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quantization">3. Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attention-maps">5.3 Attention maps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#quantization">Quantization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html">Advanced QuantizeML tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html#defining-a-quantization-scheme">1. Defining a quantization scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html#calibration">2. Calibration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html">Upgrading to Akida 2.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#workflow-differences">1. Workflow differences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#models-architecture-differences">2. Models architecture differences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#using-akidaversion">3. Using <code class="docutils literal notranslate"><span class="pre">AkidaVersion</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#edge-examples">Edge examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html">Akida vision edge learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#prepare-akida-model-for-learning">2. Prepare Akida model for learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#edge-learning-with-akida">3. Edge learning with Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html">Akida edge learning for keyword spotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#edge-learning-process">1. Edge learning process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#dataset-preparation">2. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#prepare-akida-model-for-learning">3. Prepare Akida model for learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#learn-with-akida-using-the-training-set">4. Learn with Akida using the training set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#edge-learning">5. Edge learning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html">Tips to set Akida learning parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#akida-learning-parameters">1. Akida learning parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#create-akida-model">2. Create Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#estimate-the-required-number-of-weights-of-the-trainable-layer">3. Estimate the required number of weights of the trainable layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#estimate-the-number-of-neurons-per-class">4. Estimate the number of neurons per class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#deprecated-cnn2snn-tutorials">[Deprecated] CNN2SNN tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html">Advanced CNN2SNN tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#design-a-cnn2snn-quantized-model">1. Design a CNN2SNN quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#weight-quantizer-details">2. Weight Quantizer Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#understanding-quantized-activation">3. Understanding quantized activation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#how-to-deal-with-too-high-scale-factors">4. How to deal with too high scale factors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../model_zoo_performance.html">Model zoo performance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../model_zoo_performance.html#akida-1-0-models">Akida 1.0 models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#image-icon-ref-image-domain"> Image domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#classification">Classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#object-detection">Object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#regression">Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#face-recognition">Face recognition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#audio-icon-ref-audio-domain"> Audio domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#keyword-spotting">Keyword spotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#pointcloud-icon-ref-point-cloud"> Point cloud</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id1">Classification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../model_zoo_performance.html#akida-2-0-models">Akida 2.0 models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id2"> Image domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id3">Classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id6">Object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id7">Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id8">Face recognition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#segmentation">Segmentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id10"> Audio domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id11">Keyword spotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id12"> Point cloud</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id13">Classification</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://support.brainchip.com/portal/home">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #989898" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Akida Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Akida examples</a></li>
      <li class="breadcrumb-item active">Vision transformers</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-general-plot-7-vision-transformer-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="vision-transformers">
<span id="sphx-glr-examples-general-plot-7-vision-transformer-py"></span><h1>Vision transformers<a class="headerlink" href="#vision-transformers" title="Permalink to this headline"></a></h1>
<p>This tutorial demonstrates that Vision Transformers can be adapted and converted to Akida to perform
image classification.</p>
<p>Just like for the <a class="reference external" href="plot_1_akidanet_imagenet.html#sphx-glr-examples-general-plot-1-akidanet-imagenet-py">AkidaNet example</a>, ImageNet
images are not publicly available, performance is assessed using a set of 10 copyright free images
that were found on Google using ImageNet class names.</p>
<section id="dataset-preparation">
<h2>1. Dataset preparation<a class="headerlink" href="#dataset-preparation" title="Permalink to this headline"></a></h2>
<p>See <a class="reference external" href="plot_1_akidanet_imagenet.html#sphx-glr-examples-general-plot-1-akidanet-imagenet-py">AkidaNet example</a> for
details on dataset preparation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">tensorflow.io</span> <span class="kn">import</span> <span class="n">read_file</span>
<span class="kn">from</span> <span class="nn">tensorflow.image</span> <span class="kn">import</span> <span class="n">decode_jpeg</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">get_file</span>

<span class="kn">from</span> <span class="nn">akida_models.imagenet</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="c1"># Model specification and hyperparameters</span>
<span class="n">NUM_CHANNELS</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">IMAGE_SIZE</span> <span class="o">=</span> <span class="mi">224</span>

<span class="n">NUM_IMAGES</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Retrieve dataset file from Brainchip data server</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span>
    <span class="s2">&quot;imagenet_like.zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://data.brainchip.com/dataset-mirror/imagenet_like/imagenet_like.zip&quot;</span><span class="p">,</span>
    <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;datasets/imagenet_like&#39;</span><span class="p">,</span>
    <span class="n">extract</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># Load images for test set</span>
<span class="n">x_test_files</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NUM_IMAGES</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">,</span> <span class="n">NUM_CHANNELS</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">):</span>
    <span class="n">test_file</span> <span class="o">=</span> <span class="s1">&#39;image_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span>
    <span class="n">x_test_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
    <span class="n">img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">test_file</span><span class="p">)</span>
    <span class="n">base_image</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">decode_jpeg</span><span class="p">(</span><span class="n">base_image</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="n">NUM_CHANNELS</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">preprocess_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">)</span>
    <span class="n">x_test</span><span class="p">[</span><span class="nb">id</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">NUM_IMAGES</span><span class="si">}</span><span class="s1"> images loaded and preprocessed.&#39;</span><span class="p">)</span>

<span class="c1"># Parse labels file</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="s1">&#39;labels_validation.txt&#39;</span><span class="p">)</span>
<span class="n">validation_labels</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="n">validation_labels</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Get labels for the test set by index</span>
<span class="n">labels_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">):</span>
    <span class="n">labels_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">validation_labels</span><span class="p">[</span><span class="n">x_test_files</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>10 images loaded and preprocessed.
</pre></div>
</div>
</section>
<section id="create-a-transformer-model">
<h2>2. Create a transformer model<a class="headerlink" href="#create-a-transformer-model" title="Permalink to this headline"></a></h2>
<section id="selecting-an-architecture">
<h3>2.1. Selecting an architecture<a class="headerlink" href="#selecting-an-architecture" title="Permalink to this headline"></a></h3>
<p>Vision Transformers is a hot-topic in AI and new architectures are being introduced regularly.
When selecting an appropriate achitecture for Akida, some size, speed and training capabilities
must be considered.</p>
<p>The following table briefly shows what led to chose the ViT Tiny and DeiT-dist architectures:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 23%" />
<col style="width: 11%" />
<col style="width: 23%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Architecture</p></th>
<th class="head"><p>Original accuracy</p></th>
<th class="head"><p>#Params</p></th>
<th class="head"><p>Architecture</p></th>
<th class="head"><p>Commment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ViT Base</p></td>
<td><p>79.90%</p></td>
<td><p>86M</p></td>
<td><p>12 heads,
12 blocks,
hidden size 768</p></td>
<td><p>base model but huge
amount of parameters</p></td>
</tr>
<tr class="row-odd"><td><p>ViT Tiny</p></td>
<td><p>75.48%</p></td>
<td><p>5.8M</p></td>
<td><p>3 heads,
12 blocks,
hidden size 192</p></td>
<td><p>edge compatible</p></td>
</tr>
<tr class="row-even"><td><p>DeiT-dist
Tiny</p></td>
<td><p>74.17%</p></td>
<td><p>5.8M</p></td>
<td><p>3 heads,
12 blocks,
hidden size 192</p></td>
<td><p>easy to retrain
thanks to the
distilled token</p></td>
</tr>
</tbody>
</table>
<p>The model zoo then comes with two vision transformers architectures:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_vit_ti16">BC ViT Ti16</a>, which
is a modified version of <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.vit_ti16">ViT TI16</a> described in <a class="reference external" href="https://arxiv.org/abs/2010.11929">the
original ViT paper</a>,</p></li>
<li><p><a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_deit_ti16">BC DeiT-dist Ti16</a>,
which is a modified version of the original <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.deit_ti16">DeiT TI16</a> described in <a class="reference external" href="https://arxiv.org/abs/2012.12877">the
original DeiT-dist paper</a>.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Vision Transformers support has been introduced in Akida 2.0.</p>
</div>
</section>
<section id="model-transformations">
<h3>2.2. Model transformations<a class="headerlink" href="#model-transformations" title="Permalink to this headline"></a></h3>
<p>Both architectures have been modified so that their layers can be quantized to integer only
operations. The detailed list of changes is:</p>
<blockquote>
<div><ul class="simple">
<li><p>replace <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/LayerNormalization">LayerNormalization</a> with
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.LayerMadNormalization">LayerMadNormalization</a> and
replace the last normalization previous to the classification head with a <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization">BatchNormalization</a>,</p></li>
<li><p>replace <a class="reference external" href="https://www.tensorflow.org/addons/api_docs/python/tfa/layers/GELU">GeLU</a>
activations with <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/ReLU">ReLU8</a>,</p></li>
<li><p>replace the <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/activations/softmax">softmax</a> operation in
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.Attention">Attention</a> with a
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.shiftmax">shiftmax</a> operation.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Details on the custom layers and operations are given in the API docstrings.</p>
</div>
<p>Layer replacement is made possible through the <code class="docutils literal notranslate"><span class="pre">akida_models</span> <span class="pre">create</span></code> CLI that comes with
dedicated options for the <code class="docutils literal notranslate"><span class="pre">vit_ti16</span></code> and <code class="docutils literal notranslate"><span class="pre">deit_ti16</span></code> architectures. See for example the helper
for ViT:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>akida_models<span class="w"> </span>create<span class="w"> </span>vit_ti16<span class="w"> </span>-h
usage:<span class="w"> </span>akida_models<span class="w"> </span>create<span class="w"> </span>vit_ti16<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>-c<span class="w"> </span>CLASSES<span class="o">]</span><span class="w"> </span><span class="o">[</span>-bw<span class="w"> </span>BASE_WEIGHTS<span class="o">]</span><span class="w"> </span><span class="o">[</span>--norm<span class="w"> </span><span class="o">{</span>LN,GN1,BN,LMN<span class="o">}]</span>
<span class="w">                                    </span><span class="o">[</span>--last_norm<span class="w"> </span><span class="o">{</span>LN,BN<span class="o">}]</span><span class="w"> </span><span class="o">[</span>--softmax<span class="w"> </span><span class="o">{</span>softmax,softmax2<span class="o">}]</span>
<span class="w">                                    </span><span class="o">[</span>--act<span class="w"> </span><span class="o">{</span>GeLU,ReLU8,swish<span class="o">}]</span><span class="w"> </span><span class="o">[</span>-i<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}]</span>

optional<span class="w"> </span>arguments:
<span class="w">  </span>-h,<span class="w"> </span>--help<span class="w">            </span>show<span class="w"> </span>this<span class="w"> </span><span class="nb">help</span><span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span>
<span class="w">  </span>-c<span class="w"> </span>CLASSES,<span class="w"> </span>--classes<span class="w"> </span>CLASSES
<span class="w">                        </span>The<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>classes,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span><span class="m">1000</span>.
<span class="w">  </span>-bw<span class="w"> </span>BASE_WEIGHTS,<span class="w"> </span>--base_weights<span class="w"> </span>BASE_WEIGHTS
<span class="w">                        </span>Optional<span class="w"> </span>keras<span class="w"> </span>weights<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>model,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>None.
<span class="w">  </span>--norm<span class="w"> </span><span class="o">{</span>LN,GN1,BN,LMN<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>normalization<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>LN
<span class="w">  </span>--last_norm<span class="w"> </span><span class="o">{</span>LN,BN<span class="o">}</span><span class="w">   </span>Replace<span class="w"> </span>last<span class="w"> </span>normalization<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>LN
<span class="w">  </span>--softmax<span class="w"> </span><span class="o">{</span>softmax,softmax2<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>softmax<span class="w"> </span>operation<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>softmax
<span class="w">  </span>--act<span class="w"> </span><span class="o">{</span>GeLU,ReLU8,swish<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>activation<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>GeLU
<span class="w">  </span>-i<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}</span>,<span class="w"> </span>--image_size<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}</span>
<span class="w">                        </span>The<span class="w"> </span>square<span class="w"> </span>input<span class="w"> </span>image<span class="w"> </span>size
</pre></div>
</div>
<p>The replacement layers are functionaly equivalent to the base layers but an accuracy loss is
introduced at each step. This is compensated by a tuning step after each change.</p>
<p>For example, replacing activations layers can be done with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://data.brainchip.com/models/AkidaV2/vit/vit_ti16_224.h5
akida_models<span class="w"> </span>create<span class="w"> </span>-s<span class="w"> </span>vit_ti16_relu.h5<span class="w"> </span>vit_ti16<span class="w"> </span>-bw<span class="w"> </span>vit_ti16_224.h5<span class="w"> </span>--act<span class="w"> </span>ReLU8
imagenet_train<span class="w"> </span>tune<span class="w"> </span>-m<span class="w"> </span>vit_ti16_relu.h5<span class="w"> </span>-e<span class="w"> </span><span class="m">15</span><span class="w"> </span>--optim<span class="w"> </span>Adam<span class="w"> </span>--lr_policy<span class="w"> </span>cosine_decay<span class="w"> </span><span class="se">\</span>
<span class="w">                    </span>-lr<span class="w"> </span>6e-5<span class="w"> </span>-s<span class="w"> </span>vit_ti16_relu_tuned.h5
</pre></div>
</div>
<p>After all changes, the model accuracy is close to (or better than) the original model and the
“BC” transformer model is ready for quantization.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 40%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Architecture</p></th>
<th class="head"><p>Original accuracy</p></th>
<th class="head"><p>“BC” accuracy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ViT</p></td>
<td><p>75.48%</p></td>
<td><p>74.25%</p></td>
</tr>
<tr class="row-odd"><td><p>DeiT-dist</p></td>
<td><p>74.17%</p></td>
<td><p>75.03%</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the following sections, the ViT model will be used but the very same steps apply to
DeiT-dist.</p>
</div>
</section>
<section id="load-a-pre-trained-native-keras-model">
<h3>2.3. Load a pre-trained native Keras model<a class="headerlink" href="#load-a-pre-trained-native-keras-model" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models.model_io</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="c1"># Retrieve the float model with pretrained weights and load it</span>
<span class="n">model_file</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span>
    <span class="s2">&quot;bc_vit_ti16_224.h5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224.h5&quot;</span><span class="p">,</span>
    <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;models/akidanet_imagenet&#39;</span><span class="p">)</span>
<span class="n">model_keras</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">model_file</span><span class="p">)</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224.h5

    8192/23695632 [..............................] - ETA: 0s
   40960/23695632 [..............................] - ETA: 29s
   90112/23695632 [..............................] - ETA: 28s
  139264/23695632 [..............................] - ETA: 27s
  196608/23695632 [..............................] - ETA: 27s
  262144/23695632 [..............................] - ETA: 25s
  327680/23695632 [..............................] - ETA: 24s
  401408/23695632 [..............................] - ETA: 23s
  483328/23695632 [..............................] - ETA: 22s
  573440/23695632 [..............................] - ETA: 20s
  663552/23695632 [..............................] - ETA: 20s
  770048/23695632 [..............................] - ETA: 18s
  876544/23695632 [&gt;.............................] - ETA: 17s
  991232/23695632 [&gt;.............................] - ETA: 17s
 1114112/23695632 [&gt;.............................] - ETA: 16s
 1236992/23695632 [&gt;.............................] - ETA: 15s
 1359872/23695632 [&gt;.............................] - ETA: 15s
 1499136/23695632 [&gt;.............................] - ETA: 14s
 1638400/23695632 [=&gt;............................] - ETA: 13s
 1777664/23695632 [=&gt;............................] - ETA: 13s
 1925120/23695632 [=&gt;............................] - ETA: 12s
 2072576/23695632 [=&gt;............................] - ETA: 12s
 2236416/23695632 [=&gt;............................] - ETA: 11s
 2400256/23695632 [==&gt;...........................] - ETA: 11s
 2572288/23695632 [==&gt;...........................] - ETA: 11s
 2703360/23695632 [==&gt;...........................] - ETA: 10s
 2826240/23695632 [==&gt;...........................] - ETA: 10s
 2899968/23695632 [==&gt;...........................] - ETA: 10s
 3039232/23695632 [==&gt;...........................] - ETA: 10s
 3129344/23695632 [==&gt;...........................] - ETA: 10s
 3235840/23695632 [===&gt;..........................] - ETA: 10s
 3350528/23695632 [===&gt;..........................] - ETA: 10s
 3465216/23695632 [===&gt;..........................] - ETA: 10s
 3596288/23695632 [===&gt;..........................] - ETA: 10s
 3727360/23695632 [===&gt;..........................] - ETA: 10s
 3850240/23695632 [===&gt;..........................] - ETA: 10s
 3973120/23695632 [====&gt;.........................] - ETA: 9s 
 4104192/23695632 [====&gt;.........................] - ETA: 9s
 4218880/23695632 [====&gt;.........................] - ETA: 9s
 4317184/23695632 [====&gt;.........................] - ETA: 9s
 4448256/23695632 [====&gt;.........................] - ETA: 9s
 4562944/23695632 [====&gt;.........................] - ETA: 9s
 4694016/23695632 [====&gt;.........................] - ETA: 9s
 4841472/23695632 [=====&gt;........................] - ETA: 9s
 4988928/23695632 [=====&gt;........................] - ETA: 9s
 5136384/23695632 [=====&gt;........................] - ETA: 9s
 5300224/23695632 [=====&gt;........................] - ETA: 8s
 5464064/23695632 [=====&gt;........................] - ETA: 8s
 5627904/23695632 [======&gt;.......................] - ETA: 8s
 5644288/23695632 [======&gt;.......................] - ETA: 8s
 5857280/23695632 [======&gt;.......................] - ETA: 8s
 5988352/23695632 [======&gt;.......................] - ETA: 8s
 6119424/23695632 [======&gt;.......................] - ETA: 8s
 6250496/23695632 [======&gt;.......................] - ETA: 8s
 6381568/23695632 [=======&gt;......................] - ETA: 8s
 6529024/23695632 [=======&gt;......................] - ETA: 8s
 6676480/23695632 [=======&gt;......................] - ETA: 7s
 6840320/23695632 [=======&gt;......................] - ETA: 7s
 6987776/23695632 [=======&gt;......................] - ETA: 7s
 7135232/23695632 [========&gt;.....................] - ETA: 7s
 7331840/23695632 [========&gt;.....................] - ETA: 7s
 7528448/23695632 [========&gt;.....................] - ETA: 7s
 7725056/23695632 [========&gt;.....................] - ETA: 7s
 7938048/23695632 [=========&gt;....................] - ETA: 7s
 8134656/23695632 [=========&gt;....................] - ETA: 6s
 8364032/23695632 [=========&gt;....................] - ETA: 6s
 8593408/23695632 [=========&gt;....................] - ETA: 6s
 8822784/23695632 [==========&gt;...................] - ETA: 6s
 9052160/23695632 [==========&gt;...................] - ETA: 6s
 9281536/23695632 [==========&gt;...................] - ETA: 6s
 9478144/23695632 [==========&gt;...................] - ETA: 5s
 9707520/23695632 [===========&gt;..................] - ETA: 5s
 9904128/23695632 [===========&gt;..................] - ETA: 5s
10133504/23695632 [===========&gt;..................] - ETA: 5s
10379264/23695632 [============&gt;.................] - ETA: 5s
10625024/23695632 [============&gt;.................] - ETA: 5s
10887168/23695632 [============&gt;.................] - ETA: 5s
11132928/23695632 [=============&gt;................] - ETA: 4s
11280384/23695632 [=============&gt;................] - ETA: 4s
11591680/23695632 [=============&gt;................] - ETA: 4s
11804672/23695632 [=============&gt;................] - ETA: 4s
12001280/23695632 [==============&gt;...............] - ETA: 4s
12197888/23695632 [==============&gt;...............] - ETA: 4s
12410880/23695632 [==============&gt;...............] - ETA: 4s
12632064/23695632 [==============&gt;...............] - ETA: 4s
12820480/23695632 [===============&gt;..............] - ETA: 4s
13033472/23695632 [===============&gt;..............] - ETA: 3s
13230080/23695632 [===============&gt;..............] - ETA: 3s
13459456/23695632 [================&gt;.............] - ETA: 3s
13656064/23695632 [================&gt;.............] - ETA: 3s
13787136/23695632 [================&gt;.............] - ETA: 3s
14016512/23695632 [================&gt;.............] - ETA: 3s
14196736/23695632 [================&gt;.............] - ETA: 3s
14376960/23695632 [=================&gt;............] - ETA: 3s
14573568/23695632 [=================&gt;............] - ETA: 3s
14737408/23695632 [=================&gt;............] - ETA: 3s
14950400/23695632 [=================&gt;............] - ETA: 3s
15147008/23695632 [==================&gt;...........] - ETA: 3s
15327232/23695632 [==================&gt;...........] - ETA: 2s
15556608/23695632 [==================&gt;...........] - ETA: 2s
15785984/23695632 [==================&gt;...........] - ETA: 2s
15982592/23695632 [===================&gt;..........] - ETA: 2s
16211968/23695632 [===================&gt;..........] - ETA: 2s
16457728/23695632 [===================&gt;..........] - ETA: 2s
16695296/23695632 [====================&gt;.........] - ETA: 2s
16916480/23695632 [====================&gt;.........] - ETA: 2s
17178624/23695632 [====================&gt;.........] - ETA: 2s
17457152/23695632 [=====================&gt;........] - ETA: 2s
17735680/23695632 [=====================&gt;........] - ETA: 1s
17948672/23695632 [=====================&gt;........] - ETA: 1s
18014208/23695632 [=====================&gt;........] - ETA: 1s
18178048/23695632 [======================&gt;.......] - ETA: 1s
18309120/23695632 [======================&gt;.......] - ETA: 1s
18407424/23695632 [======================&gt;.......] - ETA: 1s
18505728/23695632 [======================&gt;.......] - ETA: 1s
18620416/23695632 [======================&gt;.......] - ETA: 1s
18735104/23695632 [======================&gt;.......] - ETA: 1s
18866176/23695632 [======================&gt;.......] - ETA: 1s
18997248/23695632 [=======================&gt;......] - ETA: 1s
19128320/23695632 [=======================&gt;......] - ETA: 1s
19275776/23695632 [=======================&gt;......] - ETA: 1s
19423232/23695632 [=======================&gt;......] - ETA: 1s
19570688/23695632 [=======================&gt;......] - ETA: 1s
19718144/23695632 [=======================&gt;......] - ETA: 1s
19898368/23695632 [========================&gt;.....] - ETA: 1s
20062208/23695632 [========================&gt;.....] - ETA: 1s
20242432/23695632 [========================&gt;.....] - ETA: 1s
20439040/23695632 [========================&gt;.....] - ETA: 1s
20619264/23695632 [=========================&gt;....] - ETA: 1s
20815872/23695632 [=========================&gt;....] - ETA: 0s
21012480/23695632 [=========================&gt;....] - ETA: 0s
21225472/23695632 [=========================&gt;....] - ETA: 0s
21454848/23695632 [==========================&gt;...] - ETA: 0s
21667840/23695632 [==========================&gt;...] - ETA: 0s
21913600/23695632 [==========================&gt;...] - ETA: 0s
22142976/23695632 [===========================&gt;..] - ETA: 0s
22388736/23695632 [===========================&gt;..] - ETA: 0s
22634496/23695632 [===========================&gt;..] - ETA: 0s
22896640/23695632 [===========================&gt;..] - ETA: 0s
23158784/23695632 [============================&gt;.] - ETA: 0s
23429120/23695632 [============================&gt;.] - ETA: 0s
23666688/23695632 [============================&gt;.] - ETA: 0s
23695632/23695632 [==============================] - 8s 0us/step
/usr/local/lib/python3.8/dist-packages/keras/initializers/initializers.py:120: UserWarning: The initializer TruncatedNormal is unseeded and being called multiple times, which will return identical values each time (even if the initializer is unseeded). Please update your code to provide a seed to the initializer, or avoid using the same initalizer instance more than once.
  warnings.warn(
Model: &quot;vit-tiny&quot;
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input (InputLayer)             [(None, 224, 224, 3  0           []
                                )]

 Rescale (Rescaling)            (None, 224, 224, 3)  0           [&#39;input[0][0]&#39;]

 Embedding (Conv2D)             (None, 14, 14, 192)  147648      [&#39;Rescale[0][0]&#39;]

 reshape (Reshape)              (None, 196, 192)     0           [&#39;Embedding[0][0]&#39;]

 ClassToken (ClassToken)        (None, 197, 192)     192         [&#39;reshape[0][0]&#39;]

 Transformer/PosEmbed (AddPosit  (None, 197, 192)    37824       [&#39;ClassToken[0][0]&#39;]
 ionEmbs)

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    384         [&#39;Transformer/PosEmbed[0][0]&#39;]
 erNorm_0 (LayerMadNormalizatio
 n)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_0/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout (Dropout)              (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    0           [&#39;dropout[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/PosEmbed[0][0]&#39;]

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_0/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_0/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_1 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 192)    147648      [&#39;dropout_1[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_2 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_0/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_1/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_3 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    0           [&#39;dropout_3[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_0/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_1/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_1/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_4 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 192)    147648      [&#39;dropout_4[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_5 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_1/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_5[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_2/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_6 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    0           [&#39;dropout_6[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_1/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_2/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_2/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_7 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 192)    147648      [&#39;dropout_7[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_8 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_2/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_8[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_3/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_9 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    0           [&#39;dropout_9[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_2/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_3/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_3/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_10 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 192)    147648      [&#39;dropout_10[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_11 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_3/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_11[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_4/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_12 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    0           [&#39;dropout_12[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_3/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_4/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_4/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_13 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 192)    147648      [&#39;dropout_13[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_14 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_4/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_14[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_5/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_15 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    0           [&#39;dropout_15[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_4/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_5/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_5/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_16 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 192)    147648      [&#39;dropout_16[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_17 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_5/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_17[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_6/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_18 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    0           [&#39;dropout_18[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_5/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_6/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_6/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_19 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 192)    147648      [&#39;dropout_19[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_20 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_6/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_20[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_7/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_21 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    0           [&#39;dropout_21[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_6/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_7/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_7/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_22 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 192)    147648      [&#39;dropout_22[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_23 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_7/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_23[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_8/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_24 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    0           [&#39;dropout_24[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_7/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_8/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_8/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_25 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 192)    147648      [&#39;dropout_25[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_26 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_8/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_26[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_9/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_27 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    0           [&#39;dropout_27[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_8/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_9/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_9/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_28 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 192)    147648      [&#39;dropout_28[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_29 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_9/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_29[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 yerNorm_0 (LayerMadNormalizati                                  2[0][0]&#39;]
 on)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (Dense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (Dense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (Dense)

 Transformer/EncoderBlock_10/Mu  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (Attention)           ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (Dense)                                                      tion[0][0]&#39;]

 dropout_30 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    0           [&#39;dropout_30[0][0]&#39;,
 d_1 (Add)                                                        &#39;Transformer/EncoderBlock_9/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_2 (LayerMadNormalizati                                  _1[0][0]&#39;]
 on)

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_10/Lay
 pBlock/Dense_0 (Dense)                                          erNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_10/Mlp
 pBlock/activation (ReLU)                                        Block/Dense_0[0][0]&#39;]

 dropout_31 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 192)    147648      [&#39;dropout_31[0][0]&#39;]
 pBlock/Dense_1 (Dense)

 dropout_32 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_10/add
 d_2 (Add)                                                       _1[0][0]&#39;,
                                                                  &#39;dropout_32[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_0 (LayerMadNormalizati                                  _2[0][0]&#39;]
 on)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (Dense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (Dense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (Dense)

 Transformer/EncoderBlock_11/Mu  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (Attention)           ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (Dense)                                                      tion[0][0]&#39;]

 dropout_33 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;dropout_33[0][0]&#39;,
 d_1 (Add)                                                        &#39;Transformer/EncoderBlock_10/add
                                                                 _2[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_11/add
 yerNorm_2 (LayerMadNormalizati                                  _1[0][0]&#39;]
 on)

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_11/Lay
 pBlock/Dense_0 (Dense)                                          erNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_11/Mlp
 pBlock/activation (ReLU)                                        Block/Dense_0[0][0]&#39;]

 dropout_34 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 192)    147648      [&#39;dropout_34[0][0]&#39;]
 pBlock/Dense_1 (Dense)

 dropout_35 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_11/add
 d_2 (Add)                                                       _1[0][0]&#39;,
                                                                  &#39;dropout_35[0][0]&#39;]

 Transformer/EncoderNorm (Batch  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_11/add
 Normalization)                                                  _2[0][0]&#39;]

 ExtractToken (ExtractToken)    (None, 192)          0           [&#39;Transformer/EncoderNorm[0][0]&#39;]

 Head (Dense)                   (None, 1000)         193000      [&#39;ExtractToken[0][0]&#39;]

==================================================================================================
Total params: 5,717,800
Trainable params: 5,717,416
Non-trainable params: 384
__________________________________________________________________________________________________
</pre></div>
</div>
<p>The perfomance given below uses the 10 ImageNet like images subset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check model performance</span>
<span class="k">def</span> <span class="nf">check_model_performance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_test</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">labels_test</span><span class="o">=</span><span class="n">labels_test</span><span class="p">):</span>
    <span class="n">outputs_keras</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">NUM_IMAGES</span><span class="p">)</span>
    <span class="n">outputs_keras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">outputs_keras</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">accuracy_keras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">outputs_keras</span><span class="p">,</span> <span class="n">labels_test</span><span class="p">))</span> <span class="o">/</span> <span class="n">NUM_IMAGES</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Keras accuracy: </span><span class="si">{</span><span class="n">accuracy_keras</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_keras</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 1s 1s/step
Keras accuracy: 100.00 %
</pre></div>
</div>
</section>
</section>
<section id="quantization">
<h2>3. Quantization<a class="headerlink" href="#quantization" title="Permalink to this headline"></a></h2>
<section id="bit-ptq">
<h3>3.1. 8-bit PTQ<a class="headerlink" href="#bit-ptq" title="Permalink to this headline"></a></h3>
<p>The above native Keras model is quantized to 8-bit (all weights and activations) and we compute
the post-training quantization (PTQ) accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">fetch_file</span>

<span class="c1"># Retrieve calibration samples</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">fetch_file</span><span class="p">(</span><span class="s2">&quot;https://data.brainchip.com/dataset-mirror/samples/imagenet/imagenet_batch1024_224.npz&quot;</span><span class="p">,</span>
                     <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;imagenet_batch1024_224.npz&quot;</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">samples</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">samples</span><span class="o">.</span><span class="n">files</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/dataset-mirror/samples/imagenet/imagenet_batch1024_224.npz.

        0/616562950 [..............................] - ETA: 0s
    90112/616562950 [..............................] - ETA: 6:18
   327680/616562950 [..............................] - ETA: 3:35
   999424/616562950 [..............................] - ETA: 1:42
  1351680/616562950 [..............................] - ETA: 1:38
  1736704/616562950 [..............................] - ETA: 1:34
  2113536/616562950 [..............................] - ETA: 1:32
  2498560/616562950 [..............................] - ETA: 1:30
  2883584/616562950 [..............................] - ETA: 1:28
  3284992/616562950 [..............................] - ETA: 1:27
  3702784/616562950 [..............................] - ETA: 1:26
  4104192/616562950 [..............................] - ETA: 1:25
  4513792/616562950 [..............................] - ETA: 1:24
  4939776/616562950 [..............................] - ETA: 1:23
  5382144/616562950 [..............................] - ETA: 1:22
  5791744/616562950 [..............................] - ETA: 1:21
  6234112/616562950 [..............................] - ETA: 1:20
  6660096/616562950 [..............................] - ETA: 1:20
  7135232/616562950 [..............................] - ETA: 1:19
  7577600/616562950 [..............................] - ETA: 1:18
  8036352/616562950 [..............................] - ETA: 1:18
  8478720/616562950 [..............................] - ETA: 1:17
  8708096/616562950 [..............................] - ETA: 1:19
  9117696/616562950 [..............................] - ETA: 1:19
  9428992/616562950 [..............................] - ETA: 1:20
  9723904/616562950 [..............................] - ETA: 1:21
 10018816/616562950 [..............................] - ETA: 1:21
 10313728/616562950 [..............................] - ETA: 1:22
 10608640/616562950 [..............................] - ETA: 1:22
 10903552/616562950 [..............................] - ETA: 1:25
 11329536/616562950 [..............................] - ETA: 1:24
 11591680/616562950 [..............................] - ETA: 1:25
 11837440/616562950 [..............................] - ETA: 1:26
 12099584/616562950 [..............................] - ETA: 1:26
 12361728/616562950 [..............................] - ETA: 1:27
 12640256/616562950 [..............................] - ETA: 1:27
 12918784/616562950 [..............................] - ETA: 1:28
 13213696/616562950 [..............................] - ETA: 1:28
 13508608/616562950 [..............................] - ETA: 1:29
 13819904/616562950 [..............................] - ETA: 1:29
 14131200/616562950 [..............................] - ETA: 1:29
 14442496/616562950 [..............................] - ETA: 1:29
 14753792/616562950 [..............................] - ETA: 1:29
 15081472/616562950 [..............................] - ETA: 1:30
 15425536/616562950 [..............................] - ETA: 1:30
 15753216/616562950 [..............................] - ETA: 1:30
 16097280/616562950 [..............................] - ETA: 1:30
 16408576/616562950 [..............................] - ETA: 1:30
 16719872/616562950 [..............................] - ETA: 1:30
 17014784/616562950 [..............................] - ETA: 1:30
 17309696/616562950 [..............................] - ETA: 1:30
 17596416/616562950 [..............................] - ETA: 1:31
 17899520/616562950 [..............................] - ETA: 1:31
 18292736/616562950 [..............................] - ETA: 1:30
 18636800/616562950 [..............................] - ETA: 1:30
 19013632/616562950 [..............................] - ETA: 1:30
 19390464/616562950 [..............................] - ETA: 1:30
 19808256/616562950 [..............................] - ETA: 1:30
 20160512/616562950 [..............................] - ETA: 1:29
 20570112/616562950 [&gt;.............................] - ETA: 1:29
 20996096/616562950 [&gt;.............................] - ETA: 1:29
 21372928/616562950 [&gt;.............................] - ETA: 1:28
 21798912/616562950 [&gt;.............................] - ETA: 1:28
 22159360/616562950 [&gt;.............................] - ETA: 1:28
 22372352/616562950 [&gt;.............................] - ETA: 1:29
 22601728/616562950 [&gt;.............................] - ETA: 1:29
 22913024/616562950 [&gt;.............................] - ETA: 1:29
 23126016/616562950 [&gt;.............................] - ETA: 1:30
 23339008/616562950 [&gt;.............................] - ETA: 1:30
 23552000/616562950 [&gt;.............................] - ETA: 1:31
 23781376/616562950 [&gt;.............................] - ETA: 1:31
 24010752/616562950 [&gt;.............................] - ETA: 1:31
 24240128/616562950 [&gt;.............................] - ETA: 1:32
 24469504/616562950 [&gt;.............................] - ETA: 1:32
 24698880/616562950 [&gt;.............................] - ETA: 1:32
 24944640/616562950 [&gt;.............................] - ETA: 1:33
 25190400/616562950 [&gt;.............................] - ETA: 1:33
 25436160/616562950 [&gt;.............................] - ETA: 1:33
 25714688/616562950 [&gt;.............................] - ETA: 1:34
 25976832/616562950 [&gt;.............................] - ETA: 1:34
 26255360/616562950 [&gt;.............................] - ETA: 1:34
 26533888/616562950 [&gt;.............................] - ETA: 1:34
 26836992/616562950 [&gt;.............................] - ETA: 1:34
 27123712/616562950 [&gt;.............................] - ETA: 1:34
 27418624/616562950 [&gt;.............................] - ETA: 1:34
 27746304/616562950 [&gt;.............................] - ETA: 1:34
 28073984/616562950 [&gt;.............................] - ETA: 1:34
 28385280/616562950 [&gt;.............................] - ETA: 1:34
 28647424/616562950 [&gt;.............................] - ETA: 1:35
 28975104/616562950 [&gt;.............................] - ETA: 1:35
 29204480/616562950 [&gt;.............................] - ETA: 1:35
 29433856/616562950 [&gt;.............................] - ETA: 1:35
 29679616/616562950 [&gt;.............................] - ETA: 1:36
 29925376/616562950 [&gt;.............................] - ETA: 1:36
 30154752/616562950 [&gt;.............................] - ETA: 1:36
 30400512/616562950 [&gt;.............................] - ETA: 1:36
 30646272/616562950 [&gt;.............................] - ETA: 1:36
 30892032/616562950 [&gt;.............................] - ETA: 1:36
 31154176/616562950 [&gt;.............................] - ETA: 1:37
 31399936/616562950 [&gt;.............................] - ETA: 1:37
 31662080/616562950 [&gt;.............................] - ETA: 1:37
 31924224/616562950 [&gt;.............................] - ETA: 1:37
 32137216/616562950 [&gt;.............................] - ETA: 1:37
 32350208/616562950 [&gt;.............................] - ETA: 1:38
 32546816/616562950 [&gt;.............................] - ETA: 1:38
 32759808/616562950 [&gt;.............................] - ETA: 1:38
 32972800/616562950 [&gt;.............................] - ETA: 1:38
 33185792/616562950 [&gt;.............................] - ETA: 1:39
 33431552/616562950 [&gt;.............................] - ETA: 1:39
 33660928/616562950 [&gt;.............................] - ETA: 1:39
 33906688/616562950 [&gt;.............................] - ETA: 1:39
 34152448/616562950 [&gt;.............................] - ETA: 1:39
 34283520/616562950 [&gt;.............................] - ETA: 1:40
 34480128/616562950 [&gt;.............................] - ETA: 1:41
 34611200/616562950 [&gt;.............................] - ETA: 1:42
 34775040/616562950 [&gt;.............................] - ETA: 1:42
 34873344/616562950 [&gt;.............................] - ETA: 1:43
 34971648/616562950 [&gt;.............................] - ETA: 1:43
 35086336/616562950 [&gt;.............................] - ETA: 1:44
 35201024/616562950 [&gt;.............................] - ETA: 1:44
 35315712/616562950 [&gt;.............................] - ETA: 1:45
 35446784/616562950 [&gt;.............................] - ETA: 1:45
 35577856/616562950 [&gt;.............................] - ETA: 1:46
 35725312/616562950 [&gt;.............................] - ETA: 1:46
 35872768/616562950 [&gt;.............................] - ETA: 1:47
 36036608/616562950 [&gt;.............................] - ETA: 1:47
 36200448/616562950 [&gt;.............................] - ETA: 1:48
 36364288/616562950 [&gt;.............................] - ETA: 1:48
 36528128/616562950 [&gt;.............................] - ETA: 1:48
 36691968/616562950 [&gt;.............................] - ETA: 1:48
 36872192/616562950 [&gt;.............................] - ETA: 1:49
 37068800/616562950 [&gt;.............................] - ETA: 1:49
 37265408/616562950 [&gt;.............................] - ETA: 1:49
 37445632/616562950 [&gt;.............................] - ETA: 1:50
 37642240/616562950 [&gt;.............................] - ETA: 1:50
 37822464/616562950 [&gt;.............................] - ETA: 1:50
 38019072/616562950 [&gt;.............................] - ETA: 1:50
 38232064/616562950 [&gt;.............................] - ETA: 1:50
 38445056/616562950 [&gt;.............................] - ETA: 1:50
 38674432/616562950 [&gt;.............................] - ETA: 1:51
 38903808/616562950 [&gt;.............................] - ETA: 1:51
 39116800/616562950 [&gt;.............................] - ETA: 1:51
 39362560/616562950 [&gt;.............................] - ETA: 1:51
 39608320/616562950 [&gt;.............................] - ETA: 1:51
 39821312/616562950 [&gt;.............................] - ETA: 1:51
 40083456/616562950 [&gt;.............................] - ETA: 1:51
 40329216/616562950 [&gt;.............................] - ETA: 1:51
 40574976/616562950 [&gt;.............................] - ETA: 1:51
 40837120/616562950 [&gt;.............................] - ETA: 1:51
 41082880/616562950 [&gt;.............................] - ETA: 1:51
 41361408/616562950 [=&gt;............................] - ETA: 1:51
 41623552/616562950 [=&gt;............................] - ETA: 1:51
 41885696/616562950 [=&gt;............................] - ETA: 1:51
 42164224/616562950 [=&gt;............................] - ETA: 1:51
 42442752/616562950 [=&gt;............................] - ETA: 1:51
 42737664/616562950 [=&gt;............................] - ETA: 1:50
 43032576/616562950 [=&gt;............................] - ETA: 1:50
 43343872/616562950 [=&gt;............................] - ETA: 1:50
 43638784/616562950 [=&gt;............................] - ETA: 1:50
 43950080/616562950 [=&gt;............................] - ETA: 1:50
 44277760/616562950 [=&gt;............................] - ETA: 1:50
 44605440/616562950 [=&gt;............................] - ETA: 1:49
 44933120/616562950 [=&gt;............................] - ETA: 1:49
 45277184/616562950 [=&gt;............................] - ETA: 1:49
 45621248/616562950 [=&gt;............................] - ETA: 1:49
 45965312/616562950 [=&gt;............................] - ETA: 1:48
 46309376/616562950 [=&gt;............................] - ETA: 1:48
 46653440/616562950 [=&gt;............................] - ETA: 1:48
 46997504/616562950 [=&gt;............................] - ETA: 1:48
 47374336/616562950 [=&gt;............................] - ETA: 1:47
 47751168/616562950 [=&gt;............................] - ETA: 1:47
 48111616/616562950 [=&gt;............................] - ETA: 1:47
 48488448/616562950 [=&gt;............................] - ETA: 1:46
 48881664/616562950 [=&gt;............................] - ETA: 1:46
 49291264/616562950 [=&gt;............................] - ETA: 1:46
 49635328/616562950 [=&gt;............................] - ETA: 1:46
 49799168/616562950 [=&gt;............................] - ETA: 1:46
 50159616/616562950 [=&gt;............................] - ETA: 1:46
 50438144/616562950 [=&gt;............................] - ETA: 1:45
 50700288/616562950 [=&gt;............................] - ETA: 1:45
 50978816/616562950 [=&gt;............................] - ETA: 1:45
 51240960/616562950 [=&gt;............................] - ETA: 1:45
 51519488/616562950 [=&gt;............................] - ETA: 1:45
 51798016/616562950 [=&gt;............................] - ETA: 1:45
 52076544/616562950 [=&gt;............................] - ETA: 1:45
 52346880/616562950 [=&gt;............................] - ETA: 1:45
 52617216/616562950 [=&gt;............................] - ETA: 1:45
 52895744/616562950 [=&gt;............................] - ETA: 1:45
 53157888/616562950 [=&gt;............................] - ETA: 1:45
 53452800/616562950 [=&gt;............................] - ETA: 1:45
 53731328/616562950 [=&gt;............................] - ETA: 1:45
 54009856/616562950 [=&gt;............................] - ETA: 1:45
 54288384/616562950 [=&gt;............................] - ETA: 1:45
 54452224/616562950 [=&gt;............................] - ETA: 1:45
 54796288/616562950 [=&gt;............................] - ETA: 1:45
 55042048/616562950 [=&gt;............................] - ETA: 1:45
 55287808/616562950 [=&gt;............................] - ETA: 1:45
 55549952/616562950 [=&gt;............................] - ETA: 1:45
 55812096/616562950 [=&gt;............................] - ETA: 1:45
 56090624/616562950 [=&gt;............................] - ETA: 1:45
 56369152/616562950 [=&gt;............................] - ETA: 1:45
 56647680/616562950 [=&gt;............................] - ETA: 1:45
 56926208/616562950 [=&gt;............................] - ETA: 1:45
 57204736/616562950 [=&gt;............................] - ETA: 1:44
 57483264/616562950 [=&gt;............................] - ETA: 1:44
 57778176/616562950 [=&gt;............................] - ETA: 1:44
 58073088/616562950 [=&gt;............................] - ETA: 1:44
 58368000/616562950 [=&gt;............................] - ETA: 1:44
 58662912/616562950 [=&gt;............................] - ETA: 1:44
 58941440/616562950 [=&gt;............................] - ETA: 1:44
 59236352/616562950 [=&gt;............................] - ETA: 1:44
 59531264/616562950 [=&gt;............................] - ETA: 1:44
 59826176/616562950 [=&gt;............................] - ETA: 1:44
 60121088/616562950 [=&gt;............................] - ETA: 1:44
 60416000/616562950 [=&gt;............................] - ETA: 1:44
 60710912/616562950 [=&gt;............................] - ETA: 1:43
 61005824/616562950 [=&gt;............................] - ETA: 1:43
 61300736/616562950 [=&gt;............................] - ETA: 1:43
 61497344/616562950 [=&gt;............................] - ETA: 1:43
 61874176/616562950 [==&gt;...........................] - ETA: 1:43
 62119936/616562950 [==&gt;...........................] - ETA: 1:43
 62382080/616562950 [==&gt;...........................] - ETA: 1:43
 62660608/616562950 [==&gt;...........................] - ETA: 1:43
 62922752/616562950 [==&gt;...........................] - ETA: 1:43
 63201280/616562950 [==&gt;...........................] - ETA: 1:43
 63496192/616562950 [==&gt;...........................] - ETA: 1:43
 63774720/616562950 [==&gt;...........................] - ETA: 1:43
 64053248/616562950 [==&gt;...........................] - ETA: 1:43
 64315392/616562950 [==&gt;...........................] - ETA: 1:43
 64512000/616562950 [==&gt;...........................] - ETA: 1:43
 64708608/616562950 [==&gt;...........................] - ETA: 1:43
 64921600/616562950 [==&gt;...........................] - ETA: 1:43
 65150976/616562950 [==&gt;...........................] - ETA: 1:43
 65363968/616562950 [==&gt;...........................] - ETA: 1:43
 65462272/616562950 [==&gt;...........................] - ETA: 1:44
 65691648/616562950 [==&gt;...........................] - ETA: 1:44
 65871872/616562950 [==&gt;...........................] - ETA: 1:44
 66052096/616562950 [==&gt;...........................] - ETA: 1:44
 66215936/616562950 [==&gt;...........................] - ETA: 1:44
 66412544/616562950 [==&gt;...........................] - ETA: 1:44
 66609152/616562950 [==&gt;...........................] - ETA: 1:44
 66789376/616562950 [==&gt;...........................] - ETA: 1:44
 66985984/616562950 [==&gt;...........................] - ETA: 1:44
 67182592/616562950 [==&gt;...........................] - ETA: 1:44
 67379200/616562950 [==&gt;...........................] - ETA: 1:44
 67608576/616562950 [==&gt;...........................] - ETA: 1:44
 67837952/616562950 [==&gt;...........................] - ETA: 1:44
 68050944/616562950 [==&gt;...........................] - ETA: 1:45
 68280320/616562950 [==&gt;...........................] - ETA: 1:45
 68526080/616562950 [==&gt;...........................] - ETA: 1:45
 68755456/616562950 [==&gt;...........................] - ETA: 1:45
 69001216/616562950 [==&gt;...........................] - ETA: 1:45
 69246976/616562950 [==&gt;...........................] - ETA: 1:45
 69492736/616562950 [==&gt;...........................] - ETA: 1:45
 69746688/616562950 [==&gt;...........................] - ETA: 1:44
 70000640/616562950 [==&gt;...........................] - ETA: 1:44
 70262784/616562950 [==&gt;...........................] - ETA: 1:44
 70524928/616562950 [==&gt;...........................] - ETA: 1:44
 70803456/616562950 [==&gt;...........................] - ETA: 1:44
 71081984/616562950 [==&gt;...........................] - ETA: 1:44
 71360512/616562950 [==&gt;...........................] - ETA: 1:44
 71655424/616562950 [==&gt;...........................] - ETA: 1:44
 71950336/616562950 [==&gt;...........................] - ETA: 1:44
 72245248/616562950 [==&gt;...........................] - ETA: 1:44
 72540160/616562950 [==&gt;...........................] - ETA: 1:44
 72851456/616562950 [==&gt;...........................] - ETA: 1:44
 73146368/616562950 [==&gt;...........................] - ETA: 1:44
 73457664/616562950 [==&gt;...........................] - ETA: 1:43
 73768960/616562950 [==&gt;...........................] - ETA: 1:43
 74080256/616562950 [==&gt;...........................] - ETA: 1:43
 74407936/616562950 [==&gt;...........................] - ETA: 1:43
 74719232/616562950 [==&gt;...........................] - ETA: 1:43
 75030528/616562950 [==&gt;...........................] - ETA: 1:43
 75358208/616562950 [==&gt;...........................] - ETA: 1:43
 75669504/616562950 [==&gt;...........................] - ETA: 1:43
 75997184/616562950 [==&gt;...........................] - ETA: 1:42
 76308480/616562950 [==&gt;...........................] - ETA: 1:42
 76619776/616562950 [==&gt;...........................] - ETA: 1:42
 76931072/616562950 [==&gt;...........................] - ETA: 1:42
 77258752/616562950 [==&gt;...........................] - ETA: 1:42
 77570048/616562950 [==&gt;...........................] - ETA: 1:42
 77881344/616562950 [==&gt;...........................] - ETA: 1:42
 78192640/616562950 [==&gt;...........................] - ETA: 1:42
 78520320/616562950 [==&gt;...........................] - ETA: 1:41
 78880768/616562950 [==&gt;...........................] - ETA: 1:41
 79241216/616562950 [==&gt;...........................] - ETA: 1:41
 79618048/616562950 [==&gt;...........................] - ETA: 1:41
 79994880/616562950 [==&gt;...........................] - ETA: 1:41
 80355328/616562950 [==&gt;...........................] - ETA: 1:40
 80723968/616562950 [==&gt;...........................] - ETA: 1:40
 81076224/616562950 [==&gt;...........................] - ETA: 1:40
 81436672/616562950 [==&gt;...........................] - ETA: 1:40
 81797120/616562950 [==&gt;...........................] - ETA: 1:40
 82157568/616562950 [==&gt;...........................] - ETA: 1:40
 82583552/616562950 [===&gt;..........................] - ETA: 1:39
 83009536/616562950 [===&gt;..........................] - ETA: 1:39
 83468288/616562950 [===&gt;..........................] - ETA: 1:39
 83910656/616562950 [===&gt;..........................] - ETA: 1:38
 84385792/616562950 [===&gt;..........................] - ETA: 1:38
 84828160/616562950 [===&gt;..........................] - ETA: 1:38
 85303296/616562950 [===&gt;..........................] - ETA: 1:38
 85729280/616562950 [===&gt;..........................] - ETA: 1:37
 86220800/616562950 [===&gt;..........................] - ETA: 1:37
 86679552/616562950 [===&gt;..........................] - ETA: 1:37
 87187456/616562950 [===&gt;..........................] - ETA: 1:36
 87646208/616562950 [===&gt;..........................] - ETA: 1:36
 88039424/616562950 [===&gt;..........................] - ETA: 1:36
 88383488/616562950 [===&gt;..........................] - ETA: 1:36
 88743936/616562950 [===&gt;..........................] - ETA: 1:36
 89071616/616562950 [===&gt;..........................] - ETA: 1:35
 89432064/616562950 [===&gt;..........................] - ETA: 1:35
 89694208/616562950 [===&gt;..........................] - ETA: 1:35
 90005504/616562950 [===&gt;..........................] - ETA: 1:35
 90316800/616562950 [===&gt;..........................] - ETA: 1:35
 90611712/616562950 [===&gt;..........................] - ETA: 1:35
 90873856/616562950 [===&gt;..........................] - ETA: 1:35
 91168768/616562950 [===&gt;..........................] - ETA: 1:35
 91480064/616562950 [===&gt;..........................] - ETA: 1:35
 91774976/616562950 [===&gt;..........................] - ETA: 1:35
 92069888/616562950 [===&gt;..........................] - ETA: 1:35
 92397568/616562950 [===&gt;..........................] - ETA: 1:35
 92708864/616562950 [===&gt;..........................] - ETA: 1:35
 93003776/616562950 [===&gt;..........................] - ETA: 1:35
 93331456/616562950 [===&gt;..........................] - ETA: 1:35
 93593600/616562950 [===&gt;..........................] - ETA: 1:35
 93970432/616562950 [===&gt;..........................] - ETA: 1:35
 94068736/616562950 [===&gt;..........................] - ETA: 1:35
 94347264/616562950 [===&gt;..........................] - ETA: 1:35
 94527488/616562950 [===&gt;..........................] - ETA: 1:35
 94724096/616562950 [===&gt;..........................] - ETA: 1:35
 94887936/616562950 [===&gt;..........................] - ETA: 1:35
 95084544/616562950 [===&gt;..........................] - ETA: 1:35
 95297536/616562950 [===&gt;..........................] - ETA: 1:35
 95461376/616562950 [===&gt;..........................] - ETA: 1:35
 95657984/616562950 [===&gt;..........................] - ETA: 1:35
 95838208/616562950 [===&gt;..........................] - ETA: 1:35
 96034816/616562950 [===&gt;..........................] - ETA: 1:35
 96231424/616562950 [===&gt;..........................] - ETA: 1:36
 96296960/616562950 [===&gt;..........................] - ETA: 1:36
 96542720/616562950 [===&gt;..........................] - ETA: 1:36
 96722944/616562950 [===&gt;..........................] - ETA: 1:36
 96903168/616562950 [===&gt;..........................] - ETA: 1:36
 97050624/616562950 [===&gt;..........................] - ETA: 1:36
 97165312/616562950 [===&gt;..........................] - ETA: 1:36
 97378304/616562950 [===&gt;..........................] - ETA: 1:36
 97509376/616562950 [===&gt;..........................] - ETA: 1:36
 97673216/616562950 [===&gt;..........................] - ETA: 1:37
 97771520/616562950 [===&gt;..........................] - ETA: 1:37
 97951744/616562950 [===&gt;..........................] - ETA: 1:37
 98066432/616562950 [===&gt;..........................] - ETA: 1:37
 98197504/616562950 [===&gt;..........................] - ETA: 1:37
 98328576/616562950 [===&gt;..........................] - ETA: 1:38
 98426880/616562950 [===&gt;..........................] - ETA: 1:38
 98590720/616562950 [===&gt;..........................] - ETA: 1:38
 98689024/616562950 [===&gt;..........................] - ETA: 1:38
 98787328/616562950 [===&gt;..........................] - ETA: 1:38
 98902016/616562950 [===&gt;..........................] - ETA: 1:39
 99016704/616562950 [===&gt;..........................] - ETA: 1:39
 99131392/616562950 [===&gt;..........................] - ETA: 1:39
 99262464/616562950 [===&gt;..........................] - ETA: 1:39
 99409920/616562950 [===&gt;..........................] - ETA: 1:39
 99557376/616562950 [===&gt;..........................] - ETA: 1:39
 99704832/616562950 [===&gt;..........................] - ETA: 1:39
 99852288/616562950 [===&gt;..........................] - ETA: 1:39
 99983360/616562950 [===&gt;..........................] - ETA: 1:40
100147200/616562950 [===&gt;..........................] - ETA: 1:40
100294656/616562950 [===&gt;..........................] - ETA: 1:40
100458496/616562950 [===&gt;..........................] - ETA: 1:40
100655104/616562950 [===&gt;..........................] - ETA: 1:40
100835328/616562950 [===&gt;..........................] - ETA: 1:40
101031936/616562950 [===&gt;..........................] - ETA: 1:40
101195776/616562950 [===&gt;..........................] - ETA: 1:40
101392384/616562950 [===&gt;..........................] - ETA: 1:40
101605376/616562950 [===&gt;..........................] - ETA: 1:40
101785600/616562950 [===&gt;..........................] - ETA: 1:40
101998592/616562950 [===&gt;..........................] - ETA: 1:40
102227968/616562950 [===&gt;..........................] - ETA: 1:40
102457344/616562950 [===&gt;..........................] - ETA: 1:40
102653952/616562950 [===&gt;..........................] - ETA: 1:40
102899712/616562950 [====&gt;.........................] - ETA: 1:40
103145472/616562950 [====&gt;.........................] - ETA: 1:40
103391232/616562950 [====&gt;.........................] - ETA: 1:40
103604224/616562950 [====&gt;.........................] - ETA: 1:40
103800832/616562950 [====&gt;.........................] - ETA: 1:40
104062976/616562950 [====&gt;.........................] - ETA: 1:40
104325120/616562950 [====&gt;.........................] - ETA: 1:40
104570880/616562950 [====&gt;.........................] - ETA: 1:40
104849408/616562950 [====&gt;.........................] - ETA: 1:40
105111552/616562950 [====&gt;.........................] - ETA: 1:40
105390080/616562950 [====&gt;.........................] - ETA: 1:40
105684992/616562950 [====&gt;.........................] - ETA: 1:40
105979904/616562950 [====&gt;.........................] - ETA: 1:40
106258432/616562950 [====&gt;.........................] - ETA: 1:40
106553344/616562950 [====&gt;.........................] - ETA: 1:40
106864640/616562950 [====&gt;.........................] - ETA: 1:39
107159552/616562950 [====&gt;.........................] - ETA: 1:39
107487232/616562950 [====&gt;.........................] - ETA: 1:39
107814912/616562950 [====&gt;.........................] - ETA: 1:39
108109824/616562950 [====&gt;.........................] - ETA: 1:39
108453888/616562950 [====&gt;.........................] - ETA: 1:39
108797952/616562950 [====&gt;.........................] - ETA: 1:39
109109248/616562950 [====&gt;.........................] - ETA: 1:39
109453312/616562950 [====&gt;.........................] - ETA: 1:38
109764608/616562950 [====&gt;.........................] - ETA: 1:38
110108672/616562950 [====&gt;.........................] - ETA: 1:38
110403584/616562950 [====&gt;.........................] - ETA: 1:38
110714880/616562950 [====&gt;.........................] - ETA: 1:38
111034368/616562950 [====&gt;.........................] - ETA: 1:38
111353856/616562950 [====&gt;.........................] - ETA: 1:38
111665152/616562950 [====&gt;.........................] - ETA: 1:38
111796224/616562950 [====&gt;.........................] - ETA: 1:38
112222208/616562950 [====&gt;.........................] - ETA: 1:38
112451584/616562950 [====&gt;.........................] - ETA: 1:38
112730112/616562950 [====&gt;.........................] - ETA: 1:38
112975872/616562950 [====&gt;.........................] - ETA: 1:38
113254400/616562950 [====&gt;.........................] - ETA: 1:37
113500160/616562950 [====&gt;.........................] - ETA: 1:37
113795072/616562950 [====&gt;.........................] - ETA: 1:37
114057216/616562950 [====&gt;.........................] - ETA: 1:37
114352128/616562950 [====&gt;.........................] - ETA: 1:37
114614272/616562950 [====&gt;.........................] - ETA: 1:37
114876416/616562950 [====&gt;.........................] - ETA: 1:37
115171328/616562950 [====&gt;.........................] - ETA: 1:37
115449856/616562950 [====&gt;.........................] - ETA: 1:37
115728384/616562950 [====&gt;.........................] - ETA: 1:37
116023296/616562950 [====&gt;.........................] - ETA: 1:37
116285440/616562950 [====&gt;.........................] - ETA: 1:37
116563968/616562950 [====&gt;.........................] - ETA: 1:37
116826112/616562950 [====&gt;.........................] - ETA: 1:37
117104640/616562950 [====&gt;.........................] - ETA: 1:37
117383168/616562950 [====&gt;.........................] - ETA: 1:37
117710848/616562950 [====&gt;.........................] - ETA: 1:36
118022144/616562950 [====&gt;.........................] - ETA: 1:36
118366208/616562950 [====&gt;.........................] - ETA: 1:36
118693888/616562950 [====&gt;.........................] - ETA: 1:36
119021568/616562950 [====&gt;.........................] - ETA: 1:36
119349248/616562950 [====&gt;.........................] - ETA: 1:36
119676928/616562950 [====&gt;.........................] - ETA: 1:36
119988224/616562950 [====&gt;.........................] - ETA: 1:36
120332288/616562950 [====&gt;.........................] - ETA: 1:36
120659968/616562950 [====&gt;.........................] - ETA: 1:35
120987648/616562950 [====&gt;.........................] - ETA: 1:35
121315328/616562950 [====&gt;.........................] - ETA: 1:35
121643008/616562950 [====&gt;.........................] - ETA: 1:35
121970688/616562950 [====&gt;.........................] - ETA: 1:35
122331136/616562950 [====&gt;.........................] - ETA: 1:35
122511360/616562950 [====&gt;.........................] - ETA: 1:35
122953728/616562950 [====&gt;.........................] - ETA: 1:35
123265024/616562950 [====&gt;.........................] - ETA: 1:35
123559936/616562950 [=====&gt;........................] - ETA: 1:34
123854848/616562950 [=====&gt;........................] - ETA: 1:34
124182528/616562950 [=====&gt;........................] - ETA: 1:34
124477440/616562950 [=====&gt;........................] - ETA: 1:34
124821504/616562950 [=====&gt;........................] - ETA: 1:34
125018112/616562950 [=====&gt;........................] - ETA: 1:34
125362176/616562950 [=====&gt;........................] - ETA: 1:34
125460480/616562950 [=====&gt;........................] - ETA: 1:34
125673472/616562950 [=====&gt;........................] - ETA: 1:34
125820928/616562950 [=====&gt;........................] - ETA: 1:34
125968384/616562950 [=====&gt;........................] - ETA: 1:34
126050304/616562950 [=====&gt;........................] - ETA: 1:34
126263296/616562950 [=====&gt;........................] - ETA: 1:35
126410752/616562950 [=====&gt;........................] - ETA: 1:35
126558208/616562950 [=====&gt;........................] - ETA: 1:35
126705664/616562950 [=====&gt;........................] - ETA: 1:35
126853120/616562950 [=====&gt;........................] - ETA: 1:35
127000576/616562950 [=====&gt;........................] - ETA: 1:35
127164416/616562950 [=====&gt;........................] - ETA: 1:35
127328256/616562950 [=====&gt;........................] - ETA: 1:35
127492096/616562950 [=====&gt;........................] - ETA: 1:35
127672320/616562950 [=====&gt;........................] - ETA: 1:35
127868928/616562950 [=====&gt;........................] - ETA: 1:35
128049152/616562950 [=====&gt;........................] - ETA: 1:35
128245760/616562950 [=====&gt;........................] - ETA: 1:35
128442368/616562950 [=====&gt;........................] - ETA: 1:35
128655360/616562950 [=====&gt;........................] - ETA: 1:35
128868352/616562950 [=====&gt;........................] - ETA: 1:35
129064960/616562950 [=====&gt;........................] - ETA: 1:35
129294336/616562950 [=====&gt;........................] - ETA: 1:35
129523712/616562950 [=====&gt;........................] - ETA: 1:35
129736704/616562950 [=====&gt;........................] - ETA: 1:35
129966080/616562950 [=====&gt;........................] - ETA: 1:35
130195456/616562950 [=====&gt;........................] - ETA: 1:35
130441216/616562950 [=====&gt;........................] - ETA: 1:35
130670592/616562950 [=====&gt;........................] - ETA: 1:35
130916352/616562950 [=====&gt;........................] - ETA: 1:35
131162112/616562950 [=====&gt;........................] - ETA: 1:35
131424256/616562950 [=====&gt;........................] - ETA: 1:35
131670016/616562950 [=====&gt;........................] - ETA: 1:35
131948544/616562950 [=====&gt;........................] - ETA: 1:35
132227072/616562950 [=====&gt;........................] - ETA: 1:35
132505600/616562950 [=====&gt;........................] - ETA: 1:35
132784128/616562950 [=====&gt;........................] - ETA: 1:35
133079040/616562950 [=====&gt;........................] - ETA: 1:34
133373952/616562950 [=====&gt;........................] - ETA: 1:34
133685248/616562950 [=====&gt;........................] - ETA: 1:34
133996544/616562950 [=====&gt;........................] - ETA: 1:34
134275072/616562950 [=====&gt;........................] - ETA: 1:34
134619136/616562950 [=====&gt;........................] - ETA: 1:34
134897664/616562950 [=====&gt;........................] - ETA: 1:34
135225344/616562950 [=====&gt;........................] - ETA: 1:34
135553024/616562950 [=====&gt;........................] - ETA: 1:34
135847936/616562950 [=====&gt;........................] - ETA: 1:34
136126464/616562950 [=====&gt;........................] - ETA: 1:34
136404992/616562950 [=====&gt;........................] - ETA: 1:34
136667136/616562950 [=====&gt;........................] - ETA: 1:34
137060352/616562950 [=====&gt;........................] - ETA: 1:33
137322496/616562950 [=====&gt;........................] - ETA: 1:33
137568256/616562950 [=====&gt;........................] - ETA: 1:33
137830400/616562950 [=====&gt;........................] - ETA: 1:33
138108928/616562950 [=====&gt;........................] - ETA: 1:33
138371072/616562950 [=====&gt;........................] - ETA: 1:33
138649600/616562950 [=====&gt;........................] - ETA: 1:33
138944512/616562950 [=====&gt;........................] - ETA: 1:33
139223040/616562950 [=====&gt;........................] - ETA: 1:33
139501568/616562950 [=====&gt;........................] - ETA: 1:33
139821056/616562950 [=====&gt;........................] - ETA: 1:33
140091392/616562950 [=====&gt;........................] - ETA: 1:33
140419072/616562950 [=====&gt;........................] - ETA: 1:33
140746752/616562950 [=====&gt;........................] - ETA: 1:33
141041664/616562950 [=====&gt;........................] - ETA: 1:32
141369344/616562950 [=====&gt;........................] - ETA: 1:32
141697024/616562950 [=====&gt;........................] - ETA: 1:32
141991936/616562950 [=====&gt;........................] - ETA: 1:32
142303232/616562950 [=====&gt;........................] - ETA: 1:32
142630912/616562950 [=====&gt;........................] - ETA: 1:32
142942208/616562950 [=====&gt;........................] - ETA: 1:32
143253504/616562950 [=====&gt;........................] - ETA: 1:32
143548416/616562950 [=====&gt;........................] - ETA: 1:32
143859712/616562950 [=====&gt;........................] - ETA: 1:32
144171008/616562950 [======&gt;.......................] - ETA: 1:32
144482304/616562950 [======&gt;.......................] - ETA: 1:31
144793600/616562950 [======&gt;.......................] - ETA: 1:31
145104896/616562950 [======&gt;.......................] - ETA: 1:31
145416192/616562950 [======&gt;.......................] - ETA: 1:31
145727488/616562950 [======&gt;.......................] - ETA: 1:31
146038784/616562950 [======&gt;.......................] - ETA: 1:31
146366464/616562950 [======&gt;.......................] - ETA: 1:31
146718720/616562950 [======&gt;.......................] - ETA: 1:31
147070976/616562950 [======&gt;.......................] - ETA: 1:31
147447808/616562950 [======&gt;.......................] - ETA: 1:31
147808256/616562950 [======&gt;.......................] - ETA: 1:30
148168704/616562950 [======&gt;.......................] - ETA: 1:30
148529152/616562950 [======&gt;.......................] - ETA: 1:30
148873216/616562950 [======&gt;.......................] - ETA: 1:30
149225472/616562950 [======&gt;.......................] - ETA: 1:30
149577728/616562950 [======&gt;.......................] - ETA: 1:30
149938176/616562950 [======&gt;.......................] - ETA: 1:30
150298624/616562950 [======&gt;.......................] - ETA: 1:30
150659072/616562950 [======&gt;.......................] - ETA: 1:29
150986752/616562950 [======&gt;.......................] - ETA: 1:29
151314432/616562950 [======&gt;.......................] - ETA: 1:29
151592960/616562950 [======&gt;.......................] - ETA: 1:29
151920640/616562950 [======&gt;.......................] - ETA: 1:29
152199168/616562950 [======&gt;.......................] - ETA: 1:29
152428544/616562950 [======&gt;.......................] - ETA: 1:29
152674304/616562950 [======&gt;.......................] - ETA: 1:29
152936448/616562950 [======&gt;.......................] - ETA: 1:29
153198592/616562950 [======&gt;.......................] - ETA: 1:29
153427968/616562950 [======&gt;.......................] - ETA: 1:29
153690112/616562950 [======&gt;.......................] - ETA: 1:29
153952256/616562950 [======&gt;.......................] - ETA: 1:29
154214400/616562950 [======&gt;.......................] - ETA: 1:29
154492928/616562950 [======&gt;.......................] - ETA: 1:29
154771456/616562950 [======&gt;.......................] - ETA: 1:29
154902528/616562950 [======&gt;.......................] - ETA: 1:29
155082752/616562950 [======&gt;.......................] - ETA: 1:29
155262976/616562950 [======&gt;.......................] - ETA: 1:29
155410432/616562950 [======&gt;.......................] - ETA: 1:29
155541504/616562950 [======&gt;.......................] - ETA: 1:29
155705344/616562950 [======&gt;.......................] - ETA: 1:29
155869184/616562950 [======&gt;.......................] - ETA: 1:29
156024832/616562950 [======&gt;.......................] - ETA: 1:29
156196864/616562950 [======&gt;.......................] - ETA: 1:29
156377088/616562950 [======&gt;.......................] - ETA: 1:29
156540928/616562950 [======&gt;.......................] - ETA: 1:29
156737536/616562950 [======&gt;.......................] - ETA: 1:29
156934144/616562950 [======&gt;.......................] - ETA: 1:29
157147136/616562950 [======&gt;.......................] - ETA: 1:29
157343744/616562950 [======&gt;.......................] - ETA: 1:29
157540352/616562950 [======&gt;.......................] - ETA: 1:29
157769728/616562950 [======&gt;.......................] - ETA: 1:29
157999104/616562950 [======&gt;.......................] - ETA: 1:29
158195712/616562950 [======&gt;.......................] - ETA: 1:29
158425088/616562950 [======&gt;.......................] - ETA: 1:29
158670848/616562950 [======&gt;.......................] - ETA: 1:29
158883840/616562950 [======&gt;.......................] - ETA: 1:29
159137792/616562950 [======&gt;.......................] - ETA: 1:29
159375360/616562950 [======&gt;.......................] - ETA: 1:29
159621120/616562950 [======&gt;.......................] - ETA: 1:29
159883264/616562950 [======&gt;.......................] - ETA: 1:29
160145408/616562950 [======&gt;.......................] - ETA: 1:29
160407552/616562950 [======&gt;.......................] - ETA: 1:29
160686080/616562950 [======&gt;.......................] - ETA: 1:29
160964608/616562950 [======&gt;.......................] - ETA: 1:28
161243136/616562950 [======&gt;.......................] - ETA: 1:28
161521664/616562950 [======&gt;.......................] - ETA: 1:28
161816576/616562950 [======&gt;.......................] - ETA: 1:28
162095104/616562950 [======&gt;.......................] - ETA: 1:28
162406400/616562950 [======&gt;.......................] - ETA: 1:28
162717696/616562950 [======&gt;.......................] - ETA: 1:28
163012608/616562950 [======&gt;.......................] - ETA: 1:28
163307520/616562950 [======&gt;.......................] - ETA: 1:28
163618816/616562950 [======&gt;.......................] - ETA: 1:28
163913728/616562950 [======&gt;.......................] - ETA: 1:28
164225024/616562950 [======&gt;.......................] - ETA: 1:28
164536320/616562950 [=======&gt;......................] - ETA: 1:28
164864000/616562950 [=======&gt;......................] - ETA: 1:27
165011456/616562950 [=======&gt;......................] - ETA: 1:28
165355520/616562950 [=======&gt;......................] - ETA: 1:27
165617664/616562950 [=======&gt;......................] - ETA: 1:27
165863424/616562950 [=======&gt;......................] - ETA: 1:27
166109184/616562950 [=======&gt;......................] - ETA: 1:27
166371328/616562950 [=======&gt;......................] - ETA: 1:27
166649856/616562950 [=======&gt;......................] - ETA: 1:27
166912000/616562950 [=======&gt;......................] - ETA: 1:27
167190528/616562950 [=======&gt;......................] - ETA: 1:27
167485440/616562950 [=======&gt;......................] - ETA: 1:27
167763968/616562950 [=======&gt;......................] - ETA: 1:27
168042496/616562950 [=======&gt;......................] - ETA: 1:27
168353792/616562950 [=======&gt;......................] - ETA: 1:27
168648704/616562950 [=======&gt;......................] - ETA: 1:27
168960000/616562950 [=======&gt;......................] - ETA: 1:27
169287680/616562950 [=======&gt;......................] - ETA: 1:27
169598976/616562950 [=======&gt;......................] - ETA: 1:26
169902080/616562950 [=======&gt;......................] - ETA: 1:26
170205184/616562950 [=======&gt;......................] - ETA: 1:26
170516480/616562950 [=======&gt;......................] - ETA: 1:26
170827776/616562950 [=======&gt;......................] - ETA: 1:26
171139072/616562950 [=======&gt;......................] - ETA: 1:26
171433984/616562950 [=======&gt;......................] - ETA: 1:26
171761664/616562950 [=======&gt;......................] - ETA: 1:26
172072960/616562950 [=======&gt;......................] - ETA: 1:26
172367872/616562950 [=======&gt;......................] - ETA: 1:26
172687360/616562950 [=======&gt;......................] - ETA: 1:26
173006848/616562950 [=======&gt;......................] - ETA: 1:26
173318144/616562950 [=======&gt;......................] - ETA: 1:25
173613056/616562950 [=======&gt;......................] - ETA: 1:25
173924352/616562950 [=======&gt;......................] - ETA: 1:25
174235648/616562950 [=======&gt;......................] - ETA: 1:25
174546944/616562950 [=======&gt;......................] - ETA: 1:25
174874624/616562950 [=======&gt;......................] - ETA: 1:25
175235072/616562950 [=======&gt;......................] - ETA: 1:25
175611904/616562950 [=======&gt;......................] - ETA: 1:25
175972352/616562950 [=======&gt;......................] - ETA: 1:25
176324608/616562950 [=======&gt;......................] - ETA: 1:25
176693248/616562950 [=======&gt;......................] - ETA: 1:24
177053696/616562950 [=======&gt;......................] - ETA: 1:24
177414144/616562950 [=======&gt;......................] - ETA: 1:24
177774592/616562950 [=======&gt;......................] - ETA: 1:24
178135040/616562950 [=======&gt;......................] - ETA: 1:24
178495488/616562950 [=======&gt;......................] - ETA: 1:24
178855936/616562950 [=======&gt;......................] - ETA: 1:24
179216384/616562950 [=======&gt;......................] - ETA: 1:24
179380224/616562950 [=======&gt;......................] - ETA: 1:24
179888128/616562950 [=======&gt;......................] - ETA: 1:23
180215808/616562950 [=======&gt;......................] - ETA: 1:23
180543488/616562950 [=======&gt;......................] - ETA: 1:23
180871168/616562950 [=======&gt;......................] - ETA: 1:23
181198848/616562950 [=======&gt;......................] - ETA: 1:23
181526528/616562950 [=======&gt;......................] - ETA: 1:23
181870592/616562950 [=======&gt;......................] - ETA: 1:23
182198272/616562950 [=======&gt;......................] - ETA: 1:23
182558720/616562950 [=======&gt;......................] - ETA: 1:23
182902784/616562950 [=======&gt;......................] - ETA: 1:23
183246848/616562950 [=======&gt;......................] - ETA: 1:22
183590912/616562950 [=======&gt;......................] - ETA: 1:22
183934976/616562950 [=======&gt;......................] - ETA: 1:22
184279040/616562950 [=======&gt;......................] - ETA: 1:22
184623104/616562950 [=======&gt;......................] - ETA: 1:22
184967168/616562950 [=======&gt;......................] - ETA: 1:22
185327616/616562950 [========&gt;.....................] - ETA: 1:22
185573376/616562950 [========&gt;.....................] - ETA: 1:22
185999360/616562950 [========&gt;.....................] - ETA: 1:22
186277888/616562950 [========&gt;.....................] - ETA: 1:22
186556416/616562950 [========&gt;.....................] - ETA: 1:22
186851328/616562950 [========&gt;.....................] - ETA: 1:22
187146240/616562950 [========&gt;.....................] - ETA: 1:21
187441152/616562950 [========&gt;.....................] - ETA: 1:21
187752448/616562950 [========&gt;.....................] - ETA: 1:21
188063744/616562950 [========&gt;.....................] - ETA: 1:21
188375040/616562950 [========&gt;.....................] - ETA: 1:21
188686336/616562950 [========&gt;.....................] - ETA: 1:21
188997632/616562950 [========&gt;.....................] - ETA: 1:21
189341696/616562950 [========&gt;.....................] - ETA: 1:21
189652992/616562950 [========&gt;.....................] - ETA: 1:21
189997056/616562950 [========&gt;.....................] - ETA: 1:21
190357504/616562950 [========&gt;.....................] - ETA: 1:21
190685184/616562950 [========&gt;.....................] - ETA: 1:21
191029248/616562950 [========&gt;.....................] - ETA: 1:20
191340544/616562950 [========&gt;.....................] - ETA: 1:20
191684608/616562950 [========&gt;.....................] - ETA: 1:20
191782912/616562950 [========&gt;.....................] - ETA: 1:20
191946752/616562950 [========&gt;.....................] - ETA: 1:20
192126976/616562950 [========&gt;.....................] - ETA: 1:20
192323584/616562950 [========&gt;.....................] - ETA: 1:20
192454656/616562950 [========&gt;.....................] - ETA: 1:20
192569344/616562950 [========&gt;.....................] - ETA: 1:21
192684032/616562950 [========&gt;.....................] - ETA: 1:21
192798720/616562950 [========&gt;.....................] - ETA: 1:21
192929792/616562950 [========&gt;.....................] - ETA: 1:21
193044480/616562950 [========&gt;.....................] - ETA: 1:21
193134592/616562950 [========&gt;.....................] - ETA: 1:21
193273856/616562950 [========&gt;.....................] - ETA: 1:21
193388544/616562950 [========&gt;.....................] - ETA: 1:21
193519616/616562950 [========&gt;.....................] - ETA: 1:21
193650688/616562950 [========&gt;.....................] - ETA: 1:21
193798144/616562950 [========&gt;.....................] - ETA: 1:21
193945600/616562950 [========&gt;.....................] - ETA: 1:21
194093056/616562950 [========&gt;.....................] - ETA: 1:21
194256896/616562950 [========&gt;.....................] - ETA: 1:21
194420736/616562950 [========&gt;.....................] - ETA: 1:21
194584576/616562950 [========&gt;.....................] - ETA: 1:21
194748416/616562950 [========&gt;.....................] - ETA: 1:21
194928640/616562950 [========&gt;.....................] - ETA: 1:21
195125248/616562950 [========&gt;.....................] - ETA: 1:21
195321856/616562950 [========&gt;.....................] - ETA: 1:21
195518464/616562950 [========&gt;.....................] - ETA: 1:21
195698688/616562950 [========&gt;.....................] - ETA: 1:21
195895296/616562950 [========&gt;.....................] - ETA: 1:21
196091904/616562950 [========&gt;.....................] - ETA: 1:21
196288512/616562950 [========&gt;.....................] - ETA: 1:21
196501504/616562950 [========&gt;.....................] - ETA: 1:21
196714496/616562950 [========&gt;.....................] - ETA: 1:21
196943872/616562950 [========&gt;.....................] - ETA: 1:21
197173248/616562950 [========&gt;.....................] - ETA: 1:21
197402624/616562950 [========&gt;.....................] - ETA: 1:21
197632000/616562950 [========&gt;.....................] - ETA: 1:21
197877760/616562950 [========&gt;.....................] - ETA: 1:21
198074368/616562950 [========&gt;.....................] - ETA: 1:21
198352896/616562950 [========&gt;.....................] - ETA: 1:21
198631424/616562950 [========&gt;.....................] - ETA: 1:21
198844416/616562950 [========&gt;.....................] - ETA: 1:21
199139328/616562950 [========&gt;.....................] - ETA: 1:21
199352320/616562950 [========&gt;.....................] - ETA: 1:21
199647232/616562950 [========&gt;.....................] - ETA: 1:21
199876608/616562950 [========&gt;.....................] - ETA: 1:21
200155136/616562950 [========&gt;.....................] - ETA: 1:20
200400896/616562950 [========&gt;.....................] - ETA: 1:20
200679424/616562950 [========&gt;.....................] - ETA: 1:20
200941568/616562950 [========&gt;.....................] - ETA: 1:20
201203712/616562950 [========&gt;.....................] - ETA: 1:20
201531392/616562950 [========&gt;.....................] - ETA: 1:20
201809920/616562950 [========&gt;.....................] - ETA: 1:20
202137600/616562950 [========&gt;.....................] - ETA: 1:20
202481664/616562950 [========&gt;.....................] - ETA: 1:20
202776576/616562950 [========&gt;.....................] - ETA: 1:20
203104256/616562950 [========&gt;.....................] - ETA: 1:20
203382784/616562950 [========&gt;.....................] - ETA: 1:20
203710464/616562950 [========&gt;.....................] - ETA: 1:20
204021760/616562950 [========&gt;.....................] - ETA: 1:20
204316672/616562950 [========&gt;.....................] - ETA: 1:20
204644352/616562950 [========&gt;.....................] - ETA: 1:19
204955648/616562950 [========&gt;.....................] - ETA: 1:19
205250560/616562950 [========&gt;.....................] - ETA: 1:19
205545472/616562950 [=========&gt;....................] - ETA: 1:19
205856768/616562950 [=========&gt;....................] - ETA: 1:19
206184448/616562950 [=========&gt;....................] - ETA: 1:19
206495744/616562950 [=========&gt;....................] - ETA: 1:19
206807040/616562950 [=========&gt;....................] - ETA: 1:19
207134720/616562950 [=========&gt;....................] - ETA: 1:19
207495168/616562950 [=========&gt;....................] - ETA: 1:19
207855616/616562950 [=========&gt;....................] - ETA: 1:19
208183296/616562950 [=========&gt;....................] - ETA: 1:19
208560128/616562950 [=========&gt;....................] - ETA: 1:18
208936960/616562950 [=========&gt;....................] - ETA: 1:18
209281024/616562950 [=========&gt;....................] - ETA: 1:18
209657856/616562950 [=========&gt;....................] - ETA: 1:18
210018304/616562950 [=========&gt;....................] - ETA: 1:18
210378752/616562950 [=========&gt;....................] - ETA: 1:18
210722816/616562950 [=========&gt;....................] - ETA: 1:18
211066880/616562950 [=========&gt;....................] - ETA: 1:18
211410944/616562950 [=========&gt;....................] - ETA: 1:18
211820544/616562950 [=========&gt;....................] - ETA: 1:17
212230144/616562950 [=========&gt;....................] - ETA: 1:17
212606976/616562950 [=========&gt;....................] - ETA: 1:17
213032960/616562950 [=========&gt;....................] - ETA: 1:17
213442560/616562950 [=========&gt;....................] - ETA: 1:17
213819392/616562950 [=========&gt;....................] - ETA: 1:17
214228992/616562950 [=========&gt;....................] - ETA: 1:17
214622208/616562950 [=========&gt;....................] - ETA: 1:17
215015424/616562950 [=========&gt;....................] - ETA: 1:16
215408640/616562950 [=========&gt;....................] - ETA: 1:16
215801856/616562950 [=========&gt;....................] - ETA: 1:16
216211456/616562950 [=========&gt;....................] - ETA: 1:16
216686592/616562950 [=========&gt;....................] - ETA: 1:16
217161728/616562950 [=========&gt;....................] - ETA: 1:16
217620480/616562950 [=========&gt;....................] - ETA: 1:16
218144768/616562950 [=========&gt;....................] - ETA: 1:15
218636288/616562950 [=========&gt;....................] - ETA: 1:15
219160576/616562950 [=========&gt;....................] - ETA: 1:15
219684864/616562950 [=========&gt;....................] - ETA: 1:15
220209152/616562950 [=========&gt;....................] - ETA: 1:15
220749824/616562950 [=========&gt;....................] - ETA: 1:14
221274112/616562950 [=========&gt;....................] - ETA: 1:14
221749248/616562950 [=========&gt;....................] - ETA: 1:14
221978624/616562950 [=========&gt;....................] - ETA: 1:14
222470144/616562950 [=========&gt;....................] - ETA: 1:14
222846976/616562950 [=========&gt;....................] - ETA: 1:14
223207424/616562950 [=========&gt;....................] - ETA: 1:14
223543296/616562950 [=========&gt;....................] - ETA: 1:14
223846400/616562950 [=========&gt;....................] - ETA: 1:14
224141312/616562950 [=========&gt;....................] - ETA: 1:14
224534528/616562950 [=========&gt;....................] - ETA: 1:14
224714752/616562950 [=========&gt;....................] - ETA: 1:14
224927744/616562950 [=========&gt;....................] - ETA: 1:14
225107968/616562950 [=========&gt;....................] - ETA: 1:14
225304576/616562950 [=========&gt;....................] - ETA: 1:14
225501184/616562950 [=========&gt;....................] - ETA: 1:14
225681408/616562950 [=========&gt;....................] - ETA: 1:14
225878016/616562950 [=========&gt;....................] - ETA: 1:14
226074624/616562950 [==========&gt;...................] - ETA: 1:13
226304000/616562950 [==========&gt;...................] - ETA: 1:13
226566144/616562950 [==========&gt;...................] - ETA: 1:13
226811904/616562950 [==========&gt;...................] - ETA: 1:13
227057664/616562950 [==========&gt;...................] - ETA: 1:13
227336192/616562950 [==========&gt;...................] - ETA: 1:13
227598336/616562950 [==========&gt;...................] - ETA: 1:13
227844096/616562950 [==========&gt;...................] - ETA: 1:13
228139008/616562950 [==========&gt;...................] - ETA: 1:13
228384768/616562950 [==========&gt;...................] - ETA: 1:13
228679680/616562950 [==========&gt;...................] - ETA: 1:13
228990976/616562950 [==========&gt;...................] - ETA: 1:13
229253120/616562950 [==========&gt;...................] - ETA: 1:13
229564416/616562950 [==========&gt;...................] - ETA: 1:13
229875712/616562950 [==========&gt;...................] - ETA: 1:13
230170624/616562950 [==========&gt;...................] - ETA: 1:13
230498304/616562950 [==========&gt;...................] - ETA: 1:13
230760448/616562950 [==========&gt;...................] - ETA: 1:13
231071744/616562950 [==========&gt;...................] - ETA: 1:13
231366656/616562950 [==========&gt;...................] - ETA: 1:12
231546880/616562950 [==========&gt;...................] - ETA: 1:13
232005632/616562950 [==========&gt;...................] - ETA: 1:12
232267776/616562950 [==========&gt;...................] - ETA: 1:12
232529920/616562950 [==========&gt;...................] - ETA: 1:12
232775680/616562950 [==========&gt;...................] - ETA: 1:12
232972288/616562950 [==========&gt;...................] - ETA: 1:12
233037824/616562950 [==========&gt;...................] - ETA: 1:12
233447424/616562950 [==========&gt;...................] - ETA: 1:12
233660416/616562950 [==========&gt;...................] - ETA: 1:12
233840640/616562950 [==========&gt;...................] - ETA: 1:12
234053632/616562950 [==========&gt;...................] - ETA: 1:12
234283008/616562950 [==========&gt;...................] - ETA: 1:12
234512384/616562950 [==========&gt;...................] - ETA: 1:12
234708992/616562950 [==========&gt;...................] - ETA: 1:12
234954752/616562950 [==========&gt;...................] - ETA: 1:12
235200512/616562950 [==========&gt;...................] - ETA: 1:12
235413504/616562950 [==========&gt;...................] - ETA: 1:12
235642880/616562950 [==========&gt;...................] - ETA: 1:12
235675648/616562950 [==========&gt;...................] - ETA: 1:12
236068864/616562950 [==========&gt;...................] - ETA: 1:12
236265472/616562950 [==========&gt;...................] - ETA: 1:12
236478464/616562950 [==========&gt;...................] - ETA: 1:12
236691456/616562950 [==========&gt;...................] - ETA: 1:12
236904448/616562950 [==========&gt;...................] - ETA: 1:12
237133824/616562950 [==========&gt;...................] - ETA: 1:12
237346816/616562950 [==========&gt;...................] - ETA: 1:12
237543424/616562950 [==========&gt;...................] - ETA: 1:12
237756416/616562950 [==========&gt;...................] - ETA: 1:12
238002176/616562950 [==========&gt;...................] - ETA: 1:12
238215168/616562950 [==========&gt;...................] - ETA: 1:12
238444544/616562950 [==========&gt;...................] - ETA: 1:12
238690304/616562950 [==========&gt;...................] - ETA: 1:12
238936064/616562950 [==========&gt;...................] - ETA: 1:12
239181824/616562950 [==========&gt;...................] - ETA: 1:12
239443968/616562950 [==========&gt;...................] - ETA: 1:12
239706112/616562950 [==========&gt;...................] - ETA: 1:12
239968256/616562950 [==========&gt;...................] - ETA: 1:12
240230400/616562950 [==========&gt;...................] - ETA: 1:11
240492544/616562950 [==========&gt;...................] - ETA: 1:11
240771072/616562950 [==========&gt;...................] - ETA: 1:11
241049600/616562950 [==========&gt;...................] - ETA: 1:11
241328128/616562950 [==========&gt;...................] - ETA: 1:11
241606656/616562950 [==========&gt;...................] - ETA: 1:11
241901568/616562950 [==========&gt;...................] - ETA: 1:11
242196480/616562950 [==========&gt;...................] - ETA: 1:11
242491392/616562950 [==========&gt;...................] - ETA: 1:11
242786304/616562950 [==========&gt;...................] - ETA: 1:11
243097600/616562950 [==========&gt;...................] - ETA: 1:11
243392512/616562950 [==========&gt;...................] - ETA: 1:11
243703808/616562950 [==========&gt;...................] - ETA: 1:11
243998720/616562950 [==========&gt;...................] - ETA: 1:11
244293632/616562950 [==========&gt;...................] - ETA: 1:11
244588544/616562950 [==========&gt;...................] - ETA: 1:11
244867072/616562950 [==========&gt;...................] - ETA: 1:10
245178368/616562950 [==========&gt;...................] - ETA: 1:10
245489664/616562950 [==========&gt;...................] - ETA: 1:10
245784576/616562950 [==========&gt;...................] - ETA: 1:10
246063104/616562950 [==========&gt;...................] - ETA: 1:10
246374400/616562950 [==========&gt;...................] - ETA: 1:10
246669312/616562950 [===========&gt;..................] - ETA: 1:10
246751232/616562950 [===========&gt;..................] - ETA: 1:10
247291904/616562950 [===========&gt;..................] - ETA: 1:10
247554048/616562950 [===========&gt;..................] - ETA: 1:10
247816192/616562950 [===========&gt;..................] - ETA: 1:10
248094720/616562950 [===========&gt;..................] - ETA: 1:10
248389632/616562950 [===========&gt;..................] - ETA: 1:10
248684544/616562950 [===========&gt;..................] - ETA: 1:10
248979456/616562950 [===========&gt;..................] - ETA: 1:10
249274368/616562950 [===========&gt;..................] - ETA: 1:10
249552896/616562950 [===========&gt;..................] - ETA: 1:10
249831424/616562950 [===========&gt;..................] - ETA: 1:09
250109952/616562950 [===========&gt;..................] - ETA: 1:09
250363904/616562950 [===========&gt;..................] - ETA: 1:09
250617856/616562950 [===========&gt;..................] - ETA: 1:09
250781696/616562950 [===========&gt;..................] - ETA: 1:09
251256832/616562950 [===========&gt;..................] - ETA: 1:09
251486208/616562950 [===========&gt;..................] - ETA: 1:09
251715584/616562950 [===========&gt;..................] - ETA: 1:09
251944960/616562950 [===========&gt;..................] - ETA: 1:09
252174336/616562950 [===========&gt;..................] - ETA: 1:09
252403712/616562950 [===========&gt;..................] - ETA: 1:09
252649472/616562950 [===========&gt;..................] - ETA: 1:09
252911616/616562950 [===========&gt;..................] - ETA: 1:09
253140992/616562950 [===========&gt;..................] - ETA: 1:09
253386752/616562950 [===========&gt;..................] - ETA: 1:09
253632512/616562950 [===========&gt;..................] - ETA: 1:09
253911040/616562950 [===========&gt;..................] - ETA: 1:09
254173184/616562950 [===========&gt;..................] - ETA: 1:09
254402560/616562950 [===========&gt;..................] - ETA: 1:09
254828544/616562950 [===========&gt;..................] - ETA: 1:09
255041536/616562950 [===========&gt;..................] - ETA: 1:09
255254528/616562950 [===========&gt;..................] - ETA: 1:09
255451136/616562950 [===========&gt;..................] - ETA: 1:09
255483904/616562950 [===========&gt;..................] - ETA: 1:09
255827968/616562950 [===========&gt;..................] - ETA: 1:09
255991808/616562950 [===========&gt;..................] - ETA: 1:09
256163840/616562950 [===========&gt;..................] - ETA: 1:09
256335872/616562950 [===========&gt;..................] - ETA: 1:09
256516096/616562950 [===========&gt;..................] - ETA: 1:09
256696320/616562950 [===========&gt;..................] - ETA: 1:09
256876544/616562950 [===========&gt;..................] - ETA: 1:09
257089536/616562950 [===========&gt;..................] - ETA: 1:09
257302528/616562950 [===========&gt;..................] - ETA: 1:09
257515520/616562950 [===========&gt;..................] - ETA: 1:08
257712128/616562950 [===========&gt;..................] - ETA: 1:08
257941504/616562950 [===========&gt;..................] - ETA: 1:08
258154496/616562950 [===========&gt;..................] - ETA: 1:08
258375680/616562950 [===========&gt;..................] - ETA: 1:08
258596864/616562950 [===========&gt;..................] - ETA: 1:08
258842624/616562950 [===========&gt;..................] - ETA: 1:08
259088384/616562950 [===========&gt;..................] - ETA: 1:08
259334144/616562950 [===========&gt;..................] - ETA: 1:08
259579904/616562950 [===========&gt;..................] - ETA: 1:08
259825664/616562950 [===========&gt;..................] - ETA: 1:08
260087808/616562950 [===========&gt;..................] - ETA: 1:08
260366336/616562950 [===========&gt;..................] - ETA: 1:08
260644864/616562950 [===========&gt;..................] - ETA: 1:08
260923392/616562950 [===========&gt;..................] - ETA: 1:08
261185536/616562950 [===========&gt;..................] - ETA: 1:08
261447680/616562950 [===========&gt;..................] - ETA: 1:08
261742592/616562950 [===========&gt;..................] - ETA: 1:08
262004736/616562950 [===========&gt;..................] - ETA: 1:08
262283264/616562950 [===========&gt;..................] - ETA: 1:08
262561792/616562950 [===========&gt;..................] - ETA: 1:08
262856704/616562950 [===========&gt;..................] - ETA: 1:08
263135232/616562950 [===========&gt;..................] - ETA: 1:07
263413760/616562950 [===========&gt;..................] - ETA: 1:07
263692288/616562950 [===========&gt;..................] - ETA: 1:07
263970816/616562950 [===========&gt;..................] - ETA: 1:07
264265728/616562950 [===========&gt;..................] - ETA: 1:07
264609792/616562950 [===========&gt;..................] - ETA: 1:07
264953856/616562950 [===========&gt;..................] - ETA: 1:07
265281536/616562950 [===========&gt;..................] - ETA: 1:07
265658368/616562950 [===========&gt;..................] - ETA: 1:07
266002432/616562950 [===========&gt;..................] - ETA: 1:07
266362880/616562950 [===========&gt;..................] - ETA: 1:07
266756096/616562950 [===========&gt;..................] - ETA: 1:07
267100160/616562950 [===========&gt;..................] - ETA: 1:07
267476992/616562950 [============&gt;.................] - ETA: 1:06
267853824/616562950 [============&gt;.................] - ETA: 1:06
268230656/616562950 [============&gt;.................] - ETA: 1:06
268623872/616562950 [============&gt;.................] - ETA: 1:06
269017088/616562950 [============&gt;.................] - ETA: 1:06
269410304/616562950 [============&gt;.................] - ETA: 1:06
269819904/616562950 [============&gt;.................] - ETA: 1:06
270229504/616562950 [============&gt;.................] - ETA: 1:06
270639104/616562950 [============&gt;.................] - ETA: 1:06
271081472/616562950 [============&gt;.................] - ETA: 1:05
271507456/616562950 [============&gt;.................] - ETA: 1:05
271933440/616562950 [============&gt;.................] - ETA: 1:05
272375808/616562950 [============&gt;.................] - ETA: 1:05
272801792/616562950 [============&gt;.................] - ETA: 1:05
273260544/616562950 [============&gt;.................] - ETA: 1:05
273702912/616562950 [============&gt;.................] - ETA: 1:05
274145280/616562950 [============&gt;.................] - ETA: 1:05
274604032/616562950 [============&gt;.................] - ETA: 1:04
275079168/616562950 [============&gt;.................] - ETA: 1:04
275570688/616562950 [============&gt;.................] - ETA: 1:04
276029440/616562950 [============&gt;.................] - ETA: 1:04
276520960/616562950 [============&gt;.................] - ETA: 1:04
276979712/616562950 [============&gt;.................] - ETA: 1:04
277471232/616562950 [============&gt;.................] - ETA: 1:04
277979136/616562950 [============&gt;.................] - ETA: 1:03
278454272/616562950 [============&gt;.................] - ETA: 1:03
278978560/616562950 [============&gt;.................] - ETA: 1:03
279470080/616562950 [============&gt;.................] - ETA: 1:03
279994368/616562950 [============&gt;.................] - ETA: 1:03
280502272/616562950 [============&gt;.................] - ETA: 1:03
281026560/616562950 [============&gt;.................] - ETA: 1:03
281534464/616562950 [============&gt;.................] - ETA: 1:02
282075136/616562950 [============&gt;.................] - ETA: 1:02
282599424/616562950 [============&gt;.................] - ETA: 1:02
283140096/616562950 [============&gt;.................] - ETA: 1:02
283680768/616562950 [============&gt;.................] - ETA: 1:02
284221440/616562950 [============&gt;.................] - ETA: 1:02
284762112/616562950 [============&gt;.................] - ETA: 1:01
285319168/616562950 [============&gt;.................] - ETA: 1:01
285859840/616562950 [============&gt;.................] - ETA: 1:01
286433280/616562950 [============&gt;.................] - ETA: 1:01
286744576/616562950 [============&gt;.................] - ETA: 1:01
287268864/616562950 [============&gt;.................] - ETA: 1:01
287825920/616562950 [=============&gt;................] - ETA: 1:01
288137216/616562950 [=============&gt;................] - ETA: 1:01
288415744/616562950 [=============&gt;................] - ETA: 1:00
288727040/616562950 [=============&gt;................] - ETA: 1:00
289038336/616562950 [=============&gt;................] - ETA: 1:00
289333248/616562950 [=============&gt;................] - ETA: 1:00
289677312/616562950 [=============&gt;................] - ETA: 1:00
290004992/616562950 [=============&gt;................] - ETA: 1:00
290316288/616562950 [=============&gt;................] - ETA: 1:00
290660352/616562950 [=============&gt;................] - ETA: 1:00
290988032/616562950 [=============&gt;................] - ETA: 1:00
291332096/616562950 [=============&gt;................] - ETA: 1:00
291692544/616562950 [=============&gt;................] - ETA: 1:00
292036608/616562950 [=============&gt;................] - ETA: 1:00
292413440/616562950 [=============&gt;................] - ETA: 1:00
292757504/616562950 [=============&gt;................] - ETA: 1:00
293134336/616562950 [=============&gt;................] - ETA: 59s 
293511168/616562950 [=============&gt;................] - ETA: 59s
293871616/616562950 [=============&gt;................] - ETA: 59s
293986304/616562950 [=============&gt;................] - ETA: 59s
294477824/616562950 [=============&gt;................] - ETA: 59s
294723584/616562950 [=============&gt;................] - ETA: 59s
294756352/616562950 [=============&gt;................] - ETA: 59s
295182336/616562950 [=============&gt;................] - ETA: 59s
295395328/616562950 [=============&gt;................] - ETA: 59s
295608320/616562950 [=============&gt;................] - ETA: 59s
295821312/616562950 [=============&gt;................] - ETA: 59s
296034304/616562950 [=============&gt;................] - ETA: 59s
296255488/616562950 [=============&gt;................] - ETA: 59s
296476672/616562950 [=============&gt;................] - ETA: 59s
296722432/616562950 [=============&gt;................] - ETA: 59s
296951808/616562950 [=============&gt;................] - ETA: 59s
297197568/616562950 [=============&gt;................] - ETA: 59s
297451520/616562950 [=============&gt;................] - ETA: 59s
297689088/616562950 [=============&gt;................] - ETA: 59s
297951232/616562950 [=============&gt;................] - ETA: 59s
298213376/616562950 [=============&gt;................] - ETA: 59s
298475520/616562950 [=============&gt;................] - ETA: 59s
298770432/616562950 [=============&gt;................] - ETA: 59s
299048960/616562950 [=============&gt;................] - ETA: 58s
299327488/616562950 [=============&gt;................] - ETA: 58s
299622400/616562950 [=============&gt;................] - ETA: 58s
299917312/616562950 [=============&gt;................] - ETA: 58s
300212224/616562950 [=============&gt;................] - ETA: 58s
300539904/616562950 [=============&gt;................] - ETA: 58s
300851200/616562950 [=============&gt;................] - ETA: 58s
301154304/616562950 [=============&gt;................] - ETA: 58s
301490176/616562950 [=============&gt;................] - ETA: 58s
301817856/616562950 [=============&gt;................] - ETA: 58s
302145536/616562950 [=============&gt;................] - ETA: 58s
302489600/616562950 [=============&gt;................] - ETA: 58s
302833664/616562950 [=============&gt;................] - ETA: 58s
303177728/616562950 [=============&gt;................] - ETA: 58s
303538176/616562950 [=============&gt;................] - ETA: 58s
303882240/616562950 [=============&gt;................] - ETA: 57s
304259072/616562950 [=============&gt;................] - ETA: 57s
304635904/616562950 [=============&gt;................] - ETA: 57s
304996352/616562950 [=============&gt;................] - ETA: 57s
305389568/616562950 [=============&gt;................] - ETA: 57s
305766400/616562950 [=============&gt;................] - ETA: 57s
306159616/616562950 [=============&gt;................] - ETA: 57s
306552832/616562950 [=============&gt;................] - ETA: 57s
306929664/616562950 [=============&gt;................] - ETA: 57s
307339264/616562950 [=============&gt;................] - ETA: 57s
307748864/616562950 [=============&gt;................] - ETA: 57s
308158464/616562950 [=============&gt;................] - ETA: 56s
308584448/616562950 [==============&gt;...............] - ETA: 56s
309010432/616562950 [==============&gt;...............] - ETA: 56s
309428224/616562950 [==============&gt;...............] - ETA: 56s
309862400/616562950 [==============&gt;...............] - ETA: 56s
310288384/616562950 [==============&gt;...............] - ETA: 56s
310714368/616562950 [==============&gt;...............] - ETA: 56s
311156736/616562950 [==============&gt;...............] - ETA: 56s
311566336/616562950 [==============&gt;...............] - ETA: 56s
312041472/616562950 [==============&gt;...............] - ETA: 55s
312483840/616562950 [==============&gt;...............] - ETA: 55s
312942592/616562950 [==============&gt;...............] - ETA: 55s
313417728/616562950 [==============&gt;...............] - ETA: 55s
313892864/616562950 [==============&gt;...............] - ETA: 55s
314368000/616562950 [==============&gt;...............] - ETA: 55s
314843136/616562950 [==============&gt;...............] - ETA: 55s
315334656/616562950 [==============&gt;...............] - ETA: 55s
315809792/616562950 [==============&gt;...............] - ETA: 54s
316317696/616562950 [==============&gt;...............] - ETA: 54s
316825600/616562950 [==============&gt;...............] - ETA: 54s
317333504/616562950 [==============&gt;...............] - ETA: 54s
317841408/616562950 [==============&gt;...............] - ETA: 54s
318365696/616562950 [==============&gt;...............] - ETA: 54s
318906368/616562950 [==============&gt;...............] - ETA: 54s
319430656/616562950 [==============&gt;...............] - ETA: 54s
319954944/616562950 [==============&gt;...............] - ETA: 53s
320479232/616562950 [==============&gt;...............] - ETA: 53s
321019904/616562950 [==============&gt;...............] - ETA: 53s
321560576/616562950 [==============&gt;...............] - ETA: 53s
322117632/616562950 [==============&gt;...............] - ETA: 53s
322674688/616562950 [==============&gt;...............] - ETA: 53s
323231744/616562950 [==============&gt;...............] - ETA: 53s
323788800/616562950 [==============&gt;...............] - ETA: 52s
324362240/616562950 [==============&gt;...............] - ETA: 52s
324935680/616562950 [==============&gt;...............] - ETA: 52s
325509120/616562950 [==============&gt;...............] - ETA: 52s
326082560/616562950 [==============&gt;...............] - ETA: 52s
326672384/616562950 [==============&gt;...............] - ETA: 52s
327262208/616562950 [==============&gt;...............] - ETA: 51s
327852032/616562950 [==============&gt;...............] - ETA: 51s
328441856/616562950 [==============&gt;...............] - ETA: 51s
329031680/616562950 [===============&gt;..............] - ETA: 51s
329621504/616562950 [===============&gt;..............] - ETA: 51s
330211328/616562950 [===============&gt;..............] - ETA: 51s
330801152/616562950 [===============&gt;..............] - ETA: 51s
331390976/616562950 [===============&gt;..............] - ETA: 50s
331980800/616562950 [===============&gt;..............] - ETA: 50s
332570624/616562950 [===============&gt;..............] - ETA: 50s
333160448/616562950 [===============&gt;..............] - ETA: 50s
333750272/616562950 [===============&gt;..............] - ETA: 50s
334340096/616562950 [===============&gt;..............] - ETA: 50s
334913536/616562950 [===============&gt;..............] - ETA: 50s
335519744/616562950 [===============&gt;..............] - ETA: 49s
336109568/616562950 [===============&gt;..............] - ETA: 49s
336715776/616562950 [===============&gt;..............] - ETA: 49s
337305600/616562950 [===============&gt;..............] - ETA: 49s
337534976/616562950 [===============&gt;..............] - ETA: 49s
338305024/616562950 [===============&gt;..............] - ETA: 49s
338796544/616562950 [===============&gt;..............] - ETA: 49s
339271680/616562950 [===============&gt;..............] - ETA: 48s
339763200/616562950 [===============&gt;..............] - ETA: 48s
340254720/616562950 [===============&gt;..............] - ETA: 48s
340762624/616562950 [===============&gt;..............] - ETA: 48s
341270528/616562950 [===============&gt;..............] - ETA: 48s
341794816/616562950 [===============&gt;..............] - ETA: 48s
342319104/616562950 [===============&gt;..............] - ETA: 48s
342597632/616562950 [===============&gt;..............] - ETA: 48s
343007232/616562950 [===============&gt;..............] - ETA: 48s
343490560/616562950 [===============&gt;..............] - ETA: 48s
343744512/616562950 [===============&gt;..............] - ETA: 47s
344006656/616562950 [===============&gt;..............] - ETA: 47s
344268800/616562950 [===============&gt;..............] - ETA: 47s
344514560/616562950 [===============&gt;..............] - ETA: 47s
344760320/616562950 [===============&gt;..............] - ETA: 47s
345022464/616562950 [===============&gt;..............] - ETA: 47s
345268224/616562950 [===============&gt;..............] - ETA: 47s
345530368/616562950 [===============&gt;..............] - ETA: 47s
345825280/616562950 [===============&gt;..............] - ETA: 47s
346136576/616562950 [===============&gt;..............] - ETA: 47s
346431488/616562950 [===============&gt;..............] - ETA: 47s
346726400/616562950 [===============&gt;..............] - ETA: 47s
347004928/616562950 [===============&gt;..............] - ETA: 47s
347283456/616562950 [===============&gt;..............] - ETA: 47s
347561984/616562950 [===============&gt;..............] - ETA: 47s
347906048/616562950 [===============&gt;..............] - ETA: 47s
348233728/616562950 [===============&gt;..............] - ETA: 47s
348594176/616562950 [===============&gt;..............] - ETA: 47s
348930048/616562950 [===============&gt;..............] - ETA: 47s
349298688/616562950 [===============&gt;..............] - ETA: 46s
349642752/616562950 [================&gt;.............] - ETA: 46s
350003200/616562950 [================&gt;.............] - ETA: 46s
350396416/616562950 [================&gt;.............] - ETA: 46s
350740480/616562950 [================&gt;.............] - ETA: 46s
351117312/616562950 [================&gt;.............] - ETA: 46s
351494144/616562950 [================&gt;.............] - ETA: 46s
351879168/616562950 [================&gt;.............] - ETA: 46s
352264192/616562950 [================&gt;.............] - ETA: 46s
352657408/616562950 [================&gt;.............] - ETA: 46s
353067008/616562950 [================&gt;.............] - ETA: 46s
353460224/616562950 [================&gt;.............] - ETA: 46s
353869824/616562950 [================&gt;.............] - ETA: 46s
354295808/616562950 [================&gt;.............] - ETA: 45s
354705408/616562950 [================&gt;.............] - ETA: 45s
355147776/616562950 [================&gt;.............] - ETA: 45s
355590144/616562950 [================&gt;.............] - ETA: 45s
356016128/616562950 [================&gt;.............] - ETA: 45s
356458496/616562950 [================&gt;.............] - ETA: 45s
356900864/616562950 [================&gt;.............] - ETA: 45s
357343232/616562950 [================&gt;.............] - ETA: 45s
357801984/616562950 [================&gt;.............] - ETA: 45s
358260736/616562950 [================&gt;.............] - ETA: 45s
358735872/616562950 [================&gt;.............] - ETA: 44s
359211008/616562950 [================&gt;.............] - ETA: 44s
359702528/616562950 [================&gt;.............] - ETA: 44s
360194048/616562950 [================&gt;.............] - ETA: 44s
360685568/616562950 [================&gt;.............] - ETA: 44s
361177088/616562950 [================&gt;.............] - ETA: 44s
361652224/616562950 [================&gt;.............] - ETA: 44s
362168320/616562950 [================&gt;.............] - ETA: 44s
362651648/616562950 [================&gt;.............] - ETA: 44s
363175936/616562950 [================&gt;.............] - ETA: 43s
363683840/616562950 [================&gt;.............] - ETA: 43s
364191744/616562950 [================&gt;.............] - ETA: 43s
364716032/616562950 [================&gt;.............] - ETA: 43s
365240320/616562950 [================&gt;.............] - ETA: 43s
365780992/616562950 [================&gt;.............] - ETA: 43s
366321664/616562950 [================&gt;.............] - ETA: 43s
366862336/616562950 [================&gt;.............] - ETA: 43s
367403008/616562950 [================&gt;.............] - ETA: 43s
367943680/616562950 [================&gt;.............] - ETA: 42s
368500736/616562950 [================&gt;.............] - ETA: 42s
369057792/616562950 [================&gt;.............] - ETA: 42s
369614848/616562950 [================&gt;.............] - ETA: 42s
370188288/616562950 [=================&gt;............] - ETA: 42s
370761728/616562950 [=================&gt;............] - ETA: 42s
371335168/616562950 [=================&gt;............] - ETA: 42s
371908608/616562950 [=================&gt;............] - ETA: 42s
372498432/616562950 [=================&gt;............] - ETA: 41s
373088256/616562950 [=================&gt;............] - ETA: 41s
373678080/616562950 [=================&gt;............] - ETA: 41s
374251520/616562950 [=================&gt;............] - ETA: 41s
374841344/616562950 [=================&gt;............] - ETA: 41s
375431168/616562950 [=================&gt;............] - ETA: 41s
376020992/616562950 [=================&gt;............] - ETA: 41s
376610816/616562950 [=================&gt;............] - ETA: 40s
377200640/616562950 [=================&gt;............] - ETA: 40s
377790464/616562950 [=================&gt;............] - ETA: 40s
378380288/616562950 [=================&gt;............] - ETA: 40s
378970112/616562950 [=================&gt;............] - ETA: 40s
379559936/616562950 [=================&gt;............] - ETA: 40s
380149760/616562950 [=================&gt;............] - ETA: 40s
380739584/616562950 [=================&gt;............] - ETA: 40s
381329408/616562950 [=================&gt;............] - ETA: 39s
381919232/616562950 [=================&gt;............] - ETA: 39s
382525440/616562950 [=================&gt;............] - ETA: 39s
383131648/616562950 [=================&gt;............] - ETA: 39s
383721472/616562950 [=================&gt;............] - ETA: 39s
384065536/616562950 [=================&gt;............] - ETA: 39s
384802816/616562950 [=================&gt;............] - ETA: 39s
385294336/616562950 [=================&gt;............] - ETA: 39s
385753088/616562950 [=================&gt;............] - ETA: 38s
386260992/616562950 [=================&gt;............] - ETA: 38s
386719744/616562950 [=================&gt;............] - ETA: 38s
387227648/616562950 [=================&gt;............] - ETA: 38s
387686400/616562950 [=================&gt;............] - ETA: 38s
388177920/616562950 [=================&gt;............] - ETA: 38s
388669440/616562950 [=================&gt;............] - ETA: 38s
389111808/616562950 [=================&gt;............] - ETA: 38s
389603328/616562950 [=================&gt;............] - ETA: 38s
390094848/616562950 [=================&gt;............] - ETA: 38s
390307840/616562950 [=================&gt;............] - ETA: 38s
391110656/616562950 [==================&gt;...........] - ETA: 37s
391479296/616562950 [==================&gt;...........] - ETA: 37s
391847936/616562950 [==================&gt;...........] - ETA: 37s
392224768/616562950 [==================&gt;...........] - ETA: 37s
392650752/616562950 [==================&gt;...........] - ETA: 37s
393076736/616562950 [==================&gt;...........] - ETA: 37s
393453568/616562950 [==================&gt;...........] - ETA: 37s
393887744/616562950 [==================&gt;...........] - ETA: 37s
394256384/616562950 [==================&gt;...........] - ETA: 37s
394354688/616562950 [==================&gt;...........] - ETA: 37s
394846208/616562950 [==================&gt;...........] - ETA: 37s
395386880/616562950 [==================&gt;...........] - ETA: 37s
395583488/616562950 [==================&gt;...........] - ETA: 37s
395796480/616562950 [==================&gt;...........] - ETA: 37s
396009472/616562950 [==================&gt;...........] - ETA: 37s
396222464/616562950 [==================&gt;...........] - ETA: 37s
396435456/616562950 [==================&gt;...........] - ETA: 36s
396648448/616562950 [==================&gt;...........] - ETA: 36s
396926976/616562950 [==================&gt;...........] - ETA: 36s
397189120/616562950 [==================&gt;...........] - ETA: 36s
397451264/616562950 [==================&gt;...........] - ETA: 36s
397713408/616562950 [==================&gt;...........] - ETA: 36s
397975552/616562950 [==================&gt;...........] - ETA: 36s
398270464/616562950 [==================&gt;...........] - ETA: 36s
398565376/616562950 [==================&gt;...........] - ETA: 36s
398827520/616562950 [==================&gt;...........] - ETA: 36s
399122432/616562950 [==================&gt;...........] - ETA: 36s
399417344/616562950 [==================&gt;...........] - ETA: 36s
399695872/616562950 [==================&gt;...........] - ETA: 36s
400023552/616562950 [==================&gt;...........] - ETA: 36s
400293888/616562950 [==================&gt;...........] - ETA: 36s
400629760/616562950 [==================&gt;...........] - ETA: 36s
400973824/616562950 [==================&gt;...........] - ETA: 36s
401252352/616562950 [==================&gt;...........] - ETA: 36s
401612800/616562950 [==================&gt;...........] - ETA: 36s
401973248/616562950 [==================&gt;...........] - ETA: 36s
402268160/616562950 [==================&gt;...........] - ETA: 36s
402628608/616562950 [==================&gt;...........] - ETA: 35s
402989056/616562950 [==================&gt;...........] - ETA: 35s
403316736/616562950 [==================&gt;...........] - ETA: 35s
403693568/616562950 [==================&gt;...........] - ETA: 35s
404021248/616562950 [==================&gt;...........] - ETA: 35s
404398080/616562950 [==================&gt;...........] - ETA: 35s
404807680/616562950 [==================&gt;...........] - ETA: 35s
405151744/616562950 [==================&gt;...........] - ETA: 35s
405544960/616562950 [==================&gt;...........] - ETA: 35s
405970944/616562950 [==================&gt;...........] - ETA: 35s
406298624/616562950 [==================&gt;...........] - ETA: 35s
406724608/616562950 [==================&gt;...........] - ETA: 35s
407052288/616562950 [==================&gt;...........] - ETA: 35s
407461888/616562950 [==================&gt;...........] - ETA: 35s
407822336/616562950 [==================&gt;...........] - ETA: 35s
408215552/616562950 [==================&gt;...........] - ETA: 34s
408608768/616562950 [==================&gt;...........] - ETA: 34s
408952832/616562950 [==================&gt;...........] - ETA: 34s
409346048/616562950 [==================&gt;...........] - ETA: 34s
409739264/616562950 [==================&gt;...........] - ETA: 34s
410116096/616562950 [==================&gt;...........] - ETA: 34s
410492928/616562950 [==================&gt;...........] - ETA: 34s
410869760/616562950 [==================&gt;...........] - ETA: 34s
411246592/616562950 [===================&gt;..........] - ETA: 34s
411623424/616562950 [===================&gt;..........] - ETA: 34s
412000256/616562950 [===================&gt;..........] - ETA: 34s
412393472/616562950 [===================&gt;..........] - ETA: 34s
412819456/616562950 [===================&gt;..........] - ETA: 34s
413245440/616562950 [===================&gt;..........] - ETA: 34s
413655040/616562950 [===================&gt;..........] - ETA: 33s
414081024/616562950 [===================&gt;..........] - ETA: 33s
414490624/616562950 [===================&gt;..........] - ETA: 33s
414900224/616562950 [===================&gt;..........] - ETA: 33s
415309824/616562950 [===================&gt;..........] - ETA: 33s
415703040/616562950 [===================&gt;..........] - ETA: 33s
416096256/616562950 [===================&gt;..........] - ETA: 33s
416555008/616562950 [===================&gt;..........] - ETA: 33s
417013760/616562950 [===================&gt;..........] - ETA: 33s
417472512/616562950 [===================&gt;..........] - ETA: 33s
417931264/616562950 [===================&gt;..........] - ETA: 33s
418373632/616562950 [===================&gt;..........] - ETA: 33s
418832384/616562950 [===================&gt;..........] - ETA: 32s
419274752/616562950 [===================&gt;..........] - ETA: 32s
419700736/616562950 [===================&gt;..........] - ETA: 32s
420012032/616562950 [===================&gt;..........] - ETA: 32s
420864000/616562950 [===================&gt;..........] - ETA: 32s
421191680/616562950 [===================&gt;..........] - ETA: 32s
421601280/616562950 [===================&gt;..........] - ETA: 32s
421928960/616562950 [===================&gt;..........] - ETA: 32s
422338560/616562950 [===================&gt;..........] - ETA: 32s
422682624/616562950 [===================&gt;..........] - ETA: 32s
423075840/616562950 [===================&gt;..........] - ETA: 32s
423469056/616562950 [===================&gt;..........] - ETA: 32s
423862272/616562950 [===================&gt;..........] - ETA: 32s
424255488/616562950 [===================&gt;..........] - ETA: 31s
424632320/616562950 [===================&gt;..........] - ETA: 31s
425025536/616562950 [===================&gt;..........] - ETA: 31s
425418752/616562950 [===================&gt;..........] - ETA: 31s
425779200/616562950 [===================&gt;..........] - ETA: 31s
426147840/616562950 [===================&gt;..........] - ETA: 31s
426516480/616562950 [===================&gt;..........] - ETA: 31s
426885120/616562950 [===================&gt;..........] - ETA: 31s
427253760/616562950 [===================&gt;..........] - ETA: 31s
427622400/616562950 [===================&gt;..........] - ETA: 31s
428007424/616562950 [===================&gt;..........] - ETA: 31s
428408832/616562950 [===================&gt;..........] - ETA: 31s
428826624/616562950 [===================&gt;..........] - ETA: 31s
429252608/616562950 [===================&gt;..........] - ETA: 31s
429662208/616562950 [===================&gt;..........] - ETA: 31s
430055424/616562950 [===================&gt;..........] - ETA: 30s
430448640/616562950 [===================&gt;..........] - ETA: 30s
430596096/616562950 [===================&gt;..........] - ETA: 30s
431398912/616562950 [===================&gt;..........] - ETA: 30s
431775744/616562950 [====================&gt;.........] - ETA: 30s
432119808/616562950 [====================&gt;.........] - ETA: 30s
432496640/616562950 [====================&gt;.........] - ETA: 30s
432873472/616562950 [====================&gt;.........] - ETA: 30s
433217536/616562950 [====================&gt;.........] - ETA: 30s
433594368/616562950 [====================&gt;.........] - ETA: 30s
433954816/616562950 [====================&gt;.........] - ETA: 30s
434266112/616562950 [====================&gt;.........] - ETA: 30s
434790400/616562950 [====================&gt;.........] - ETA: 30s
435331072/616562950 [====================&gt;.........] - ETA: 30s
435544064/616562950 [====================&gt;.........] - ETA: 30s
435740672/616562950 [====================&gt;.........] - ETA: 30s
435937280/616562950 [====================&gt;.........] - ETA: 29s
436133888/616562950 [====================&gt;.........] - ETA: 29s
436330496/616562950 [====================&gt;.........] - ETA: 29s
436527104/616562950 [====================&gt;.........] - ETA: 29s
436756480/616562950 [====================&gt;.........] - ETA: 29s
436985856/616562950 [====================&gt;.........] - ETA: 29s
437248000/616562950 [====================&gt;.........] - ETA: 29s
437493760/616562950 [====================&gt;.........] - ETA: 29s
437739520/616562950 [====================&gt;.........] - ETA: 29s
438018048/616562950 [====================&gt;.........] - ETA: 29s
438280192/616562950 [====================&gt;.........] - ETA: 29s
438542336/616562950 [====================&gt;.........] - ETA: 29s
438820864/616562950 [====================&gt;.........] - ETA: 29s
439115776/616562950 [====================&gt;.........] - ETA: 29s
439377920/616562950 [====================&gt;.........] - ETA: 29s
439672832/616562950 [====================&gt;.........] - ETA: 29s
439967744/616562950 [====================&gt;.........] - ETA: 29s
440246272/616562950 [====================&gt;.........] - ETA: 29s
440573952/616562950 [====================&gt;.........] - ETA: 29s
440918016/616562950 [====================&gt;.........] - ETA: 29s
441262080/616562950 [====================&gt;.........] - ETA: 29s
441622528/616562950 [====================&gt;.........] - ETA: 29s
441966592/616562950 [====================&gt;.........] - ETA: 29s
442277888/616562950 [====================&gt;.........] - ETA: 29s
442621952/616562950 [====================&gt;.........] - ETA: 28s
442949632/616562950 [====================&gt;.........] - ETA: 28s
443293696/616562950 [====================&gt;.........] - ETA: 28s
443654144/616562950 [====================&gt;.........] - ETA: 28s
443998208/616562950 [====================&gt;.........] - ETA: 28s
444375040/616562950 [====================&gt;.........] - ETA: 28s
444735488/616562950 [====================&gt;.........] - ETA: 28s
445095936/616562950 [====================&gt;.........] - ETA: 28s
445489152/616562950 [====================&gt;.........] - ETA: 28s
445865984/616562950 [====================&gt;.........] - ETA: 28s
446242816/616562950 [====================&gt;.........] - ETA: 28s
446636032/616562950 [====================&gt;.........] - ETA: 28s
447029248/616562950 [====================&gt;.........] - ETA: 28s
447422464/616562950 [====================&gt;.........] - ETA: 28s
447815680/616562950 [====================&gt;.........] - ETA: 28s
448225280/616562950 [====================&gt;.........] - ETA: 27s
448651264/616562950 [====================&gt;.........] - ETA: 27s
449077248/616562950 [====================&gt;.........] - ETA: 27s
449486848/616562950 [====================&gt;.........] - ETA: 27s
449863680/616562950 [====================&gt;.........] - ETA: 27s
450289664/616562950 [====================&gt;.........] - ETA: 27s
450699264/616562950 [====================&gt;.........] - ETA: 27s
451158016/616562950 [====================&gt;.........] - ETA: 27s
451584000/616562950 [====================&gt;.........] - ETA: 27s
452050944/616562950 [====================&gt;.........] - ETA: 27s
452460544/616562950 [=====================&gt;........] - ETA: 27s
452911104/616562950 [=====================&gt;........] - ETA: 27s
453369856/616562950 [=====================&gt;........] - ETA: 27s
453844992/616562950 [=====================&gt;........] - ETA: 26s
454287360/616562950 [=====================&gt;........] - ETA: 26s
454746112/616562950 [=====================&gt;........] - ETA: 26s
455221248/616562950 [=====================&gt;........] - ETA: 26s
455712768/616562950 [=====================&gt;........] - ETA: 26s
456204288/616562950 [=====================&gt;........] - ETA: 26s
456695808/616562950 [=====================&gt;........] - ETA: 26s
457203712/616562950 [=====================&gt;........] - ETA: 26s
457711616/616562950 [=====================&gt;........] - ETA: 26s
458219520/616562950 [=====================&gt;........] - ETA: 26s
458727424/616562950 [=====================&gt;........] - ETA: 26s
459251712/616562950 [=====================&gt;........] - ETA: 25s
459776000/616562950 [=====================&gt;........] - ETA: 25s
460316672/616562950 [=====================&gt;........] - ETA: 25s
460857344/616562950 [=====================&gt;........] - ETA: 25s
461398016/616562950 [=====================&gt;........] - ETA: 25s
461938688/616562950 [=====================&gt;........] - ETA: 25s
462495744/616562950 [=====================&gt;........] - ETA: 25s
463052800/616562950 [=====================&gt;........] - ETA: 25s
463609856/616562950 [=====================&gt;........] - ETA: 25s
464183296/616562950 [=====================&gt;........] - ETA: 24s
464740352/616562950 [=====================&gt;........] - ETA: 24s
465313792/616562950 [=====================&gt;........] - ETA: 24s
465887232/616562950 [=====================&gt;........] - ETA: 24s
466468864/616562950 [=====================&gt;........] - ETA: 24s
467034112/616562950 [=====================&gt;........] - ETA: 24s
467623936/616562950 [=====================&gt;........] - ETA: 24s
468197376/616562950 [=====================&gt;........] - ETA: 24s
468787200/616562950 [=====================&gt;........] - ETA: 24s
469377024/616562950 [=====================&gt;........] - ETA: 24s
469966848/616562950 [=====================&gt;........] - ETA: 23s
470556672/616562950 [=====================&gt;........] - ETA: 23s
471162880/616562950 [=====================&gt;........] - ETA: 23s
471752704/616562950 [=====================&gt;........] - ETA: 23s
472342528/616562950 [=====================&gt;........] - ETA: 23s
472948736/616562950 [======================&gt;.......] - ETA: 23s
473554944/616562950 [======================&gt;.......] - ETA: 23s
474144768/616562950 [======================&gt;.......] - ETA: 23s
474734592/616562950 [======================&gt;.......] - ETA: 23s
475308032/616562950 [======================&gt;.......] - ETA: 22s
475897856/616562950 [======================&gt;.......] - ETA: 22s
476487680/616562950 [======================&gt;.......] - ETA: 22s
477077504/616562950 [======================&gt;.......] - ETA: 22s
477667328/616562950 [======================&gt;.......] - ETA: 22s
478257152/616562950 [======================&gt;.......] - ETA: 22s
478420992/616562950 [======================&gt;.......] - ETA: 22s
479322112/616562950 [======================&gt;.......] - ETA: 22s
479830016/616562950 [======================&gt;.......] - ETA: 22s
480305152/616562950 [======================&gt;.......] - ETA: 22s
480813056/616562950 [======================&gt;.......] - ETA: 21s
481304576/616562950 [======================&gt;.......] - ETA: 21s
481828864/616562950 [======================&gt;.......] - ETA: 21s
482336768/616562950 [======================&gt;.......] - ETA: 21s
482861056/616562950 [======================&gt;.......] - ETA: 21s
483368960/616562950 [======================&gt;.......] - ETA: 21s
483909632/616562950 [======================&gt;.......] - ETA: 21s
484450304/616562950 [======================&gt;.......] - ETA: 21s
484990976/616562950 [======================&gt;.......] - ETA: 21s
485515264/616562950 [======================&gt;.......] - ETA: 21s
486072320/616562950 [======================&gt;.......] - ETA: 20s
486629376/616562950 [======================&gt;.......] - ETA: 20s
487153664/616562950 [======================&gt;.......] - ETA: 20s
487202816/616562950 [======================&gt;.......] - ETA: 20s
487759872/616562950 [======================&gt;.......] - ETA: 20s
488382464/616562950 [======================&gt;.......] - ETA: 20s
488644608/616562950 [======================&gt;.......] - ETA: 20s
488923136/616562950 [======================&gt;.......] - ETA: 20s
489185280/616562950 [======================&gt;.......] - ETA: 20s
489447424/616562950 [======================&gt;.......] - ETA: 20s
489709568/616562950 [======================&gt;.......] - ETA: 20s
489971712/616562950 [======================&gt;.......] - ETA: 20s
490233856/616562950 [======================&gt;.......] - ETA: 20s
490545152/616562950 [======================&gt;.......] - ETA: 20s
490889216/616562950 [======================&gt;.......] - ETA: 20s
491216896/616562950 [======================&gt;.......] - ETA: 20s
491528192/616562950 [======================&gt;.......] - ETA: 20s
491888640/616562950 [======================&gt;.......] - ETA: 20s
492208128/616562950 [======================&gt;.......] - ETA: 19s
492560384/616562950 [======================&gt;.......] - ETA: 19s
492920832/616562950 [======================&gt;.......] - ETA: 19s
493281280/616562950 [=======================&gt;......] - ETA: 19s
493658112/616562950 [=======================&gt;......] - ETA: 19s
494034944/616562950 [=======================&gt;......] - ETA: 19s
494395392/616562950 [=======================&gt;......] - ETA: 19s
494772224/616562950 [=======================&gt;......] - ETA: 19s
495165440/616562950 [=======================&gt;......] - ETA: 19s
495542272/616562950 [=======================&gt;......] - ETA: 19s
495935488/616562950 [=======================&gt;......] - ETA: 19s
496328704/616562950 [=======================&gt;......] - ETA: 19s
496713728/616562950 [=======================&gt;......] - ETA: 19s
497131520/616562950 [=======================&gt;......] - ETA: 19s
497524736/616562950 [=======================&gt;......] - ETA: 19s
497967104/616562950 [=======================&gt;......] - ETA: 19s
498384896/616562950 [=======================&gt;......] - ETA: 18s
498786304/616562950 [=======================&gt;......] - ETA: 18s
499228672/616562950 [=======================&gt;......] - ETA: 18s
499638272/616562950 [=======================&gt;......] - ETA: 18s
500097024/616562950 [=======================&gt;......] - ETA: 18s
500523008/616562950 [=======================&gt;......] - ETA: 18s
500981760/616562950 [=======================&gt;......] - ETA: 18s
501440512/616562950 [=======================&gt;......] - ETA: 18s
501899264/616562950 [=======================&gt;......] - ETA: 18s
502374400/616562950 [=======================&gt;......] - ETA: 18s
502833152/616562950 [=======================&gt;......] - ETA: 18s
503308288/616562950 [=======================&gt;......] - ETA: 18s
503799808/616562950 [=======================&gt;......] - ETA: 18s
504274944/616562950 [=======================&gt;......] - ETA: 17s
504766464/616562950 [=======================&gt;......] - ETA: 17s
505257984/616562950 [=======================&gt;......] - ETA: 17s
505749504/616562950 [=======================&gt;......] - ETA: 17s
506257408/616562950 [=======================&gt;......] - ETA: 17s
506765312/616562950 [=======================&gt;......] - ETA: 17s
507273216/616562950 [=======================&gt;......] - ETA: 17s
507764736/616562950 [=======================&gt;......] - ETA: 17s
507830272/616562950 [=======================&gt;......] - ETA: 17s
508600320/616562950 [=======================&gt;......] - ETA: 17s
509009920/616562950 [=======================&gt;......] - ETA: 17s
509370368/616562950 [=======================&gt;......] - ETA: 17s
509763584/616562950 [=======================&gt;......] - ETA: 17s
510173184/616562950 [=======================&gt;......] - ETA: 16s
510533632/616562950 [=======================&gt;......] - ETA: 16s
510959616/616562950 [=======================&gt;......] - ETA: 16s
511385600/616562950 [=======================&gt;......] - ETA: 16s
511778816/616562950 [=======================&gt;......] - ETA: 16s
512204800/616562950 [=======================&gt;......] - ETA: 16s
512598016/616562950 [=======================&gt;......] - ETA: 16s
513024000/616562950 [=======================&gt;......] - ETA: 16s
513449984/616562950 [=======================&gt;......] - ETA: 16s
513892352/616562950 [========================&gt;.....] - ETA: 16s
514334720/616562950 [========================&gt;.....] - ETA: 16s
514777088/616562950 [========================&gt;.....] - ETA: 16s
515219456/616562950 [========================&gt;.....] - ETA: 16s
515678208/616562950 [========================&gt;.....] - ETA: 16s
516153344/616562950 [========================&gt;.....] - ETA: 15s
516612096/616562950 [========================&gt;.....] - ETA: 15s
517087232/616562950 [========================&gt;.....] - ETA: 15s
517562368/616562950 [========================&gt;.....] - ETA: 15s
518037504/616562950 [========================&gt;.....] - ETA: 15s
518512640/616562950 [========================&gt;.....] - ETA: 15s
519004160/616562950 [========================&gt;.....] - ETA: 15s
519495680/616562950 [========================&gt;.....] - ETA: 15s
519970816/616562950 [========================&gt;.....] - ETA: 15s
520478720/616562950 [========================&gt;.....] - ETA: 15s
520986624/616562950 [========================&gt;.....] - ETA: 15s
521478144/616562950 [========================&gt;.....] - ETA: 15s
522002432/616562950 [========================&gt;.....] - ETA: 14s
522526720/616562950 [========================&gt;.....] - ETA: 14s
523051008/616562950 [========================&gt;.....] - ETA: 14s
523575296/616562950 [========================&gt;.....] - ETA: 14s
524099584/616562950 [========================&gt;.....] - ETA: 14s
524640256/616562950 [========================&gt;.....] - ETA: 14s
525180928/616562950 [========================&gt;.....] - ETA: 14s
525721600/616562950 [========================&gt;.....] - ETA: 14s
526262272/616562950 [========================&gt;.....] - ETA: 14s
526819328/616562950 [========================&gt;.....] - ETA: 14s
527360000/616562950 [========================&gt;.....] - ETA: 14s
527917056/616562950 [========================&gt;.....] - ETA: 13s
528474112/616562950 [========================&gt;.....] - ETA: 13s
529031168/616562950 [========================&gt;.....] - ETA: 13s
529604608/616562950 [========================&gt;.....] - ETA: 13s
530178048/616562950 [========================&gt;.....] - ETA: 13s
530751488/616562950 [========================&gt;.....] - ETA: 13s
531341312/616562950 [========================&gt;.....] - ETA: 13s
531914752/616562950 [========================&gt;.....] - ETA: 13s
532504576/616562950 [========================&gt;.....] - ETA: 13s
533110784/616562950 [========================&gt;.....] - ETA: 13s
533291008/616562950 [========================&gt;.....] - ETA: 13s
534175744/616562950 [========================&gt;.....] - ETA: 12s
534618112/616562950 [=========================&gt;....] - ETA: 12s
535076864/616562950 [=========================&gt;....] - ETA: 12s
535535616/616562950 [=========================&gt;....] - ETA: 12s
535977984/616562950 [=========================&gt;....] - ETA: 12s
536420352/616562950 [=========================&gt;....] - ETA: 12s
536485888/616562950 [=========================&gt;....] - ETA: 12s
537141248/616562950 [=========================&gt;....] - ETA: 12s
537157632/616562950 [=========================&gt;....] - ETA: 12s
537796608/616562950 [=========================&gt;....] - ETA: 12s
538058752/616562950 [=========================&gt;....] - ETA: 12s
538288128/616562950 [=========================&gt;....] - ETA: 12s
538337280/616562950 [=========================&gt;....] - ETA: 12s
538877952/616562950 [=========================&gt;....] - ETA: 12s
539066368/616562950 [=========================&gt;....] - ETA: 12s
539271168/616562950 [=========================&gt;....] - ETA: 12s
539467776/616562950 [=========================&gt;....] - ETA: 12s
539664384/616562950 [=========================&gt;....] - ETA: 12s
539893760/616562950 [=========================&gt;....] - ETA: 12s
540123136/616562950 [=========================&gt;....] - ETA: 12s
540336128/616562950 [=========================&gt;....] - ETA: 11s
540565504/616562950 [=========================&gt;....] - ETA: 11s
540811264/616562950 [=========================&gt;....] - ETA: 11s
541057024/616562950 [=========================&gt;....] - ETA: 11s
541286400/616562950 [=========================&gt;....] - ETA: 11s
541532160/616562950 [=========================&gt;....] - ETA: 11s
541794304/616562950 [=========================&gt;....] - ETA: 11s
542040064/616562950 [=========================&gt;....] - ETA: 11s
542302208/616562950 [=========================&gt;....] - ETA: 11s
542580736/616562950 [=========================&gt;....] - ETA: 11s
542842880/616562950 [=========================&gt;....] - ETA: 11s
543137792/616562950 [=========================&gt;....] - ETA: 11s
543416320/616562950 [=========================&gt;....] - ETA: 11s
543694848/616562950 [=========================&gt;....] - ETA: 11s
543997952/616562950 [=========================&gt;....] - ETA: 11s
544284672/616562950 [=========================&gt;....] - ETA: 11s
544595968/616562950 [=========================&gt;....] - ETA: 11s
544923648/616562950 [=========================&gt;....] - ETA: 11s
545234944/616562950 [=========================&gt;....] - ETA: 11s
545529856/616562950 [=========================&gt;....] - ETA: 11s
545873920/616562950 [=========================&gt;....] - ETA: 11s
546185216/616562950 [=========================&gt;....] - ETA: 11s
546512896/616562950 [=========================&gt;....] - ETA: 11s
546865152/616562950 [=========================&gt;....] - ETA: 10s
547184640/616562950 [=========================&gt;....] - ETA: 10s
547545088/616562950 [=========================&gt;....] - ETA: 10s
547905536/616562950 [=========================&gt;....] - ETA: 10s
548249600/616562950 [=========================&gt;....] - ETA: 10s
548610048/616562950 [=========================&gt;....] - ETA: 10s
548970496/616562950 [=========================&gt;....] - ETA: 10s
549347328/616562950 [=========================&gt;....] - ETA: 10s
549724160/616562950 [=========================&gt;....] - ETA: 10s
550100992/616562950 [=========================&gt;....] - ETA: 10s
550510592/616562950 [=========================&gt;....] - ETA: 10s
550887424/616562950 [=========================&gt;....] - ETA: 10s
551264256/616562950 [=========================&gt;....] - ETA: 10s
551690240/616562950 [=========================&gt;....] - ETA: 10s
552083456/616562950 [=========================&gt;....] - ETA: 10s
552493056/616562950 [=========================&gt;....] - ETA: 10s
552919040/616562950 [=========================&gt;....] - ETA: 10s
553328640/616562950 [=========================&gt;....] - ETA: 9s 
553771008/616562950 [=========================&gt;....] - ETA: 9s
554196992/616562950 [=========================&gt;....] - ETA: 9s
554622976/616562950 [=========================&gt;....] - ETA: 9s
555065344/616562950 [==========================&gt;...] - ETA: 9s
555507712/616562950 [==========================&gt;...] - ETA: 9s
555966464/616562950 [==========================&gt;...] - ETA: 9s
556408832/616562950 [==========================&gt;...] - ETA: 9s
556867584/616562950 [==========================&gt;...] - ETA: 9s
557326336/616562950 [==========================&gt;...] - ETA: 9s
557801472/616562950 [==========================&gt;...] - ETA: 9s
558292992/616562950 [==========================&gt;...] - ETA: 9s
558751744/616562950 [==========================&gt;...] - ETA: 9s
559259648/616562950 [==========================&gt;...] - ETA: 8s
559734784/616562950 [==========================&gt;...] - ETA: 8s
560226304/616562950 [==========================&gt;...] - ETA: 8s
560717824/616562950 [==========================&gt;...] - ETA: 8s
561225728/616562950 [==========================&gt;...] - ETA: 8s
561750016/616562950 [==========================&gt;...] - ETA: 8s
562257920/616562950 [==========================&gt;...] - ETA: 8s
562782208/616562950 [==========================&gt;...] - ETA: 8s
563306496/616562950 [==========================&gt;...] - ETA: 8s
563830784/616562950 [==========================&gt;...] - ETA: 8s
564371456/616562950 [==========================&gt;...] - ETA: 8s
564912128/616562950 [==========================&gt;...] - ETA: 8s
565436416/616562950 [==========================&gt;...] - ETA: 7s
565993472/616562950 [==========================&gt;...] - ETA: 7s
566534144/616562950 [==========================&gt;...] - ETA: 7s
567091200/616562950 [==========================&gt;...] - ETA: 7s
567648256/616562950 [==========================&gt;...] - ETA: 7s
568205312/616562950 [==========================&gt;...] - ETA: 7s
568762368/616562950 [==========================&gt;...] - ETA: 7s
569335808/616562950 [==========================&gt;...] - ETA: 7s
569909248/616562950 [==========================&gt;...] - ETA: 7s
570466304/616562950 [==========================&gt;...] - ETA: 7s
571056128/616562950 [==========================&gt;...] - ETA: 7s
571645952/616562950 [==========================&gt;...] - ETA: 6s
572235776/616562950 [==========================&gt;...] - ETA: 6s
572825600/616562950 [==========================&gt;...] - ETA: 6s
573415424/616562950 [==========================&gt;...] - ETA: 6s
574005248/616562950 [==========================&gt;...] - ETA: 6s
574595072/616562950 [==========================&gt;...] - ETA: 6s
575184896/616562950 [==========================&gt;...] - ETA: 6s
575774720/616562950 [===========================&gt;..] - ETA: 6s
576364544/616562950 [===========================&gt;..] - ETA: 6s
576954368/616562950 [===========================&gt;..] - ETA: 6s
577544192/616562950 [===========================&gt;..] - ETA: 6s
578134016/616562950 [===========================&gt;..] - ETA: 5s
578494464/616562950 [===========================&gt;..] - ETA: 5s
579346432/616562950 [===========================&gt;..] - ETA: 5s
579624960/616562950 [===========================&gt;..] - ETA: 5s
580198400/616562950 [===========================&gt;..] - ETA: 5s
580788224/616562950 [===========================&gt;..] - ETA: 5s
581001216/616562950 [===========================&gt;..] - ETA: 5s
581279744/616562950 [===========================&gt;..] - ETA: 5s
581525504/616562950 [===========================&gt;..] - ETA: 5s
581787648/616562950 [===========================&gt;..] - ETA: 5s
582082560/616562950 [===========================&gt;..] - ETA: 5s
582377472/616562950 [===========================&gt;..] - ETA: 5s
582656000/616562950 [===========================&gt;..] - ETA: 5s
582901760/616562950 [===========================&gt;..] - ETA: 5s
583213056/616562950 [===========================&gt;..] - ETA: 5s
583409664/616562950 [===========================&gt;..] - ETA: 5s
583852032/616562950 [===========================&gt;..] - ETA: 5s
583999488/616562950 [===========================&gt;..] - ETA: 5s
584425472/616562950 [===========================&gt;..] - ETA: 4s
584589312/616562950 [===========================&gt;..] - ETA: 4s
584769536/616562950 [===========================&gt;..] - ETA: 4s
584949760/616562950 [===========================&gt;..] - ETA: 4s
585129984/616562950 [===========================&gt;..] - ETA: 4s
585310208/616562950 [===========================&gt;..] - ETA: 4s
585474048/616562950 [===========================&gt;..] - ETA: 4s
585670656/616562950 [===========================&gt;..] - ETA: 4s
585850880/616562950 [===========================&gt;..] - ETA: 4s
586031104/616562950 [===========================&gt;..] - ETA: 4s
586227712/616562950 [===========================&gt;..] - ETA: 4s
586407936/616562950 [===========================&gt;..] - ETA: 4s
586620928/616562950 [===========================&gt;..] - ETA: 4s
586817536/616562950 [===========================&gt;..] - ETA: 4s
587046912/616562950 [===========================&gt;..] - ETA: 4s
587243520/616562950 [===========================&gt;..] - ETA: 4s
587456512/616562950 [===========================&gt;..] - ETA: 4s
587669504/616562950 [===========================&gt;..] - ETA: 4s
587931648/616562950 [===========================&gt;..] - ETA: 4s
588193792/616562950 [===========================&gt;..] - ETA: 4s
588406784/616562950 [===========================&gt;..] - ETA: 4s
588685312/616562950 [===========================&gt;..] - ETA: 4s
588947456/616562950 [===========================&gt;..] - ETA: 4s
589209600/616562950 [===========================&gt;..] - ETA: 4s
589471744/616562950 [===========================&gt;..] - ETA: 4s
589733888/616562950 [===========================&gt;..] - ETA: 4s
590020608/616562950 [===========================&gt;..] - ETA: 4s
590290944/616562950 [===========================&gt;..] - ETA: 4s
590585856/616562950 [===========================&gt;..] - ETA: 4s
590897152/616562950 [===========================&gt;..] - ETA: 4s
591175680/616562950 [===========================&gt;..] - ETA: 3s
591470592/616562950 [===========================&gt;..] - ETA: 3s
591781888/616562950 [===========================&gt;..] - ETA: 3s
592093184/616562950 [===========================&gt;..] - ETA: 3s
592404480/616562950 [===========================&gt;..] - ETA: 3s
592715776/616562950 [===========================&gt;..] - ETA: 3s
593043456/616562950 [===========================&gt;..] - ETA: 3s
593387520/616562950 [===========================&gt;..] - ETA: 3s
593715200/616562950 [===========================&gt;..] - ETA: 3s
594059264/616562950 [===========================&gt;..] - ETA: 3s
594403328/616562950 [===========================&gt;..] - ETA: 3s
594763776/616562950 [===========================&gt;..] - ETA: 3s
595140608/616562950 [===========================&gt;..] - ETA: 3s
595484672/616562950 [===========================&gt;..] - ETA: 3s
595845120/616562950 [===========================&gt;..] - ETA: 3s
596213760/616562950 [============================&gt;.] - ETA: 3s
596582400/616562950 [============================&gt;.] - ETA: 3s
596975616/616562950 [============================&gt;.] - ETA: 3s
597352448/616562950 [============================&gt;.] - ETA: 2s
597745664/616562950 [============================&gt;.] - ETA: 2s
598138880/616562950 [============================&gt;.] - ETA: 2s
598548480/616562950 [============================&gt;.] - ETA: 2s
598958080/616562950 [============================&gt;.] - ETA: 2s
599367680/616562950 [============================&gt;.] - ETA: 2s
599777280/616562950 [============================&gt;.] - ETA: 2s
600203264/616562950 [============================&gt;.] - ETA: 2s
600629248/616562950 [============================&gt;.] - ETA: 2s
601038848/616562950 [============================&gt;.] - ETA: 2s
601464832/616562950 [============================&gt;.] - ETA: 2s
601907200/616562950 [============================&gt;.] - ETA: 2s
602333184/616562950 [============================&gt;.] - ETA: 2s
602808320/616562950 [============================&gt;.] - ETA: 2s
603267072/616562950 [============================&gt;.] - ETA: 2s
603725824/616562950 [============================&gt;.] - ETA: 1s
604217344/616562950 [============================&gt;.] - ETA: 1s
604692480/616562950 [============================&gt;.] - ETA: 1s
605167616/616562950 [============================&gt;.] - ETA: 1s
605642752/616562950 [============================&gt;.] - ETA: 1s
606117888/616562950 [============================&gt;.] - ETA: 1s
606609408/616562950 [============================&gt;.] - ETA: 1s
607100928/616562950 [============================&gt;.] - ETA: 1s
607608832/616562950 [============================&gt;.] - ETA: 1s
608100352/616562950 [============================&gt;.] - ETA: 1s
608624640/616562950 [============================&gt;.] - ETA: 1s
609132544/616562950 [============================&gt;.] - ETA: 1s
609656832/616562950 [============================&gt;.] - ETA: 1s
610181120/616562950 [============================&gt;.] - ETA: 0s
610689024/616562950 [============================&gt;.] - ETA: 0s
611213312/616562950 [============================&gt;.] - ETA: 0s
611753984/616562950 [============================&gt;.] - ETA: 0s
612294656/616562950 [============================&gt;.] - ETA: 0s
612818944/616562950 [============================&gt;.] - ETA: 0s
613376000/616562950 [============================&gt;.] - ETA: 0s
613916672/616562950 [============================&gt;.] - ETA: 0s
614473728/616562950 [============================&gt;.] - ETA: 0s
615030784/616562950 [============================&gt;.] - ETA: 0s
615587840/616562950 [============================&gt;.] - ETA: 0s
616161280/616562950 [============================&gt;.] - ETA: 0s
616562950/616562950 [==============================] - 95s 0us/step
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">quantizeml.models</span> <span class="kn">import</span> <span class="n">quantize</span>
<span class="kn">from</span> <span class="nn">quantizeml.layers</span> <span class="kn">import</span> <span class="n">QuantizationParams</span>

<span class="c1"># Quantize the model to 8-bit and calibrate using 1024 samples with a batch size of 100 over 2</span>
<span class="c1"># epochs.</span>
<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">quantize</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span>
                           <span class="n">qparams</span><span class="o">=</span><span class="n">QuantizationParams</span><span class="p">(</span><span class="n">weight_bits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">activation_bits</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
                           <span class="n">num_samples</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 48s
 2/11 [====&gt;.........................] - ETA: 1s 
 3/11 [=======&gt;......................] - ETA: 1s
 4/11 [=========&gt;....................] - ETA: 1s
 5/11 [============&gt;.................] - ETA: 0s
 6/11 [===============&gt;..............] - ETA: 0s
 7/11 [==================&gt;...........] - ETA: 0s
 8/11 [====================&gt;.........] - ETA: 0s
 9/11 [=======================&gt;......] - ETA: 0s
10/11 [==========================&gt;...] - ETA: 0s
11/11 [==============================] - ETA: 0s
11/11 [==============================] - 6s 163ms/step

 1/11 [=&gt;............................] - ETA: 1s
 2/11 [====&gt;.........................] - ETA: 1s
 3/11 [=======&gt;......................] - ETA: 1s
 4/11 [=========&gt;....................] - ETA: 1s
 5/11 [============&gt;.................] - ETA: 1s
 6/11 [===============&gt;..............] - ETA: 0s
 7/11 [==================&gt;...........] - ETA: 0s
 8/11 [====================&gt;.........] - ETA: 0s
 9/11 [=======================&gt;......] - ETA: 0s
10/11 [==========================&gt;...] - ETA: 0s
11/11 [==============================] - ETA: 0s
11/11 [==============================] - 2s 162ms/step
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 34s 34s/step
Keras accuracy: 90.00 %
</pre></div>
</div>
</section>
<section id="load-a-pre-trained-quantized-keras-model">
<h3>3.2. Load a pre-trained quantized Keras model<a class="headerlink" href="#load-a-pre-trained-quantized-keras-model" title="Permalink to this headline"></a></h3>
<p>The <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_vit_ti16_imagenet_pretrained">bc_vit_ti16_imagenet_pretrained helper</a> was
obtained with the same 8-bit quantization scheme but with an additional QAT step to further
improve accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">bc_vit_ti16_imagenet_pretrained</span>

<span class="c1"># Load the pre-trained quantized model</span>
<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">bc_vit_ti16_imagenet_pretrained</span><span class="p">()</span>
<span class="n">model_quantized</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224_i8_w8_a8.h5.

       0/24405400 [..............................] - ETA: 0s
   98304/24405400 [..............................] - ETA: 13s
  360448/24405400 [..............................] - ETA: 6s 
  655360/24405400 [..............................] - ETA: 5s
  958464/24405400 [&gt;.............................] - ETA: 5s
 1261568/24405400 [&gt;.............................] - ETA: 4s
 1572864/24405400 [&gt;.............................] - ETA: 4s
 1892352/24405400 [=&gt;............................] - ETA: 4s
 2170880/24405400 [=&gt;............................] - ETA: 4s
 2523136/24405400 [==&gt;...........................] - ETA: 4s
 2850816/24405400 [==&gt;...........................] - ETA: 3s
 3178496/24405400 [==&gt;...........................] - ETA: 3s
 3522560/24405400 [===&gt;..........................] - ETA: 3s
 3858432/24405400 [===&gt;..........................] - ETA: 3s
 4194304/24405400 [====&gt;.........................] - ETA: 3s
 4554752/24405400 [====&gt;.........................] - ETA: 3s
 4898816/24405400 [=====&gt;........................] - ETA: 3s
 5275648/24405400 [=====&gt;........................] - ETA: 3s
 5668864/24405400 [=====&gt;........................] - ETA: 3s
 6029312/24405400 [======&gt;.......................] - ETA: 2s
 6422528/24405400 [======&gt;.......................] - ETA: 2s
 6799360/24405400 [=======&gt;......................] - ETA: 2s
 7176192/24405400 [=======&gt;......................] - ETA: 2s
 7585792/24405400 [========&gt;.....................] - ETA: 2s
 7946240/24405400 [========&gt;.....................] - ETA: 2s
 8323072/24405400 [=========&gt;....................] - ETA: 2s
 8716288/24405400 [=========&gt;....................] - ETA: 2s
 9142272/24405400 [==========&gt;...................] - ETA: 2s
 9535488/24405400 [==========&gt;...................] - ETA: 2s
 9945088/24405400 [===========&gt;..................] - ETA: 2s
10338304/24405400 [===========&gt;..................] - ETA: 2s
10780672/24405400 [============&gt;.................] - ETA: 2s
11173888/24405400 [============&gt;.................] - ETA: 1s
11599872/24405400 [=============&gt;................] - ETA: 1s
11976704/24405400 [=============&gt;................] - ETA: 1s
12353536/24405400 [==============&gt;...............] - ETA: 1s
12746752/24405400 [==============&gt;...............] - ETA: 1s
13156352/24405400 [===============&gt;..............] - ETA: 1s
13533184/24405400 [===============&gt;..............] - ETA: 1s
13746176/24405400 [===============&gt;..............] - ETA: 1s
14286848/24405400 [================&gt;.............] - ETA: 1s
14606336/24405400 [================&gt;.............] - ETA: 1s
14942208/24405400 [=================&gt;............] - ETA: 1s
15269888/24405400 [=================&gt;............] - ETA: 1s
15605760/24405400 [==================&gt;...........] - ETA: 1s
15908864/24405400 [==================&gt;...........] - ETA: 1s
16228352/24405400 [==================&gt;...........] - ETA: 1s
16547840/24405400 [===================&gt;..........] - ETA: 1s
16859136/24405400 [===================&gt;..........] - ETA: 1s
17170432/24405400 [====================&gt;.........] - ETA: 1s
17481728/24405400 [====================&gt;.........] - ETA: 1s
17801216/24405400 [====================&gt;.........] - ETA: 0s
18112512/24405400 [=====================&gt;........] - ETA: 0s
18432000/24405400 [=====================&gt;........] - ETA: 0s
18759680/24405400 [======================&gt;.......] - ETA: 0s
19087360/24405400 [======================&gt;.......] - ETA: 0s
19415040/24405400 [======================&gt;.......] - ETA: 0s
19873792/24405400 [=======================&gt;......] - ETA: 0s
20168704/24405400 [=======================&gt;......] - ETA: 0s
20463616/24405400 [========================&gt;.....] - ETA: 0s
20758528/24405400 [========================&gt;.....] - ETA: 0s
21069824/24405400 [========================&gt;.....] - ETA: 0s
21331968/24405400 [=========================&gt;....] - ETA: 0s
21594112/24405400 [=========================&gt;....] - ETA: 0s
21807104/24405400 [=========================&gt;....] - ETA: 0s
22036480/24405400 [==========================&gt;...] - ETA: 0s
22282240/24405400 [==========================&gt;...] - ETA: 0s
22511616/24405400 [==========================&gt;...] - ETA: 0s
22757376/24405400 [==========================&gt;...] - ETA: 0s
23019520/24405400 [===========================&gt;..] - ETA: 0s
23298048/24405400 [===========================&gt;..] - ETA: 0s
23543808/24405400 [===========================&gt;..] - ETA: 0s
23805952/24405400 [============================&gt;.] - ETA: 0s
24084480/24405400 [============================&gt;.] - ETA: 0s
24363008/24405400 [============================&gt;.] - ETA: 0s
24405400/24405400 [==============================] - 4s 0us/step
Model: &quot;vit-tiny&quot;
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input (InputLayer)             [(None, 224, 224, 3  0           []
                                )]

 Rescale (QuantizedRescaling)   (None, 224, 224, 3)  0           [&#39;input[0][0]&#39;]

 Embedding (QuantizedConv2D)    (None, 14, 14, 192)  147648      [&#39;Rescale[0][0]&#39;]

 reshape (QuantizedReshape)     (None, 196, 192)     0           [&#39;Embedding[0][0]&#39;]

 ClassToken (QuantizedClassToke  (None, 197, 192)    192         [&#39;reshape[0][0]&#39;]
 n)

 Transformer/PosEmbed (Quantize  (None, 197, 192)    38208       [&#39;ClassToken[0][0]&#39;]
 dAddPositionEmbs)

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    768         [&#39;Transformer/PosEmbed[0][0]&#39;]
 erNorm_0 (QuantizedLayerNormal
 ization)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout (QuantizedDropout)     (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    384         [&#39;dropout[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/PosEmbed[0][0]&#39;]

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_0/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_0/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_1 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 192)    148032      [&#39;dropout_1[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_2 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_3 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    384         [&#39;dropout_3[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_0/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_1/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_1/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_4 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 192)    148032      [&#39;dropout_4[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_5 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_5[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_6 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    384         [&#39;dropout_6[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_1/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_2/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_2/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_7 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 192)    148032      [&#39;dropout_7[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_8 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_8[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_9 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    384         [&#39;dropout_9[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_2/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_3/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_3/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_10 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 192)    148032      [&#39;dropout_10[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_11 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_11[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_12 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    384         [&#39;dropout_12[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_3/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_4/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_4/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_13 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 192)    148032      [&#39;dropout_13[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_14 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_14[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_15 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    384         [&#39;dropout_15[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_4/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_5/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_5/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_16 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 192)    148032      [&#39;dropout_16[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_17 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_17[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_18 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    384         [&#39;dropout_18[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_5/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_6/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_6/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_19 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 192)    148032      [&#39;dropout_19[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_20 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_20[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_21 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    384         [&#39;dropout_21[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_6/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_7/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_7/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_22 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 192)    148032      [&#39;dropout_22[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_23 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_23[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_24 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    384         [&#39;dropout_24[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_7/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_8/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_8/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_25 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 192)    148032      [&#39;dropout_25[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_26 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_26[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_27 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    384         [&#39;dropout_27[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_8/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_9/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_9/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_9/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_28 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 192)    148032      [&#39;dropout_28[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_29 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_29[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_9/add_
 yerNorm_0 (QuantizedLayerNorma                                  2[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (QuantizedAttention)  ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (QuantizedDense)                                             tion[0][0]&#39;]

 dropout_30 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    384         [&#39;dropout_30[0][0]&#39;,
 d_1 (QuantizedAdd)                                               &#39;Transformer/EncoderBlock_9/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_2 (QuantizedLayerNorma                                  _1[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_10/Lay
 pBlock/Dense_0 (QuantizedDense                                  erNorm_2[0][0]&#39;]
 )

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_10/Mlp
 pBlock/activation (QuantizedRe                                  Block/Dense_0[0][0]&#39;]
 LU)

 dropout_31 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 192)    148032      [&#39;dropout_31[0][0]&#39;]
 pBlock/Dense_1 (QuantizedDense
 )

 dropout_32 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 d_2 (QuantizedAdd)                                              _1[0][0]&#39;,
                                                                  &#39;dropout_32[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_0 (QuantizedLayerNorma                                  _2[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (QuantizedAttention)  ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (QuantizedDense)                                             tion[0][0]&#39;]

 dropout_33 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    384         [&#39;dropout_33[0][0]&#39;,
 d_1 (QuantizedAdd)                                               &#39;Transformer/EncoderBlock_10/add
                                                                 _2[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_11/add
 yerNorm_2 (QuantizedLayerNorma                                  _1[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_11/Lay
 pBlock/Dense_0 (QuantizedDense                                  erNorm_2[0][0]&#39;]
 )

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_11/Mlp
 pBlock/activation (QuantizedRe                                  Block/Dense_0[0][0]&#39;]
 LU)

 dropout_34 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 192)    148032      [&#39;dropout_34[0][0]&#39;]
 pBlock/Dense_1 (QuantizedDense
 )

 dropout_35 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_11/add
 d_2 (QuantizedAdd)                                              _1[0][0]&#39;,
                                                                  &#39;dropout_35[0][0]&#39;]

 Transformer/EncoderNorm (Quant  (None, 197, 192)    1152        [&#39;Transformer/EncoderBlock_11/add
 izedBatchNormalization)                                         _2[0][0]&#39;]

 ExtractToken (QuantizedExtract  (None, 192)         0           [&#39;Transformer/EncoderNorm[0][0]&#39;]
 Token)

 Head (QuantizedDense)          (None, 1000)         193000      [&#39;ExtractToken[0][0]&#39;]

 dequantizer (Dequantizer)      (None, 1000)         0           [&#39;Head[0][0]&#39;]

==================================================================================================
Total params: 5,773,528
Trainable params: 5,717,800
Non-trainable params: 55,728
__________________________________________________________________________________________________
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 35s 35s/step
Keras accuracy: 100.00 %
</pre></div>
</div>
</section>
</section>
<section id="conversion-to-akida">
<h2>4. Conversion to Akida<a class="headerlink" href="#conversion-to-akida" title="Permalink to this headline"></a></h2>
<p>The quantized Keras model is now converted into an Akida model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">convert</span>

<span class="c1"># Convert the model</span>
<span class="n">model_akida</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
<span class="n">model_akida</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>                 Model Summary
________________________________________________
Input shape    Output shape  Sequences  Layers
================================================
[224, 224, 3]  [1, 1, 1000]  1          137
________________________________________________

___________________________________________________________________________________________________________________
Layer (type)                                                                      Output shape   Kernel shape

======================================= SW/Embedding-dequantizer (Software) =======================================

Embedding (Stem)                                                                  [1, 197, 192]  (16, 16, 3, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/LayerNorm_0 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/query (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/key (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/value (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/attention (Attention)  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/out (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/add_1 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/LayerNorm_2 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MlpBlock/Dense_0 (Dense2D)                            [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MlpBlock/Dense_1 (Dense2D)                            [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/add_2 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/LayerNorm_0 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/query (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/key (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/value (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/attention (Attention)  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/out (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/add_1 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/LayerNorm_2 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MlpBlock/Dense_0 (Dense2D)                            [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MlpBlock/Dense_1 (Dense2D)                            [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/add_2 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderNorm (BatchNormalization)                                      [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
ExtractToken (ExtractToken)                                                       [1, 1, 192]    N/A
___________________________________________________________________________________________________________________
Head (Dense2D)                                                                    [1, 1, 1000]   (192, 1000)
___________________________________________________________________________________________________________________
dequantizer (Dequantizer)                                                         [1, 1, 1000]   N/A
___________________________________________________________________________________________________________________
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_akida</span> <span class="o">=</span> <span class="n">model_akida</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">labels_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy_akida</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>

<span class="c1"># For non-regression purposes</span>
<span class="k">assert</span> <span class="n">accuracy_akida</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Accuracy: 100.00 %
</pre></div>
</div>
</section>
<section id="attention-maps">
<h2>5.3 Attention maps<a class="headerlink" href="#attention-maps" title="Permalink to this headline"></a></h2>
<p>Instead of showing predictions, here we propose to show attention maps on an image. This is
derived from <a class="reference external" href="https://arxiv.org/abs/2005.00928">Abnar et al. attention rollout</a> as shown in the
following <a class="reference external" href="https://keras.io/examples/vision/probing_vits/#method-ii-attention-rollout">Keras tutorial</a>. This aims to
highlight the model abilities to focus on relevant parts in the input image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">quantizeml.layers</span> <span class="kn">import</span> <span class="n">ClassToken</span><span class="p">,</span> <span class="n">Attention</span>
<span class="kn">from</span> <span class="nn">quantizeml.tensors</span> <span class="kn">import</span> <span class="n">FixedPoint</span>
<span class="kn">from</span> <span class="nn">quantizeml.models.transforms.transforms_utils</span> <span class="kn">import</span> <span class="n">get_layers_by_type</span>


<span class="k">def</span> <span class="nf">build_attention_map</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">image</span><span class="p">):</span>
    <span class="c1"># Get the Attention layers list</span>
    <span class="n">attentions</span> <span class="o">=</span> <span class="n">get_layers_by_type</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Attention</span><span class="p">)</span>

    <span class="c1"># Calculate the number of tokens and deduce the grid size</span>
    <span class="n">num_tokens</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ly</span><span class="p">,</span> <span class="n">ClassToken</span><span class="p">)</span> <span class="k">for</span> <span class="n">ly</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span>
    <span class="n">grid_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">attentions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">output_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">num_tokens</span><span class="p">))</span>

    <span class="c1"># Get the attention weights from each transformer</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">la</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">la</span> <span class="ow">in</span> <span class="n">attentions</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Converts to float if needed</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">FixedPoint</span><span class="p">)</span> <span class="k">else</span> <span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="c1"># Heads number</span>
    <span class="n">num_heads</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">num_layers</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">num_layers</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Average the attention weights across all heads</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># To account for residual connections, we add an identity matrix to the attention matrix and</span>
    <span class="c1"># re-normalize the weights.</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">reshaped</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span> <span class="o">/</span> <span class="n">reshaped</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

    <span class="c1"># Recursively multiply the weight matrices</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">reshaped</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">reshaped</span><span class="p">)):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">reshaped</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">n</span><span class="p">])</span>

    <span class="c1"># Attention from the output token to the input space</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">grid_size</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">mask</span> <span class="o">/</span> <span class="n">mask</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">mask</span> <span class="o">*</span> <span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>


<span class="c1"># Using a specific image for which attention map is easier to observe</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

<span class="c1"># Compute the attention map</span>
<span class="n">attention_float</span> <span class="o">=</span> <span class="n">build_attention_map</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
<span class="n">attention_quantized</span> <span class="o">=</span> <span class="n">build_attention_map</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>

<span class="c1"># Display the attention map</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Float&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">attention_float</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Quantized&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">attention_quantized</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Attention masks&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_7_vision_transformer_001.png" srcset="../../_images/sphx_glr_plot_7_vision_transformer_001.png" alt="Attention masks, Original, Float, Quantized" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 2s 2s/step

1/1 [==============================] - ETA: 0s
1/1 [==============================] - 33s 33s/step
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 4 minutes  40.275 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-general-plot-7-vision-transformer-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/eff8033b2bd356f7a111980b79134365/plot_7_vision_transformer.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_7_vision_transformer.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/05650343d25ad287b6cecb0e9a3a3ef5/plot_7_vision_transformer.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_7_vision_transformer.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_6_segmentation.html" class="btn btn-neutral float-left" title="Segmentation tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../quantization/plot_0_advanced_quantizeml.html" class="btn btn-neutral float-right" title="Advanced QuantizeML tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, BrainChip Holdings Ltd. All Rights Reserved.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>