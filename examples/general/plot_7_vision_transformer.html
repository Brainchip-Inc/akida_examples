<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vision transformers &mdash; Akida Examples  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Advanced QuantizeML tutorial" href="../quantization/plot_0_advanced_quantizeml.html" />
    <link rel="prev" title="Segmentation tutorial" href="plot_6_segmentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #989898" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/MetaTF_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Akida, 2nd Generation
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#supported-configurations">Supported configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#quick-installation">Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#running-examples">Running examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/user_guide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/akida.html">Akida user guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#programming-interface">Programming interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#the-akida-model">The Akida Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#akida-layers">Akida layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#model-hardware-mapping">Model Hardware Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#devices">Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#model-mapping">Model mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#advanced-mapping-details-and-hardware-devices-usage">Advanced Mapping Details and Hardware Devices Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#performance-measurement">Performance measurement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#using-akida-edge-learning">Using Akida Edge learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#learning-constraints">Learning constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#compiling-a-layer">Compiling a layer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quantizeml.html">QuantizeML toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#the-fixedpoint-representation">The FixedPoint representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#quantization-flow">Quantization flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#compatibility-constraints">Compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#model-loading">Model loading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#command-line-interface">Command line interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#quantize-cli">quantize CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#config-cli">config CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#check-cli">check CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#insert-rescaling-cli">insert_rescaling CLI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#supported-layer-types">Supported layer types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/cnn2snn.html">CNN2SNN toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#conversion-flow">Conversion flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#conversion-compatibility">Conversion compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#command-line-interface">Command-line interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#handling-akida-1-0-and-akida-2-0-specificities">Handling Akida 1.0 and Akida 2.0 specificities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#legacy-quantization-api">Legacy quantization API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#typical-quantization-scenario">Typical quantization scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#design-compatibility-constraints">Design compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#id3">Command-line interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#layers-considerations">Layers Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/akida_models.html">Akida models zoo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-creation">Command-line interface for model creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-training">Command-line interface for model training</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#kws-training">KWS training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#akidanet-training">AkidaNet training</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-evaluation">Command-line interface for model evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-to-evaluate-model-macs">Command-line interface to evaluate model MACS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#id1">Layer Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#handling-akida-1-0-and-akida-2-0-specificities">Handling Akida 1.0 and Akida 2.0 specificities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hw_constraints.html">Hardware constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#inputconvolutional">InputConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#convolutional">Convolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#separableconvolutional">SeparableConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#fullyconnected">FullyConnected</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/api_reference.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/akida_apis.html">Akida runtime</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#model">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#layer">Layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id1">Layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#mapping">Mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#akida-v1-layers">Akida V1 layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#akida-v2-layers">Akida V2 layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#layer-parameters">Layer parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#layertype">LayerType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#padding">Padding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#pooltype">PoolType</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#optimizers">Optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#sequence">Sequence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id2">Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#backendtype">BackendType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#pass">Pass</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#device">Device</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id3">Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#hwversion">HwVersion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#hwdevice">HWDevice</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id4">HWDevice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#socdriver">SocDriver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#clockmode">ClockMode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#powermeter">PowerMeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#np">NP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#tools">Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#sparsity">Sparsity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#compatibility">Compatibility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html">CNN2SNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#akida-version">Akida version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#conversion">Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#legacy-quantization-api">Legacy quantization API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#utils">Utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#calibration">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#transforms">Transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#constraint">Constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantization">Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizers">Quantizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantized-layers">Quantized layers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/quantizeml_apis.html">QuantizeML</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#layers">Layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#reshaping">Reshaping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#activations">Activations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#attention">Attention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#normalization">Normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#convolution">Convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#depthwise-convolution">Depthwise convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#separable-convolution">Separable convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#dense">Dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#skip-connection">Skip connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#pooling">Pooling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#shiftmax">Shiftmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#transformers">Transformers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#rescaling">Rescaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#dropout">Dropout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantizers">Quantizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantization-parameters">Quantization parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#calibration">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#recording">Recording</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#models">Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#transforms">Transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantization">Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#id1">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#utils">Utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#tensors">Tensors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#qtensor">QTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#fixedpoint">FixedPoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#qfloat">QFloat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/akida_models_apis.html">Akida models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#layer-blocks">Layer blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#cnn-blocks">CNN blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transformers-blocks">Transformers blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transposed-blocks">Transposed blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#detection-block">Detection block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#helpers">Helpers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#gamma-constraint">Gamma constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#unfusing-separableconvolutional">Unfusing SeparableConvolutional</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#extract-samples">Extract samples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#knowledge-distillation">Knowledge distillation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#macs">MACS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#model-i-o">Model I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#utils">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#model-zoo">Model zoo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#akidanet">AkidaNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#mobilenet">Mobilenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#ds-cnn">DS-CNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#vgg">VGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#yolo">YOLO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#pointnet">PointNet++</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#gxnor">GXNOR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#centernet">CenterNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#akidaunet">AkidaUNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transformers">Transformers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#general-examples">General examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_0_global_workflow.html">Global Akida workflow tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#create-and-train">1. Create and train</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#quantize">2. Quantize</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#convert">3. Convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#gxnor-mnist">4. GXNOR/MNIST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_1_akidanet_imagenet.html">AkidaNet/ImageNet inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#pretrained-quantized-model">2. Pretrained quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#conversion-to-akida">3. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#hardware-mapping-and-performance">4. Hardware mapping and performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_2_ds_cnn_kws.html">DS-CNN/KWS inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-the-preprocessed-dataset">1. Load the preprocessed dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#confusion-matrix">5. Confusion matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_3_regression.html">Age estimation (regression) example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-the-utkface-dataset">1. Load the UTKFace Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#estimate-age-on-a-single-image">5. Estimate age on a single image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_4_transfer_learning.html">Transfer learning with AkidaNet for PlantVillage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#transfer-learning-process">Transfer learning process</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#get-a-trained-akidanet-base-model">2. Get a trained AkidaNet base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#add-a-classification-head-to-the-model">3. Add a classification head to the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#freeze-the-base-model">4. Freeze the base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#train-for-a-few-epochs">5. Train for a few epochs</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#quantize-the-model">6. Quantize the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#compute-accuracy">7. Compute accuracy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_5_voc_yolo_detection.html">YOLO/PASCAL-VOC detection tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#introduction">1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#preprocessing-tools">2. Preprocessing tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#model-architecture">3. Model architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#training">4. Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#performance">5. Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#conversion-to-akida">6. Conversion to Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_6_segmentation.html">Segmentation tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-the-dataset">1. Load the dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#segment-a-single-image">5. Segment a single image</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Vision transformers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-a-transformer-model">2. Create a transformer model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quantization">3. Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attention-maps">5.3 Attention maps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#quantization">Quantization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html">Advanced QuantizeML tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html#defining-a-quantization-scheme">1. Defining a quantization scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html#calibration">2. Calibration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html">Upgrading to Akida 2.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#workflow-differences">1. Workflow differences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#models-architecture-differences">2. Models architecture differences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#using-akidaversion">3. Using <code class="docutils literal notranslate"><span class="pre">AkidaVersion</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#edge-examples">Edge examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html">Akida vision edge learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#prepare-akida-model-for-learning">2. Prepare Akida model for learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#edge-learning-with-akida">3. Edge learning with Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html">Akida edge learning for keyword spotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#edge-learning-process">1. Edge learning process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#dataset-preparation">2. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#prepare-akida-model-for-learning">3. Prepare Akida model for learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#learn-with-akida-using-the-training-set">4. Learn with Akida using the training set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#edge-learning">5. Edge learning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html">Tips to set Akida learning parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#akida-learning-parameters">1. Akida learning parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#create-akida-model">2. Create Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#estimate-the-required-number-of-weights-of-the-trainable-layer">3. Estimate the required number of weights of the trainable layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#estimate-the-number-of-neurons-per-class">4. Estimate the number of neurons per class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#deprecated-cnn2snn-tutorials">[Deprecated] CNN2SNN tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html">Advanced CNN2SNN tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#design-a-cnn2snn-quantized-model">1. Design a CNN2SNN quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#weight-quantizer-details">2. Weight Quantizer Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#understanding-quantized-activation">3. Understanding quantized activation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#how-to-deal-with-too-high-scale-factors">4. How to deal with too high scale factors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../model_zoo_performance.html">Model zoo performance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../model_zoo_performance.html#akida-1-0-models">Akida 1.0 models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#image-icon-ref-image-domain"> Image domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#classification">Classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#object-detection">Object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#regression">Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#face-recognition">Face recognition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#audio-icon-ref-audio-domain"> Audio domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#keyword-spotting">Keyword spotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#pointcloud-icon-ref-point-cloud"> Point cloud</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id1">Classification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../model_zoo_performance.html#akida-2-0-models">Akida 2.0 models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id2"> Image domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id3">Classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id6">Object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id7">Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id8">Face recognition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#segmentation">Segmentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id10"> Audio domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id11">Keyword spotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id12"> Point cloud</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id13">Classification</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://support.brainchip.com/portal/home">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #989898" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Akida Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Akida examples</a></li>
      <li class="breadcrumb-item active">Vision transformers</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-general-plot-7-vision-transformer-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="vision-transformers">
<span id="sphx-glr-examples-general-plot-7-vision-transformer-py"></span><h1>Vision transformers<a class="headerlink" href="#vision-transformers" title="Permalink to this headline"></a></h1>
<p>This tutorial demonstrates that Vision Transformers can be adapted and converted to Akida to perform
image classification.</p>
<p>Just like for the <a class="reference external" href="plot_1_akidanet_imagenet.html#sphx-glr-examples-general-plot-1-akidanet-imagenet-py">AkidaNet example</a>, ImageNet
images are not publicly available, performance is assessed using a set of 10 copyright free images
that were found on Google using ImageNet class names.</p>
<section id="dataset-preparation">
<h2>1. Dataset preparation<a class="headerlink" href="#dataset-preparation" title="Permalink to this headline"></a></h2>
<p>See <a class="reference external" href="plot_1_akidanet_imagenet.html#sphx-glr-examples-general-plot-1-akidanet-imagenet-py">AkidaNet example</a> for
details on dataset preparation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">tensorflow.io</span> <span class="kn">import</span> <span class="n">read_file</span>
<span class="kn">from</span> <span class="nn">tensorflow.image</span> <span class="kn">import</span> <span class="n">decode_jpeg</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">get_file</span>

<span class="kn">from</span> <span class="nn">akida_models.imagenet</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="c1"># Model specification and hyperparameters</span>
<span class="n">NUM_CHANNELS</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">IMAGE_SIZE</span> <span class="o">=</span> <span class="mi">224</span>

<span class="n">NUM_IMAGES</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Retrieve dataset file from Brainchip data server</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span>
    <span class="s2">&quot;imagenet_like.zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://data.brainchip.com/dataset-mirror/imagenet_like/imagenet_like.zip&quot;</span><span class="p">,</span>
    <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;datasets/imagenet_like&#39;</span><span class="p">,</span>
    <span class="n">extract</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># Load images for test set</span>
<span class="n">x_test_files</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NUM_IMAGES</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">,</span> <span class="n">NUM_CHANNELS</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">):</span>
    <span class="n">test_file</span> <span class="o">=</span> <span class="s1">&#39;image_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span>
    <span class="n">x_test_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
    <span class="n">img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">test_file</span><span class="p">)</span>
    <span class="n">base_image</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">decode_jpeg</span><span class="p">(</span><span class="n">base_image</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="n">NUM_CHANNELS</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">preprocess_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">)</span>
    <span class="n">x_test</span><span class="p">[</span><span class="nb">id</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">NUM_IMAGES</span><span class="si">}</span><span class="s1"> images loaded and preprocessed.&#39;</span><span class="p">)</span>

<span class="c1"># Parse labels file</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="s1">&#39;labels_validation.txt&#39;</span><span class="p">)</span>
<span class="n">validation_labels</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="n">validation_labels</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Get labels for the test set by index</span>
<span class="n">labels_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">):</span>
    <span class="n">labels_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">validation_labels</span><span class="p">[</span><span class="n">x_test_files</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>10 images loaded and preprocessed.
</pre></div>
</div>
</section>
<section id="create-a-transformer-model">
<h2>2. Create a transformer model<a class="headerlink" href="#create-a-transformer-model" title="Permalink to this headline"></a></h2>
<section id="selecting-an-architecture">
<h3>2.1. Selecting an architecture<a class="headerlink" href="#selecting-an-architecture" title="Permalink to this headline"></a></h3>
<p>Vision Transformers is a hot-topic in AI and new architectures are being introduced regularly.
When selecting an appropriate achitecture for Akida, some size, speed and training capabilities
must be considered.</p>
<p>The following table briefly shows what led to chose the ViT Tiny and DeiT-dist architectures:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 23%" />
<col style="width: 11%" />
<col style="width: 23%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Architecture</p></th>
<th class="head"><p>Original accuracy</p></th>
<th class="head"><p>#Params</p></th>
<th class="head"><p>Architecture</p></th>
<th class="head"><p>Commment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ViT Base</p></td>
<td><p>79.90%</p></td>
<td><p>86M</p></td>
<td><p>12 heads,
12 blocks,
hidden size 768</p></td>
<td><p>base model but huge
amount of parameters</p></td>
</tr>
<tr class="row-odd"><td><p>ViT Tiny</p></td>
<td><p>75.48%</p></td>
<td><p>5.8M</p></td>
<td><p>3 heads,
12 blocks,
hidden size 192</p></td>
<td><p>edge compatible</p></td>
</tr>
<tr class="row-even"><td><p>DeiT-dist
Tiny</p></td>
<td><p>74.17%</p></td>
<td><p>5.8M</p></td>
<td><p>3 heads,
12 blocks,
hidden size 192</p></td>
<td><p>easy to retrain
thanks to the
distilled token</p></td>
</tr>
</tbody>
</table>
<p>The model zoo then comes with two vision transformers architectures:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_vit_ti16">BC ViT Ti16</a>, which
is a modified version of <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.vit_ti16">ViT TI16</a> described in <a class="reference external" href="https://arxiv.org/abs/2010.11929">the
original ViT paper</a>,</p></li>
<li><p><a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_deit_ti16">BC DeiT-dist Ti16</a>,
which is a modified version of the original <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.deit_ti16">DeiT TI16</a> described in <a class="reference external" href="https://arxiv.org/abs/2012.12877">the
original DeiT-dist paper</a>.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Vision Transformers support has been introduced in Akida 2.0.</p>
</div>
</section>
<section id="model-transformations">
<h3>2.2. Model transformations<a class="headerlink" href="#model-transformations" title="Permalink to this headline"></a></h3>
<p>Both architectures have been modified so that their layers can be quantized to integer only
operations. The detailed list of changes is:</p>
<blockquote>
<div><ul class="simple">
<li><p>replace <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/LayerNormalization">LayerNormalization</a> with
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.LayerMadNormalization">LayerMadNormalization</a> and
replace the last normalization previous to the classification head with a <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization">BatchNormalization</a>,</p></li>
<li><p>replace <a class="reference external" href="https://www.tensorflow.org/addons/api_docs/python/tfa/layers/GELU">GeLU</a>
activations with <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/ReLU">ReLU8</a>,</p></li>
<li><p>replace the <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/activations/softmax">softmax</a> operation in
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.Attention">Attention</a> with a
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.shiftmax">shiftmax</a> operation.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Details on the custom layers and operations are given in the API docstrings.</p>
</div>
<p>Layer replacement is made possible through the <code class="docutils literal notranslate"><span class="pre">akida_models</span> <span class="pre">create</span></code> CLI that comes with
dedicated options for the <code class="docutils literal notranslate"><span class="pre">vit_ti16</span></code> and <code class="docutils literal notranslate"><span class="pre">deit_ti16</span></code> architectures. See for example the helper
for ViT:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>akida_models<span class="w"> </span>create<span class="w"> </span>vit_ti16<span class="w"> </span>-h
usage:<span class="w"> </span>akida_models<span class="w"> </span>create<span class="w"> </span>vit_ti16<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>-c<span class="w"> </span>CLASSES<span class="o">]</span><span class="w"> </span><span class="o">[</span>-bw<span class="w"> </span>BASE_WEIGHTS<span class="o">]</span><span class="w"> </span><span class="o">[</span>--norm<span class="w"> </span><span class="o">{</span>LN,GN1,BN,LMN<span class="o">}]</span>
<span class="w">                                    </span><span class="o">[</span>--last_norm<span class="w"> </span><span class="o">{</span>LN,BN<span class="o">}]</span><span class="w"> </span><span class="o">[</span>--softmax<span class="w"> </span><span class="o">{</span>softmax,softmax2<span class="o">}]</span>
<span class="w">                                    </span><span class="o">[</span>--act<span class="w"> </span><span class="o">{</span>GeLU,ReLU8,swish<span class="o">}]</span><span class="w"> </span><span class="o">[</span>-i<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}]</span>

optional<span class="w"> </span>arguments:
<span class="w">  </span>-h,<span class="w"> </span>--help<span class="w">            </span>show<span class="w"> </span>this<span class="w"> </span><span class="nb">help</span><span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span>
<span class="w">  </span>-c<span class="w"> </span>CLASSES,<span class="w"> </span>--classes<span class="w"> </span>CLASSES
<span class="w">                        </span>The<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>classes,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span><span class="m">1000</span>.
<span class="w">  </span>-bw<span class="w"> </span>BASE_WEIGHTS,<span class="w"> </span>--base_weights<span class="w"> </span>BASE_WEIGHTS
<span class="w">                        </span>Optional<span class="w"> </span>keras<span class="w"> </span>weights<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>model,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>None.
<span class="w">  </span>--norm<span class="w"> </span><span class="o">{</span>LN,GN1,BN,LMN<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>normalization<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>LN
<span class="w">  </span>--last_norm<span class="w"> </span><span class="o">{</span>LN,BN<span class="o">}</span><span class="w">   </span>Replace<span class="w"> </span>last<span class="w"> </span>normalization<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>LN
<span class="w">  </span>--softmax<span class="w"> </span><span class="o">{</span>softmax,softmax2<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>softmax<span class="w"> </span>operation<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>softmax
<span class="w">  </span>--act<span class="w"> </span><span class="o">{</span>GeLU,ReLU8,swish<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>activation<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>GeLU
<span class="w">  </span>-i<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}</span>,<span class="w"> </span>--image_size<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}</span>
<span class="w">                        </span>The<span class="w"> </span>square<span class="w"> </span>input<span class="w"> </span>image<span class="w"> </span>size
</pre></div>
</div>
<p>The replacement layers are functionaly equivalent to the base layers but an accuracy loss is
introduced at each step. This is compensated by a tuning step after each change.</p>
<p>For example, replacing activations layers can be done with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://data.brainchip.com/models/AkidaV2/vit/vit_ti16_224.h5
akida_models<span class="w"> </span>create<span class="w"> </span>-s<span class="w"> </span>vit_ti16_relu.h5<span class="w"> </span>vit_ti16<span class="w"> </span>-bw<span class="w"> </span>vit_ti16_224.h5<span class="w"> </span>--act<span class="w"> </span>ReLU8
imagenet_train<span class="w"> </span>tune<span class="w"> </span>-m<span class="w"> </span>vit_ti16_relu.h5<span class="w"> </span>-e<span class="w"> </span><span class="m">15</span><span class="w"> </span>--optim<span class="w"> </span>Adam<span class="w"> </span>--lr_policy<span class="w"> </span>cosine_decay<span class="w"> </span><span class="se">\</span>
<span class="w">                    </span>-lr<span class="w"> </span>6e-5<span class="w"> </span>-s<span class="w"> </span>vit_ti16_relu_tuned.h5
</pre></div>
</div>
<p>After all changes, the model accuracy is close to (or better than) the original model and the
“BC” transformer model is ready for quantization.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 40%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Architecture</p></th>
<th class="head"><p>Original accuracy</p></th>
<th class="head"><p>“BC” accuracy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ViT</p></td>
<td><p>75.48%</p></td>
<td><p>74.25%</p></td>
</tr>
<tr class="row-odd"><td><p>DeiT-dist</p></td>
<td><p>74.17%</p></td>
<td><p>75.03%</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the following sections, the ViT model will be used but the very same steps apply to
DeiT-dist.</p>
</div>
</section>
<section id="load-a-pre-trained-native-keras-model">
<h3>2.3. Load a pre-trained native Keras model<a class="headerlink" href="#load-a-pre-trained-native-keras-model" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models.model_io</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="c1"># Retrieve the float model with pretrained weights and load it</span>
<span class="n">model_file</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span>
    <span class="s2">&quot;bc_vit_ti16_224.h5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224.h5&quot;</span><span class="p">,</span>
    <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;models/akidanet_imagenet&#39;</span><span class="p">)</span>
<span class="n">model_keras</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">model_file</span><span class="p">)</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224.h5

    8192/23695632 [..............................] - ETA: 0s
  155648/23695632 [..............................] - ETA: 7s
  368640/23695632 [..............................] - ETA: 6s
 1130496/23695632 [&gt;.............................] - ETA: 3s
 1695744/23695632 [=&gt;............................] - ETA: 2s
 2260992/23695632 [=&gt;............................] - ETA: 2s
 2834432/23695632 [==&gt;...........................] - ETA: 2s
 3407872/23695632 [===&gt;..........................] - ETA: 2s
 3948544/23695632 [===&gt;..........................] - ETA: 2s
 4538368/23695632 [====&gt;.........................] - ETA: 1s
 5128192/23695632 [=====&gt;........................] - ETA: 1s
 5709824/23695632 [======&gt;.......................] - ETA: 1s
 6299648/23695632 [======&gt;.......................] - ETA: 1s
 6905856/23695632 [=======&gt;......................] - ETA: 1s
 7487488/23695632 [========&gt;.....................] - ETA: 1s
 8093696/23695632 [=========&gt;....................] - ETA: 1s
 8683520/23695632 [=========&gt;....................] - ETA: 1s
 9273344/23695632 [==========&gt;...................] - ETA: 1s
 9863168/23695632 [===========&gt;..................] - ETA: 1s
10452992/23695632 [============&gt;.................] - ETA: 1s
11059200/23695632 [=============&gt;................] - ETA: 1s
11657216/23695632 [=============&gt;................] - ETA: 1s
12247040/23695632 [==============&gt;...............] - ETA: 1s
12853248/23695632 [===============&gt;..............] - ETA: 0s
13459456/23695632 [================&gt;.............] - ETA: 0s
14049280/23695632 [================&gt;.............] - ETA: 0s
14639104/23695632 [=================&gt;............] - ETA: 0s
15245312/23695632 [==================&gt;...........] - ETA: 0s
15835136/23695632 [===================&gt;..........] - ETA: 0s
16424960/23695632 [===================&gt;..........] - ETA: 0s
17014784/23695632 [====================&gt;.........] - ETA: 0s
17604608/23695632 [=====================&gt;........] - ETA: 0s
18194432/23695632 [======================&gt;.......] - ETA: 0s
18800640/23695632 [======================&gt;.......] - ETA: 0s
19161088/23695632 [=======================&gt;......] - ETA: 0s
19668992/23695632 [=======================&gt;......] - ETA: 0s
20209664/23695632 [========================&gt;.....] - ETA: 0s
20586496/23695632 [=========================&gt;....] - ETA: 0s
20963328/23695632 [=========================&gt;....] - ETA: 0s
21323776/23695632 [=========================&gt;....] - ETA: 0s
21708800/23695632 [==========================&gt;...] - ETA: 0s
22077440/23695632 [==========================&gt;...] - ETA: 0s
22454272/23695632 [===========================&gt;..] - ETA: 0s
22863872/23695632 [===========================&gt;..] - ETA: 0s
23240704/23695632 [============================&gt;.] - ETA: 0s
23601152/23695632 [============================&gt;.] - ETA: 0s
23695632/23695632 [==============================] - 2s 0us/step
/usr/local/lib/python3.8/dist-packages/keras/initializers/initializers.py:120: UserWarning: The initializer TruncatedNormal is unseeded and being called multiple times, which will return identical values each time (even if the initializer is unseeded). Please update your code to provide a seed to the initializer, or avoid using the same initalizer instance more than once.
  warnings.warn(
Model: &quot;vit-tiny&quot;
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input (InputLayer)             [(None, 224, 224, 3  0           []
                                )]

 Rescale (Rescaling)            (None, 224, 224, 3)  0           [&#39;input[0][0]&#39;]

 Embedding (Conv2D)             (None, 14, 14, 192)  147648      [&#39;Rescale[0][0]&#39;]

 reshape (Reshape)              (None, 196, 192)     0           [&#39;Embedding[0][0]&#39;]

 ClassToken (ClassToken)        (None, 197, 192)     192         [&#39;reshape[0][0]&#39;]

 Transformer/PosEmbed (AddPosit  (None, 197, 192)    37824       [&#39;ClassToken[0][0]&#39;]
 ionEmbs)

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    384         [&#39;Transformer/PosEmbed[0][0]&#39;]
 erNorm_0 (LayerMadNormalizatio
 n)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_0/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout (Dropout)              (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    0           [&#39;dropout[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/PosEmbed[0][0]&#39;]

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_0/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_0/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_1 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 192)    147648      [&#39;dropout_1[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_2 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_0/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_1/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_3 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    0           [&#39;dropout_3[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_0/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_1/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_1/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_4 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 192)    147648      [&#39;dropout_4[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_5 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_1/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_5[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_2/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_6 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    0           [&#39;dropout_6[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_1/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_2/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_2/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_7 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 192)    147648      [&#39;dropout_7[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_8 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_2/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_8[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_3/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_9 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    0           [&#39;dropout_9[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_2/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_3/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_3/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_10 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 192)    147648      [&#39;dropout_10[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_11 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_3/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_11[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_4/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_12 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    0           [&#39;dropout_12[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_3/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_4/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_4/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_13 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 192)    147648      [&#39;dropout_13[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_14 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_4/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_14[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_5/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_15 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    0           [&#39;dropout_15[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_4/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_5/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_5/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_16 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 192)    147648      [&#39;dropout_16[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_17 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_5/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_17[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_6/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_18 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    0           [&#39;dropout_18[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_5/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_6/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_6/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_19 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 192)    147648      [&#39;dropout_19[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_20 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_6/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_20[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_7/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_21 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    0           [&#39;dropout_21[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_6/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_7/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_7/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_22 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 192)    147648      [&#39;dropout_22[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_23 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_7/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_23[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_8/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_24 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    0           [&#39;dropout_24[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_7/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_8/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_8/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_25 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 192)    147648      [&#39;dropout_25[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_26 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_8/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_26[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_9/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_27 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    0           [&#39;dropout_27[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_8/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_9/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_9/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_28 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 192)    147648      [&#39;dropout_28[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_29 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_9/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_29[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 yerNorm_0 (LayerMadNormalizati                                  2[0][0]&#39;]
 on)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (Dense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (Dense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (Dense)

 Transformer/EncoderBlock_10/Mu  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (Attention)           ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (Dense)                                                      tion[0][0]&#39;]

 dropout_30 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    0           [&#39;dropout_30[0][0]&#39;,
 d_1 (Add)                                                        &#39;Transformer/EncoderBlock_9/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_2 (LayerMadNormalizati                                  _1[0][0]&#39;]
 on)

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_10/Lay
 pBlock/Dense_0 (Dense)                                          erNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_10/Mlp
 pBlock/activation (ReLU)                                        Block/Dense_0[0][0]&#39;]

 dropout_31 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 192)    147648      [&#39;dropout_31[0][0]&#39;]
 pBlock/Dense_1 (Dense)

 dropout_32 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_10/add
 d_2 (Add)                                                       _1[0][0]&#39;,
                                                                  &#39;dropout_32[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_0 (LayerMadNormalizati                                  _2[0][0]&#39;]
 on)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (Dense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (Dense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (Dense)

 Transformer/EncoderBlock_11/Mu  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (Attention)           ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (Dense)                                                      tion[0][0]&#39;]

 dropout_33 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;dropout_33[0][0]&#39;,
 d_1 (Add)                                                        &#39;Transformer/EncoderBlock_10/add
                                                                 _2[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_11/add
 yerNorm_2 (LayerMadNormalizati                                  _1[0][0]&#39;]
 on)

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_11/Lay
 pBlock/Dense_0 (Dense)                                          erNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_11/Mlp
 pBlock/activation (ReLU)                                        Block/Dense_0[0][0]&#39;]

 dropout_34 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 192)    147648      [&#39;dropout_34[0][0]&#39;]
 pBlock/Dense_1 (Dense)

 dropout_35 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_11/add
 d_2 (Add)                                                       _1[0][0]&#39;,
                                                                  &#39;dropout_35[0][0]&#39;]

 Transformer/EncoderNorm (Batch  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_11/add
 Normalization)                                                  _2[0][0]&#39;]

 ExtractToken (ExtractToken)    (None, 192)          0           [&#39;Transformer/EncoderNorm[0][0]&#39;]

 Head (Dense)                   (None, 1000)         193000      [&#39;ExtractToken[0][0]&#39;]

==================================================================================================
Total params: 5,717,800
Trainable params: 5,717,416
Non-trainable params: 384
__________________________________________________________________________________________________
</pre></div>
</div>
<p>The perfomance given below uses the 10 ImageNet like images subset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check model performance</span>
<span class="k">def</span> <span class="nf">check_model_performance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_test</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">labels_test</span><span class="o">=</span><span class="n">labels_test</span><span class="p">):</span>
    <span class="n">outputs_keras</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">NUM_IMAGES</span><span class="p">)</span>
    <span class="n">outputs_keras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">outputs_keras</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">accuracy_keras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">outputs_keras</span><span class="p">,</span> <span class="n">labels_test</span><span class="p">))</span> <span class="o">/</span> <span class="n">NUM_IMAGES</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Keras accuracy: </span><span class="si">{</span><span class="n">accuracy_keras</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_keras</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 1s 1s/step
Keras accuracy: 100.00 %
</pre></div>
</div>
</section>
</section>
<section id="quantization">
<h2>3. Quantization<a class="headerlink" href="#quantization" title="Permalink to this headline"></a></h2>
<section id="bit-ptq">
<h3>3.1. 8-bit PTQ<a class="headerlink" href="#bit-ptq" title="Permalink to this headline"></a></h3>
<p>The above native Keras model is quantized to 8-bit (all weights and activations) and we compute
the post-training quantization (PTQ) accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">fetch_file</span>

<span class="c1"># Retrieve calibration samples</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">fetch_file</span><span class="p">(</span><span class="s2">&quot;https://data.brainchip.com/dataset-mirror/samples/imagenet/imagenet_batch1024_224.npz&quot;</span><span class="p">,</span>
                     <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;imagenet_batch1024_224.npz&quot;</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">samples</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">samples</span><span class="o">.</span><span class="n">files</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/dataset-mirror/samples/imagenet/imagenet_batch1024_224.npz.

        0/616562950 [..............................] - ETA: 0s
    98304/616562950 [..............................] - ETA: 5:35
   376832/616562950 [..............................] - ETA: 3:45
  1449984/616562950 [..............................] - ETA: 1:20
  2039808/616562950 [..............................] - ETA: 1:12
  2613248/616562950 [..............................] - ETA: 1:07
  3203072/616562950 [..............................] - ETA: 1:04
  3792896/616562950 [..............................] - ETA: 1:02
  4366336/616562950 [..............................] - ETA: 1:01
  4956160/616562950 [..............................] - ETA: 1:00
  5570560/616562950 [..............................] - ETA: 59s 
  6160384/616562950 [..............................] - ETA: 58s
  6750208/616562950 [..............................] - ETA: 58s
  7340032/616562950 [..............................] - ETA: 57s
  7929856/616562950 [..............................] - ETA: 57s
  8536064/616562950 [..............................] - ETA: 56s
  9043968/616562950 [..............................] - ETA: 56s
  9502720/616562950 [..............................] - ETA: 57s
  9977856/616562950 [..............................] - ETA: 57s
 10469376/616562950 [..............................] - ETA: 57s
 10960896/616562950 [..............................] - ETA: 58s
 11452416/616562950 [..............................] - ETA: 58s
 11927552/616562950 [..............................] - ETA: 58s
 12451840/616562950 [..............................] - ETA: 58s
 12959744/616562950 [..............................] - ETA: 58s
 13467648/616562950 [..............................] - ETA: 58s
 13991936/616562950 [..............................] - ETA: 58s
 14516224/616562950 [..............................] - ETA: 58s
 15040512/616562950 [..............................] - ETA: 58s
 15581184/616562950 [..............................] - ETA: 58s
 16105472/616562950 [..............................] - ETA: 58s
 16646144/616562950 [..............................] - ETA: 58s
 17186816/616562950 [..............................] - ETA: 57s
 17743872/616562950 [..............................] - ETA: 57s
 18300928/616562950 [..............................] - ETA: 57s
 18874368/616562950 [..............................] - ETA: 57s
 19431424/616562950 [..............................] - ETA: 57s
 20004864/616562950 [..............................] - ETA: 57s
 20578304/616562950 [&gt;.............................] - ETA: 56s
 21151744/616562950 [&gt;.............................] - ETA: 56s
 21725184/616562950 [&gt;.............................] - ETA: 56s
 22298624/616562950 [&gt;.............................] - ETA: 56s
 22872064/616562950 [&gt;.............................] - ETA: 56s
 23445504/616562950 [&gt;.............................] - ETA: 56s
 24035328/616562950 [&gt;.............................] - ETA: 55s
 24641536/616562950 [&gt;.............................] - ETA: 55s
 25214976/616562950 [&gt;.............................] - ETA: 55s
 25804800/616562950 [&gt;.............................] - ETA: 55s
 26394624/616562950 [&gt;.............................] - ETA: 55s
 26984448/616562950 [&gt;.............................] - ETA: 55s
 27574272/616562950 [&gt;.............................] - ETA: 54s
 28180480/616562950 [&gt;.............................] - ETA: 54s
 28770304/616562950 [&gt;.............................] - ETA: 54s
 29360128/616562950 [&gt;.............................] - ETA: 54s
 29949952/616562950 [&gt;.............................] - ETA: 54s
 30539776/616562950 [&gt;.............................] - ETA: 54s
 31129600/616562950 [&gt;.............................] - ETA: 54s
 31735808/616562950 [&gt;.............................] - ETA: 53s
 32325632/616562950 [&gt;.............................] - ETA: 53s
 32931840/616562950 [&gt;.............................] - ETA: 53s
 33521664/616562950 [&gt;.............................] - ETA: 53s
 34127872/616562950 [&gt;.............................] - ETA: 53s
 34717696/616562950 [&gt;.............................] - ETA: 53s
 35307520/616562950 [&gt;.............................] - ETA: 53s
 35897344/616562950 [&gt;.............................] - ETA: 53s
 36487168/616562950 [&gt;.............................] - ETA: 52s
 37076992/616562950 [&gt;.............................] - ETA: 52s
 37666816/616562950 [&gt;.............................] - ETA: 52s
 38273024/616562950 [&gt;.............................] - ETA: 52s
 38862848/616562950 [&gt;.............................] - ETA: 52s
 39469056/616562950 [&gt;.............................] - ETA: 52s
 40058880/616562950 [&gt;.............................] - ETA: 52s
 40656896/616562950 [&gt;.............................] - ETA: 52s
 41238528/616562950 [=&gt;............................] - ETA: 52s
 41828352/616562950 [=&gt;............................] - ETA: 52s
 42319872/616562950 [=&gt;............................] - ETA: 52s
 42860544/616562950 [=&gt;............................] - ETA: 52s
 43417600/616562950 [=&gt;............................] - ETA: 52s
 43810816/616562950 [=&gt;............................] - ETA: 52s
 44171264/616562950 [=&gt;............................] - ETA: 52s
 44564480/616562950 [=&gt;............................] - ETA: 52s
 44990464/616562950 [=&gt;............................] - ETA: 52s
 45383680/616562950 [=&gt;............................] - ETA: 53s
 45785088/616562950 [=&gt;............................] - ETA: 53s
 46202880/616562950 [=&gt;............................] - ETA: 53s
 46596096/616562950 [=&gt;............................] - ETA: 53s
 47005696/616562950 [=&gt;............................] - ETA: 53s
 47431680/616562950 [=&gt;............................] - ETA: 53s
 47841280/616562950 [=&gt;............................] - ETA: 53s
 48283648/616562950 [=&gt;............................] - ETA: 53s
 48726016/616562950 [=&gt;............................] - ETA: 53s
 49135616/616562950 [=&gt;............................] - ETA: 53s
 49577984/616562950 [=&gt;............................] - ETA: 53s
 50036736/616562950 [=&gt;............................] - ETA: 54s
 50495488/616562950 [=&gt;............................] - ETA: 54s
 50970624/616562950 [=&gt;............................] - ETA: 54s
 51445760/616562950 [=&gt;............................] - ETA: 54s
 51920896/616562950 [=&gt;............................] - ETA: 54s
 52396032/616562950 [=&gt;............................] - ETA: 54s
 52887552/616562950 [=&gt;............................] - ETA: 54s
 53362688/616562950 [=&gt;............................] - ETA: 54s
 53870592/616562950 [=&gt;............................] - ETA: 54s
 54345728/616562950 [=&gt;............................] - ETA: 54s
 54870016/616562950 [=&gt;............................] - ETA: 54s
 55361536/616562950 [=&gt;............................] - ETA: 54s
 55869440/616562950 [=&gt;............................] - ETA: 54s
 56377344/616562950 [=&gt;............................] - ETA: 54s
 56885248/616562950 [=&gt;............................] - ETA: 54s
 57409536/616562950 [=&gt;............................] - ETA: 53s
 57933824/616562950 [=&gt;............................] - ETA: 53s
 58474496/616562950 [=&gt;............................] - ETA: 53s
 58998784/616562950 [=&gt;............................] - ETA: 53s
 59539456/616562950 [=&gt;............................] - ETA: 53s
 60080128/616562950 [=&gt;............................] - ETA: 53s
 60620800/616562950 [=&gt;............................] - ETA: 53s
 61177856/616562950 [=&gt;............................] - ETA: 53s
 61751296/616562950 [==&gt;...........................] - ETA: 53s
 62324736/616562950 [==&gt;...........................] - ETA: 53s
 62881792/616562950 [==&gt;...........................] - ETA: 53s
 63455232/616562950 [==&gt;...........................] - ETA: 53s
 64028672/616562950 [==&gt;...........................] - ETA: 53s
 64585728/616562950 [==&gt;...........................] - ETA: 52s
 65175552/616562950 [==&gt;...........................] - ETA: 52s
 65765376/616562950 [==&gt;...........................] - ETA: 52s
 66355200/616562950 [==&gt;...........................] - ETA: 52s
 66945024/616562950 [==&gt;...........................] - ETA: 52s
 67534848/616562950 [==&gt;...........................] - ETA: 52s
 68124672/616562950 [==&gt;...........................] - ETA: 52s
 68714496/616562950 [==&gt;...........................] - ETA: 52s
 69304320/616562950 [==&gt;...........................] - ETA: 52s
 69910528/616562950 [==&gt;...........................] - ETA: 52s
 70516736/616562950 [==&gt;...........................] - ETA: 51s
 71106560/616562950 [==&gt;...........................] - ETA: 51s
 71696384/616562950 [==&gt;...........................] - ETA: 51s
 72286208/616562950 [==&gt;...........................] - ETA: 51s
 72876032/616562950 [==&gt;...........................] - ETA: 51s
 73465856/616562950 [==&gt;...........................] - ETA: 51s
 74055680/616562950 [==&gt;...........................] - ETA: 51s
 74661888/616562950 [==&gt;...........................] - ETA: 51s
 75251712/616562950 [==&gt;...........................] - ETA: 51s
 75841536/616562950 [==&gt;...........................] - ETA: 51s
 76398592/616562950 [==&gt;...........................] - ETA: 51s
 76955648/616562950 [==&gt;...........................] - ETA: 50s
 77512704/616562950 [==&gt;...........................] - ETA: 50s
 77676544/616562950 [==&gt;...........................] - ETA: 51s
 78249984/616562950 [==&gt;...........................] - ETA: 51s
 78561280/616562950 [==&gt;...........................] - ETA: 51s
 78938112/616562950 [==&gt;...........................] - ETA: 51s
 79298560/616562950 [==&gt;...........................] - ETA: 51s
 79659008/616562950 [==&gt;...........................] - ETA: 51s
 80052224/616562950 [==&gt;...........................] - ETA: 51s
 80445440/616562950 [==&gt;...........................] - ETA: 51s
 80805888/616562950 [==&gt;...........................] - ETA: 51s
 81199104/616562950 [==&gt;...........................] - ETA: 51s
 81608704/616562950 [==&gt;...........................] - ETA: 51s
 81985536/616562950 [==&gt;...........................] - ETA: 51s
 82395136/616562950 [===&gt;..........................] - ETA: 51s
 82821120/616562950 [===&gt;..........................] - ETA: 51s
 83214336/616562950 [===&gt;..........................] - ETA: 51s
 83640320/616562950 [===&gt;..........................] - ETA: 51s
 84017152/616562950 [===&gt;..........................] - ETA: 51s
 84459520/616562950 [===&gt;..........................] - ETA: 51s
 84869120/616562950 [===&gt;..........................] - ETA: 52s
 85311488/616562950 [===&gt;..........................] - ETA: 52s
 85737472/616562950 [===&gt;..........................] - ETA: 52s
 86163456/616562950 [===&gt;..........................] - ETA: 52s
 86622208/616562950 [===&gt;..........................] - ETA: 52s
 87080960/616562950 [===&gt;..........................] - ETA: 52s
 87539712/616562950 [===&gt;..........................] - ETA: 52s
 87998464/616562950 [===&gt;..........................] - ETA: 52s
 88440832/616562950 [===&gt;..........................] - ETA: 52s
 88932352/616562950 [===&gt;..........................] - ETA: 51s
 89391104/616562950 [===&gt;..........................] - ETA: 51s
 89882624/616562950 [===&gt;..........................] - ETA: 51s
 90374144/616562950 [===&gt;..........................] - ETA: 51s
 90849280/616562950 [===&gt;..........................] - ETA: 51s
 91357184/616562950 [===&gt;..........................] - ETA: 51s
 91848704/616562950 [===&gt;..........................] - ETA: 51s
 92340224/616562950 [===&gt;..........................] - ETA: 51s
 92848128/616562950 [===&gt;..........................] - ETA: 51s
 93372416/616562950 [===&gt;..........................] - ETA: 51s
 93880320/616562950 [===&gt;..........................] - ETA: 51s
 94420992/616562950 [===&gt;..........................] - ETA: 51s
 94945280/616562950 [===&gt;..........................] - ETA: 51s
 95469568/616562950 [===&gt;..........................] - ETA: 51s
 95993856/616562950 [===&gt;..........................] - ETA: 51s
 96518144/616562950 [===&gt;..........................] - ETA: 51s
 97042432/616562950 [===&gt;..........................] - ETA: 51s
 97583104/616562950 [===&gt;..........................] - ETA: 51s
 98123776/616562950 [===&gt;..........................] - ETA: 51s
 98680832/616562950 [===&gt;..........................] - ETA: 51s
 99237888/616562950 [===&gt;..........................] - ETA: 50s
 99794944/616562950 [===&gt;..........................] - ETA: 50s
100352000/616562950 [===&gt;..........................] - ETA: 50s
100925440/616562950 [===&gt;..........................] - ETA: 50s
101515264/616562950 [===&gt;..........................] - ETA: 50s
102088704/616562950 [===&gt;..........................] - ETA: 50s
102678528/616562950 [===&gt;..........................] - ETA: 50s
103268352/616562950 [====&gt;.........................] - ETA: 50s
103858176/616562950 [====&gt;.........................] - ETA: 50s
104448000/616562950 [====&gt;.........................] - ETA: 50s
105037824/616562950 [====&gt;.........................] - ETA: 50s
105627648/616562950 [====&gt;.........................] - ETA: 49s
106217472/616562950 [====&gt;.........................] - ETA: 49s
106807296/616562950 [====&gt;.........................] - ETA: 49s
107397120/616562950 [====&gt;.........................] - ETA: 49s
107986944/616562950 [====&gt;.........................] - ETA: 49s
108576768/616562950 [====&gt;.........................] - ETA: 49s
109166592/616562950 [====&gt;.........................] - ETA: 49s
109756416/616562950 [====&gt;.........................] - ETA: 49s
110346240/616562950 [====&gt;.........................] - ETA: 49s
110936064/616562950 [====&gt;.........................] - ETA: 49s
111525888/616562950 [====&gt;.........................] - ETA: 49s
112115712/616562950 [====&gt;.........................] - ETA: 48s
112705536/616562950 [====&gt;.........................] - ETA: 48s
113311744/616562950 [====&gt;.........................] - ETA: 48s
113917952/616562950 [====&gt;.........................] - ETA: 48s
114524160/616562950 [====&gt;.........................] - ETA: 48s
115113984/616562950 [====&gt;.........................] - ETA: 48s
115703808/616562950 [====&gt;.........................] - ETA: 48s
116293632/616562950 [====&gt;.........................] - ETA: 48s
116883456/616562950 [====&gt;.........................] - ETA: 48s
117473280/616562950 [====&gt;.........................] - ETA: 48s
118063104/616562950 [====&gt;.........................] - ETA: 48s
118652928/616562950 [====&gt;.........................] - ETA: 48s
119259136/616562950 [====&gt;.........................] - ETA: 47s
119848960/616562950 [====&gt;.........................] - ETA: 47s
120438784/616562950 [====&gt;.........................] - ETA: 47s
121028608/616562950 [====&gt;.........................] - ETA: 47s
121487360/616562950 [====&gt;.........................] - ETA: 47s
122011648/616562950 [====&gt;.........................] - ETA: 47s
122585088/616562950 [====&gt;.........................] - ETA: 47s
122945536/616562950 [====&gt;.........................] - ETA: 47s
123289600/616562950 [====&gt;.........................] - ETA: 47s
123715584/616562950 [=====&gt;........................] - ETA: 47s
124133376/616562950 [=====&gt;........................] - ETA: 47s
124485632/616562950 [=====&gt;........................] - ETA: 47s
124895232/616562950 [=====&gt;........................] - ETA: 47s
125321216/616562950 [=====&gt;........................] - ETA: 47s
125714432/616562950 [=====&gt;........................] - ETA: 47s
126140416/616562950 [=====&gt;........................] - ETA: 47s
126566400/616562950 [=====&gt;........................] - ETA: 47s
126976000/616562950 [=====&gt;........................] - ETA: 47s
127418368/616562950 [=====&gt;........................] - ETA: 47s
127844352/616562950 [=====&gt;........................] - ETA: 47s
128270336/616562950 [=====&gt;........................] - ETA: 47s
128729088/616562950 [=====&gt;........................] - ETA: 47s
129171456/616562950 [=====&gt;........................] - ETA: 47s
129630208/616562950 [=====&gt;........................] - ETA: 47s
130105344/616562950 [=====&gt;........................] - ETA: 47s
130547712/616562950 [=====&gt;........................] - ETA: 47s
131022848/616562950 [=====&gt;........................] - ETA: 47s
131497984/616562950 [=====&gt;........................] - ETA: 47s
131956736/616562950 [=====&gt;........................] - ETA: 47s
132448256/616562950 [=====&gt;........................] - ETA: 47s
132923392/616562950 [=====&gt;........................] - ETA: 47s
133431296/616562950 [=====&gt;........................] - ETA: 47s
133922816/616562950 [=====&gt;........................] - ETA: 47s
134414336/616562950 [=====&gt;........................] - ETA: 47s
134938624/616562950 [=====&gt;........................] - ETA: 47s
135446528/616562950 [=====&gt;........................] - ETA: 47s
135954432/616562950 [=====&gt;........................] - ETA: 47s
136478720/616562950 [=====&gt;........................] - ETA: 47s
136986624/616562950 [=====&gt;........................] - ETA: 47s
137527296/616562950 [=====&gt;........................] - ETA: 47s
138051584/616562950 [=====&gt;........................] - ETA: 46s
138592256/616562950 [=====&gt;........................] - ETA: 46s
139116544/616562950 [=====&gt;........................] - ETA: 46s
139673600/616562950 [=====&gt;........................] - ETA: 46s
140214272/616562950 [=====&gt;........................] - ETA: 46s
140787712/616562950 [=====&gt;........................] - ETA: 46s
141344768/616562950 [=====&gt;........................] - ETA: 46s
141918208/616562950 [=====&gt;........................] - ETA: 46s
142475264/616562950 [=====&gt;........................] - ETA: 46s
143048704/616562950 [=====&gt;........................] - ETA: 46s
143622144/616562950 [=====&gt;........................] - ETA: 46s
144195584/616562950 [======&gt;.......................] - ETA: 46s
144785408/616562950 [======&gt;.......................] - ETA: 46s
145375232/616562950 [======&gt;.......................] - ETA: 46s
145965056/616562950 [======&gt;.......................] - ETA: 45s
146571264/616562950 [======&gt;.......................] - ETA: 45s
147161088/616562950 [======&gt;.......................] - ETA: 45s
147750912/616562950 [======&gt;.......................] - ETA: 45s
148340736/616562950 [======&gt;.......................] - ETA: 45s
148930560/616562950 [======&gt;.......................] - ETA: 45s
149520384/616562950 [======&gt;.......................] - ETA: 45s
150110208/616562950 [======&gt;.......................] - ETA: 45s
150700032/616562950 [======&gt;.......................] - ETA: 45s
151289856/616562950 [======&gt;.......................] - ETA: 45s
151896064/616562950 [======&gt;.......................] - ETA: 45s
152485888/616562950 [======&gt;.......................] - ETA: 45s
153075712/616562950 [======&gt;.......................] - ETA: 45s
153665536/616562950 [======&gt;.......................] - ETA: 44s
154255360/616562950 [======&gt;.......................] - ETA: 44s
154845184/616562950 [======&gt;.......................] - ETA: 44s
155435008/616562950 [======&gt;.......................] - ETA: 44s
156041216/616562950 [======&gt;.......................] - ETA: 44s
156631040/616562950 [======&gt;.......................] - ETA: 44s
157237248/616562950 [======&gt;.......................] - ETA: 44s
157827072/616562950 [======&gt;.......................] - ETA: 44s
158416896/616562950 [======&gt;.......................] - ETA: 44s
159006720/616562950 [======&gt;.......................] - ETA: 44s
159596544/616562950 [======&gt;.......................] - ETA: 44s
160186368/616562950 [======&gt;.......................] - ETA: 44s
160776192/616562950 [======&gt;.......................] - ETA: 44s
161366016/616562950 [======&gt;.......................] - ETA: 43s
161955840/616562950 [======&gt;.......................] - ETA: 43s
162562048/616562950 [======&gt;.......................] - ETA: 43s
163151872/616562950 [======&gt;.......................] - ETA: 43s
163741696/616562950 [======&gt;.......................] - ETA: 43s
164331520/616562950 [======&gt;.......................] - ETA: 43s
164921344/616562950 [=======&gt;......................] - ETA: 43s
165347328/616562950 [=======&gt;......................] - ETA: 43s
166150144/616562950 [=======&gt;......................] - ETA: 43s
166658048/616562950 [=======&gt;......................] - ETA: 43s
167182336/616562950 [=======&gt;......................] - ETA: 43s
167723008/616562950 [=======&gt;......................] - ETA: 43s
168247296/616562950 [=======&gt;......................] - ETA: 43s
168804352/616562950 [=======&gt;......................] - ETA: 43s
169361408/616562950 [=======&gt;......................] - ETA: 43s
169902080/616562950 [=======&gt;......................] - ETA: 42s
170459136/616562950 [=======&gt;......................] - ETA: 42s
171016192/616562950 [=======&gt;......................] - ETA: 42s
171606016/616562950 [=======&gt;......................] - ETA: 42s
172179456/616562950 [=======&gt;......................] - ETA: 42s
172769280/616562950 [=======&gt;......................] - ETA: 42s
173359104/616562950 [=======&gt;......................] - ETA: 42s
173948928/616562950 [=======&gt;......................] - ETA: 42s
174538752/616562950 [=======&gt;......................] - ETA: 42s
175128576/616562950 [=======&gt;......................] - ETA: 42s
175718400/616562950 [=======&gt;......................] - ETA: 42s
176308224/616562950 [=======&gt;......................] - ETA: 42s
176898048/616562950 [=======&gt;......................] - ETA: 42s
177487872/616562950 [=======&gt;......................] - ETA: 42s
178094080/616562950 [=======&gt;......................] - ETA: 41s
178700288/616562950 [=======&gt;......................] - ETA: 41s
179290112/616562950 [=======&gt;......................] - ETA: 41s
179879936/616562950 [=======&gt;......................] - ETA: 41s
180453376/616562950 [=======&gt;......................] - ETA: 41s
181026816/616562950 [=======&gt;......................] - ETA: 41s
181616640/616562950 [=======&gt;......................] - ETA: 41s
182190080/616562950 [=======&gt;......................] - ETA: 41s
182779904/616562950 [=======&gt;......................] - ETA: 41s
183369728/616562950 [=======&gt;......................] - ETA: 41s
183943168/616562950 [=======&gt;......................] - ETA: 41s
184532992/616562950 [=======&gt;......................] - ETA: 41s
185106432/616562950 [========&gt;.....................] - ETA: 41s
185696256/616562950 [========&gt;.....................] - ETA: 41s
186286080/616562950 [========&gt;.....................] - ETA: 41s
186875904/616562950 [========&gt;.....................] - ETA: 40s
187465728/616562950 [========&gt;.....................] - ETA: 40s
188055552/616562950 [========&gt;.....................] - ETA: 40s
188628992/616562950 [========&gt;.....................] - ETA: 40s
189218816/616562950 [========&gt;.....................] - ETA: 40s
189726720/616562950 [========&gt;.....................] - ETA: 40s
190496768/616562950 [========&gt;.....................] - ETA: 40s
190988288/616562950 [========&gt;.....................] - ETA: 40s
191496192/616562950 [========&gt;.....................] - ETA: 40s
192020480/616562950 [========&gt;.....................] - ETA: 40s
192544768/616562950 [========&gt;.....................] - ETA: 40s
193069056/616562950 [========&gt;.....................] - ETA: 40s
193593344/616562950 [========&gt;.....................] - ETA: 40s
194117632/616562950 [========&gt;.....................] - ETA: 40s
194658304/616562950 [========&gt;.....................] - ETA: 40s
195198976/616562950 [========&gt;.....................] - ETA: 40s
195723264/616562950 [========&gt;.....................] - ETA: 40s
196280320/616562950 [========&gt;.....................] - ETA: 40s
196820992/616562950 [========&gt;.....................] - ETA: 39s
197378048/616562950 [========&gt;.....................] - ETA: 39s
197935104/616562950 [========&gt;.....................] - ETA: 39s
198508544/616562950 [========&gt;.....................] - ETA: 39s
199081984/616562950 [========&gt;.....................] - ETA: 39s
199655424/616562950 [========&gt;.....................] - ETA: 39s
200245248/616562950 [========&gt;.....................] - ETA: 39s
200835072/616562950 [========&gt;.....................] - ETA: 39s
201424896/616562950 [========&gt;.....................] - ETA: 39s
202014720/616562950 [========&gt;.....................] - ETA: 39s
202604544/616562950 [========&gt;.....................] - ETA: 39s
203194368/616562950 [========&gt;.....................] - ETA: 39s
203784192/616562950 [========&gt;.....................] - ETA: 39s
204390400/616562950 [========&gt;.....................] - ETA: 39s
204980224/616562950 [========&gt;.....................] - ETA: 39s
205553664/616562950 [=========&gt;....................] - ETA: 39s
206143488/616562950 [=========&gt;....................] - ETA: 38s
206733312/616562950 [=========&gt;....................] - ETA: 38s
207323136/616562950 [=========&gt;....................] - ETA: 38s
207929344/616562950 [=========&gt;....................] - ETA: 38s
208535552/616562950 [=========&gt;....................] - ETA: 38s
209125376/616562950 [=========&gt;....................] - ETA: 38s
209715200/616562950 [=========&gt;....................] - ETA: 38s
210321408/616562950 [=========&gt;....................] - ETA: 38s
210911232/616562950 [=========&gt;....................] - ETA: 38s
211501056/616562950 [=========&gt;....................] - ETA: 38s
212090880/616562950 [=========&gt;....................] - ETA: 38s
212680704/616562950 [=========&gt;....................] - ETA: 38s
213270528/616562950 [=========&gt;....................] - ETA: 38s
213647360/616562950 [=========&gt;....................] - ETA: 38s
214319104/616562950 [=========&gt;....................] - ETA: 38s
214712320/616562950 [=========&gt;....................] - ETA: 38s
215056384/616562950 [=========&gt;....................] - ETA: 38s
215367680/616562950 [=========&gt;....................] - ETA: 38s
215662592/616562950 [=========&gt;....................] - ETA: 38s
215941120/616562950 [=========&gt;....................] - ETA: 38s
216203264/616562950 [=========&gt;....................] - ETA: 38s
216465408/616562950 [=========&gt;....................] - ETA: 38s
216743936/616562950 [=========&gt;....................] - ETA: 38s
217006080/616562950 [=========&gt;....................] - ETA: 38s
217300992/616562950 [=========&gt;....................] - ETA: 38s
217595904/616562950 [=========&gt;....................] - ETA: 38s
217874432/616562950 [=========&gt;....................] - ETA: 38s
218185728/616562950 [=========&gt;....................] - ETA: 38s
218497024/616562950 [=========&gt;....................] - ETA: 38s
218791936/616562950 [=========&gt;....................] - ETA: 38s
219119616/616562950 [=========&gt;....................] - ETA: 38s
219430912/616562950 [=========&gt;....................] - ETA: 38s
219725824/616562950 [=========&gt;....................] - ETA: 38s
220086272/616562950 [=========&gt;....................] - ETA: 38s
220413952/616562950 [=========&gt;....................] - ETA: 38s
220741632/616562950 [=========&gt;....................] - ETA: 38s
221110272/616562950 [=========&gt;....................] - ETA: 38s
221446144/616562950 [=========&gt;....................] - ETA: 38s
221790208/616562950 [=========&gt;....................] - ETA: 38s
222183424/616562950 [=========&gt;....................] - ETA: 38s
222543872/616562950 [=========&gt;....................] - ETA: 38s
222904320/616562950 [=========&gt;....................] - ETA: 38s
223313920/616562950 [=========&gt;....................] - ETA: 38s
223707136/616562950 [=========&gt;....................] - ETA: 38s
224067584/616562950 [=========&gt;....................] - ETA: 38s
224460800/616562950 [=========&gt;....................] - ETA: 38s
224854016/616562950 [=========&gt;....................] - ETA: 38s
225247232/616562950 [=========&gt;....................] - ETA: 38s
225673216/616562950 [=========&gt;....................] - ETA: 38s
226082816/616562950 [==========&gt;...................] - ETA: 38s
226492416/616562950 [==========&gt;...................] - ETA: 38s
226918400/616562950 [==========&gt;...................] - ETA: 38s
227344384/616562950 [==========&gt;...................] - ETA: 38s
227770368/616562950 [==========&gt;...................] - ETA: 38s
228212736/616562950 [==========&gt;...................] - ETA: 38s
228655104/616562950 [==========&gt;...................] - ETA: 37s
229097472/616562950 [==========&gt;...................] - ETA: 37s
229539840/616562950 [==========&gt;...................] - ETA: 37s
229998592/616562950 [==========&gt;...................] - ETA: 37s
230457344/616562950 [==========&gt;...................] - ETA: 37s
230916096/616562950 [==========&gt;...................] - ETA: 37s
231391232/616562950 [==========&gt;...................] - ETA: 37s
231866368/616562950 [==========&gt;...................] - ETA: 37s
232341504/616562950 [==========&gt;...................] - ETA: 37s
232800256/616562950 [==========&gt;...................] - ETA: 37s
233308160/616562950 [==========&gt;...................] - ETA: 37s
233783296/616562950 [==========&gt;...................] - ETA: 37s
234274816/616562950 [==========&gt;...................] - ETA: 37s
234782720/616562950 [==========&gt;...................] - ETA: 37s
235290624/616562950 [==========&gt;...................] - ETA: 37s
235798528/616562950 [==========&gt;...................] - ETA: 37s
236322816/616562950 [==========&gt;...................] - ETA: 37s
236847104/616562950 [==========&gt;...................] - ETA: 37s
237387776/616562950 [==========&gt;...................] - ETA: 37s
237928448/616562950 [==========&gt;...................] - ETA: 37s
238469120/616562950 [==========&gt;...................] - ETA: 37s
239009792/616562950 [==========&gt;...................] - ETA: 37s
239566848/616562950 [==========&gt;...................] - ETA: 37s
240123904/616562950 [==========&gt;...................] - ETA: 36s
240680960/616562950 [==========&gt;...................] - ETA: 36s
241238016/616562950 [==========&gt;...................] - ETA: 36s
241811456/616562950 [==========&gt;...................] - ETA: 36s
242368512/616562950 [==========&gt;...................] - ETA: 36s
242941952/616562950 [==========&gt;...................] - ETA: 36s
243531776/616562950 [==========&gt;...................] - ETA: 36s
244105216/616562950 [==========&gt;...................] - ETA: 36s
244678656/616562950 [==========&gt;...................] - ETA: 36s
245268480/616562950 [==========&gt;...................] - ETA: 36s
245858304/616562950 [==========&gt;...................] - ETA: 36s
246448128/616562950 [==========&gt;...................] - ETA: 36s
247054336/616562950 [===========&gt;..................] - ETA: 36s
247644160/616562950 [===========&gt;..................] - ETA: 36s
248233984/616562950 [===========&gt;..................] - ETA: 36s
248823808/616562950 [===========&gt;..................] - ETA: 35s
249430016/616562950 [===========&gt;..................] - ETA: 35s
250019840/616562950 [===========&gt;..................] - ETA: 35s
250609664/616562950 [===========&gt;..................] - ETA: 35s
251215872/616562950 [===========&gt;..................] - ETA: 35s
251805696/616562950 [===========&gt;..................] - ETA: 35s
252411904/616562950 [===========&gt;..................] - ETA: 35s
253001728/616562950 [===========&gt;..................] - ETA: 35s
253591552/616562950 [===========&gt;..................] - ETA: 35s
254181376/616562950 [===========&gt;..................] - ETA: 35s
254771200/616562950 [===========&gt;..................] - ETA: 35s
255361024/616562950 [===========&gt;..................] - ETA: 35s
255950848/616562950 [===========&gt;..................] - ETA: 35s
256557056/616562950 [===========&gt;..................] - ETA: 35s
257146880/616562950 [===========&gt;..................] - ETA: 34s
257736704/616562950 [===========&gt;..................] - ETA: 34s
258326528/616562950 [===========&gt;..................] - ETA: 34s
258924544/616562950 [===========&gt;..................] - ETA: 34s
259506176/616562950 [===========&gt;..................] - ETA: 34s
260096000/616562950 [===========&gt;..................] - ETA: 34s
260702208/616562950 [===========&gt;..................] - ETA: 34s
261292032/616562950 [===========&gt;..................] - ETA: 34s
261881856/616562950 [===========&gt;..................] - ETA: 34s
262471680/616562950 [===========&gt;..................] - ETA: 34s
263077888/616562950 [===========&gt;..................] - ETA: 34s
263667712/616562950 [===========&gt;..................] - ETA: 34s
264257536/616562950 [===========&gt;..................] - ETA: 34s
264749056/616562950 [===========&gt;..................] - ETA: 34s
265273344/616562950 [===========&gt;..................] - ETA: 34s
265764864/616562950 [===========&gt;..................] - ETA: 34s
266289152/616562950 [===========&gt;..................] - ETA: 33s
266813440/616562950 [===========&gt;..................] - ETA: 33s
267354112/616562950 [============&gt;.................] - ETA: 33s
267911168/616562950 [============&gt;.................] - ETA: 33s
268435456/616562950 [============&gt;.................] - ETA: 33s
268992512/616562950 [============&gt;.................] - ETA: 33s
269565952/616562950 [============&gt;.................] - ETA: 33s
270123008/616562950 [============&gt;.................] - ETA: 33s
270696448/616562950 [============&gt;.................] - ETA: 33s
271269888/616562950 [============&gt;.................] - ETA: 33s
271859712/616562950 [============&gt;.................] - ETA: 33s
272433152/616562950 [============&gt;.................] - ETA: 33s
273006592/616562950 [============&gt;.................] - ETA: 33s
273596416/616562950 [============&gt;.................] - ETA: 33s
274186240/616562950 [============&gt;.................] - ETA: 33s
274759680/616562950 [============&gt;.................] - ETA: 33s
275365888/616562950 [============&gt;.................] - ETA: 33s
275955712/616562950 [============&gt;.................] - ETA: 32s
276545536/616562950 [============&gt;.................] - ETA: 32s
277135360/616562950 [============&gt;.................] - ETA: 32s
277659648/616562950 [============&gt;.................] - ETA: 32s
278331392/616562950 [============&gt;.................] - ETA: 32s
278921216/616562950 [============&gt;.................] - ETA: 32s
279511040/616562950 [============&gt;.................] - ETA: 32s
280100864/616562950 [============&gt;.................] - ETA: 32s
280690688/616562950 [============&gt;.................] - ETA: 32s
281264128/616562950 [============&gt;.................] - ETA: 32s
281821184/616562950 [============&gt;.................] - ETA: 32s
282378240/616562950 [============&gt;.................] - ETA: 32s
282918912/616562950 [============&gt;.................] - ETA: 32s
283475968/616562950 [============&gt;.................] - ETA: 32s
284033024/616562950 [============&gt;.................] - ETA: 32s
284475392/616562950 [============&gt;.................] - ETA: 32s
285245440/616562950 [============&gt;.................] - ETA: 31s
285704192/616562950 [============&gt;.................] - ETA: 31s
286195712/616562950 [============&gt;.................] - ETA: 31s
286670848/616562950 [============&gt;.................] - ETA: 31s
287162368/616562950 [============&gt;.................] - ETA: 31s
287637504/616562950 [============&gt;.................] - ETA: 31s
288145408/616562950 [=============&gt;................] - ETA: 31s
288653312/616562950 [=============&gt;................] - ETA: 31s
289177600/616562950 [=============&gt;................] - ETA: 31s
289701888/616562950 [=============&gt;................] - ETA: 31s
290226176/616562950 [=============&gt;................] - ETA: 31s
290750464/616562950 [=============&gt;................] - ETA: 31s
291291136/616562950 [=============&gt;................] - ETA: 31s
291831808/616562950 [=============&gt;................] - ETA: 31s
292372480/616562950 [=============&gt;................] - ETA: 31s
292913152/616562950 [=============&gt;................] - ETA: 31s
293470208/616562950 [=============&gt;................] - ETA: 31s
294027264/616562950 [=============&gt;................] - ETA: 31s
294584320/616562950 [=============&gt;................] - ETA: 31s
295141376/616562950 [=============&gt;................] - ETA: 31s
295698432/616562950 [=============&gt;................] - ETA: 30s
296271872/616562950 [=============&gt;................] - ETA: 30s
296845312/616562950 [=============&gt;................] - ETA: 30s
297435136/616562950 [=============&gt;................] - ETA: 30s
298024960/616562950 [=============&gt;................] - ETA: 30s
298614784/616562950 [=============&gt;................] - ETA: 30s
299204608/616562950 [=============&gt;................] - ETA: 30s
299794432/616562950 [=============&gt;................] - ETA: 30s
300384256/616562950 [=============&gt;................] - ETA: 30s
300974080/616562950 [=============&gt;................] - ETA: 30s
301563904/616562950 [=============&gt;................] - ETA: 30s
302153728/616562950 [=============&gt;................] - ETA: 30s
302727168/616562950 [=============&gt;................] - ETA: 30s
303316992/616562950 [=============&gt;................] - ETA: 30s
303906816/616562950 [=============&gt;................] - ETA: 30s
304480256/616562950 [=============&gt;................] - ETA: 30s
305070080/616562950 [=============&gt;................] - ETA: 29s
305659904/616562950 [=============&gt;................] - ETA: 29s
306249728/616562950 [=============&gt;................] - ETA: 29s
306839552/616562950 [=============&gt;................] - ETA: 29s
307429376/616562950 [=============&gt;................] - ETA: 29s
308019200/616562950 [=============&gt;................] - ETA: 29s
308609024/616562950 [==============&gt;...............] - ETA: 29s
309198848/616562950 [==============&gt;...............] - ETA: 29s
309788672/616562950 [==============&gt;...............] - ETA: 29s
310378496/616562950 [==============&gt;...............] - ETA: 29s
310984704/616562950 [==============&gt;...............] - ETA: 29s
311590912/616562950 [==============&gt;...............] - ETA: 29s
312180736/616562950 [==============&gt;...............] - ETA: 29s
312786944/616562950 [==============&gt;...............] - ETA: 29s
313393152/616562950 [==============&gt;...............] - ETA: 29s
313982976/616562950 [==============&gt;...............] - ETA: 29s
314572800/616562950 [==============&gt;...............] - ETA: 28s
315162624/616562950 [==============&gt;...............] - ETA: 28s
315768832/616562950 [==============&gt;...............] - ETA: 28s
316358656/616562950 [==============&gt;...............] - ETA: 28s
316948480/616562950 [==============&gt;...............] - ETA: 28s
317440000/616562950 [==============&gt;...............] - ETA: 28s
317849600/616562950 [==============&gt;...............] - ETA: 28s
318226432/616562950 [==============&gt;...............] - ETA: 28s
318603264/616562950 [==============&gt;...............] - ETA: 28s
318980096/616562950 [==============&gt;...............] - ETA: 28s
319373312/616562950 [==============&gt;...............] - ETA: 28s
319766528/616562950 [==============&gt;...............] - ETA: 28s
320159744/616562950 [==============&gt;...............] - ETA: 28s
320569344/616562950 [==============&gt;...............] - ETA: 28s
320978944/616562950 [==============&gt;...............] - ETA: 28s
321372160/616562950 [==============&gt;...............] - ETA: 28s
321798144/616562950 [==============&gt;...............] - ETA: 28s
322224128/616562950 [==============&gt;...............] - ETA: 28s
322633728/616562950 [==============&gt;...............] - ETA: 28s
323076096/616562950 [==============&gt;...............] - ETA: 28s
323502080/616562950 [==============&gt;...............] - ETA: 28s
323944448/616562950 [==============&gt;...............] - ETA: 28s
324386816/616562950 [==============&gt;...............] - ETA: 28s
324812800/616562950 [==============&gt;...............] - ETA: 28s
325271552/616562950 [==============&gt;...............] - ETA: 28s
325730304/616562950 [==============&gt;...............] - ETA: 28s
326189056/616562950 [==============&gt;...............] - ETA: 28s
326647808/616562950 [==============&gt;...............] - ETA: 28s
327122944/616562950 [==============&gt;...............] - ETA: 27s
327614464/616562950 [==============&gt;...............] - ETA: 27s
328089600/616562950 [==============&gt;...............] - ETA: 27s
328581120/616562950 [==============&gt;...............] - ETA: 27s
329072640/616562950 [===============&gt;..............] - ETA: 27s
329564160/616562950 [===============&gt;..............] - ETA: 27s
330055680/616562950 [===============&gt;..............] - ETA: 27s
330563584/616562950 [===============&gt;..............] - ETA: 27s
331071488/616562950 [===============&gt;..............] - ETA: 27s
331563008/616562950 [===============&gt;..............] - ETA: 27s
332087296/616562950 [===============&gt;..............] - ETA: 27s
332611584/616562950 [===============&gt;..............] - ETA: 27s
333135872/616562950 [===============&gt;..............] - ETA: 27s
333676544/616562950 [===============&gt;..............] - ETA: 27s
334217216/616562950 [===============&gt;..............] - ETA: 27s
334757888/616562950 [===============&gt;..............] - ETA: 27s
335298560/616562950 [===============&gt;..............] - ETA: 27s
335839232/616562950 [===============&gt;..............] - ETA: 27s
336396288/616562950 [===============&gt;..............] - ETA: 27s
336936960/616562950 [===============&gt;..............] - ETA: 27s
337485824/616562950 [===============&gt;..............] - ETA: 26s
338034688/616562950 [===============&gt;..............] - ETA: 26s
338608128/616562950 [===============&gt;..............] - ETA: 26s
339181568/616562950 [===============&gt;..............] - ETA: 26s
339755008/616562950 [===============&gt;..............] - ETA: 26s
340336640/616562950 [===============&gt;..............] - ETA: 26s
340910080/616562950 [===============&gt;..............] - ETA: 26s
341491712/616562950 [===============&gt;..............] - ETA: 26s
342081536/616562950 [===============&gt;..............] - ETA: 26s
342671360/616562950 [===============&gt;..............] - ETA: 26s
343261184/616562950 [===============&gt;..............] - ETA: 26s
343851008/616562950 [===============&gt;..............] - ETA: 26s
344440832/616562950 [===============&gt;..............] - ETA: 26s
345030656/616562950 [===============&gt;..............] - ETA: 26s
345620480/616562950 [===============&gt;..............] - ETA: 26s
346210304/616562950 [===============&gt;..............] - ETA: 26s
346816512/616562950 [===============&gt;..............] - ETA: 25s
347406336/616562950 [===============&gt;..............] - ETA: 25s
347996160/616562950 [===============&gt;..............] - ETA: 25s
348585984/616562950 [===============&gt;..............] - ETA: 25s
349175808/616562950 [===============&gt;..............] - ETA: 25s
349765632/616562950 [================&gt;.............] - ETA: 25s
350355456/616562950 [================&gt;.............] - ETA: 25s
350961664/616562950 [================&gt;.............] - ETA: 25s
351551488/616562950 [================&gt;.............] - ETA: 25s
352141312/616562950 [================&gt;.............] - ETA: 25s
352731136/616562950 [================&gt;.............] - ETA: 25s
353320960/616562950 [================&gt;.............] - ETA: 25s
353927168/616562950 [================&gt;.............] - ETA: 25s
354516992/616562950 [================&gt;.............] - ETA: 25s
355123200/616562950 [================&gt;.............] - ETA: 25s
355713024/616562950 [================&gt;.............] - ETA: 25s
356302848/616562950 [================&gt;.............] - ETA: 25s
356892672/616562950 [================&gt;.............] - ETA: 24s
357482496/616562950 [================&gt;.............] - ETA: 24s
358080512/616562950 [================&gt;.............] - ETA: 24s
358662144/616562950 [================&gt;.............] - ETA: 24s
359038976/616562950 [================&gt;.............] - ETA: 24s
359563264/616562950 [================&gt;.............] - ETA: 24s
360136704/616562950 [================&gt;.............] - ETA: 24s
360513536/616562950 [================&gt;.............] - ETA: 24s
360824832/616562950 [================&gt;.............] - ETA: 24s
361168896/616562950 [================&gt;.............] - ETA: 24s
361562112/616562950 [================&gt;.............] - ETA: 24s
361922560/616562950 [================&gt;.............] - ETA: 24s
362332160/616562950 [================&gt;.............] - ETA: 24s
362725376/616562950 [================&gt;.............] - ETA: 24s
363134976/616562950 [================&gt;.............] - ETA: 24s
363544576/616562950 [================&gt;.............] - ETA: 24s
363937792/616562950 [================&gt;.............] - ETA: 24s
364380160/616562950 [================&gt;.............] - ETA: 24s
364789760/616562950 [================&gt;.............] - ETA: 24s
365232128/616562950 [================&gt;.............] - ETA: 24s
365674496/616562950 [================&gt;.............] - ETA: 24s
366100480/616562950 [================&gt;.............] - ETA: 24s
366559232/616562950 [================&gt;.............] - ETA: 24s
367001600/616562950 [================&gt;.............] - ETA: 24s
367443968/616562950 [================&gt;.............] - ETA: 24s
367919104/616562950 [================&gt;.............] - ETA: 24s
368377856/616562950 [================&gt;.............] - ETA: 24s
368869376/616562950 [================&gt;.............] - ETA: 23s
369344512/616562950 [================&gt;.............] - ETA: 23s
369836032/616562950 [================&gt;.............] - ETA: 23s
370327552/616562950 [=================&gt;............] - ETA: 23s
370819072/616562950 [=================&gt;............] - ETA: 23s
371310592/616562950 [=================&gt;............] - ETA: 23s
371802112/616562950 [=================&gt;............] - ETA: 23s
372310016/616562950 [=================&gt;............] - ETA: 23s
372817920/616562950 [=================&gt;............] - ETA: 23s
373342208/616562950 [=================&gt;............] - ETA: 23s
373850112/616562950 [=================&gt;............] - ETA: 23s
374374400/616562950 [=================&gt;............] - ETA: 23s
374898688/616562950 [=================&gt;............] - ETA: 23s
375422976/616562950 [=================&gt;............] - ETA: 23s
375963648/616562950 [=================&gt;............] - ETA: 23s
376504320/616562950 [=================&gt;............] - ETA: 23s
377061376/616562950 [=================&gt;............] - ETA: 23s
377618432/616562950 [=================&gt;............] - ETA: 23s
378159104/616562950 [=================&gt;............] - ETA: 23s
378732544/616562950 [=================&gt;............] - ETA: 23s
379289600/616562950 [=================&gt;............] - ETA: 22s
379854848/616562950 [=================&gt;............] - ETA: 22s
380420096/616562950 [=================&gt;............] - ETA: 22s
380993536/616562950 [=================&gt;............] - ETA: 22s
381566976/616562950 [=================&gt;............] - ETA: 22s
382156800/616562950 [=================&gt;............] - ETA: 22s
382746624/616562950 [=================&gt;............] - ETA: 22s
383336448/616562950 [=================&gt;............] - ETA: 22s
383926272/616562950 [=================&gt;............] - ETA: 22s
384516096/616562950 [=================&gt;............] - ETA: 22s
385073152/616562950 [=================&gt;............] - ETA: 22s
385630208/616562950 [=================&gt;............] - ETA: 22s
386187264/616562950 [=================&gt;............] - ETA: 22s
386744320/616562950 [=================&gt;............] - ETA: 22s
387284992/616562950 [=================&gt;............] - ETA: 22s
387842048/616562950 [=================&gt;............] - ETA: 22s
388382720/616562950 [=================&gt;............] - ETA: 22s
388939776/616562950 [=================&gt;............] - ETA: 21s
389496832/616562950 [=================&gt;............] - ETA: 21s
390053888/616562950 [=================&gt;............] - ETA: 21s
390610944/616562950 [==================&gt;...........] - ETA: 21s
391151616/616562950 [==================&gt;...........] - ETA: 21s
391741440/616562950 [==================&gt;...........] - ETA: 21s
392347648/616562950 [==================&gt;...........] - ETA: 21s
392953856/616562950 [==================&gt;...........] - ETA: 21s
393543680/616562950 [==================&gt;...........] - ETA: 21s
394133504/616562950 [==================&gt;...........] - ETA: 21s
394723328/616562950 [==================&gt;...........] - ETA: 21s
395313152/616562950 [==================&gt;...........] - ETA: 21s
395902976/616562950 [==================&gt;...........] - ETA: 21s
396509184/616562950 [==================&gt;...........] - ETA: 21s
397099008/616562950 [==================&gt;...........] - ETA: 21s
397688832/616562950 [==================&gt;...........] - ETA: 21s
398278656/616562950 [==================&gt;...........] - ETA: 21s
398868480/616562950 [==================&gt;...........] - ETA: 20s
399458304/616562950 [==================&gt;...........] - ETA: 20s
400048128/616562950 [==================&gt;...........] - ETA: 20s
400637952/616562950 [==================&gt;...........] - ETA: 20s
401227776/616562950 [==================&gt;...........] - ETA: 20s
401817600/616562950 [==================&gt;...........] - ETA: 20s
402391040/616562950 [==================&gt;...........] - ETA: 20s
402866176/616562950 [==================&gt;...........] - ETA: 20s
403390464/616562950 [==================&gt;...........] - ETA: 20s
403931136/616562950 [==================&gt;...........] - ETA: 20s
404471808/616562950 [==================&gt;...........] - ETA: 20s
405012480/616562950 [==================&gt;...........] - ETA: 20s
405569536/616562950 [==================&gt;...........] - ETA: 20s
406126592/616562950 [==================&gt;...........] - ETA: 20s
406683648/616562950 [==================&gt;...........] - ETA: 20s
407240704/616562950 [==================&gt;...........] - ETA: 20s
407814144/616562950 [==================&gt;...........] - ETA: 20s
408387584/616562950 [==================&gt;...........] - ETA: 20s
408977408/616562950 [==================&gt;...........] - ETA: 19s
409550848/616562950 [==================&gt;...........] - ETA: 19s
410140672/616562950 [==================&gt;...........] - ETA: 19s
410730496/616562950 [==================&gt;...........] - ETA: 19s
411303936/616562950 [===================&gt;..........] - ETA: 19s
411893760/616562950 [===================&gt;..........] - ETA: 19s
412499968/616562950 [===================&gt;..........] - ETA: 19s
413089792/616562950 [===================&gt;..........] - ETA: 19s
413679616/616562950 [===================&gt;..........] - ETA: 19s
414285824/616562950 [===================&gt;..........] - ETA: 19s
414875648/616562950 [===================&gt;..........] - ETA: 19s
415465472/616562950 [===================&gt;..........] - ETA: 19s
416055296/616562950 [===================&gt;..........] - ETA: 19s
416645120/616562950 [===================&gt;..........] - ETA: 19s
417234944/616562950 [===================&gt;..........] - ETA: 19s
417824768/616562950 [===================&gt;..........] - ETA: 19s
418414592/616562950 [===================&gt;..........] - ETA: 19s
419004416/616562950 [===================&gt;..........] - ETA: 18s
419594240/616562950 [===================&gt;..........] - ETA: 18s
420184064/616562950 [===================&gt;..........] - ETA: 18s
420773888/616562950 [===================&gt;..........] - ETA: 18s
421363712/616562950 [===================&gt;..........] - ETA: 18s
421953536/616562950 [===================&gt;..........] - ETA: 18s
422543360/616562950 [===================&gt;..........] - ETA: 18s
423149568/616562950 [===================&gt;..........] - ETA: 18s
423739392/616562950 [===================&gt;..........] - ETA: 18s
424329216/616562950 [===================&gt;..........] - ETA: 18s
424919040/616562950 [===================&gt;..........] - ETA: 18s
425525248/616562950 [===================&gt;..........] - ETA: 18s
426115072/616562950 [===================&gt;..........] - ETA: 18s
426704896/616562950 [===================&gt;..........] - ETA: 18s
427294720/616562950 [===================&gt;..........] - ETA: 18s
427884544/616562950 [===================&gt;..........] - ETA: 18s
428474368/616562950 [===================&gt;..........] - ETA: 17s
429064192/616562950 [===================&gt;..........] - ETA: 17s
429654016/616562950 [===================&gt;..........] - ETA: 17s
430243840/616562950 [===================&gt;..........] - ETA: 17s
430620672/616562950 [===================&gt;..........] - ETA: 17s
431407104/616562950 [===================&gt;..........] - ETA: 17s
431915008/616562950 [====================&gt;.........] - ETA: 17s
432455680/616562950 [====================&gt;.........] - ETA: 17s
432979968/616562950 [====================&gt;.........] - ETA: 17s
433520640/616562950 [====================&gt;.........] - ETA: 17s
434061312/616562950 [====================&gt;.........] - ETA: 17s
434601984/616562950 [====================&gt;.........] - ETA: 17s
435159040/616562950 [====================&gt;.........] - ETA: 17s
435699712/616562950 [====================&gt;.........] - ETA: 17s
436256768/616562950 [====================&gt;.........] - ETA: 17s
436813824/616562950 [====================&gt;.........] - ETA: 17s
437387264/616562950 [====================&gt;.........] - ETA: 17s
437944320/616562950 [====================&gt;.........] - ETA: 17s
438517760/616562950 [====================&gt;.........] - ETA: 17s
439091200/616562950 [====================&gt;.........] - ETA: 16s
439664640/616562950 [====================&gt;.........] - ETA: 16s
440254464/616562950 [====================&gt;.........] - ETA: 16s
440844288/616562950 [====================&gt;.........] - ETA: 16s
441434112/616562950 [====================&gt;.........] - ETA: 16s
442023936/616562950 [====================&gt;.........] - ETA: 16s
442613760/616562950 [====================&gt;.........] - ETA: 16s
443203584/616562950 [====================&gt;.........] - ETA: 16s
443793408/616562950 [====================&gt;.........] - ETA: 16s
444383232/616562950 [====================&gt;.........] - ETA: 16s
444973056/616562950 [====================&gt;.........] - ETA: 16s
445562880/616562950 [====================&gt;.........] - ETA: 16s
446169088/616562950 [====================&gt;.........] - ETA: 16s
446758912/616562950 [====================&gt;.........] - ETA: 16s
447348736/616562950 [====================&gt;.........] - ETA: 16s
447938560/616562950 [====================&gt;.........] - ETA: 16s
448528384/616562950 [====================&gt;.........] - ETA: 16s
449118208/616562950 [====================&gt;.........] - ETA: 15s
449724416/616562950 [====================&gt;.........] - ETA: 15s
450314240/616562950 [====================&gt;.........] - ETA: 15s
450904064/616562950 [====================&gt;.........] - ETA: 15s
451510272/616562950 [====================&gt;.........] - ETA: 15s
452100096/616562950 [====================&gt;.........] - ETA: 15s
452706304/616562950 [=====================&gt;........] - ETA: 15s
453296128/616562950 [=====================&gt;........] - ETA: 15s
453885952/616562950 [=====================&gt;........] - ETA: 15s
454475776/616562950 [=====================&gt;........] - ETA: 15s
455081984/616562950 [=====================&gt;........] - ETA: 15s
455671808/616562950 [=====================&gt;........] - ETA: 15s
456261632/616562950 [=====================&gt;........] - ETA: 15s
456851456/616562950 [=====================&gt;........] - ETA: 15s
457457664/616562950 [=====================&gt;........] - ETA: 15s
458047488/616562950 [=====================&gt;........] - ETA: 15s
458637312/616562950 [=====================&gt;........] - ETA: 15s
459227136/616562950 [=====================&gt;........] - ETA: 14s
459816960/616562950 [=====================&gt;........] - ETA: 14s
460095488/616562950 [=====================&gt;........] - ETA: 14s
460570624/616562950 [=====================&gt;........] - ETA: 14s
461160448/616562950 [=====================&gt;........] - ETA: 14s
461520896/616562950 [=====================&gt;........] - ETA: 14s
461930496/616562950 [=====================&gt;........] - ETA: 14s
462323712/616562950 [=====================&gt;........] - ETA: 14s
462692352/616562950 [=====================&gt;........] - ETA: 14s
463110144/616562950 [=====================&gt;........] - ETA: 14s
463486976/616562950 [=====================&gt;........] - ETA: 14s
463863808/616562950 [=====================&gt;........] - ETA: 14s
464273408/616562950 [=====================&gt;........] - ETA: 14s
464715776/616562950 [=====================&gt;........] - ETA: 14s
465108992/616562950 [=====================&gt;........] - ETA: 14s
465534976/616562950 [=====================&gt;........] - ETA: 14s
465977344/616562950 [=====================&gt;........] - ETA: 14s
466386944/616562950 [=====================&gt;........] - ETA: 14s
466845696/616562950 [=====================&gt;........] - ETA: 14s
467288064/616562950 [=====================&gt;........] - ETA: 14s
467730432/616562950 [=====================&gt;........] - ETA: 14s
468205568/616562950 [=====================&gt;........] - ETA: 14s
468647936/616562950 [=====================&gt;........] - ETA: 14s
469106688/616562950 [=====================&gt;........] - ETA: 14s
469581824/616562950 [=====================&gt;........] - ETA: 14s
470040576/616562950 [=====================&gt;........] - ETA: 14s
470532096/616562950 [=====================&gt;........] - ETA: 13s
471007232/616562950 [=====================&gt;........] - ETA: 13s
471498752/616562950 [=====================&gt;........] - ETA: 13s
471990272/616562950 [=====================&gt;........] - ETA: 13s
472481792/616562950 [=====================&gt;........] - ETA: 13s
472989696/616562950 [======================&gt;.......] - ETA: 13s
473497600/616562950 [======================&gt;.......] - ETA: 13s
474005504/616562950 [======================&gt;.......] - ETA: 13s
474529792/616562950 [======================&gt;.......] - ETA: 13s
475037696/616562950 [======================&gt;.......] - ETA: 13s
475578368/616562950 [======================&gt;.......] - ETA: 13s
476102656/616562950 [======================&gt;.......] - ETA: 13s
476626944/616562950 [======================&gt;.......] - ETA: 13s
477167616/616562950 [======================&gt;.......] - ETA: 13s
477708288/616562950 [======================&gt;.......] - ETA: 13s
478248960/616562950 [======================&gt;.......] - ETA: 13s
478806016/616562950 [======================&gt;.......] - ETA: 13s
479363072/616562950 [======================&gt;.......] - ETA: 13s
479920128/616562950 [======================&gt;.......] - ETA: 13s
480493568/616562950 [======================&gt;.......] - ETA: 13s
481067008/616562950 [======================&gt;.......] - ETA: 12s
481640448/616562950 [======================&gt;.......] - ETA: 12s
482230272/616562950 [======================&gt;.......] - ETA: 12s
482820096/616562950 [======================&gt;.......] - ETA: 12s
483409920/616562950 [======================&gt;.......] - ETA: 12s
483999744/616562950 [======================&gt;.......] - ETA: 12s
484605952/616562950 [======================&gt;.......] - ETA: 12s
485195776/616562950 [======================&gt;.......] - ETA: 12s
485785600/616562950 [======================&gt;.......] - ETA: 12s
486375424/616562950 [======================&gt;.......] - ETA: 12s
486965248/616562950 [======================&gt;.......] - ETA: 12s
487555072/616562950 [======================&gt;.......] - ETA: 12s
488144896/616562950 [======================&gt;.......] - ETA: 12s
488734720/616562950 [======================&gt;.......] - ETA: 12s
489324544/616562950 [======================&gt;.......] - ETA: 12s
489914368/616562950 [======================&gt;.......] - ETA: 12s
490520576/616562950 [======================&gt;.......] - ETA: 12s
491110400/616562950 [======================&gt;.......] - ETA: 11s
491700224/616562950 [======================&gt;.......] - ETA: 11s
492290048/616562950 [======================&gt;.......] - ETA: 11s
492896256/616562950 [======================&gt;.......] - ETA: 11s
493486080/616562950 [=======================&gt;......] - ETA: 11s
494075904/616562950 [=======================&gt;......] - ETA: 11s
494632960/616562950 [=======================&gt;......] - ETA: 11s
495190016/616562950 [=======================&gt;......] - ETA: 11s
495583232/616562950 [=======================&gt;......] - ETA: 11s
496320512/616562950 [=======================&gt;......] - ETA: 11s
496812032/616562950 [=======================&gt;......] - ETA: 11s
497303552/616562950 [=======================&gt;......] - ETA: 11s
497811456/616562950 [=======================&gt;......] - ETA: 11s
498319360/616562950 [=======================&gt;......] - ETA: 11s
498843648/616562950 [=======================&gt;......] - ETA: 11s
499351552/616562950 [=======================&gt;......] - ETA: 11s
499859456/616562950 [=======================&gt;......] - ETA: 11s
500367360/616562950 [=======================&gt;......] - ETA: 11s
500908032/616562950 [=======================&gt;......] - ETA: 11s
501432320/616562950 [=======================&gt;......] - ETA: 10s
501972992/616562950 [=======================&gt;......] - ETA: 10s
502513664/616562950 [=======================&gt;......] - ETA: 10s
503054336/616562950 [=======================&gt;......] - ETA: 10s
503611392/616562950 [=======================&gt;......] - ETA: 10s
504168448/616562950 [=======================&gt;......] - ETA: 10s
504741888/616562950 [=======================&gt;......] - ETA: 10s
505315328/616562950 [=======================&gt;......] - ETA: 10s
505888768/616562950 [=======================&gt;......] - ETA: 10s
506445824/616562950 [=======================&gt;......] - ETA: 10s
507019264/616562950 [=======================&gt;......] - ETA: 10s
507592704/616562950 [=======================&gt;......] - ETA: 10s
508166144/616562950 [=======================&gt;......] - ETA: 10s
508739584/616562950 [=======================&gt;......] - ETA: 10s
509313024/616562950 [=======================&gt;......] - ETA: 10s
509902848/616562950 [=======================&gt;......] - ETA: 10s
510492672/616562950 [=======================&gt;......] - ETA: 10s
511082496/616562950 [=======================&gt;......] - ETA: 10s
511688704/616562950 [=======================&gt;......] - ETA: 9s 
512278528/616562950 [=======================&gt;......] - ETA: 9s
512884736/616562950 [=======================&gt;......] - ETA: 9s
513474560/616562950 [=======================&gt;......] - ETA: 9s
514064384/616562950 [========================&gt;.....] - ETA: 9s
514670592/616562950 [========================&gt;.....] - ETA: 9s
515260416/616562950 [========================&gt;.....] - ETA: 9s
515850240/616562950 [========================&gt;.....] - ETA: 9s
516440064/616562950 [========================&gt;.....] - ETA: 9s
517029888/616562950 [========================&gt;.....] - ETA: 9s
517636096/616562950 [========================&gt;.....] - ETA: 9s
518225920/616562950 [========================&gt;.....] - ETA: 9s
518815744/616562950 [========================&gt;.....] - ETA: 9s
519405568/616562950 [========================&gt;.....] - ETA: 9s
520011776/616562950 [========================&gt;.....] - ETA: 9s
520585216/616562950 [========================&gt;.....] - ETA: 9s
521175040/616562950 [========================&gt;.....] - ETA: 9s
521764864/616562950 [========================&gt;.....] - ETA: 9s
522371072/616562950 [========================&gt;.....] - ETA: 8s
522960896/616562950 [========================&gt;.....] - ETA: 8s
523550720/616562950 [========================&gt;.....] - ETA: 8s
524140544/616562950 [========================&gt;.....] - ETA: 8s
524730368/616562950 [========================&gt;.....] - ETA: 8s
525320192/616562950 [========================&gt;.....] - ETA: 8s
525926400/616562950 [========================&gt;.....] - ETA: 8s
526532608/616562950 [========================&gt;.....] - ETA: 8s
527122432/616562950 [========================&gt;.....] - ETA: 8s
527695872/616562950 [========================&gt;.....] - ETA: 8s
528171008/616562950 [========================&gt;.....] - ETA: 8s
528728064/616562950 [========================&gt;.....] - ETA: 8s
529137664/616562950 [========================&gt;.....] - ETA: 8s
529481728/616562950 [========================&gt;.....] - ETA: 8s
529858560/616562950 [========================&gt;.....] - ETA: 8s
530268160/616562950 [========================&gt;.....] - ETA: 8s
530644992/616562950 [========================&gt;.....] - ETA: 8s
531054592/616562950 [========================&gt;.....] - ETA: 8s
531480576/616562950 [========================&gt;.....] - ETA: 8s
531857408/616562950 [========================&gt;.....] - ETA: 8s
532299776/616562950 [========================&gt;.....] - ETA: 8s
532709376/616562950 [========================&gt;.....] - ETA: 7s
533118976/616562950 [========================&gt;.....] - ETA: 7s
533544960/616562950 [========================&gt;.....] - ETA: 7s
533970944/616562950 [========================&gt;.....] - ETA: 7s
534413312/616562950 [=========================&gt;....] - ETA: 7s
534839296/616562950 [=========================&gt;....] - ETA: 7s
535281664/616562950 [=========================&gt;....] - ETA: 7s
535756800/616562950 [=========================&gt;....] - ETA: 7s
536182784/616562950 [=========================&gt;....] - ETA: 7s
536657920/616562950 [=========================&gt;....] - ETA: 7s
537100288/616562950 [=========================&gt;....] - ETA: 7s
537575424/616562950 [=========================&gt;....] - ETA: 7s
538034176/616562950 [=========================&gt;....] - ETA: 7s
538525696/616562950 [=========================&gt;....] - ETA: 7s
539017216/616562950 [=========================&gt;....] - ETA: 7s
539492352/616562950 [=========================&gt;....] - ETA: 7s
540000256/616562950 [=========================&gt;....] - ETA: 7s
540475392/616562950 [=========================&gt;....] - ETA: 7s
540983296/616562950 [=========================&gt;....] - ETA: 7s
541474816/616562950 [=========================&gt;....] - ETA: 7s
541982720/616562950 [=========================&gt;....] - ETA: 7s
542490624/616562950 [=========================&gt;....] - ETA: 7s
543014912/616562950 [=========================&gt;....] - ETA: 7s
543555584/616562950 [=========================&gt;....] - ETA: 6s
544096256/616562950 [=========================&gt;....] - ETA: 6s
544636928/616562950 [=========================&gt;....] - ETA: 6s
545177600/616562950 [=========================&gt;....] - ETA: 6s
545734656/616562950 [=========================&gt;....] - ETA: 6s
546275328/616562950 [=========================&gt;....] - ETA: 6s
546832384/616562950 [=========================&gt;....] - ETA: 6s
547389440/616562950 [=========================&gt;....] - ETA: 6s
547946496/616562950 [=========================&gt;....] - ETA: 6s
548519936/616562950 [=========================&gt;....] - ETA: 6s
549093376/616562950 [=========================&gt;....] - ETA: 6s
549666816/616562950 [=========================&gt;....] - ETA: 6s
550256640/616562950 [=========================&gt;....] - ETA: 6s
550846464/616562950 [=========================&gt;....] - ETA: 6s
551436288/616562950 [=========================&gt;....] - ETA: 6s
552026112/616562950 [=========================&gt;....] - ETA: 6s
552615936/616562950 [=========================&gt;....] - ETA: 6s
553205760/616562950 [=========================&gt;....] - ETA: 6s
553795584/616562950 [=========================&gt;....] - ETA: 5s
554385408/616562950 [=========================&gt;....] - ETA: 5s
554975232/616562950 [==========================&gt;...] - ETA: 5s
555565056/616562950 [==========================&gt;...] - ETA: 5s
556171264/616562950 [==========================&gt;...] - ETA: 5s
556761088/616562950 [==========================&gt;...] - ETA: 5s
557350912/616562950 [==========================&gt;...] - ETA: 5s
557940736/616562950 [==========================&gt;...] - ETA: 5s
558530560/616562950 [==========================&gt;...] - ETA: 5s
559120384/616562950 [==========================&gt;...] - ETA: 5s
559710208/616562950 [==========================&gt;...] - ETA: 5s
560300032/616562950 [==========================&gt;...] - ETA: 5s
560889856/616562950 [==========================&gt;...] - ETA: 5s
561496064/616562950 [==========================&gt;...] - ETA: 5s
562085888/616562950 [==========================&gt;...] - ETA: 5s
562692096/616562950 [==========================&gt;...] - ETA: 5s
563281920/616562950 [==========================&gt;...] - ETA: 5s
563871744/616562950 [==========================&gt;...] - ETA: 5s
564461568/616562950 [==========================&gt;...] - ETA: 4s
565067776/616562950 [==========================&gt;...] - ETA: 4s
565657600/616562950 [==========================&gt;...] - ETA: 4s
566247424/616562950 [==========================&gt;...] - ETA: 4s
566853632/616562950 [==========================&gt;...] - ETA: 4s
567443456/616562950 [==========================&gt;...] - ETA: 4s
568033280/616562950 [==========================&gt;...] - ETA: 4s
568639488/616562950 [==========================&gt;...] - ETA: 4s
569229312/616562950 [==========================&gt;...] - ETA: 4s
569835520/616562950 [==========================&gt;...] - ETA: 4s
570343424/616562950 [==========================&gt;...] - ETA: 4s
570884096/616562950 [==========================&gt;...] - ETA: 4s
571490304/616562950 [==========================&gt;...] - ETA: 4s
571867136/616562950 [==========================&gt;...] - ETA: 4s
572243968/616562950 [==========================&gt;...] - ETA: 4s
572620800/616562950 [==========================&gt;...] - ETA: 4s
573014016/616562950 [==========================&gt;...] - ETA: 4s
573407232/616562950 [==========================&gt;...] - ETA: 4s
573816832/616562950 [==========================&gt;...] - ETA: 4s
574226432/616562950 [==========================&gt;...] - ETA: 4s
574636032/616562950 [==========================&gt;...] - ETA: 4s
575062016/616562950 [==========================&gt;...] - ETA: 3s
575471616/616562950 [===========================&gt;..] - ETA: 3s
575897600/616562950 [===========================&gt;..] - ETA: 3s
576339968/616562950 [===========================&gt;..] - ETA: 3s
576749568/616562950 [===========================&gt;..] - ETA: 3s
577208320/616562950 [===========================&gt;..] - ETA: 3s
577634304/616562950 [===========================&gt;..] - ETA: 3s
578076672/616562950 [===========================&gt;..] - ETA: 3s
578535424/616562950 [===========================&gt;..] - ETA: 3s
578977792/616562950 [===========================&gt;..] - ETA: 3s
579469312/616562950 [===========================&gt;..] - ETA: 3s
579911680/616562950 [===========================&gt;..] - ETA: 3s
580386816/616562950 [===========================&gt;..] - ETA: 3s
580886528/616562950 [===========================&gt;..] - ETA: 3s
581337088/616562950 [===========================&gt;..] - ETA: 3s
581844992/616562950 [===========================&gt;..] - ETA: 3s
582320128/616562950 [===========================&gt;..] - ETA: 3s
582828032/616562950 [===========================&gt;..] - ETA: 3s
583319552/616562950 [===========================&gt;..] - ETA: 3s
583811072/616562950 [===========================&gt;..] - ETA: 3s
584318976/616562950 [===========================&gt;..] - ETA: 3s
584826880/616562950 [===========================&gt;..] - ETA: 3s
585351168/616562950 [===========================&gt;..] - ETA: 2s
585875456/616562950 [===========================&gt;..] - ETA: 2s
586416128/616562950 [===========================&gt;..] - ETA: 2s
586940416/616562950 [===========================&gt;..] - ETA: 2s
587481088/616562950 [===========================&gt;..] - ETA: 2s
588005376/616562950 [===========================&gt;..] - ETA: 2s
588562432/616562950 [===========================&gt;..] - ETA: 2s
589103104/616562950 [===========================&gt;..] - ETA: 2s
589660160/616562950 [===========================&gt;..] - ETA: 2s
590217216/616562950 [===========================&gt;..] - ETA: 2s
590774272/616562950 [===========================&gt;..] - ETA: 2s
591347712/616562950 [===========================&gt;..] - ETA: 2s
591921152/616562950 [===========================&gt;..] - ETA: 2s
592494592/616562950 [===========================&gt;..] - ETA: 2s
593084416/616562950 [===========================&gt;..] - ETA: 2s
593674240/616562950 [===========================&gt;..] - ETA: 2s
594247680/616562950 [===========================&gt;..] - ETA: 2s
594837504/616562950 [===========================&gt;..] - ETA: 2s
595443712/616562950 [===========================&gt;..] - ETA: 2s
596033536/616562950 [============================&gt;.] - ETA: 1s
596623360/616562950 [============================&gt;.] - ETA: 1s
597229568/616562950 [============================&gt;.] - ETA: 1s
597835776/616562950 [============================&gt;.] - ETA: 1s
598409216/616562950 [============================&gt;.] - ETA: 1s
598966272/616562950 [============================&gt;.] - ETA: 1s
599539712/616562950 [============================&gt;.] - ETA: 1s
600096768/616562950 [============================&gt;.] - ETA: 1s
600653824/616562950 [============================&gt;.] - ETA: 1s
601210880/616562950 [============================&gt;.] - ETA: 1s
601767936/616562950 [============================&gt;.] - ETA: 1s
602308608/616562950 [============================&gt;.] - ETA: 1s
602882048/616562950 [============================&gt;.] - ETA: 1s
603439104/616562950 [============================&gt;.] - ETA: 1s
603979776/616562950 [============================&gt;.] - ETA: 1s
604536832/616562950 [============================&gt;.] - ETA: 1s
605093888/616562950 [============================&gt;.] - ETA: 1s
605683712/616562950 [============================&gt;.] - ETA: 1s
606273536/616562950 [============================&gt;.] - ETA: 0s
606765056/616562950 [============================&gt;.] - ETA: 0s
607535104/616562950 [============================&gt;.] - ETA: 0s
608141312/616562950 [============================&gt;.] - ETA: 0s
608714752/616562950 [============================&gt;.] - ETA: 0s
609304576/616562950 [============================&gt;.] - ETA: 0s
609894400/616562950 [============================&gt;.] - ETA: 0s
610500608/616562950 [============================&gt;.] - ETA: 0s
611106816/616562950 [============================&gt;.] - ETA: 0s
611467264/616562950 [============================&gt;.] - ETA: 0s
611909632/616562950 [============================&gt;.] - ETA: 0s
612483072/616562950 [============================&gt;.] - ETA: 0s
612843520/616562950 [============================&gt;.] - ETA: 0s
613236736/616562950 [============================&gt;.] - ETA: 0s
613613568/616562950 [============================&gt;.] - ETA: 0s
613990400/616562950 [============================&gt;.] - ETA: 0s
614400000/616562950 [============================&gt;.] - ETA: 0s
614793216/616562950 [============================&gt;.] - ETA: 0s
615186432/616562950 [============================&gt;.] - ETA: 0s
615612416/616562950 [============================&gt;.] - ETA: 0s
616022016/616562950 [============================&gt;.] - ETA: 0s
616431616/616562950 [============================&gt;.] - ETA: 0s
616562950/616562950 [==============================] - 59s 0us/step
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">quantizeml.models</span> <span class="kn">import</span> <span class="n">quantize</span>
<span class="kn">from</span> <span class="nn">quantizeml.layers</span> <span class="kn">import</span> <span class="n">QuantizationParams</span>

<span class="c1"># Quantize the model to 8-bit and calibrate using 1024 samples with a batch size of 100 over 2</span>
<span class="c1"># epochs.</span>
<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">quantize</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span>
                           <span class="n">qparams</span><span class="o">=</span><span class="n">QuantizationParams</span><span class="p">(</span><span class="n">weight_bits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">activation_bits</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
                           <span class="n">num_samples</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 48s
 2/11 [====&gt;.........................] - ETA: 1s 
 3/11 [=======&gt;......................] - ETA: 1s
 4/11 [=========&gt;....................] - ETA: 1s
 5/11 [============&gt;.................] - ETA: 1s
 6/11 [===============&gt;..............] - ETA: 0s
 7/11 [==================&gt;...........] - ETA: 0s
 8/11 [====================&gt;.........] - ETA: 0s
 9/11 [=======================&gt;......] - ETA: 0s
10/11 [==========================&gt;...] - ETA: 0s
11/11 [==============================] - ETA: 0s
11/11 [==============================] - 6s 160ms/step

 1/11 [=&gt;............................] - ETA: 1s
 2/11 [====&gt;.........................] - ETA: 1s
 3/11 [=======&gt;......................] - ETA: 1s
 4/11 [=========&gt;....................] - ETA: 1s
 5/11 [============&gt;.................] - ETA: 1s
 6/11 [===============&gt;..............] - ETA: 0s
 7/11 [==================&gt;...........] - ETA: 0s
 8/11 [====================&gt;.........] - ETA: 0s
 9/11 [=======================&gt;......] - ETA: 0s
10/11 [==========================&gt;...] - ETA: 0s
11/11 [==============================] - ETA: 0s
11/11 [==============================] - 2s 167ms/step
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 34s 34s/step
Keras accuracy: 90.00 %
</pre></div>
</div>
</section>
<section id="load-a-pre-trained-quantized-keras-model">
<h3>3.2. Load a pre-trained quantized Keras model<a class="headerlink" href="#load-a-pre-trained-quantized-keras-model" title="Permalink to this headline"></a></h3>
<p>The <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_vit_ti16_imagenet_pretrained">bc_vit_ti16_imagenet_pretrained helper</a> was
obtained with the same 8-bit quantization scheme but with an additional QAT step to further
improve accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">bc_vit_ti16_imagenet_pretrained</span>

<span class="c1"># Load the pre-trained quantized model</span>
<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">bc_vit_ti16_imagenet_pretrained</span><span class="p">()</span>
<span class="n">model_quantized</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224_i8_w8_a8.h5.

       0/24405400 [..............................] - ETA: 0s
   49152/24405400 [..............................] - ETA: 26s
   73728/24405400 [..............................] - ETA: 35s
  114688/24405400 [..............................] - ETA: 34s
  155648/24405400 [..............................] - ETA: 35s
  188416/24405400 [..............................] - ETA: 36s
  204800/24405400 [..............................] - ETA: 40s
  229376/24405400 [..............................] - ETA: 45s
  262144/24405400 [..............................] - ETA: 44s
  294912/24405400 [..............................] - ETA: 44s
  319488/24405400 [..............................] - ETA: 45s
  327680/24405400 [..............................] - ETA: 47s
  352256/24405400 [..............................] - ETA: 49s
  368640/24405400 [..............................] - ETA: 50s
  376832/24405400 [..............................] - ETA: 54s
  393216/24405400 [..............................] - ETA: 55s
  417792/24405400 [..............................] - ETA: 57s
  434176/24405400 [..............................] - ETA: 58s
  450560/24405400 [..............................] - ETA: 59s
  475136/24405400 [..............................] - ETA: 59s
  499712/24405400 [..............................] - ETA: 1:00
  507904/24405400 [..............................] - ETA: 1:02
  532480/24405400 [..............................] - ETA: 1:01
  548864/24405400 [..............................] - ETA: 1:01
  573440/24405400 [..............................] - ETA: 1:01
  598016/24405400 [..............................] - ETA: 1:00
  614400/24405400 [..............................] - ETA: 1:03
  647168/24405400 [..............................] - ETA: 1:02
  663552/24405400 [..............................] - ETA: 1:05
  688128/24405400 [..............................] - ETA: 1:06
  712704/24405400 [..............................] - ETA: 1:06
  737280/24405400 [..............................] - ETA: 1:05
  761856/24405400 [..............................] - ETA: 1:07
  770048/24405400 [..............................] - ETA: 1:07
  794624/24405400 [..............................] - ETA: 1:07
  811008/24405400 [..............................] - ETA: 1:07
  835584/24405400 [&gt;.............................] - ETA: 1:07
  868352/24405400 [&gt;.............................] - ETA: 1:07
  884736/24405400 [&gt;.............................] - ETA: 1:07
  901120/24405400 [&gt;.............................] - ETA: 1:07
  925696/24405400 [&gt;.............................] - ETA: 1:07
  933888/24405400 [&gt;.............................] - ETA: 1:09
  966656/24405400 [&gt;.............................] - ETA: 1:08
  991232/24405400 [&gt;.............................] - ETA: 1:08
 1007616/24405400 [&gt;.............................] - ETA: 1:09
 1024000/24405400 [&gt;.............................] - ETA: 1:09
 1040384/24405400 [&gt;.............................] - ETA: 1:09
 1073152/24405400 [&gt;.............................] - ETA: 1:08
 1105920/24405400 [&gt;.............................] - ETA: 1:08
 1146880/24405400 [&gt;.............................] - ETA: 1:06
 1179648/24405400 [&gt;.............................] - ETA: 1:05
 1228800/24405400 [&gt;.............................] - ETA: 1:04
 1261568/24405400 [&gt;.............................] - ETA: 1:03
 1310720/24405400 [&gt;.............................] - ETA: 1:02
 1335296/24405400 [&gt;.............................] - ETA: 1:01
 1384448/24405400 [&gt;.............................] - ETA: 1:00
 1425408/24405400 [&gt;.............................] - ETA: 59s 
 1466368/24405400 [&gt;.............................] - ETA: 58s
 1515520/24405400 [&gt;.............................] - ETA: 57s
 1540096/24405400 [&gt;.............................] - ETA: 57s
 1597440/24405400 [&gt;.............................] - ETA: 56s
 1638400/24405400 [=&gt;............................] - ETA: 55s
 1671168/24405400 [=&gt;............................] - ETA: 55s
 1695744/24405400 [=&gt;............................] - ETA: 54s
 1720320/24405400 [=&gt;............................] - ETA: 54s
 1753088/24405400 [=&gt;............................] - ETA: 54s
 1785856/24405400 [=&gt;............................] - ETA: 53s
 1818624/24405400 [=&gt;............................] - ETA: 53s
 1851392/24405400 [=&gt;............................] - ETA: 53s
 1884160/24405400 [=&gt;............................] - ETA: 53s
 1925120/24405400 [=&gt;............................] - ETA: 52s
 1957888/24405400 [=&gt;............................] - ETA: 52s
 1990656/24405400 [=&gt;............................] - ETA: 52s
 2048000/24405400 [=&gt;............................] - ETA: 51s
 2080768/24405400 [=&gt;............................] - ETA: 51s
 2105344/24405400 [=&gt;............................] - ETA: 51s
 2154496/24405400 [=&gt;............................] - ETA: 50s
 2179072/24405400 [=&gt;............................] - ETA: 50s
 2211840/24405400 [=&gt;............................] - ETA: 50s
 2252800/24405400 [=&gt;............................] - ETA: 49s
 2293760/24405400 [=&gt;............................] - ETA: 49s
 2326528/24405400 [=&gt;............................] - ETA: 49s
 2375680/24405400 [=&gt;............................] - ETA: 48s
 2383872/24405400 [=&gt;............................] - ETA: 49s
 2424832/24405400 [=&gt;............................] - ETA: 48s
 2457600/24405400 [==&gt;...........................] - ETA: 48s
 2482176/24405400 [==&gt;...........................] - ETA: 48s
 2514944/24405400 [==&gt;...........................] - ETA: 48s
 2547712/24405400 [==&gt;...........................] - ETA: 48s
 2580480/24405400 [==&gt;...........................] - ETA: 48s
 2621440/24405400 [==&gt;...........................] - ETA: 48s
 2646016/24405400 [==&gt;...........................] - ETA: 47s
 2678784/24405400 [==&gt;...........................] - ETA: 47s
 2711552/24405400 [==&gt;...........................] - ETA: 47s
 2752512/24405400 [==&gt;...........................] - ETA: 47s
 2768896/24405400 [==&gt;...........................] - ETA: 47s
 2826240/24405400 [==&gt;...........................] - ETA: 46s
 2867200/24405400 [==&gt;...........................] - ETA: 46s
 2908160/24405400 [==&gt;...........................] - ETA: 46s
 2957312/24405400 [==&gt;...........................] - ETA: 45s
 2998272/24405400 [==&gt;...........................] - ETA: 45s
 3047424/24405400 [==&gt;...........................] - ETA: 44s
 3096576/24405400 [==&gt;...........................] - ETA: 44s
 3137536/24405400 [==&gt;...........................] - ETA: 44s
 3178496/24405400 [==&gt;...........................] - ETA: 43s
 3235840/24405400 [==&gt;...........................] - ETA: 43s
 3293184/24405400 [===&gt;..........................] - ETA: 42s
 3342336/24405400 [===&gt;..........................] - ETA: 42s
 3399680/24405400 [===&gt;..........................] - ETA: 41s
 3457024/24405400 [===&gt;..........................] - ETA: 41s
 3522560/24405400 [===&gt;..........................] - ETA: 40s
 3596288/24405400 [===&gt;..........................] - ETA: 40s
 3678208/24405400 [===&gt;..........................] - ETA: 39s
 3751936/24405400 [===&gt;..........................] - ETA: 38s
 3825664/24405400 [===&gt;..........................] - ETA: 38s
 3874816/24405400 [===&gt;..........................] - ETA: 37s
 3932160/24405400 [===&gt;..........................] - ETA: 37s
 3981312/24405400 [===&gt;..........................] - ETA: 37s
 4038656/24405400 [===&gt;..........................] - ETA: 36s
 4079616/24405400 [====&gt;.........................] - ETA: 36s
 4145152/24405400 [====&gt;.........................] - ETA: 36s
 4177920/24405400 [====&gt;.........................] - ETA: 36s
 4210688/24405400 [====&gt;.........................] - ETA: 36s
 4259840/24405400 [====&gt;.........................] - ETA: 36s
 4276224/24405400 [====&gt;.........................] - ETA: 36s
 4325376/24405400 [====&gt;.........................] - ETA: 36s
 4358144/24405400 [====&gt;.........................] - ETA: 36s
 4390912/24405400 [====&gt;.........................] - ETA: 36s
 4440064/24405400 [====&gt;.........................] - ETA: 36s
 4472832/24405400 [====&gt;.........................] - ETA: 35s
 4521984/24405400 [====&gt;.........................] - ETA: 35s
 4554752/24405400 [====&gt;.........................] - ETA: 35s
 4603904/24405400 [====&gt;.........................] - ETA: 35s
 4653056/24405400 [====&gt;.........................] - ETA: 35s
 4685824/24405400 [====&gt;.........................] - ETA: 35s
 4734976/24405400 [====&gt;.........................] - ETA: 34s
 4767744/24405400 [====&gt;.........................] - ETA: 34s
 4800512/24405400 [====&gt;.........................] - ETA: 34s
 4866048/24405400 [====&gt;.........................] - ETA: 34s
 4915200/24405400 [=====&gt;........................] - ETA: 34s
 4964352/24405400 [=====&gt;........................] - ETA: 34s
 5013504/24405400 [=====&gt;........................] - ETA: 34s
 5062656/24405400 [=====&gt;........................] - ETA: 34s
 5111808/24405400 [=====&gt;........................] - ETA: 33s
 5160960/24405400 [=====&gt;........................] - ETA: 33s
 5210112/24405400 [=====&gt;........................] - ETA: 33s
 5259264/24405400 [=====&gt;........................] - ETA: 33s
 5308416/24405400 [=====&gt;........................] - ETA: 33s
 5357568/24405400 [=====&gt;........................] - ETA: 33s
 5406720/24405400 [=====&gt;........................] - ETA: 33s
 5455872/24405400 [=====&gt;........................] - ETA: 33s
 5505024/24405400 [=====&gt;........................] - ETA: 32s
 5521408/24405400 [=====&gt;........................] - ETA: 33s
 5554176/24405400 [=====&gt;........................] - ETA: 33s
 5570560/24405400 [=====&gt;........................] - ETA: 33s
 5619712/24405400 [=====&gt;........................] - ETA: 33s
 5652480/24405400 [=====&gt;........................] - ETA: 34s
 5668864/24405400 [=====&gt;........................] - ETA: 34s
 5685248/24405400 [=====&gt;........................] - ETA: 36s
 5701632/24405400 [======&gt;.......................] - ETA: 37s
 5718016/24405400 [======&gt;.......................] - ETA: 37s
 5734400/24405400 [======&gt;.......................] - ETA: 39s
 5750784/24405400 [======&gt;.......................] - ETA: 42s
 5767168/24405400 [======&gt;.......................] - ETA: 42s
 5783552/24405400 [======&gt;.......................] - ETA: 44s
 5816320/24405400 [======&gt;.......................] - ETA: 44s
 5832704/24405400 [======&gt;.......................] - ETA: 45s
 5849088/24405400 [======&gt;.......................] - ETA: 45s
 5898240/24405400 [======&gt;.......................] - ETA: 45s
 5931008/24405400 [======&gt;.......................] - ETA: 44s
 5947392/24405400 [======&gt;.......................] - ETA: 44s
 5980160/24405400 [======&gt;.......................] - ETA: 44s
 6012928/24405400 [======&gt;.......................] - ETA: 44s
 6045696/24405400 [======&gt;.......................] - ETA: 44s
 6078464/24405400 [======&gt;.......................] - ETA: 44s
 6111232/24405400 [======&gt;.......................] - ETA: 44s
 6160384/24405400 [======&gt;.......................] - ETA: 43s
 6209536/24405400 [======&gt;.......................] - ETA: 43s
 6258688/24405400 [======&gt;.......................] - ETA: 43s
 6324224/24405400 [======&gt;.......................] - ETA: 42s
 6373376/24405400 [======&gt;.......................] - ETA: 42s
 6438912/24405400 [======&gt;.......................] - ETA: 42s
 6504448/24405400 [======&gt;.......................] - ETA: 41s
 6569984/24405400 [=======&gt;......................] - ETA: 41s
 6635520/24405400 [=======&gt;......................] - ETA: 40s
 6701056/24405400 [=======&gt;......................] - ETA: 40s
 6782976/24405400 [=======&gt;......................] - ETA: 39s
 6864896/24405400 [=======&gt;......................] - ETA: 39s
 6946816/24405400 [=======&gt;......................] - ETA: 38s
 7028736/24405400 [=======&gt;......................] - ETA: 38s
 7127040/24405400 [=======&gt;......................] - ETA: 37s
 7225344/24405400 [=======&gt;......................] - ETA: 37s
 7307264/24405400 [=======&gt;......................] - ETA: 36s
 7389184/24405400 [========&gt;.....................] - ETA: 36s
 7454720/24405400 [========&gt;.....................] - ETA: 35s
 7520256/24405400 [========&gt;.....................] - ETA: 35s
 7585792/24405400 [========&gt;.....................] - ETA: 35s
 7651328/24405400 [========&gt;.....................] - ETA: 34s
 7700480/24405400 [========&gt;.....................] - ETA: 34s
 7749632/24405400 [========&gt;.....................] - ETA: 34s
 7798784/24405400 [========&gt;.....................] - ETA: 34s
 7864320/24405400 [========&gt;.....................] - ETA: 34s
 7929856/24405400 [========&gt;.....................] - ETA: 33s
 7995392/24405400 [========&gt;.....................] - ETA: 33s
 8060928/24405400 [========&gt;.....................] - ETA: 33s
 8126464/24405400 [========&gt;.....................] - ETA: 32s
 8208384/24405400 [=========&gt;....................] - ETA: 32s
 8290304/24405400 [=========&gt;....................] - ETA: 32s
 8355840/24405400 [=========&gt;....................] - ETA: 31s
 8404992/24405400 [=========&gt;....................] - ETA: 31s
 8486912/24405400 [=========&gt;....................] - ETA: 31s
 8536064/24405400 [=========&gt;....................] - ETA: 31s
 8568832/24405400 [=========&gt;....................] - ETA: 31s
 8617984/24405400 [=========&gt;....................] - ETA: 31s
 8667136/24405400 [=========&gt;....................] - ETA: 31s
 8716288/24405400 [=========&gt;....................] - ETA: 31s
 8732672/24405400 [=========&gt;....................] - ETA: 31s
 8765440/24405400 [=========&gt;....................] - ETA: 31s
 8798208/24405400 [=========&gt;....................] - ETA: 31s
 8830976/24405400 [=========&gt;....................] - ETA: 31s
 8847360/24405400 [=========&gt;....................] - ETA: 31s
 8863744/24405400 [=========&gt;....................] - ETA: 31s
 8880128/24405400 [=========&gt;....................] - ETA: 31s
 8896512/24405400 [=========&gt;....................] - ETA: 31s
 8929280/24405400 [=========&gt;....................] - ETA: 32s
 8962048/24405400 [==========&gt;...................] - ETA: 32s
 8978432/24405400 [==========&gt;...................] - ETA: 32s
 9011200/24405400 [==========&gt;...................] - ETA: 32s
 9043968/24405400 [==========&gt;...................] - ETA: 33s
 9060352/24405400 [==========&gt;...................] - ETA: 33s
 9076736/24405400 [==========&gt;...................] - ETA: 33s
 9093120/24405400 [==========&gt;...................] - ETA: 33s
 9109504/24405400 [==========&gt;...................] - ETA: 35s
 9125888/24405400 [==========&gt;...................] - ETA: 35s
 9158656/24405400 [==========&gt;...................] - ETA: 38s
 9175040/24405400 [==========&gt;...................] - ETA: 41s
 9191424/24405400 [==========&gt;...................] - ETA: 41s
 9207808/24405400 [==========&gt;...................] - ETA: 42s
 9224192/24405400 [==========&gt;...................] - ETA: 44s
 9240576/24405400 [==========&gt;...................] - ETA: 44s
 9256960/24405400 [==========&gt;...................] - ETA: 45s
 9273344/24405400 [==========&gt;...................] - ETA: 46s
 9289728/24405400 [==========&gt;...................] - ETA: 47s
 9306112/24405400 [==========&gt;...................] - ETA: 47s
 9322496/24405400 [==========&gt;...................] - ETA: 48s
 9338880/24405400 [==========&gt;...................] - ETA: 48s
 9355264/24405400 [==========&gt;...................] - ETA: 48s
 9371648/24405400 [==========&gt;...................] - ETA: 50s
 9388032/24405400 [==========&gt;...................] - ETA: 50s
 9404416/24405400 [==========&gt;...................] - ETA: 51s
 9420800/24405400 [==========&gt;...................] - ETA: 52s
 9437184/24405400 [==========&gt;...................] - ETA: 52s
 9453568/24405400 [==========&gt;...................] - ETA: 52s
 9469952/24405400 [==========&gt;...................] - ETA: 52s
 9486336/24405400 [==========&gt;...................] - ETA: 53s
 9502720/24405400 [==========&gt;...................] - ETA: 53s
 9519104/24405400 [==========&gt;...................] - ETA: 54s
 9535488/24405400 [==========&gt;...................] - ETA: 54s
 9551872/24405400 [==========&gt;...................] - ETA: 54s
 9568256/24405400 [==========&gt;...................] - ETA: 54s
 9584640/24405400 [==========&gt;...................] - ETA: 54s
 9601024/24405400 [==========&gt;...................] - ETA: 54s
 9617408/24405400 [==========&gt;...................] - ETA: 54s
 9633792/24405400 [==========&gt;...................] - ETA: 1:00
 9650176/24405400 [==========&gt;...................] - ETA: 1:01
 9666560/24405400 [==========&gt;...................] - ETA: 1:01
 9682944/24405400 [==========&gt;...................] - ETA: 1:03
 9699328/24405400 [==========&gt;...................] - ETA: 1:03
 9715712/24405400 [==========&gt;...................] - ETA: 1:03
 9732096/24405400 [==========&gt;...................] - ETA: 1:03
 9748480/24405400 [==========&gt;...................] - ETA: 1:04
 9764864/24405400 [===========&gt;..................] - ETA: 1:05
 9781248/24405400 [===========&gt;..................] - ETA: 1:06
 9797632/24405400 [===========&gt;..................] - ETA: 1:07
 9814016/24405400 [===========&gt;..................] - ETA: 1:07
 9830400/24405400 [===========&gt;..................] - ETA: 1:08
 9846784/24405400 [===========&gt;..................] - ETA: 1:09
 9863168/24405400 [===========&gt;..................] - ETA: 1:09
 9879552/24405400 [===========&gt;..................] - ETA: 1:12
 9895936/24405400 [===========&gt;..................] - ETA: 1:12
 9912320/24405400 [===========&gt;..................] - ETA: 1:13
 9928704/24405400 [===========&gt;..................] - ETA: 1:13
 9945088/24405400 [===========&gt;..................] - ETA: 1:13
 9961472/24405400 [===========&gt;..................] - ETA: 1:14
 9977856/24405400 [===========&gt;..................] - ETA: 1:15
 9994240/24405400 [===========&gt;..................] - ETA: 1:15
10010624/24405400 [===========&gt;..................] - ETA: 1:16
10027008/24405400 [===========&gt;..................] - ETA: 1:16
10043392/24405400 [===========&gt;..................] - ETA: 1:16
10059776/24405400 [===========&gt;..................] - ETA: 1:16
10076160/24405400 [===========&gt;..................] - ETA: 1:16
10092544/24405400 [===========&gt;..................] - ETA: 1:16
10108928/24405400 [===========&gt;..................] - ETA: 1:16
10125312/24405400 [===========&gt;..................] - ETA: 1:17
10141696/24405400 [===========&gt;..................] - ETA: 1:17
10158080/24405400 [===========&gt;..................] - ETA: 1:17
10174464/24405400 [===========&gt;..................] - ETA: 1:17
10190848/24405400 [===========&gt;..................] - ETA: 1:17
10207232/24405400 [===========&gt;..................] - ETA: 1:17
10223616/24405400 [===========&gt;..................] - ETA: 1:17
10240000/24405400 [===========&gt;..................] - ETA: 1:19
10256384/24405400 [===========&gt;..................] - ETA: 1:20
10272768/24405400 [===========&gt;..................] - ETA: 1:20
10289152/24405400 [===========&gt;..................] - ETA: 1:20
10305536/24405400 [===========&gt;..................] - ETA: 1:20
10321920/24405400 [===========&gt;..................] - ETA: 1:20
10338304/24405400 [===========&gt;..................] - ETA: 1:20
10354688/24405400 [===========&gt;..................] - ETA: 1:19
10371072/24405400 [===========&gt;..................] - ETA: 1:19
10387456/24405400 [===========&gt;..................] - ETA: 1:19
10403840/24405400 [===========&gt;..................] - ETA: 1:19
10420224/24405400 [===========&gt;..................] - ETA: 1:19
10436608/24405400 [===========&gt;..................] - ETA: 1:19
10452992/24405400 [===========&gt;..................] - ETA: 1:19
10469376/24405400 [===========&gt;..................] - ETA: 1:18
10485760/24405400 [===========&gt;..................] - ETA: 1:18
10518528/24405400 [===========&gt;..................] - ETA: 1:18
10534912/24405400 [===========&gt;..................] - ETA: 1:18
10551296/24405400 [===========&gt;..................] - ETA: 1:18
10567680/24405400 [===========&gt;..................] - ETA: 1:18
10584064/24405400 [============&gt;.................] - ETA: 1:18
10600448/24405400 [============&gt;.................] - ETA: 1:18
10616832/24405400 [============&gt;.................] - ETA: 1:18
10633216/24405400 [============&gt;.................] - ETA: 1:18
10649600/24405400 [============&gt;.................] - ETA: 1:18
10665984/24405400 [============&gt;.................] - ETA: 1:18
10698752/24405400 [============&gt;.................] - ETA: 1:17
10715136/24405400 [============&gt;.................] - ETA: 1:17
10731520/24405400 [============&gt;.................] - ETA: 1:18
10747904/24405400 [============&gt;.................] - ETA: 1:18
10764288/24405400 [============&gt;.................] - ETA: 1:18
10797056/24405400 [============&gt;.................] - ETA: 1:17
10813440/24405400 [============&gt;.................] - ETA: 1:17
10829824/24405400 [============&gt;.................] - ETA: 1:17
10846208/24405400 [============&gt;.................] - ETA: 1:17
10862592/24405400 [============&gt;.................] - ETA: 1:17
10878976/24405400 [============&gt;.................] - ETA: 1:17
10895360/24405400 [============&gt;.................] - ETA: 1:17
10928128/24405400 [============&gt;.................] - ETA: 1:16
10944512/24405400 [============&gt;.................] - ETA: 1:16
10977280/24405400 [============&gt;.................] - ETA: 1:16
11010048/24405400 [============&gt;.................] - ETA: 1:16
11026432/24405400 [============&gt;.................] - ETA: 1:16
11042816/24405400 [============&gt;.................] - ETA: 1:16
11075584/24405400 [============&gt;.................] - ETA: 1:16
11108352/24405400 [============&gt;.................] - ETA: 1:15
11141120/24405400 [============&gt;.................] - ETA: 1:15
11173888/24405400 [============&gt;.................] - ETA: 1:15
11206656/24405400 [============&gt;.................] - ETA: 1:15
11223040/24405400 [============&gt;.................] - ETA: 1:14
11255808/24405400 [============&gt;.................] - ETA: 1:14
11272192/24405400 [============&gt;.................] - ETA: 1:14
11288576/24405400 [============&gt;.................] - ETA: 1:14
11304960/24405400 [============&gt;.................] - ETA: 1:14
11321344/24405400 [============&gt;.................] - ETA: 1:14
11337728/24405400 [============&gt;.................] - ETA: 1:14
11354112/24405400 [============&gt;.................] - ETA: 1:15
11370496/24405400 [============&gt;.................] - ETA: 1:15
11386880/24405400 [============&gt;.................] - ETA: 1:15
11403264/24405400 [=============&gt;................] - ETA: 1:15
11419648/24405400 [=============&gt;................] - ETA: 1:15
11436032/24405400 [=============&gt;................] - ETA: 1:15
11452416/24405400 [=============&gt;................] - ETA: 1:15
11468800/24405400 [=============&gt;................] - ETA: 1:14
11485184/24405400 [=============&gt;................] - ETA: 1:14
11501568/24405400 [=============&gt;................] - ETA: 1:14
11517952/24405400 [=============&gt;................] - ETA: 1:14
11550720/24405400 [=============&gt;................] - ETA: 1:14
11583488/24405400 [=============&gt;................] - ETA: 1:14
11599872/24405400 [=============&gt;................] - ETA: 1:13
11616256/24405400 [=============&gt;................] - ETA: 1:13
11632640/24405400 [=============&gt;................] - ETA: 1:13
11649024/24405400 [=============&gt;................] - ETA: 1:13
11681792/24405400 [=============&gt;................] - ETA: 1:13
11698176/24405400 [=============&gt;................] - ETA: 1:13
11714560/24405400 [=============&gt;................] - ETA: 1:13
11730944/24405400 [=============&gt;................] - ETA: 1:13
11747328/24405400 [=============&gt;................] - ETA: 1:12
11763712/24405400 [=============&gt;................] - ETA: 1:12
11796480/24405400 [=============&gt;................] - ETA: 1:12
11812864/24405400 [=============&gt;................] - ETA: 1:12
11829248/24405400 [=============&gt;................] - ETA: 1:12
11845632/24405400 [=============&gt;................] - ETA: 1:12
11878400/24405400 [=============&gt;................] - ETA: 1:11
11911168/24405400 [=============&gt;................] - ETA: 1:11
11927552/24405400 [=============&gt;................] - ETA: 1:11
11943936/24405400 [=============&gt;................] - ETA: 1:11
11960320/24405400 [=============&gt;................] - ETA: 1:11
11976704/24405400 [=============&gt;................] - ETA: 1:11
11993088/24405400 [=============&gt;................] - ETA: 1:11
12009472/24405400 [=============&gt;................] - ETA: 1:11
12025856/24405400 [=============&gt;................] - ETA: 1:11
12042240/24405400 [=============&gt;................] - ETA: 1:11
12058624/24405400 [=============&gt;................] - ETA: 1:11
12091392/24405400 [=============&gt;................] - ETA: 1:10
12107776/24405400 [=============&gt;................] - ETA: 1:10
12124160/24405400 [=============&gt;................] - ETA: 1:10
12140544/24405400 [=============&gt;................] - ETA: 1:10
12156928/24405400 [=============&gt;................] - ETA: 1:10
12189696/24405400 [=============&gt;................] - ETA: 1:09
12238848/24405400 [==============&gt;...............] - ETA: 1:09
12255232/24405400 [==============&gt;...............] - ETA: 1:09
12304384/24405400 [==============&gt;...............] - ETA: 1:08
12337152/24405400 [==============&gt;...............] - ETA: 1:08
12353536/24405400 [==============&gt;...............] - ETA: 1:08
12369920/24405400 [==============&gt;...............] - ETA: 1:08
12402688/24405400 [==============&gt;...............] - ETA: 1:08
12435456/24405400 [==============&gt;...............] - ETA: 1:07
12468224/24405400 [==============&gt;...............] - ETA: 1:07
12500992/24405400 [==============&gt;...............] - ETA: 1:07
12533760/24405400 [==============&gt;...............] - ETA: 1:06
12550144/24405400 [==============&gt;...............] - ETA: 1:06
12582912/24405400 [==============&gt;...............] - ETA: 1:06
12615680/24405400 [==============&gt;...............] - ETA: 1:06
12632064/24405400 [==============&gt;...............] - ETA: 1:06
12664832/24405400 [==============&gt;...............] - ETA: 1:05
12697600/24405400 [==============&gt;...............] - ETA: 1:05
12730368/24405400 [==============&gt;...............] - ETA: 1:05
12746752/24405400 [==============&gt;...............] - ETA: 1:05
12779520/24405400 [==============&gt;...............] - ETA: 1:04
12795904/24405400 [==============&gt;...............] - ETA: 1:04
12845056/24405400 [==============&gt;...............] - ETA: 1:04
12877824/24405400 [==============&gt;...............] - ETA: 1:04
12910592/24405400 [==============&gt;...............] - ETA: 1:03
12943360/24405400 [==============&gt;...............] - ETA: 1:03
12976128/24405400 [==============&gt;...............] - ETA: 1:03
13008896/24405400 [==============&gt;...............] - ETA: 1:02
13058048/24405400 [===============&gt;..............] - ETA: 1:02
13107200/24405400 [===============&gt;..............] - ETA: 1:01
13156352/24405400 [===============&gt;..............] - ETA: 1:01
13205504/24405400 [===============&gt;..............] - ETA: 1:01
13271040/24405400 [===============&gt;..............] - ETA: 1:00
13320192/24405400 [===============&gt;..............] - ETA: 1:00
13352960/24405400 [===============&gt;..............] - ETA: 59s 
13434880/24405400 [===============&gt;..............] - ETA: 58s
13484032/24405400 [===============&gt;..............] - ETA: 58s
13533184/24405400 [===============&gt;..............] - ETA: 58s
13582336/24405400 [===============&gt;..............] - ETA: 57s
13631488/24405400 [===============&gt;..............] - ETA: 57s
13680640/24405400 [===============&gt;..............] - ETA: 56s
13713408/24405400 [===============&gt;..............] - ETA: 56s
13729792/24405400 [===============&gt;..............] - ETA: 56s
13762560/24405400 [===============&gt;..............] - ETA: 56s
13795328/24405400 [===============&gt;..............] - ETA: 56s
13828096/24405400 [===============&gt;..............] - ETA: 55s
13860864/24405400 [================&gt;.............] - ETA: 55s
13910016/24405400 [================&gt;.............] - ETA: 55s
13942784/24405400 [================&gt;.............] - ETA: 54s
13959168/24405400 [================&gt;.............] - ETA: 54s
14008320/24405400 [================&gt;.............] - ETA: 54s
14041088/24405400 [================&gt;.............] - ETA: 54s
14073856/24405400 [================&gt;.............] - ETA: 53s
14123008/24405400 [================&gt;.............] - ETA: 53s
14172160/24405400 [================&gt;.............] - ETA: 53s
14221312/24405400 [================&gt;.............] - ETA: 52s
14270464/24405400 [================&gt;.............] - ETA: 52s
14336000/24405400 [================&gt;.............] - ETA: 51s
14401536/24405400 [================&gt;.............] - ETA: 51s
14467072/24405400 [================&gt;.............] - ETA: 50s
14532608/24405400 [================&gt;.............] - ETA: 50s
14614528/24405400 [================&gt;.............] - ETA: 49s
14647296/24405400 [=================&gt;............] - ETA: 49s
14729216/24405400 [=================&gt;............] - ETA: 48s
14778368/24405400 [=================&gt;............] - ETA: 48s
14794752/24405400 [=================&gt;............] - ETA: 48s
14860288/24405400 [=================&gt;............] - ETA: 47s
14909440/24405400 [=================&gt;............] - ETA: 47s
14958592/24405400 [=================&gt;............] - ETA: 46s
14991360/24405400 [=================&gt;............] - ETA: 46s
15024128/24405400 [=================&gt;............] - ETA: 46s
15073280/24405400 [=================&gt;............] - ETA: 46s
15106048/24405400 [=================&gt;............] - ETA: 45s
15122432/24405400 [=================&gt;............] - ETA: 45s
15171584/24405400 [=================&gt;............] - ETA: 45s
15204352/24405400 [=================&gt;............] - ETA: 45s
15237120/24405400 [=================&gt;............] - ETA: 45s
15269888/24405400 [=================&gt;............] - ETA: 45s
15286272/24405400 [=================&gt;............] - ETA: 44s
15319040/24405400 [=================&gt;............] - ETA: 44s
15351808/24405400 [=================&gt;............] - ETA: 44s
15384576/24405400 [=================&gt;............] - ETA: 44s
15417344/24405400 [=================&gt;............] - ETA: 44s
15450112/24405400 [=================&gt;............] - ETA: 43s
15466496/24405400 [==================&gt;...........] - ETA: 43s
15515648/24405400 [==================&gt;...........] - ETA: 43s
15532032/24405400 [==================&gt;...........] - ETA: 43s
15581184/24405400 [==================&gt;...........] - ETA: 43s
15597568/24405400 [==================&gt;...........] - ETA: 43s
15630336/24405400 [==================&gt;...........] - ETA: 42s
15679488/24405400 [==================&gt;...........] - ETA: 42s
15695872/24405400 [==================&gt;...........] - ETA: 42s
15728640/24405400 [==================&gt;...........] - ETA: 42s
15761408/24405400 [==================&gt;...........] - ETA: 42s
15777792/24405400 [==================&gt;...........] - ETA: 42s
15794176/24405400 [==================&gt;...........] - ETA: 42s
15826944/24405400 [==================&gt;...........] - ETA: 42s
15843328/24405400 [==================&gt;...........] - ETA: 41s
15876096/24405400 [==================&gt;...........] - ETA: 41s
15892480/24405400 [==================&gt;...........] - ETA: 41s
15908864/24405400 [==================&gt;...........] - ETA: 41s
15941632/24405400 [==================&gt;...........] - ETA: 41s
15974400/24405400 [==================&gt;...........] - ETA: 41s
15990784/24405400 [==================&gt;...........] - ETA: 41s
16023552/24405400 [==================&gt;...........] - ETA: 41s
16039936/24405400 [==================&gt;...........] - ETA: 41s
16056320/24405400 [==================&gt;...........] - ETA: 41s
16072704/24405400 [==================&gt;...........] - ETA: 41s
16105472/24405400 [==================&gt;...........] - ETA: 40s
16121856/24405400 [==================&gt;...........] - ETA: 40s
16154624/24405400 [==================&gt;...........] - ETA: 40s
16187392/24405400 [==================&gt;...........] - ETA: 40s
16203776/24405400 [==================&gt;...........] - ETA: 40s
16220160/24405400 [==================&gt;...........] - ETA: 40s
16236544/24405400 [==================&gt;...........] - ETA: 40s
16269312/24405400 [==================&gt;...........] - ETA: 40s
16302080/24405400 [===================&gt;..........] - ETA: 40s
16318464/24405400 [===================&gt;..........] - ETA: 39s
16334848/24405400 [===================&gt;..........] - ETA: 39s
16351232/24405400 [===================&gt;..........] - ETA: 40s
16367616/24405400 [===================&gt;..........] - ETA: 40s
16384000/24405400 [===================&gt;..........] - ETA: 40s
16400384/24405400 [===================&gt;..........] - ETA: 39s
16416768/24405400 [===================&gt;..........] - ETA: 39s
16433152/24405400 [===================&gt;..........] - ETA: 40s
16449536/24405400 [===================&gt;..........] - ETA: 40s
16465920/24405400 [===================&gt;..........] - ETA: 40s
16482304/24405400 [===================&gt;..........] - ETA: 40s
16498688/24405400 [===================&gt;..........] - ETA: 39s
16531456/24405400 [===================&gt;..........] - ETA: 39s
16547840/24405400 [===================&gt;..........] - ETA: 39s
16564224/24405400 [===================&gt;..........] - ETA: 39s
16580608/24405400 [===================&gt;..........] - ETA: 39s
16596992/24405400 [===================&gt;..........] - ETA: 39s
16613376/24405400 [===================&gt;..........] - ETA: 39s
16629760/24405400 [===================&gt;..........] - ETA: 39s
16662528/24405400 [===================&gt;..........] - ETA: 39s
16695296/24405400 [===================&gt;..........] - ETA: 39s
16711680/24405400 [===================&gt;..........] - ETA: 39s
16728064/24405400 [===================&gt;..........] - ETA: 39s
16744448/24405400 [===================&gt;..........] - ETA: 39s
16760832/24405400 [===================&gt;..........] - ETA: 39s
16793600/24405400 [===================&gt;..........] - ETA: 39s
16809984/24405400 [===================&gt;..........] - ETA: 38s
16826368/24405400 [===================&gt;..........] - ETA: 38s
16842752/24405400 [===================&gt;..........] - ETA: 38s
16859136/24405400 [===================&gt;..........] - ETA: 38s
16875520/24405400 [===================&gt;..........] - ETA: 38s
16891904/24405400 [===================&gt;..........] - ETA: 38s
16908288/24405400 [===================&gt;..........] - ETA: 38s
16924672/24405400 [===================&gt;..........] - ETA: 38s
16941056/24405400 [===================&gt;..........] - ETA: 38s
16957440/24405400 [===================&gt;..........] - ETA: 38s
16973824/24405400 [===================&gt;..........] - ETA: 38s
16990208/24405400 [===================&gt;..........] - ETA: 38s
17006592/24405400 [===================&gt;..........] - ETA: 37s
17022976/24405400 [===================&gt;..........] - ETA: 37s
17055744/24405400 [===================&gt;..........] - ETA: 37s
17072128/24405400 [===================&gt;..........] - ETA: 37s
17088512/24405400 [====================&gt;.........] - ETA: 37s
17104896/24405400 [====================&gt;.........] - ETA: 37s
17121280/24405400 [====================&gt;.........] - ETA: 37s
17137664/24405400 [====================&gt;.........] - ETA: 37s
17154048/24405400 [====================&gt;.........] - ETA: 37s
17170432/24405400 [====================&gt;.........] - ETA: 37s
17186816/24405400 [====================&gt;.........] - ETA: 37s
17203200/24405400 [====================&gt;.........] - ETA: 37s
17219584/24405400 [====================&gt;.........] - ETA: 37s
17252352/24405400 [====================&gt;.........] - ETA: 37s
17268736/24405400 [====================&gt;.........] - ETA: 36s
17301504/24405400 [====================&gt;.........] - ETA: 36s
17317888/24405400 [====================&gt;.........] - ETA: 36s
17334272/24405400 [====================&gt;.........] - ETA: 36s
17350656/24405400 [====================&gt;.........] - ETA: 36s
17367040/24405400 [====================&gt;.........] - ETA: 36s
17383424/24405400 [====================&gt;.........] - ETA: 36s
17399808/24405400 [====================&gt;.........] - ETA: 36s
17416192/24405400 [====================&gt;.........] - ETA: 36s
17432576/24405400 [====================&gt;.........] - ETA: 36s
17448960/24405400 [====================&gt;.........] - ETA: 36s
17465344/24405400 [====================&gt;.........] - ETA: 36s
17481728/24405400 [====================&gt;.........] - ETA: 36s
17498112/24405400 [====================&gt;.........] - ETA: 36s
17514496/24405400 [====================&gt;.........] - ETA: 36s
17530880/24405400 [====================&gt;.........] - ETA: 36s
17547264/24405400 [====================&gt;.........] - ETA: 36s
17563648/24405400 [====================&gt;.........] - ETA: 36s
17596416/24405400 [====================&gt;.........] - ETA: 36s
17629184/24405400 [====================&gt;.........] - ETA: 35s
17645568/24405400 [====================&gt;.........] - ETA: 35s
17661952/24405400 [====================&gt;.........] - ETA: 35s
17694720/24405400 [====================&gt;.........] - ETA: 35s
17727488/24405400 [====================&gt;.........] - ETA: 35s
17743872/24405400 [====================&gt;.........] - ETA: 35s
17776640/24405400 [====================&gt;.........] - ETA: 35s
17809408/24405400 [====================&gt;.........] - ETA: 34s
17842176/24405400 [====================&gt;.........] - ETA: 34s
17874944/24405400 [====================&gt;.........] - ETA: 34s
17891328/24405400 [====================&gt;.........] - ETA: 34s
17907712/24405400 [=====================&gt;........] - ETA: 34s
17924096/24405400 [=====================&gt;........] - ETA: 34s
17956864/24405400 [=====================&gt;........] - ETA: 34s
17989632/24405400 [=====================&gt;........] - ETA: 33s
18006016/24405400 [=====================&gt;........] - ETA: 33s
18038784/24405400 [=====================&gt;........] - ETA: 33s
18071552/24405400 [=====================&gt;........] - ETA: 33s
18104320/24405400 [=====================&gt;........] - ETA: 33s
18137088/24405400 [=====================&gt;........] - ETA: 32s
18169856/24405400 [=====================&gt;........] - ETA: 32s
18202624/24405400 [=====================&gt;........] - ETA: 32s
18235392/24405400 [=====================&gt;........] - ETA: 32s
18268160/24405400 [=====================&gt;........] - ETA: 32s
18300928/24405400 [=====================&gt;........] - ETA: 31s
18333696/24405400 [=====================&gt;........] - ETA: 31s
18366464/24405400 [=====================&gt;........] - ETA: 31s
18415616/24405400 [=====================&gt;........] - ETA: 31s
18448384/24405400 [=====================&gt;........] - ETA: 31s
18497536/24405400 [=====================&gt;........] - ETA: 30s
18546688/24405400 [=====================&gt;........] - ETA: 30s
18595840/24405400 [=====================&gt;........] - ETA: 30s
18644992/24405400 [=====================&gt;........] - ETA: 29s
18694144/24405400 [=====================&gt;........] - ETA: 29s
18726912/24405400 [======================&gt;.......] - ETA: 29s
18759680/24405400 [======================&gt;.......] - ETA: 29s
18792448/24405400 [======================&gt;.......] - ETA: 28s
18825216/24405400 [======================&gt;.......] - ETA: 28s
18874368/24405400 [======================&gt;.......] - ETA: 28s
18907136/24405400 [======================&gt;.......] - ETA: 28s
18939904/24405400 [======================&gt;.......] - ETA: 27s
18972672/24405400 [======================&gt;.......] - ETA: 27s
19005440/24405400 [======================&gt;.......] - ETA: 27s
19038208/24405400 [======================&gt;.......] - ETA: 27s
19087360/24405400 [======================&gt;.......] - ETA: 27s
19120128/24405400 [======================&gt;.......] - ETA: 26s
19136512/24405400 [======================&gt;.......] - ETA: 26s
19169280/24405400 [======================&gt;.......] - ETA: 26s
19202048/24405400 [======================&gt;.......] - ETA: 26s
19218432/24405400 [======================&gt;.......] - ETA: 26s
19234816/24405400 [======================&gt;.......] - ETA: 26s
19267584/24405400 [======================&gt;.......] - ETA: 25s
19283968/24405400 [======================&gt;.......] - ETA: 25s
19316736/24405400 [======================&gt;.......] - ETA: 25s
19365888/24405400 [======================&gt;.......] - ETA: 25s
19398656/24405400 [======================&gt;.......] - ETA: 25s
19415040/24405400 [======================&gt;.......] - ETA: 25s
19431424/24405400 [======================&gt;.......] - ETA: 25s
19464192/24405400 [======================&gt;.......] - ETA: 24s
19480576/24405400 [======================&gt;.......] - ETA: 24s
19496960/24405400 [======================&gt;.......] - ETA: 24s
19513344/24405400 [======================&gt;.......] - ETA: 24s
19529728/24405400 [=======================&gt;......] - ETA: 24s
19562496/24405400 [=======================&gt;......] - ETA: 24s
19578880/24405400 [=======================&gt;......] - ETA: 24s
19595264/24405400 [=======================&gt;......] - ETA: 24s
19611648/24405400 [=======================&gt;......] - ETA: 24s
19628032/24405400 [=======================&gt;......] - ETA: 24s
19644416/24405400 [=======================&gt;......] - ETA: 23s
19660800/24405400 [=======================&gt;......] - ETA: 23s
19693568/24405400 [=======================&gt;......] - ETA: 23s
19709952/24405400 [=======================&gt;......] - ETA: 23s
19726336/24405400 [=======================&gt;......] - ETA: 23s
19759104/24405400 [=======================&gt;......] - ETA: 23s
19775488/24405400 [=======================&gt;......] - ETA: 23s
19791872/24405400 [=======================&gt;......] - ETA: 23s
19824640/24405400 [=======================&gt;......] - ETA: 23s
19841024/24405400 [=======================&gt;......] - ETA: 22s
19857408/24405400 [=======================&gt;......] - ETA: 22s
19873792/24405400 [=======================&gt;......] - ETA: 22s
19890176/24405400 [=======================&gt;......] - ETA: 22s
19906560/24405400 [=======================&gt;......] - ETA: 22s
19922944/24405400 [=======================&gt;......] - ETA: 22s
19939328/24405400 [=======================&gt;......] - ETA: 22s
19955712/24405400 [=======================&gt;......] - ETA: 22s
19972096/24405400 [=======================&gt;......] - ETA: 22s
19988480/24405400 [=======================&gt;......] - ETA: 22s
20004864/24405400 [=======================&gt;......] - ETA: 22s
20021248/24405400 [=======================&gt;......] - ETA: 22s
20037632/24405400 [=======================&gt;......] - ETA: 22s
20054016/24405400 [=======================&gt;......] - ETA: 22s
20070400/24405400 [=======================&gt;......] - ETA: 22s
20103168/24405400 [=======================&gt;......] - ETA: 21s
20135936/24405400 [=======================&gt;......] - ETA: 21s
20168704/24405400 [=======================&gt;......] - ETA: 21s
20201472/24405400 [=======================&gt;......] - ETA: 21s
20234240/24405400 [=======================&gt;......] - ETA: 21s
20299776/24405400 [=======================&gt;......] - ETA: 20s
20332544/24405400 [=======================&gt;......] - ETA: 20s
20381696/24405400 [========================&gt;.....] - ETA: 20s
20414464/24405400 [========================&gt;.....] - ETA: 20s
20463616/24405400 [========================&gt;.....] - ETA: 19s
20496384/24405400 [========================&gt;.....] - ETA: 19s
20529152/24405400 [========================&gt;.....] - ETA: 19s
20561920/24405400 [========================&gt;.....] - ETA: 19s
20611072/24405400 [========================&gt;.....] - ETA: 18s
20643840/24405400 [========================&gt;.....] - ETA: 18s
20692992/24405400 [========================&gt;.....] - ETA: 18s
20742144/24405400 [========================&gt;.....] - ETA: 18s
20807680/24405400 [========================&gt;.....] - ETA: 17s
20856832/24405400 [========================&gt;.....] - ETA: 17s
20905984/24405400 [========================&gt;.....] - ETA: 17s
20955136/24405400 [========================&gt;.....] - ETA: 17s
21037056/24405400 [========================&gt;.....] - ETA: 16s
21086208/24405400 [========================&gt;.....] - ETA: 16s
21151744/24405400 [=========================&gt;....] - ETA: 15s
21200896/24405400 [=========================&gt;....] - ETA: 15s
21282816/24405400 [=========================&gt;....] - ETA: 15s
21364736/24405400 [=========================&gt;....] - ETA: 14s
21430272/24405400 [=========================&gt;....] - ETA: 14s
21512192/24405400 [=========================&gt;....] - ETA: 13s
21594112/24405400 [=========================&gt;....] - ETA: 13s
21676032/24405400 [=========================&gt;....] - ETA: 13s
21708800/24405400 [=========================&gt;....] - ETA: 12s
21807104/24405400 [=========================&gt;....] - ETA: 12s
21856256/24405400 [=========================&gt;....] - ETA: 12s
21921792/24405400 [=========================&gt;....] - ETA: 11s
21987328/24405400 [==========================&gt;...] - ETA: 11s
22052864/24405400 [==========================&gt;...] - ETA: 11s
22118400/24405400 [==========================&gt;...] - ETA: 10s
22200320/24405400 [==========================&gt;...] - ETA: 10s
22249472/24405400 [==========================&gt;...] - ETA: 10s
22298624/24405400 [==========================&gt;...] - ETA: 9s 
22364160/24405400 [==========================&gt;...] - ETA: 9s
22429696/24405400 [==========================&gt;...] - ETA: 9s
22495232/24405400 [==========================&gt;...] - ETA: 8s
22560768/24405400 [==========================&gt;...] - ETA: 8s
22642688/24405400 [==========================&gt;...] - ETA: 8s
22691840/24405400 [==========================&gt;...] - ETA: 7s
22790144/24405400 [===========================&gt;..] - ETA: 7s
22855680/24405400 [===========================&gt;..] - ETA: 7s
22937600/24405400 [===========================&gt;..] - ETA: 6s
23019520/24405400 [===========================&gt;..] - ETA: 6s
23101440/24405400 [===========================&gt;..] - ETA: 5s
23183360/24405400 [===========================&gt;..] - ETA: 5s
23232512/24405400 [===========================&gt;..] - ETA: 5s
23330816/24405400 [===========================&gt;..] - ETA: 4s
23379968/24405400 [===========================&gt;..] - ETA: 4s
23461888/24405400 [===========================&gt;..] - ETA: 4s
23527424/24405400 [===========================&gt;..] - ETA: 3s
23576576/24405400 [===========================&gt;..] - ETA: 3s
23625728/24405400 [============================&gt;.] - ETA: 3s
23674880/24405400 [============================&gt;.] - ETA: 3s
23724032/24405400 [============================&gt;.] - ETA: 3s
23789568/24405400 [============================&gt;.] - ETA: 2s
23855104/24405400 [============================&gt;.] - ETA: 2s
23887872/24405400 [============================&gt;.] - ETA: 2s
23953408/24405400 [============================&gt;.] - ETA: 2s
24002560/24405400 [============================&gt;.] - ETA: 1s
24068096/24405400 [============================&gt;.] - ETA: 1s
24133632/24405400 [============================&gt;.] - ETA: 1s
24199168/24405400 [============================&gt;.] - ETA: 0s
24248320/24405400 [============================&gt;.] - ETA: 0s
24330240/24405400 [============================&gt;.] - ETA: 0s
24395776/24405400 [============================&gt;.] - ETA: 0s
24405400/24405400 [==============================] - 107s 4us/step
Model: &quot;vit-tiny&quot;
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input (InputLayer)             [(None, 224, 224, 3  0           []
                                )]

 Rescale (QuantizedRescaling)   (None, 224, 224, 3)  0           [&#39;input[0][0]&#39;]

 Embedding (QuantizedConv2D)    (None, 14, 14, 192)  147648      [&#39;Rescale[0][0]&#39;]

 reshape (QuantizedReshape)     (None, 196, 192)     0           [&#39;Embedding[0][0]&#39;]

 ClassToken (QuantizedClassToke  (None, 197, 192)    192         [&#39;reshape[0][0]&#39;]
 n)

 Transformer/PosEmbed (Quantize  (None, 197, 192)    38208       [&#39;ClassToken[0][0]&#39;]
 dAddPositionEmbs)

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    768         [&#39;Transformer/PosEmbed[0][0]&#39;]
 erNorm_0 (QuantizedLayerNormal
 ization)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout (QuantizedDropout)     (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    384         [&#39;dropout[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/PosEmbed[0][0]&#39;]

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_0/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_0/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_1 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 192)    148032      [&#39;dropout_1[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_2 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_3 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    384         [&#39;dropout_3[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_0/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_1/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_1/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_4 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 192)    148032      [&#39;dropout_4[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_5 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_5[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_6 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    384         [&#39;dropout_6[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_1/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_2/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_2/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_7 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 192)    148032      [&#39;dropout_7[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_8 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_8[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_9 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    384         [&#39;dropout_9[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_2/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_3/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_3/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_10 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 192)    148032      [&#39;dropout_10[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_11 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_11[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_12 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    384         [&#39;dropout_12[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_3/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_4/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_4/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_13 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 192)    148032      [&#39;dropout_13[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_14 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_14[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_15 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    384         [&#39;dropout_15[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_4/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_5/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_5/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_16 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 192)    148032      [&#39;dropout_16[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_17 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_17[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_18 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    384         [&#39;dropout_18[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_5/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_6/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_6/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_19 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 192)    148032      [&#39;dropout_19[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_20 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_20[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_21 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    384         [&#39;dropout_21[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_6/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_7/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_7/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_22 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 192)    148032      [&#39;dropout_22[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_23 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_23[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_24 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    384         [&#39;dropout_24[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_7/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_8/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_8/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_25 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 192)    148032      [&#39;dropout_25[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_26 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_26[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_27 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    384         [&#39;dropout_27[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_8/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_9/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_9/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_9/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_28 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 192)    148032      [&#39;dropout_28[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_29 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_29[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_9/add_
 yerNorm_0 (QuantizedLayerNorma                                  2[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (QuantizedAttention)  ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (QuantizedDense)                                             tion[0][0]&#39;]

 dropout_30 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    384         [&#39;dropout_30[0][0]&#39;,
 d_1 (QuantizedAdd)                                               &#39;Transformer/EncoderBlock_9/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_2 (QuantizedLayerNorma                                  _1[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_10/Lay
 pBlock/Dense_0 (QuantizedDense                                  erNorm_2[0][0]&#39;]
 )

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_10/Mlp
 pBlock/activation (QuantizedRe                                  Block/Dense_0[0][0]&#39;]
 LU)

 dropout_31 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 192)    148032      [&#39;dropout_31[0][0]&#39;]
 pBlock/Dense_1 (QuantizedDense
 )

 dropout_32 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 d_2 (QuantizedAdd)                                              _1[0][0]&#39;,
                                                                  &#39;dropout_32[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_0 (QuantizedLayerNorma                                  _2[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (QuantizedAttention)  ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (QuantizedDense)                                             tion[0][0]&#39;]

 dropout_33 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    384         [&#39;dropout_33[0][0]&#39;,
 d_1 (QuantizedAdd)                                               &#39;Transformer/EncoderBlock_10/add
                                                                 _2[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_11/add
 yerNorm_2 (QuantizedLayerNorma                                  _1[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_11/Lay
 pBlock/Dense_0 (QuantizedDense                                  erNorm_2[0][0]&#39;]
 )

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_11/Mlp
 pBlock/activation (QuantizedRe                                  Block/Dense_0[0][0]&#39;]
 LU)

 dropout_34 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 192)    148032      [&#39;dropout_34[0][0]&#39;]
 pBlock/Dense_1 (QuantizedDense
 )

 dropout_35 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_11/add
 d_2 (QuantizedAdd)                                              _1[0][0]&#39;,
                                                                  &#39;dropout_35[0][0]&#39;]

 Transformer/EncoderNorm (Quant  (None, 197, 192)    1152        [&#39;Transformer/EncoderBlock_11/add
 izedBatchNormalization)                                         _2[0][0]&#39;]

 ExtractToken (QuantizedExtract  (None, 192)         0           [&#39;Transformer/EncoderNorm[0][0]&#39;]
 Token)

 Head (QuantizedDense)          (None, 1000)         193000      [&#39;ExtractToken[0][0]&#39;]

 dequantizer (Dequantizer)      (None, 1000)         0           [&#39;Head[0][0]&#39;]

==================================================================================================
Total params: 5,773,528
Trainable params: 5,717,800
Non-trainable params: 55,728
__________________________________________________________________________________________________
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 35s 35s/step
Keras accuracy: 100.00 %
</pre></div>
</div>
</section>
</section>
<section id="conversion-to-akida">
<h2>4. Conversion to Akida<a class="headerlink" href="#conversion-to-akida" title="Permalink to this headline"></a></h2>
<p>The quantized Keras model is now converted into an Akida model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">convert</span>

<span class="c1"># Convert the model</span>
<span class="n">model_akida</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
<span class="n">model_akida</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>                 Model Summary
________________________________________________
Input shape    Output shape  Sequences  Layers
================================================
[224, 224, 3]  [1, 1, 1000]  1          137
________________________________________________

___________________________________________________________________________________________________________________
Layer (type)                                                                      Output shape   Kernel shape

======================================= SW/Embedding-dequantizer (Software) =======================================

Embedding (Stem)                                                                  [1, 197, 192]  (16, 16, 3, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/LayerNorm_0 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/query (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/key (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/value (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/attention (Attention)  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/out (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/add_1 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/LayerNorm_2 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MlpBlock/Dense_0 (Dense2D)                            [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MlpBlock/Dense_1 (Dense2D)                            [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/add_2 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/LayerNorm_0 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/query (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/key (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/value (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/attention (Attention)  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/out (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/add_1 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/LayerNorm_2 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MlpBlock/Dense_0 (Dense2D)                            [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MlpBlock/Dense_1 (Dense2D)                            [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/add_2 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderNorm (BatchNormalization)                                      [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
ExtractToken (ExtractToken)                                                       [1, 1, 192]    N/A
___________________________________________________________________________________________________________________
Head (Dense2D)                                                                    [1, 1, 1000]   (192, 1000)
___________________________________________________________________________________________________________________
dequantizer (Dequantizer)                                                         [1, 1, 1000]   N/A
___________________________________________________________________________________________________________________
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_akida</span> <span class="o">=</span> <span class="n">model_akida</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">labels_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy_akida</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>

<span class="c1"># For non-regression purposes</span>
<span class="k">assert</span> <span class="n">accuracy_akida</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Accuracy: 100.00 %
</pre></div>
</div>
</section>
<section id="attention-maps">
<h2>5.3 Attention maps<a class="headerlink" href="#attention-maps" title="Permalink to this headline"></a></h2>
<p>Instead of showing predictions, here we propose to show attention maps on an image. This is
derived from <a class="reference external" href="https://arxiv.org/abs/2005.00928">Abnar et al. attention rollout</a> as shown in the
following <a class="reference external" href="https://keras.io/examples/vision/probing_vits/#method-ii-attention-rollout">Keras tutorial</a>. This aims to
highlight the model abilities to focus on relevant parts in the input image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">quantizeml.layers</span> <span class="kn">import</span> <span class="n">ClassToken</span><span class="p">,</span> <span class="n">Attention</span>
<span class="kn">from</span> <span class="nn">quantizeml.tensors</span> <span class="kn">import</span> <span class="n">FixedPoint</span>
<span class="kn">from</span> <span class="nn">quantizeml.models.transforms.transforms_utils</span> <span class="kn">import</span> <span class="n">get_layers_by_type</span>


<span class="k">def</span> <span class="nf">build_attention_map</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">image</span><span class="p">):</span>
    <span class="c1"># Get the Attention layers list</span>
    <span class="n">attentions</span> <span class="o">=</span> <span class="n">get_layers_by_type</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Attention</span><span class="p">)</span>

    <span class="c1"># Calculate the number of tokens and deduce the grid size</span>
    <span class="n">num_tokens</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ly</span><span class="p">,</span> <span class="n">ClassToken</span><span class="p">)</span> <span class="k">for</span> <span class="n">ly</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span>
    <span class="n">grid_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">attentions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">output_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">num_tokens</span><span class="p">))</span>

    <span class="c1"># Get the attention weights from each transformer</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">la</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">la</span> <span class="ow">in</span> <span class="n">attentions</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Converts to float if needed</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">FixedPoint</span><span class="p">)</span> <span class="k">else</span> <span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="c1"># Heads number</span>
    <span class="n">num_heads</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">num_layers</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">num_layers</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Average the attention weights across all heads</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># To account for residual connections, we add an identity matrix to the attention matrix and</span>
    <span class="c1"># re-normalize the weights.</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">reshaped</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span> <span class="o">/</span> <span class="n">reshaped</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

    <span class="c1"># Recursively multiply the weight matrices</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">reshaped</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">reshaped</span><span class="p">)):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">reshaped</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">n</span><span class="p">])</span>

    <span class="c1"># Attention from the output token to the input space</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">grid_size</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">mask</span> <span class="o">/</span> <span class="n">mask</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">mask</span> <span class="o">*</span> <span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>


<span class="c1"># Using a specific image for which attention map is easier to observe</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

<span class="c1"># Compute the attention map</span>
<span class="n">attention_float</span> <span class="o">=</span> <span class="n">build_attention_map</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
<span class="n">attention_quantized</span> <span class="o">=</span> <span class="n">build_attention_map</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>

<span class="c1"># Display the attention map</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Float&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">attention_float</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Quantized&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">attention_quantized</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Attention masks&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_7_vision_transformer_001.png" srcset="../../_images/sphx_glr_plot_7_vision_transformer_001.png" alt="Attention masks, Original, Float, Quantized" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 2s 2s/step

1/1 [==============================] - ETA: 0s
1/1 [==============================] - 33s 33s/step
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 5 minutes  41.518 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-general-plot-7-vision-transformer-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/eff8033b2bd356f7a111980b79134365/plot_7_vision_transformer.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_7_vision_transformer.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/05650343d25ad287b6cecb0e9a3a3ef5/plot_7_vision_transformer.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_7_vision_transformer.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_6_segmentation.html" class="btn btn-neutral float-left" title="Segmentation tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../quantization/plot_0_advanced_quantizeml.html" class="btn btn-neutral float-right" title="Advanced QuantizeML tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, BrainChip Holdings Ltd. All Rights Reserved.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>