<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vision transformers &mdash; Akida Examples  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Advanced QuantizeML tutorial" href="../quantization/plot_0_advanced_quantizeml.html" />
    <link rel="prev" title="Segmentation tutorial" href="plot_6_segmentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #989898" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/MetaTF_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Akida, 2nd Generation
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#supported-configurations">Supported configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#quick-installation">Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#running-examples">Running examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/user_guide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/akida.html">Akida user guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#programming-interface">Programming interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#the-akida-model">The Akida Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#akida-layers">Akida layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#model-hardware-mapping">Model Hardware Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#devices">Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#model-mapping">Model mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#advanced-mapping-details-and-hardware-devices-usage">Advanced Mapping Details and Hardware Devices Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#performance-measurement">Performance measurement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida.html#using-akida-edge-learning">Using Akida Edge learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#learning-constraints">Learning constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida.html#compiling-a-layer">Compiling a layer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quantizeml.html">QuantizeML toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#the-fixedpoint-representation">The FixedPoint representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#quantization-flow">Quantization flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#compatibility-constraints">Compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#model-loading">Model loading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#command-line-interface">Command line interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#quantize-cli">quantize CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#config-cli">config CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#check-cli">check CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/quantizeml.html#insert-rescaling-cli">insert_rescaling CLI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/quantizeml.html#supported-layer-types">Supported layer types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/cnn2snn.html">CNN2SNN toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#conversion-flow">Conversion flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#conversion-compatibility">Conversion compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#command-line-interface">Command-line interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#handling-akida-1-0-and-akida-2-0-specificities">Handling Akida 1.0 and Akida 2.0 specificities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/cnn2snn.html#legacy-quantization-api">Legacy quantization API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#typical-quantization-scenario">Typical quantization scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#design-compatibility-constraints">Design compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#id3">Command-line interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#layers-considerations">Layers Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/cnn2snn.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/akida_models.html">Akida models zoo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-creation">Command-line interface for model creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-training">Command-line interface for model training</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#kws-training">KWS training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/akida_models.html#akidanet-training">AkidaNet training</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-for-model-evaluation">Command-line interface for model evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#command-line-interface-to-evaluate-model-macs">Command-line interface to evaluate model MACS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#id1">Layer Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/akida_models.html#handling-akida-1-0-and-akida-2-0-specificities">Handling Akida 1.0 and Akida 2.0 specificities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hw_constraints.html">Hardware constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#inputconvolutional">InputConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#convolutional">Convolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#separableconvolutional">SeparableConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/hw_constraints.html#fullyconnected">FullyConnected</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/api_reference.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/akida_apis.html">Akida runtime</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#model">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#layer">Layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id1">Layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#mapping">Mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#akida-v1-layers">Akida V1 layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#akida-v2-layers">Akida V2 layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#layer-parameters">Layer parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#layertype">LayerType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#padding">Padding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#pooltype">PoolType</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#optimizers">Optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#sequence">Sequence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id2">Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#backendtype">BackendType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#pass">Pass</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#device">Device</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id3">Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#hwversion">HwVersion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#hwdevice">HWDevice</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#id4">HWDevice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#socdriver">SocDriver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#clockmode">ClockMode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#powermeter">PowerMeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#np">NP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_apis.html#tools">Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#sparsity">Sparsity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_apis.html#compatibility">Compatibility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html">CNN2SNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#akida-version">Akida version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#conversion">Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#legacy-quantization-api">Legacy quantization API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#utils">Utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#calibration">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#transforms">Transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#constraint">Constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantization">Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantizers">Quantizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/cnn2snn_apis.html#quantized-layers">Quantized layers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/quantizeml_apis.html">QuantizeML</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#layers">Layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#reshaping">Reshaping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#activations">Activations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#attention">Attention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#normalization">Normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#convolution">Convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#depthwise-convolution">Depthwise convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#separable-convolution">Separable convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#dense">Dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#skip-connection">Skip connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#pooling">Pooling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#shiftmax">Shiftmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#transformers">Transformers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#rescaling">Rescaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#dropout">Dropout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantizers">Quantizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantization-parameters">Quantization parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#calibration">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#recording">Recording</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#models">Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#transforms">Transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#quantization">Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#id1">Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#utils">Utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#tensors">Tensors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#qtensor">QTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#fixedpoint">FixedPoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/quantizeml_apis.html#qfloat">QFloat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api_reference/akida_models_apis.html">Akida models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#layer-blocks">Layer blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#cnn-blocks">CNN blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transformers-blocks">Transformers blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transposed-blocks">Transposed blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#detection-block">Detection block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#helpers">Helpers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#gamma-constraint">Gamma constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#unfusing-separableconvolutional">Unfusing SeparableConvolutional</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#extract-samples">Extract samples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#knowledge-distillation">Knowledge distillation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#macs">MACS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#model-i-o">Model I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#utils">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api_reference/akida_models_apis.html#model-zoo">Model zoo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#akidanet">AkidaNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#mobilenet">Mobilenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#ds-cnn">DS-CNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#vgg">VGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#yolo">YOLO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#pointnet">PointNet++</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#gxnor">GXNOR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#centernet">CenterNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#akidaunet">AkidaUNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api_reference/akida_models_apis.html#transformers">Transformers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#general-examples">General examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_0_global_workflow.html">Global Akida workflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#create-and-train">1. Create and train</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#quantize">2. Quantize</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#convert">3. Convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_0_global_workflow.html#gxnor-mnist">4. GXNOR/MNIST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_1_akidanet_imagenet.html">AkidaNet/ImageNet inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#pretrained-quantized-model">2. Pretrained quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#conversion-to-akida">3. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_1_akidanet_imagenet.html#hardware-mapping-and-performance">4. Hardware mapping and performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_2_ds_cnn_kws.html">DS-CNN/KWS inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-the-preprocessed-dataset">1. Load the preprocessed dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_2_ds_cnn_kws.html#confusion-matrix">5. Confusion matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_3_regression.html">Age estimation (regression) example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-the-utkface-dataset">1. Load the UTKFace Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_3_regression.html#estimate-age-on-a-single-image">5. Estimate age on a single image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_4_transfer_learning.html">Transfer learning with AkidaNet for PlantVillage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#transfer-learning-process">Transfer learning process</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#get-a-trained-akidanet-base-model">2. Get a trained AkidaNet base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#add-a-classification-head-to-the-model">3. Add a classification head to the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#freeze-the-base-model">4. Freeze the base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#train-for-a-few-epochs">5. Train for a few epochs</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#quantize-the-model">6. Quantize the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_4_transfer_learning.html#compute-accuracy">7. Compute accuracy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_5_voc_yolo_detection.html">YOLO/PASCAL-VOC detection tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#introduction">1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#preprocessing-tools">2. Preprocessing tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#model-architecture">3. Model architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#training">4. Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#performance">5. Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_5_voc_yolo_detection.html#conversion-to-akida">6. Conversion to Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_6_segmentation.html">Segmentation tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-the-dataset">1. Load the dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#load-a-pre-trained-quantized-keras-model">3. Load a pre-trained quantized Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_6_segmentation.html#segment-a-single-image">5. Segment a single image</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Vision transformers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-a-transformer-model">2. Create a transformer model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quantization">3. Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attention-maps">5.3 Attention maps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#quantization">Quantization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html">Advanced QuantizeML tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html#defining-a-quantization-scheme">1. Defining a quantization scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_0_advanced_quantizeml.html#calibration">2. Calibration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html">Upgrading to Akida 2.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#workflow-differences">1. Workflow differences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#models-architecture-differences">2. Models architecture differences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantization/plot_1_upgrading_to_2.0.html#using-akidaversion">3. Using <code class="docutils literal notranslate"><span class="pre">AkidaVersion</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#edge-examples">Edge examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html">Akida vision edge learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#prepare-akida-model-for-learning">2. Prepare Akida model for learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_0_edge_learning_vision.html#edge-learning-with-akida">3. Edge learning with Akida</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html">Akida edge learning for keyword spotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#edge-learning-process">1. Edge learning process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#dataset-preparation">2. Dataset preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#prepare-akida-model-for-learning">3. Prepare Akida model for learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#learn-with-akida-using-the-training-set">4. Learn with Akida using the training set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_1_edge_learning_kws.html#edge-learning">5. Edge learning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html">Tips to set Akida learning parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#akida-learning-parameters">1. Akida learning parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#create-akida-model">2. Create Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#estimate-the-required-number-of-weights-of-the-trainable-layer">3. Estimate the required number of weights of the trainable layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../edge/plot_2_edge_learning_parameters.html#estimate-the-number-of-neurons-per-class">4. Estimate the number of neurons per class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#deprecated-cnn2snn-tutorials">[Deprecated] CNN2SNN tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html">Advanced CNN2SNN tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#design-a-cnn2snn-quantized-model">1. Design a CNN2SNN quantized model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#weight-quantizer-details">2. Weight Quantizer Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#understanding-quantized-activation">3. Understanding quantized activation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cnn2snn/plot_1_advanced_cnn2snn.html#how-to-deal-with-too-high-scale-factors">4. How to deal with too high scale factors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../model_zoo_performance.html">Model zoo performance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../model_zoo_performance.html#akida-1-0-models">Akida 1.0 models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#image-icon-ref-image-domain"> Image domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#classification">Classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#object-detection">Object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#regression">Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#face-recognition">Face recognition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#audio-icon-ref-audio-domain"> Audio domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#keyword-spotting">Keyword spotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#pointcloud-icon-ref-point-cloud"> Point cloud</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id1">Classification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../model_zoo_performance.html#akida-2-0-models">Akida 2.0 models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id2"> Image domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id3">Classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id6">Object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id7">Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id8">Face recognition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#segmentation">Segmentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id10"> Audio domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id11">Keyword spotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../model_zoo_performance.html#id12"> Point cloud</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../model_zoo_performance.html#id13">Classification</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://support.brainchip.com/portal/home">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #989898" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Akida Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Akida examples</a></li>
      <li class="breadcrumb-item active">Vision transformers</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-general-plot-7-vision-transformer-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="vision-transformers">
<span id="sphx-glr-examples-general-plot-7-vision-transformer-py"></span><h1>Vision transformers<a class="headerlink" href="#vision-transformers" title="Permalink to this headline"></a></h1>
<p>This tutorial demonstrates that Vision Transformers can be adapted and converted to Akida to perform
image classification.</p>
<p>Just like for the <a class="reference external" href="plot_1_akidanet_imagenet.html#sphx-glr-examples-general-plot-1-akidanet-imagenet-py">AkidaNet example</a>, ImageNet
images are not publicly available, performance is assessed using a set of 10 copyright free images
that were found on Google using ImageNet class names.</p>
<section id="dataset-preparation">
<h2>1. Dataset preparation<a class="headerlink" href="#dataset-preparation" title="Permalink to this headline"></a></h2>
<p>See <a class="reference external" href="plot_1_akidanet_imagenet.html#sphx-glr-examples-general-plot-1-akidanet-imagenet-py">AkidaNet example</a> for
details on dataset preparation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">tensorflow.io</span> <span class="kn">import</span> <span class="n">read_file</span>
<span class="kn">from</span> <span class="nn">tensorflow.image</span> <span class="kn">import</span> <span class="n">decode_jpeg</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">get_file</span>

<span class="kn">from</span> <span class="nn">akida_models.imagenet</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="c1"># Model specification and hyperparameters</span>
<span class="n">NUM_CHANNELS</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">IMAGE_SIZE</span> <span class="o">=</span> <span class="mi">224</span>

<span class="n">NUM_IMAGES</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Retrieve dataset file from Brainchip data server</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span>
    <span class="s2">&quot;imagenet_like.zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://data.brainchip.com/dataset-mirror/imagenet_like/imagenet_like.zip&quot;</span><span class="p">,</span>
    <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;datasets/imagenet_like&#39;</span><span class="p">,</span>
    <span class="n">extract</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># Load images for test set</span>
<span class="n">x_test_files</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NUM_IMAGES</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">,</span> <span class="n">NUM_CHANNELS</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">):</span>
    <span class="n">test_file</span> <span class="o">=</span> <span class="s1">&#39;image_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span>
    <span class="n">x_test_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
    <span class="n">img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">test_file</span><span class="p">)</span>
    <span class="n">base_image</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">decode_jpeg</span><span class="p">(</span><span class="n">base_image</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="n">NUM_CHANNELS</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">preprocess_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">IMAGE_SIZE</span><span class="p">)</span>
    <span class="n">x_test</span><span class="p">[</span><span class="nb">id</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">NUM_IMAGES</span><span class="si">}</span><span class="s1"> images loaded and preprocessed.&#39;</span><span class="p">)</span>

<span class="c1"># Parse labels file</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="s1">&#39;labels_validation.txt&#39;</span><span class="p">)</span>
<span class="n">validation_labels</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="n">validation_labels</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Get labels for the test set by index</span>
<span class="n">labels_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_IMAGES</span><span class="p">):</span>
    <span class="n">labels_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">validation_labels</span><span class="p">[</span><span class="n">x_test_files</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>10 images loaded and preprocessed.
</pre></div>
</div>
</section>
<section id="create-a-transformer-model">
<h2>2. Create a transformer model<a class="headerlink" href="#create-a-transformer-model" title="Permalink to this headline"></a></h2>
<section id="selecting-an-architecture">
<h3>2.1. Selecting an architecture<a class="headerlink" href="#selecting-an-architecture" title="Permalink to this headline"></a></h3>
<p>Vision Transformers is a hot-topic in AI and new architectures are being introduced regularly.
When selecting an appropriate achitecture for Akida, some size, speed and training capabilities
must be considered.</p>
<p>The following table briefly shows what led to chose the ViT Tiny and DeiT-dist architectures:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 23%" />
<col style="width: 11%" />
<col style="width: 23%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Architecture</p></th>
<th class="head"><p>Original accuracy</p></th>
<th class="head"><p>#Params</p></th>
<th class="head"><p>Architecture</p></th>
<th class="head"><p>Commment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ViT Base</p></td>
<td><p>79.90%</p></td>
<td><p>86M</p></td>
<td><p>12 heads,
12 blocks,
hidden size 768</p></td>
<td><p>base model but huge
amount of parameters</p></td>
</tr>
<tr class="row-odd"><td><p>ViT Tiny</p></td>
<td><p>75.48%</p></td>
<td><p>5.8M</p></td>
<td><p>3 heads,
12 blocks,
hidden size 192</p></td>
<td><p>edge compatible</p></td>
</tr>
<tr class="row-even"><td><p>DeiT-dist
Tiny</p></td>
<td><p>74.17%</p></td>
<td><p>5.8M</p></td>
<td><p>3 heads,
12 blocks,
hidden size 192</p></td>
<td><p>easy to retrain
thanks to the
distilled token</p></td>
</tr>
</tbody>
</table>
<p>The model zoo then comes with two vision transformers architectures:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_vit_ti16">BC ViT Ti16</a>, which
is a modified version of <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.vit_ti16">ViT TI16</a> described in <a class="reference external" href="https://arxiv.org/abs/2010.11929">the
original ViT paper</a>,</p></li>
<li><p><a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_deit_ti16">BC DeiT-dist Ti16</a>,
which is a modified version of the original <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.deit_ti16">DeiT TI16</a> described in <a class="reference external" href="https://arxiv.org/abs/2012.12877">the
original DeiT-dist paper</a>.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Vision Transformers support has been introduced in Akida 2.0.</p>
</div>
</section>
<section id="model-transformations">
<h3>2.2. Model transformations<a class="headerlink" href="#model-transformations" title="Permalink to this headline"></a></h3>
<p>Both architectures have been modified so that their layers can be quantized to integer only
operations. The detailed list of changes is:</p>
<blockquote>
<div><ul class="simple">
<li><p>replace <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/LayerNormalization">LayerNormalization</a> with
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.LayerMadNormalization">LayerMadNormalization</a> and
replace the last normalization previous to the classification head with a <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization">BatchNormalization</a>,</p></li>
<li><p>replace <a class="reference external" href="https://www.tensorflow.org/addons/api_docs/python/tfa/layers/GELU">GeLU</a>
activations with <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/ReLU">ReLU8</a>,</p></li>
<li><p>replace the <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/activations/softmax">softmax</a> operation in
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.Attention">Attention</a> with a
<a class="reference external" href="../../api_reference/quantizeml_apis.html#quantizeml.layers.shiftmax">shiftmax</a> operation.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Details on the custom layers and operations are given in the API docstrings.</p>
</div>
<p>Layer replacement is made possible through the <code class="docutils literal notranslate"><span class="pre">akida_models</span> <span class="pre">create</span></code> CLI that comes with
dedicated options for the <code class="docutils literal notranslate"><span class="pre">vit_ti16</span></code> and <code class="docutils literal notranslate"><span class="pre">deit_ti16</span></code> architectures. See for example the helper
for ViT:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>akida_models<span class="w"> </span>create<span class="w"> </span>vit_ti16<span class="w"> </span>-h
usage:<span class="w"> </span>akida_models<span class="w"> </span>create<span class="w"> </span>vit_ti16<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>-c<span class="w"> </span>CLASSES<span class="o">]</span><span class="w"> </span><span class="o">[</span>-bw<span class="w"> </span>BASE_WEIGHTS<span class="o">]</span><span class="w"> </span><span class="o">[</span>--norm<span class="w"> </span><span class="o">{</span>LN,GN1,BN,LMN<span class="o">}]</span>
<span class="w">                                    </span><span class="o">[</span>--last_norm<span class="w"> </span><span class="o">{</span>LN,BN<span class="o">}]</span><span class="w"> </span><span class="o">[</span>--softmax<span class="w"> </span><span class="o">{</span>softmax,softmax2<span class="o">}]</span>
<span class="w">                                    </span><span class="o">[</span>--act<span class="w"> </span><span class="o">{</span>GeLU,ReLU8,swish<span class="o">}]</span><span class="w"> </span><span class="o">[</span>-i<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}]</span>

optional<span class="w"> </span>arguments:
<span class="w">  </span>-h,<span class="w"> </span>--help<span class="w">            </span>show<span class="w"> </span>this<span class="w"> </span><span class="nb">help</span><span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span>
<span class="w">  </span>-c<span class="w"> </span>CLASSES,<span class="w"> </span>--classes<span class="w"> </span>CLASSES
<span class="w">                        </span>The<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>classes,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span><span class="m">1000</span>.
<span class="w">  </span>-bw<span class="w"> </span>BASE_WEIGHTS,<span class="w"> </span>--base_weights<span class="w"> </span>BASE_WEIGHTS
<span class="w">                        </span>Optional<span class="w"> </span>keras<span class="w"> </span>weights<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>model,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>None.
<span class="w">  </span>--norm<span class="w"> </span><span class="o">{</span>LN,GN1,BN,LMN<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>normalization<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>LN
<span class="w">  </span>--last_norm<span class="w"> </span><span class="o">{</span>LN,BN<span class="o">}</span><span class="w">   </span>Replace<span class="w"> </span>last<span class="w"> </span>normalization<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>LN
<span class="w">  </span>--softmax<span class="w"> </span><span class="o">{</span>softmax,softmax2<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>softmax<span class="w"> </span>operation<span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>softmax
<span class="w">  </span>--act<span class="w"> </span><span class="o">{</span>GeLU,ReLU8,swish<span class="o">}</span>
<span class="w">                        </span>Replace<span class="w"> </span>activation<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>model<span class="w"> </span>with<span class="w"> </span>custom<span class="w"> </span><span class="k">function</span>,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>GeLU
<span class="w">  </span>-i<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}</span>,<span class="w"> </span>--image_size<span class="w"> </span><span class="o">{</span><span class="m">224</span>,384<span class="o">}</span>
<span class="w">                        </span>The<span class="w"> </span>square<span class="w"> </span>input<span class="w"> </span>image<span class="w"> </span>size
</pre></div>
</div>
<p>The replacement layers are functionaly equivalent to the base layers but an accuracy loss is
introduced at each step. This is compensated by a tuning step after each change.</p>
<p>For example, replacing activations layers can be done with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://data.brainchip.com/models/AkidaV2/vit/vit_ti16_224.h5
akida_models<span class="w"> </span>create<span class="w"> </span>-s<span class="w"> </span>vit_ti16_relu.h5<span class="w"> </span>vit_ti16<span class="w"> </span>-bw<span class="w"> </span>vit_ti16_224.h5<span class="w"> </span>--act<span class="w"> </span>ReLU8
imagenet_train<span class="w"> </span>tune<span class="w"> </span>-m<span class="w"> </span>vit_ti16_relu.h5<span class="w"> </span>-e<span class="w"> </span><span class="m">15</span><span class="w"> </span>--optim<span class="w"> </span>Adam<span class="w"> </span>--lr_policy<span class="w"> </span>cosine_decay<span class="w"> </span><span class="se">\</span>
<span class="w">                    </span>-lr<span class="w"> </span>6e-5<span class="w"> </span>-s<span class="w"> </span>vit_ti16_relu_tuned.h5
</pre></div>
</div>
<p>After all changes, the model accuracy is close to (or better than) the original model and the
“BC” transformer model is ready for quantization.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 40%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Architecture</p></th>
<th class="head"><p>Original accuracy</p></th>
<th class="head"><p>“BC” accuracy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ViT</p></td>
<td><p>75.48%</p></td>
<td><p>74.25%</p></td>
</tr>
<tr class="row-odd"><td><p>DeiT-dist</p></td>
<td><p>74.17%</p></td>
<td><p>75.03%</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the following sections, the ViT model will be used but the very same steps apply to
DeiT-dist.</p>
</div>
</section>
<section id="load-a-pre-trained-native-keras-model">
<h3>2.3. Load a pre-trained native Keras model<a class="headerlink" href="#load-a-pre-trained-native-keras-model" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models.model_io</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="c1"># Retrieve the float model with pretrained weights and load it</span>
<span class="n">model_file</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span>
    <span class="s2">&quot;bc_vit_ti16_224.h5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224.h5&quot;</span><span class="p">,</span>
    <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;models/akidanet_imagenet&#39;</span><span class="p">)</span>
<span class="n">model_keras</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">model_file</span><span class="p">)</span>
<span class="n">model_keras</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224.h5

    8192/23695632 [..............................] - ETA: 0s
   98304/23695632 [..............................] - ETA: 14s
  376832/23695632 [..............................] - ETA: 7s 
  901120/23695632 [&gt;.............................] - ETA: 4s
 1253376/23695632 [&gt;.............................] - ETA: 3s
 1646592/23695632 [=&gt;............................] - ETA: 3s
 1998848/23695632 [=&gt;............................] - ETA: 3s
 2359296/23695632 [=&gt;............................] - ETA: 3s
 2744320/23695632 [==&gt;...........................] - ETA: 3s
 3129344/23695632 [==&gt;...........................] - ETA: 3s
 3506176/23695632 [===&gt;..........................] - ETA: 3s
 3907584/23695632 [===&gt;..........................] - ETA: 2s
 4300800/23695632 [====&gt;.........................] - ETA: 2s
 4694016/23695632 [====&gt;.........................] - ETA: 2s
 5103616/23695632 [=====&gt;........................] - ETA: 2s
 5513216/23695632 [=====&gt;........................] - ETA: 2s
 5922816/23695632 [======&gt;.......................] - ETA: 2s
 6348800/23695632 [=======&gt;......................] - ETA: 2s
 6758400/23695632 [=======&gt;......................] - ETA: 2s
 7184384/23695632 [========&gt;.....................] - ETA: 2s
 7593984/23695632 [========&gt;.....................] - ETA: 2s
 8036352/23695632 [=========&gt;....................] - ETA: 2s
 8478720/23695632 [=========&gt;....................] - ETA: 2s
 8888320/23695632 [==========&gt;...................] - ETA: 1s
 9330688/23695632 [==========&gt;...................] - ETA: 1s
 9789440/23695632 [===========&gt;..................] - ETA: 1s
10231808/23695632 [===========&gt;..................] - ETA: 1s
10674176/23695632 [============&gt;.................] - ETA: 1s
11132928/23695632 [=============&gt;................] - ETA: 1s
11608064/23695632 [=============&gt;................] - ETA: 1s
12066816/23695632 [==============&gt;...............] - ETA: 1s
12541952/23695632 [==============&gt;...............] - ETA: 1s
13017088/23695632 [===============&gt;..............] - ETA: 1s
13492224/23695632 [================&gt;.............] - ETA: 1s
13983744/23695632 [================&gt;.............] - ETA: 1s
14475264/23695632 [=================&gt;............] - ETA: 1s
14966784/23695632 [=================&gt;............] - ETA: 1s
15441920/23695632 [==================&gt;...........] - ETA: 1s
15917056/23695632 [===================&gt;..........] - ETA: 0s
16424960/23695632 [===================&gt;..........] - ETA: 0s
16932864/23695632 [====================&gt;.........] - ETA: 0s
17440768/23695632 [=====================&gt;........] - ETA: 0s
17965056/23695632 [=====================&gt;........] - ETA: 0s
18489344/23695632 [======================&gt;.......] - ETA: 0s
18997248/23695632 [=======================&gt;......] - ETA: 0s
19521536/23695632 [=======================&gt;......] - ETA: 0s
20045824/23695632 [========================&gt;.....] - ETA: 0s
20570112/23695632 [=========================&gt;....] - ETA: 0s
21110784/23695632 [=========================&gt;....] - ETA: 0s
21602304/23695632 [==========================&gt;...] - ETA: 0s
22134784/23695632 [===========================&gt;..] - ETA: 0s
22683648/23695632 [===========================&gt;..] - ETA: 0s
23240704/23695632 [============================&gt;.] - ETA: 0s
23695632/23695632 [==============================] - 3s 0us/step
/usr/local/lib/python3.8/dist-packages/keras/initializers/initializers.py:120: UserWarning: The initializer TruncatedNormal is unseeded and being called multiple times, which will return identical values each time (even if the initializer is unseeded). Please update your code to provide a seed to the initializer, or avoid using the same initalizer instance more than once.
  warnings.warn(
Model: &quot;vit-tiny&quot;
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input (InputLayer)             [(None, 224, 224, 3  0           []
                                )]

 Rescale (Rescaling)            (None, 224, 224, 3)  0           [&#39;input[0][0]&#39;]

 Embedding (Conv2D)             (None, 14, 14, 192)  147648      [&#39;Rescale[0][0]&#39;]

 reshape (Reshape)              (None, 196, 192)     0           [&#39;Embedding[0][0]&#39;]

 ClassToken (ClassToken)        (None, 197, 192)     192         [&#39;reshape[0][0]&#39;]

 Transformer/PosEmbed (AddPosit  (None, 197, 192)    37824       [&#39;ClassToken[0][0]&#39;]
 ionEmbs)

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    384         [&#39;Transformer/PosEmbed[0][0]&#39;]
 erNorm_0 (LayerMadNormalizatio
 n)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_0/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout (Dropout)              (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    0           [&#39;dropout[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/PosEmbed[0][0]&#39;]

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_0/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_0/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_1 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 192)    147648      [&#39;dropout_1[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_2 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_0/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_1/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_3 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    0           [&#39;dropout_3[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_0/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_1/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_1/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_4 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 192)    147648      [&#39;dropout_4[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_5 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_1/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_5[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_2/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_6 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    0           [&#39;dropout_6[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_1/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_2/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_2/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_7 (Dropout)            (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 192)    147648      [&#39;dropout_7[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_8 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_2/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_8[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_3/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_9 (Dropout)            (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    0           [&#39;dropout_9[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_2/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_3/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_3/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_10 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 192)    147648      [&#39;dropout_10[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_11 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_3/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_11[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_4/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_12 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    0           [&#39;dropout_12[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_3/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_4/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_4/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_13 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 192)    147648      [&#39;dropout_13[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_14 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_4/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_14[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_5/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_15 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    0           [&#39;dropout_15[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_4/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_5/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_5/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_16 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 192)    147648      [&#39;dropout_16[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_17 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_5/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_17[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_6/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_18 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    0           [&#39;dropout_18[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_5/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_6/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_6/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_19 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 192)    147648      [&#39;dropout_19[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_20 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_6/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_20[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_7/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_21 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    0           [&#39;dropout_21[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_6/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_7/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_7/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_22 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 192)    147648      [&#39;dropout_22[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_23 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_7/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_23[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_8/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_24 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    0           [&#39;dropout_24[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_7/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_8/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_8/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_25 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 192)    147648      [&#39;dropout_25[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_26 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_8/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_26[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_0 (LayerMadNormalizatio                                  2[0][0]&#39;]
 n)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (Dense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (Dense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (Dense)

 Transformer/EncoderBlock_9/Mul  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (Attention)            ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (Dense)                                                       ion[0][0]&#39;]

 dropout_27 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    0           [&#39;dropout_27[0][0]&#39;,
 _1 (Add)                                                         &#39;Transformer/EncoderBlock_8/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 erNorm_2 (LayerMadNormalizatio                                  1[0][0]&#39;]
 n)

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_9/Laye
 Block/Dense_0 (Dense)                                           rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_9/MlpB
 Block/activation (ReLU)                                         lock/Dense_0[0][0]&#39;]

 dropout_28 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 192)    147648      [&#39;dropout_28[0][0]&#39;]
 Block/Dense_1 (Dense)

 dropout_29 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_9/add_
 _2 (Add)                                                        1[0][0]&#39;,
                                                                  &#39;dropout_29[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 yerNorm_0 (LayerMadNormalizati                                  2[0][0]&#39;]
 on)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (Dense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (Dense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (Dense)

 Transformer/EncoderBlock_10/Mu  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (Attention)           ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (Dense)                                                      tion[0][0]&#39;]

 dropout_30 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    0           [&#39;dropout_30[0][0]&#39;,
 d_1 (Add)                                                        &#39;Transformer/EncoderBlock_9/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_2 (LayerMadNormalizati                                  _1[0][0]&#39;]
 on)

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_10/Lay
 pBlock/Dense_0 (Dense)                                          erNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_10/Mlp
 pBlock/activation (ReLU)                                        Block/Dense_0[0][0]&#39;]

 dropout_31 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 192)    147648      [&#39;dropout_31[0][0]&#39;]
 pBlock/Dense_1 (Dense)

 dropout_32 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_10/add
 d_2 (Add)                                                       _1[0][0]&#39;,
                                                                  &#39;dropout_32[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_0 (LayerMadNormalizati                                  _2[0][0]&#39;]
 on)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (Dense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (Dense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (Dense)

 Transformer/EncoderBlock_11/Mu  ((None, 197, 192),  0           [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (Attention)           ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37056       [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (Dense)                                                      tion[0][0]&#39;]

 dropout_33 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;dropout_33[0][0]&#39;,
 d_1 (Add)                                                        &#39;Transformer/EncoderBlock_10/add
                                                                 _2[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_11/add
 yerNorm_2 (LayerMadNormalizati                                  _1[0][0]&#39;]
 on)

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_11/Lay
 pBlock/Dense_0 (Dense)                                          erNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    0           [&#39;Transformer/EncoderBlock_11/Mlp
 pBlock/activation (ReLU)                                        Block/Dense_0[0][0]&#39;]

 dropout_34 (Dropout)           (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 192)    147648      [&#39;dropout_34[0][0]&#39;]
 pBlock/Dense_1 (Dense)

 dropout_35 (Dropout)           (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_11/add
 d_2 (Add)                                                       _1[0][0]&#39;,
                                                                  &#39;dropout_35[0][0]&#39;]

 Transformer/EncoderNorm (Batch  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_11/add
 Normalization)                                                  _2[0][0]&#39;]

 ExtractToken (ExtractToken)    (None, 192)          0           [&#39;Transformer/EncoderNorm[0][0]&#39;]

 Head (Dense)                   (None, 1000)         193000      [&#39;ExtractToken[0][0]&#39;]

==================================================================================================
Total params: 5,717,800
Trainable params: 5,717,416
Non-trainable params: 384
__________________________________________________________________________________________________
</pre></div>
</div>
<p>The perfomance given below uses the 10 ImageNet like images subset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check model performance</span>
<span class="k">def</span> <span class="nf">check_model_performance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_test</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">labels_test</span><span class="o">=</span><span class="n">labels_test</span><span class="p">):</span>
    <span class="n">outputs_keras</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">NUM_IMAGES</span><span class="p">)</span>
    <span class="n">outputs_keras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">outputs_keras</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">accuracy_keras</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">outputs_keras</span><span class="p">,</span> <span class="n">labels_test</span><span class="p">))</span> <span class="o">/</span> <span class="n">NUM_IMAGES</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Keras accuracy: </span><span class="si">{</span><span class="n">accuracy_keras</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_keras</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 1s 1s/step
Keras accuracy: 100.00 %
</pre></div>
</div>
</section>
</section>
<section id="quantization">
<h2>3. Quantization<a class="headerlink" href="#quantization" title="Permalink to this headline"></a></h2>
<section id="bit-ptq">
<h3>3.1. 8-bit PTQ<a class="headerlink" href="#bit-ptq" title="Permalink to this headline"></a></h3>
<p>The above native Keras model is quantized to 8-bit (all weights and activations) and we compute
the post-training quantization (PTQ) accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">fetch_file</span>

<span class="c1"># Retrieve calibration samples</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">fetch_file</span><span class="p">(</span><span class="s2">&quot;https://data.brainchip.com/dataset-mirror/samples/imagenet/imagenet_batch1024_224.npz&quot;</span><span class="p">,</span>
                     <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;imagenet_batch1024_224.npz&quot;</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">samples</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">samples</span><span class="o">.</span><span class="n">files</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/dataset-mirror/samples/imagenet/imagenet_batch1024_224.npz.

        0/616562950 [..............................] - ETA: 0s
    98304/616562950 [..............................] - ETA: 6:32
   344064/616562950 [..............................] - ETA: 4:32
  1081344/616562950 [..............................] - ETA: 2:01
  1712128/616562950 [..............................] - ETA: 1:35
  1835008/616562950 [..............................] - ETA: 1:45
  2293760/616562950 [..............................] - ETA: 1:38
  2596864/616562950 [..............................] - ETA: 1:38
  2867200/616562950 [..............................] - ETA: 1:40
  3153920/616562950 [..............................] - ETA: 1:41
  3448832/616562950 [..............................] - ETA: 1:41
  3686400/616562950 [..............................] - ETA: 1:49
  3981312/616562950 [..............................] - ETA: 1:50
  4145152/616562950 [..............................] - ETA: 1:53
  4308992/616562950 [..............................] - ETA: 1:57
  4489216/616562950 [..............................] - ETA: 1:59
  4653056/616562950 [..............................] - ETA: 2:02
  4849664/616562950 [..............................] - ETA: 2:04
  5013504/616562950 [..............................] - ETA: 2:06
  5210112/616562950 [..............................] - ETA: 2:07
  5406720/616562950 [..............................] - ETA: 2:09
  5586944/616562950 [..............................] - ETA: 2:10
  5799936/616562950 [..............................] - ETA: 2:11
  5996544/616562950 [..............................] - ETA: 2:12
  6225920/616562950 [..............................] - ETA: 2:13
  6438912/616562950 [..............................] - ETA: 2:13
  6651904/616562950 [..............................] - ETA: 2:14
  6881280/616562950 [..............................] - ETA: 2:14
  7110656/616562950 [..............................] - ETA: 2:14
  7340032/616562950 [..............................] - ETA: 2:14
  7585792/616562950 [..............................] - ETA: 2:14
  7831552/616562950 [..............................] - ETA: 2:14
  8077312/616562950 [..............................] - ETA: 2:14
  8323072/616562950 [..............................] - ETA: 2:14
  8601600/616562950 [..............................] - ETA: 2:13
  8863744/616562950 [..............................] - ETA: 2:13
  9125888/616562950 [..............................] - ETA: 2:13
  9404416/616562950 [..............................] - ETA: 2:12
  9682944/616562950 [..............................] - ETA: 2:12
  9961472/616562950 [..............................] - ETA: 2:11
 10240000/616562950 [..............................] - ETA: 2:11
 10534912/616562950 [..............................] - ETA: 2:10
 10829824/616562950 [..............................] - ETA: 2:09
 11124736/616562950 [..............................] - ETA: 2:09
 11419648/616562950 [..............................] - ETA: 2:08
 11698176/616562950 [..............................] - ETA: 2:08
 12009472/616562950 [..............................] - ETA: 2:07
 12320768/616562950 [..............................] - ETA: 2:06
 12615680/616562950 [..............................] - ETA: 2:05
 12910592/616562950 [..............................] - ETA: 2:05
 13254656/616562950 [..............................] - ETA: 2:04
 13565952/616562950 [..............................] - ETA: 2:03
 13893632/616562950 [..............................] - ETA: 2:03
 14221312/616562950 [..............................] - ETA: 2:02
 14532608/616562950 [..............................] - ETA: 2:01
 14663680/616562950 [..............................] - ETA: 2:03
 14909440/616562950 [..............................] - ETA: 2:03
 15204352/616562950 [..............................] - ETA: 2:02
 15368192/616562950 [..............................] - ETA: 2:03
 15564800/616562950 [..............................] - ETA: 2:04
 15745024/616562950 [..............................] - ETA: 2:04
 15941632/616562950 [..............................] - ETA: 2:05
 16138240/616562950 [..............................] - ETA: 2:05
 16351232/616562950 [..............................] - ETA: 2:05
 16531456/616562950 [..............................] - ETA: 2:06
 16760832/616562950 [..............................] - ETA: 2:06
 16957440/616562950 [..............................] - ETA: 2:06
 17137664/616562950 [..............................] - ETA: 2:07
 17399808/616562950 [..............................] - ETA: 2:07
 17596416/616562950 [..............................] - ETA: 2:07
 17858560/616562950 [..............................] - ETA: 2:07
 18071552/616562950 [..............................] - ETA: 2:07
 18350080/616562950 [..............................] - ETA: 2:07
 18579456/616562950 [..............................] - ETA: 2:07
 18857984/616562950 [..............................] - ETA: 2:07
 19087360/616562950 [..............................] - ETA: 2:07
 19349504/616562950 [..............................] - ETA: 2:07
 19611648/616562950 [..............................] - ETA: 2:07
 19890176/616562950 [..............................] - ETA: 2:07
 20152320/616562950 [..............................] - ETA: 2:06
 20430848/616562950 [..............................] - ETA: 2:06
 20709376/616562950 [&gt;.............................] - ETA: 2:06
 20971520/616562950 [&gt;.............................] - ETA: 2:06
 21266432/616562950 [&gt;.............................] - ETA: 2:05
 21544960/616562950 [&gt;.............................] - ETA: 2:05
 21839872/616562950 [&gt;.............................] - ETA: 2:05
 22151168/616562950 [&gt;.............................] - ETA: 2:04
 22446080/616562950 [&gt;.............................] - ETA: 2:04
 22773760/616562950 [&gt;.............................] - ETA: 2:04
 23068672/616562950 [&gt;.............................] - ETA: 2:03
 23396352/616562950 [&gt;.............................] - ETA: 2:03
 23674880/616562950 [&gt;.............................] - ETA: 2:03
 23969792/616562950 [&gt;.............................] - ETA: 2:04
 24264704/616562950 [&gt;.............................] - ETA: 2:04
 24444928/616562950 [&gt;.............................] - ETA: 2:04
 24608768/616562950 [&gt;.............................] - ETA: 2:04
 24788992/616562950 [&gt;.............................] - ETA: 2:05
 24952832/616562950 [&gt;.............................] - ETA: 2:05
 25149440/616562950 [&gt;.............................] - ETA: 2:05
 25329664/616562950 [&gt;.............................] - ETA: 2:06
 25542656/616562950 [&gt;.............................] - ETA: 2:06
 25722880/616562950 [&gt;.............................] - ETA: 2:06
 25935872/616562950 [&gt;.............................] - ETA: 2:06
 26132480/616562950 [&gt;.............................] - ETA: 2:06
 26345472/616562950 [&gt;.............................] - ETA: 2:06
 26558464/616562950 [&gt;.............................] - ETA: 2:07
 26787840/616562950 [&gt;.............................] - ETA: 2:07
 27000832/616562950 [&gt;.............................] - ETA: 2:07
 27230208/616562950 [&gt;.............................] - ETA: 2:07
 27475968/616562950 [&gt;.............................] - ETA: 2:07
 27738112/616562950 [&gt;.............................] - ETA: 2:07
 27959296/616562950 [&gt;.............................] - ETA: 2:07
 28180480/616562950 [&gt;.............................] - ETA: 2:07
 28459008/616562950 [&gt;.............................] - ETA: 2:07
 28704768/616562950 [&gt;.............................] - ETA: 2:06
 28983296/616562950 [&gt;.............................] - ETA: 2:06
 29229056/616562950 [&gt;.............................] - ETA: 2:06
 29507584/616562950 [&gt;.............................] - ETA: 2:06
 29769728/616562950 [&gt;.............................] - ETA: 2:06
 30064640/616562950 [&gt;.............................] - ETA: 2:06
 30326784/616562950 [&gt;.............................] - ETA: 2:05
 30621696/616562950 [&gt;.............................] - ETA: 2:05
 30883840/616562950 [&gt;.............................] - ETA: 2:05
 31178752/616562950 [&gt;.............................] - ETA: 2:05
 31490048/616562950 [&gt;.............................] - ETA: 2:04
 31801344/616562950 [&gt;.............................] - ETA: 2:04
 32112640/616562950 [&gt;.............................] - ETA: 2:04
 32423936/616562950 [&gt;.............................] - ETA: 2:04
 32751616/616562950 [&gt;.............................] - ETA: 2:03
 33062912/616562950 [&gt;.............................] - ETA: 2:03
 33357824/616562950 [&gt;.............................] - ETA: 2:03
 33619968/616562950 [&gt;.............................] - ETA: 2:03
 33832960/616562950 [&gt;.............................] - ETA: 2:03
 34078720/616562950 [&gt;.............................] - ETA: 2:03
 34308096/616562950 [&gt;.............................] - ETA: 2:02
 34537472/616562950 [&gt;.............................] - ETA: 2:03
 34783232/616562950 [&gt;.............................] - ETA: 2:03
 35028992/616562950 [&gt;.............................] - ETA: 2:02
 35274752/616562950 [&gt;.............................] - ETA: 2:02
 35520512/616562950 [&gt;.............................] - ETA: 2:02
 35766272/616562950 [&gt;.............................] - ETA: 2:02
 36028416/616562950 [&gt;.............................] - ETA: 2:02
 36290560/616562950 [&gt;.............................] - ETA: 2:02
 36569088/616562950 [&gt;.............................] - ETA: 2:02
 36831232/616562950 [&gt;.............................] - ETA: 2:02
 37093376/616562950 [&gt;.............................] - ETA: 2:02
 37371904/616562950 [&gt;.............................] - ETA: 2:01
 37683200/616562950 [&gt;.............................] - ETA: 2:01
 37961728/616562950 [&gt;.............................] - ETA: 2:01
 38273024/616562950 [&gt;.............................] - ETA: 2:01
 38567936/616562950 [&gt;.............................] - ETA: 2:01
 38879232/616562950 [&gt;.............................] - ETA: 2:00
 39206912/616562950 [&gt;.............................] - ETA: 2:00
 39518208/616562950 [&gt;.............................] - ETA: 2:00
 39845888/616562950 [&gt;.............................] - ETA: 1:59
 40157184/616562950 [&gt;.............................] - ETA: 1:59
 40484864/616562950 [&gt;.............................] - ETA: 1:59
 40828928/616562950 [&gt;.............................] - ETA: 1:59
 41156608/616562950 [=&gt;............................] - ETA: 1:58
 41500672/616562950 [=&gt;............................] - ETA: 1:58
 41828352/616562950 [=&gt;............................] - ETA: 1:58
 42205184/616562950 [=&gt;............................] - ETA: 1:57
 42549248/616562950 [=&gt;............................] - ETA: 1:57
 42876928/616562950 [=&gt;............................] - ETA: 1:57
 43204608/616562950 [=&gt;............................] - ETA: 1:56
 43499520/616562950 [=&gt;............................] - ETA: 1:56
 43778048/616562950 [=&gt;............................] - ETA: 1:56
 44122112/616562950 [=&gt;............................] - ETA: 1:56
 44498944/616562950 [=&gt;............................] - ETA: 1:55
 44875776/616562950 [=&gt;............................] - ETA: 1:55
 45252608/616562950 [=&gt;............................] - ETA: 1:54
 45645824/616562950 [=&gt;............................] - ETA: 1:54
 46039040/616562950 [=&gt;............................] - ETA: 1:54
 46432256/616562950 [=&gt;............................] - ETA: 1:53
 46809088/616562950 [=&gt;............................] - ETA: 1:53
 47218688/616562950 [=&gt;............................] - ETA: 1:52
 47628288/616562950 [=&gt;............................] - ETA: 1:52
 48037888/616562950 [=&gt;............................] - ETA: 1:52
 48463872/616562950 [=&gt;............................] - ETA: 1:51
 48873472/616562950 [=&gt;............................] - ETA: 1:51
 49266688/616562950 [=&gt;............................] - ETA: 1:50
 49692672/616562950 [=&gt;............................] - ETA: 1:50
 50151424/616562950 [=&gt;............................] - ETA: 1:49
 50561024/616562950 [=&gt;............................] - ETA: 1:49
 51003392/616562950 [=&gt;............................] - ETA: 1:48
 51462144/616562950 [=&gt;............................] - ETA: 1:48
 51888128/616562950 [=&gt;............................] - ETA: 1:48
 52330496/616562950 [=&gt;............................] - ETA: 1:47
 52772864/616562950 [=&gt;............................] - ETA: 1:47
 53231616/616562950 [=&gt;............................] - ETA: 1:46
 53673984/616562950 [=&gt;............................] - ETA: 1:46
 54132736/616562950 [=&gt;............................] - ETA: 1:45
 54607872/616562950 [=&gt;............................] - ETA: 1:45
 55066624/616562950 [=&gt;............................] - ETA: 1:44
 55541760/616562950 [=&gt;............................] - ETA: 1:44
 55967744/616562950 [=&gt;............................] - ETA: 1:44
 56377344/616562950 [=&gt;............................] - ETA: 1:44
 56737792/616562950 [=&gt;............................] - ETA: 1:43
 56950784/616562950 [=&gt;............................] - ETA: 1:44
 56983552/616562950 [=&gt;............................] - ETA: 1:44
 57212928/616562950 [=&gt;............................] - ETA: 1:44
 57393152/616562950 [=&gt;............................] - ETA: 1:44
 57524224/616562950 [=&gt;............................] - ETA: 1:45
 57655296/616562950 [=&gt;............................] - ETA: 1:45
 57786368/616562950 [=&gt;............................] - ETA: 1:46
 57966592/616562950 [=&gt;............................] - ETA: 1:46
 58064896/616562950 [=&gt;............................] - ETA: 1:46
 58179584/616562950 [=&gt;............................] - ETA: 1:47
 58277888/616562950 [=&gt;............................] - ETA: 1:47
 58392576/616562950 [=&gt;............................] - ETA: 1:47
 58507264/616562950 [=&gt;............................] - ETA: 1:47
 58638336/616562950 [=&gt;............................] - ETA: 1:48
 58769408/616562950 [=&gt;............................] - ETA: 1:48
 58900480/616562950 [=&gt;............................] - ETA: 1:48
 59031552/616562950 [=&gt;............................] - ETA: 1:48
 59179008/616562950 [=&gt;............................] - ETA: 1:49
 59326464/616562950 [=&gt;............................] - ETA: 1:49
 59473920/616562950 [=&gt;............................] - ETA: 1:49
 59637760/616562950 [=&gt;............................] - ETA: 1:49
 59801600/616562950 [=&gt;............................] - ETA: 1:49
 59949056/616562950 [=&gt;............................] - ETA: 1:50
 60129280/616562950 [=&gt;............................] - ETA: 1:50
 60293120/616562950 [=&gt;............................] - ETA: 1:50
 60489728/616562950 [=&gt;............................] - ETA: 1:50
 60669952/616562950 [=&gt;............................] - ETA: 1:50
 60891136/616562950 [=&gt;............................] - ETA: 1:50
 61046784/616562950 [=&gt;............................] - ETA: 1:50
 61259776/616562950 [=&gt;............................] - ETA: 1:50
 61440000/616562950 [=&gt;............................] - ETA: 1:50
 61652992/616562950 [=&gt;............................] - ETA: 1:51
 61865984/616562950 [==&gt;...........................] - ETA: 1:51
 62095360/616562950 [==&gt;...........................] - ETA: 1:51
 62291968/616562950 [==&gt;...........................] - ETA: 1:51
 62504960/616562950 [==&gt;...........................] - ETA: 1:51
 62668800/616562950 [==&gt;...........................] - ETA: 1:51
 62914560/616562950 [==&gt;...........................] - ETA: 1:51
 63062016/616562950 [==&gt;...........................] - ETA: 1:52
 63291392/616562950 [==&gt;...........................] - ETA: 1:52
 63422464/616562950 [==&gt;...........................] - ETA: 1:52
 63537152/616562950 [==&gt;...........................] - ETA: 1:52
 63684608/616562950 [==&gt;...........................] - ETA: 1:52
 63815680/616562950 [==&gt;...........................] - ETA: 1:53
 63963136/616562950 [==&gt;...........................] - ETA: 1:53
 64110592/616562950 [==&gt;...........................] - ETA: 1:53
 64258048/616562950 [==&gt;...........................] - ETA: 1:53
 64405504/616562950 [==&gt;...........................] - ETA: 1:53
 64569344/616562950 [==&gt;...........................] - ETA: 1:53
 64733184/616562950 [==&gt;...........................] - ETA: 1:54
 64913408/616562950 [==&gt;...........................] - ETA: 1:54
 65077248/616562950 [==&gt;...........................] - ETA: 1:54
 65273856/616562950 [==&gt;...........................] - ETA: 1:54
 65437696/616562950 [==&gt;...........................] - ETA: 1:54
 65634304/616562950 [==&gt;...........................] - ETA: 1:54
 65830912/616562950 [==&gt;...........................] - ETA: 1:54
 66027520/616562950 [==&gt;...........................] - ETA: 1:54
 66224128/616562950 [==&gt;...........................] - ETA: 1:54
 66437120/616562950 [==&gt;...........................] - ETA: 1:54
 66633728/616562950 [==&gt;...........................] - ETA: 1:54
 66846720/616562950 [==&gt;...........................] - ETA: 1:54
 67076096/616562950 [==&gt;...........................] - ETA: 1:54
 67305472/616562950 [==&gt;...........................] - ETA: 1:54
 67518464/616562950 [==&gt;...........................] - ETA: 1:54
 67764224/616562950 [==&gt;...........................] - ETA: 1:54
 67993600/616562950 [==&gt;...........................] - ETA: 1:54
 68239360/616562950 [==&gt;...........................] - ETA: 1:54
 68485120/616562950 [==&gt;...........................] - ETA: 1:54
 68730880/616562950 [==&gt;...........................] - ETA: 1:54
 68993024/616562950 [==&gt;...........................] - ETA: 1:54
 69238784/616562950 [==&gt;...........................] - ETA: 1:54
 69500928/616562950 [==&gt;...........................] - ETA: 1:54
 69746688/616562950 [==&gt;...........................] - ETA: 1:54
 70025216/616562950 [==&gt;...........................] - ETA: 1:54
 70287360/616562950 [==&gt;...........................] - ETA: 1:54
 70565888/616562950 [==&gt;...........................] - ETA: 1:54
 70844416/616562950 [==&gt;...........................] - ETA: 1:54
 71139328/616562950 [==&gt;...........................] - ETA: 1:53
 71434240/616562950 [==&gt;...........................] - ETA: 1:53
 71729152/616562950 [==&gt;...........................] - ETA: 1:53
 72040448/616562950 [==&gt;...........................] - ETA: 1:53
 72351744/616562950 [==&gt;...........................] - ETA: 1:53
 72663040/616562950 [==&gt;...........................] - ETA: 1:53
 72990720/616562950 [==&gt;...........................] - ETA: 1:53
 73302016/616562950 [==&gt;...........................] - ETA: 1:52
 73613312/616562950 [==&gt;...........................] - ETA: 1:52
 73940992/616562950 [==&gt;...........................] - ETA: 1:52
 74235904/616562950 [==&gt;...........................] - ETA: 1:52
 74579968/616562950 [==&gt;...........................] - ETA: 1:52
 74907648/616562950 [==&gt;...........................] - ETA: 1:52
 75251712/616562950 [==&gt;...........................] - ETA: 1:51
 75612160/616562950 [==&gt;...........................] - ETA: 1:51
 75956224/616562950 [==&gt;...........................] - ETA: 1:51
 76316672/616562950 [==&gt;...........................] - ETA: 1:51
 76644352/616562950 [==&gt;...........................] - ETA: 1:50
 77021184/616562950 [==&gt;...........................] - ETA: 1:50
 77365248/616562950 [==&gt;...........................] - ETA: 1:50
 77725696/616562950 [==&gt;...........................] - ETA: 1:50
 78102528/616562950 [==&gt;...........................] - ETA: 1:50
 78462976/616562950 [==&gt;...........................] - ETA: 1:49
 78839808/616562950 [==&gt;...........................] - ETA: 1:49
 79249408/616562950 [==&gt;...........................] - ETA: 1:49
 79626240/616562950 [==&gt;...........................] - ETA: 1:49
 80019456/616562950 [==&gt;...........................] - ETA: 1:48
 80429056/616562950 [==&gt;...........................] - ETA: 1:48
 80822272/616562950 [==&gt;...........................] - ETA: 1:48
 81199104/616562950 [==&gt;...........................] - ETA: 1:47
 81625088/616562950 [==&gt;...........................] - ETA: 1:47
 82034688/616562950 [==&gt;...........................] - ETA: 1:47
 82427904/616562950 [===&gt;..........................] - ETA: 1:47
 82853888/616562950 [===&gt;..........................] - ETA: 1:46
 83263488/616562950 [===&gt;..........................] - ETA: 1:46
 83689472/616562950 [===&gt;..........................] - ETA: 1:46
 84131840/616562950 [===&gt;..........................] - ETA: 1:45
 84557824/616562950 [===&gt;..........................] - ETA: 1:45
 85000192/616562950 [===&gt;..........................] - ETA: 1:45
 85426176/616562950 [===&gt;..........................] - ETA: 1:44
 85868544/616562950 [===&gt;..........................] - ETA: 1:44
 86327296/616562950 [===&gt;..........................] - ETA: 1:44
 86769664/616562950 [===&gt;..........................] - ETA: 1:44
 87212032/616562950 [===&gt;..........................] - ETA: 1:43
 87687168/616562950 [===&gt;..........................] - ETA: 1:43
 88145920/616562950 [===&gt;..........................] - ETA: 1:43
 88604672/616562950 [===&gt;..........................] - ETA: 1:42
 89096192/616562950 [===&gt;..........................] - ETA: 1:42
 89571328/616562950 [===&gt;..........................] - ETA: 1:42
 90062848/616562950 [===&gt;..........................] - ETA: 1:41
 90554368/616562950 [===&gt;..........................] - ETA: 1:41
 91029504/616562950 [===&gt;..........................] - ETA: 1:41
 91521024/616562950 [===&gt;..........................] - ETA: 1:40
 92020736/616562950 [===&gt;..........................] - ETA: 1:40
 92504064/616562950 [===&gt;..........................] - ETA: 1:39
 92995584/616562950 [===&gt;..........................] - ETA: 1:39
 93487104/616562950 [===&gt;..........................] - ETA: 1:39
 94011392/616562950 [===&gt;..........................] - ETA: 1:38
 94339072/616562950 [===&gt;..........................] - ETA: 1:38
 94633984/616562950 [===&gt;..........................] - ETA: 1:38
 95076352/616562950 [===&gt;..........................] - ETA: 1:38
 95338496/616562950 [===&gt;..........................] - ETA: 1:38
 95617024/616562950 [===&gt;..........................] - ETA: 1:38
 95862784/616562950 [===&gt;..........................] - ETA: 1:38
 96141312/616562950 [===&gt;..........................] - ETA: 1:38
 96419840/616562950 [===&gt;..........................] - ETA: 1:38
 96698368/616562950 [===&gt;..........................] - ETA: 1:38
 96993280/616562950 [===&gt;..........................] - ETA: 1:38
 97271808/616562950 [===&gt;..........................] - ETA: 1:38
 97583104/616562950 [===&gt;..........................] - ETA: 1:38
 97861632/616562950 [===&gt;..........................] - ETA: 1:37
 98172928/616562950 [===&gt;..........................] - ETA: 1:37
 98500608/616562950 [===&gt;..........................] - ETA: 1:37
 98811904/616562950 [===&gt;..........................] - ETA: 1:37
 99139584/616562950 [===&gt;..........................] - ETA: 1:37
 99450880/616562950 [===&gt;..........................] - ETA: 1:37
 99794944/616562950 [===&gt;..........................] - ETA: 1:37
100106240/616562950 [===&gt;..........................] - ETA: 1:37
100450304/616562950 [===&gt;..........................] - ETA: 1:37
100777984/616562950 [===&gt;..........................] - ETA: 1:37
101105664/616562950 [===&gt;..........................] - ETA: 1:36
101457920/616562950 [===&gt;..........................] - ETA: 1:36
101793792/616562950 [===&gt;..........................] - ETA: 1:36
102154240/616562950 [===&gt;..........................] - ETA: 1:36
102514688/616562950 [===&gt;..........................] - ETA: 1:36
102858752/616562950 [====&gt;.........................] - ETA: 1:36
103251968/616562950 [====&gt;.........................] - ETA: 1:36
103596032/616562950 [====&gt;.........................] - ETA: 1:35
103972864/616562950 [====&gt;.........................] - ETA: 1:35
104366080/616562950 [====&gt;.........................] - ETA: 1:35
104726528/616562950 [====&gt;.........................] - ETA: 1:35
105103360/616562950 [====&gt;.........................] - ETA: 1:35
105480192/616562950 [====&gt;.........................] - ETA: 1:35
105881600/616562950 [====&gt;.........................] - ETA: 1:34
106283008/616562950 [====&gt;.........................] - ETA: 1:34
106659840/616562950 [====&gt;.........................] - ETA: 1:34
107085824/616562950 [====&gt;.........................] - ETA: 1:34
107495424/616562950 [====&gt;.........................] - ETA: 1:34
107905024/616562950 [====&gt;.........................] - ETA: 1:33
108331008/616562950 [====&gt;.........................] - ETA: 1:33
108740608/616562950 [====&gt;.........................] - ETA: 1:33
109166592/616562950 [====&gt;.........................] - ETA: 1:33
109608960/616562950 [====&gt;.........................] - ETA: 1:33
110018560/616562950 [====&gt;.........................] - ETA: 1:32
110460928/616562950 [====&gt;.........................] - ETA: 1:32
110903296/616562950 [====&gt;.........................] - ETA: 1:32
111329280/616562950 [====&gt;.........................] - ETA: 1:32
111771648/616562950 [====&gt;.........................] - ETA: 1:32
112230400/616562950 [====&gt;.........................] - ETA: 1:31
112689152/616562950 [====&gt;.........................] - ETA: 1:31
113164288/616562950 [====&gt;.........................] - ETA: 1:31
113606656/616562950 [====&gt;.........................] - ETA: 1:31
114081792/616562950 [====&gt;.........................] - ETA: 1:30
114556928/616562950 [====&gt;.........................] - ETA: 1:30
115032064/616562950 [====&gt;.........................] - ETA: 1:30
115507200/616562950 [====&gt;.........................] - ETA: 1:30
115998720/616562950 [====&gt;.........................] - ETA: 1:29
116473856/616562950 [====&gt;.........................] - ETA: 1:29
116965376/616562950 [====&gt;.........................] - ETA: 1:29
117456896/616562950 [====&gt;.........................] - ETA: 1:29
117948416/616562950 [====&gt;.........................] - ETA: 1:29
118456320/616562950 [====&gt;.........................] - ETA: 1:28
118964224/616562950 [====&gt;.........................] - ETA: 1:28
119472128/616562950 [====&gt;.........................] - ETA: 1:28
119963648/616562950 [====&gt;.........................] - ETA: 1:28
120479744/616562950 [====&gt;.........................] - ETA: 1:27
120979456/616562950 [====&gt;.........................] - ETA: 1:27
121503744/616562950 [====&gt;.........................] - ETA: 1:27
122044416/616562950 [====&gt;.........................] - ETA: 1:26
122585088/616562950 [====&gt;.........................] - ETA: 1:26
123125760/616562950 [====&gt;.........................] - ETA: 1:26
123666432/616562950 [=====&gt;........................] - ETA: 1:26
124207104/616562950 [=====&gt;........................] - ETA: 1:25
124764160/616562950 [=====&gt;........................] - ETA: 1:25
125321216/616562950 [=====&gt;........................] - ETA: 1:25
125878272/616562950 [=====&gt;........................] - ETA: 1:25
126386176/616562950 [=====&gt;........................] - ETA: 1:24
126943232/616562950 [=====&gt;........................] - ETA: 1:24
127516672/616562950 [=====&gt;........................] - ETA: 1:24
128090112/616562950 [=====&gt;........................] - ETA: 1:24
128663552/616562950 [=====&gt;........................] - ETA: 1:23
129220608/616562950 [=====&gt;........................] - ETA: 1:23
129794048/616562950 [=====&gt;........................] - ETA: 1:23
130367488/616562950 [=====&gt;........................] - ETA: 1:22
130940928/616562950 [=====&gt;........................] - ETA: 1:22
131481600/616562950 [=====&gt;........................] - ETA: 1:22
132055040/616562950 [=====&gt;........................] - ETA: 1:22
132628480/616562950 [=====&gt;........................] - ETA: 1:21
133185536/616562950 [=====&gt;........................] - ETA: 1:21
133783552/616562950 [=====&gt;........................] - ETA: 1:21
134348800/616562950 [=====&gt;........................] - ETA: 1:21
134938624/616562950 [=====&gt;........................] - ETA: 1:20
135528448/616562950 [=====&gt;........................] - ETA: 1:20
136118272/616562950 [=====&gt;........................] - ETA: 1:20
136708096/616562950 [=====&gt;........................] - ETA: 1:19
137306112/616562950 [=====&gt;........................] - ETA: 1:19
137887744/616562950 [=====&gt;........................] - ETA: 1:19
138477568/616562950 [=====&gt;........................] - ETA: 1:19
139059200/616562950 [=====&gt;........................] - ETA: 1:18
139640832/616562950 [=====&gt;........................] - ETA: 1:18
140230656/616562950 [=====&gt;........................] - ETA: 1:18
140820480/616562950 [=====&gt;........................] - ETA: 1:18
141410304/616562950 [=====&gt;........................] - ETA: 1:17
142000128/616562950 [=====&gt;........................] - ETA: 1:17
142589952/616562950 [=====&gt;........................] - ETA: 1:17
143212544/616562950 [=====&gt;........................] - ETA: 1:17
143802368/616562950 [=====&gt;........................] - ETA: 1:16
144392192/616562950 [======&gt;.......................] - ETA: 1:16
144982016/616562950 [======&gt;.......................] - ETA: 1:16
145571840/616562950 [======&gt;.......................] - ETA: 1:16
146161664/616562950 [======&gt;.......................] - ETA: 1:15
146751488/616562950 [======&gt;.......................] - ETA: 1:15
147341312/616562950 [======&gt;.......................] - ETA: 1:15
147931136/616562950 [======&gt;.......................] - ETA: 1:15
148520960/616562950 [======&gt;.......................] - ETA: 1:14
149110784/616562950 [======&gt;.......................] - ETA: 1:14
149700608/616562950 [======&gt;.......................] - ETA: 1:14
150290432/616562950 [======&gt;.......................] - ETA: 1:14
150749184/616562950 [======&gt;.......................] - ETA: 1:14
151093248/616562950 [======&gt;.......................] - ETA: 1:14
151502848/616562950 [======&gt;.......................] - ETA: 1:13
151863296/616562950 [======&gt;.......................] - ETA: 1:13
152240128/616562950 [======&gt;.......................] - ETA: 1:13
152600576/616562950 [======&gt;.......................] - ETA: 1:13
152977408/616562950 [======&gt;.......................] - ETA: 1:13
153362432/616562950 [======&gt;.......................] - ETA: 1:13
153731072/616562950 [======&gt;.......................] - ETA: 1:13
154124288/616562950 [======&gt;.......................] - ETA: 1:13
154517504/616562950 [======&gt;.......................] - ETA: 1:13
154910720/616562950 [======&gt;.......................] - ETA: 1:13
155320320/616562950 [======&gt;.......................] - ETA: 1:13
155713536/616562950 [======&gt;.......................] - ETA: 1:12
156139520/616562950 [======&gt;.......................] - ETA: 1:12
156549120/616562950 [======&gt;.......................] - ETA: 1:12
156958720/616562950 [======&gt;.......................] - ETA: 1:12
157384704/616562950 [======&gt;.......................] - ETA: 1:12
157810688/616562950 [======&gt;.......................] - ETA: 1:12
158236672/616562950 [======&gt;.......................] - ETA: 1:12
158646272/616562950 [======&gt;.......................] - ETA: 1:12
159072256/616562950 [======&gt;.......................] - ETA: 1:12
159514624/616562950 [======&gt;.......................] - ETA: 1:11
159956992/616562950 [======&gt;.......................] - ETA: 1:11
160399360/616562950 [======&gt;.......................] - ETA: 1:11
160858112/616562950 [======&gt;.......................] - ETA: 1:11
161300480/616562950 [======&gt;.......................] - ETA: 1:11
161759232/616562950 [======&gt;.......................] - ETA: 1:11
162217984/616562950 [======&gt;.......................] - ETA: 1:11
162676736/616562950 [======&gt;.......................] - ETA: 1:11
163135488/616562950 [======&gt;.......................] - ETA: 1:10
163610624/616562950 [======&gt;.......................] - ETA: 1:10
164102144/616562950 [======&gt;.......................] - ETA: 1:10
164577280/616562950 [=======&gt;......................] - ETA: 1:10
165068800/616562950 [=======&gt;......................] - ETA: 1:10
165560320/616562950 [=======&gt;......................] - ETA: 1:10
166035456/616562950 [=======&gt;......................] - ETA: 1:10
166543360/616562950 [=======&gt;......................] - ETA: 1:09
167034880/616562950 [=======&gt;......................] - ETA: 1:09
167542784/616562950 [=======&gt;......................] - ETA: 1:09
168050688/616562950 [=======&gt;......................] - ETA: 1:09
168558592/616562950 [=======&gt;......................] - ETA: 1:09
169082880/616562950 [=======&gt;......................] - ETA: 1:09
169607168/616562950 [=======&gt;......................] - ETA: 1:09
170131456/616562950 [=======&gt;......................] - ETA: 1:08
170655744/616562950 [=======&gt;......................] - ETA: 1:08
171196416/616562950 [=======&gt;......................] - ETA: 1:08
171737088/616562950 [=======&gt;......................] - ETA: 1:08
172261376/616562950 [=======&gt;......................] - ETA: 1:08
172802048/616562950 [=======&gt;......................] - ETA: 1:08
173359104/616562950 [=======&gt;......................] - ETA: 1:07
173916160/616562950 [=======&gt;......................] - ETA: 1:07
174415872/616562950 [=======&gt;......................] - ETA: 1:07
174964736/616562950 [=======&gt;......................] - ETA: 1:07
175521792/616562950 [=======&gt;......................] - ETA: 1:07
176078848/616562950 [=======&gt;......................] - ETA: 1:07
176652288/616562950 [=======&gt;......................] - ETA: 1:06
177225728/616562950 [=======&gt;......................] - ETA: 1:06
177799168/616562950 [=======&gt;......................] - ETA: 1:06
178380800/616562950 [=======&gt;......................] - ETA: 1:06
178946048/616562950 [=======&gt;......................] - ETA: 1:06
179535872/616562950 [=======&gt;......................] - ETA: 1:05
180125696/616562950 [=======&gt;......................] - ETA: 1:05
180715520/616562950 [=======&gt;......................] - ETA: 1:05
181305344/616562950 [=======&gt;......................] - ETA: 1:05
181895168/616562950 [=======&gt;......................] - ETA: 1:05
182468608/616562950 [=======&gt;......................] - ETA: 1:05
183058432/616562950 [=======&gt;......................] - ETA: 1:04
183648256/616562950 [=======&gt;......................] - ETA: 1:04
184254464/616562950 [=======&gt;......................] - ETA: 1:04
184844288/616562950 [=======&gt;......................] - ETA: 1:04
185450496/616562950 [========&gt;.....................] - ETA: 1:04
186040320/616562950 [========&gt;.....................] - ETA: 1:04
186630144/616562950 [========&gt;.....................] - ETA: 1:03
187236352/616562950 [========&gt;.....................] - ETA: 1:03
187826176/616562950 [========&gt;.....................] - ETA: 1:03
188416000/616562950 [========&gt;.....................] - ETA: 1:03
189005824/616562950 [========&gt;.....................] - ETA: 1:03
189595648/616562950 [========&gt;.....................] - ETA: 1:02
190201856/616562950 [========&gt;.....................] - ETA: 1:02
190791680/616562950 [========&gt;.....................] - ETA: 1:02
191381504/616562950 [========&gt;.....................] - ETA: 1:02
191971328/616562950 [========&gt;.....................] - ETA: 1:02
192561152/616562950 [========&gt;.....................] - ETA: 1:02
193150976/616562950 [========&gt;.....................] - ETA: 1:01
193740800/616562950 [========&gt;.....................] - ETA: 1:01
194330624/616562950 [========&gt;.....................] - ETA: 1:01
194936832/616562950 [========&gt;.....................] - ETA: 1:01
195526656/616562950 [========&gt;.....................] - ETA: 1:01
196116480/616562950 [========&gt;.....................] - ETA: 1:01
196706304/616562950 [========&gt;.....................] - ETA: 1:00
197296128/616562950 [========&gt;.....................] - ETA: 1:00
197885952/616562950 [========&gt;.....................] - ETA: 1:00
198475776/616562950 [========&gt;.....................] - ETA: 1:00
199065600/616562950 [========&gt;.....................] - ETA: 1:00
199507968/616562950 [========&gt;.....................] - ETA: 1:00
200097792/616562950 [========&gt;.....................] - ETA: 1:00
200671232/616562950 [========&gt;.....................] - ETA: 1:00
201064448/616562950 [========&gt;.....................] - ETA: 59s 
201424896/616562950 [========&gt;.....................] - ETA: 59s
201801728/616562950 [========&gt;.....................] - ETA: 59s
202194944/616562950 [========&gt;.....................] - ETA: 59s
202539008/616562950 [========&gt;.....................] - ETA: 59s
202932224/616562950 [========&gt;.....................] - ETA: 59s
203325440/616562950 [========&gt;.....................] - ETA: 59s
203718656/616562950 [========&gt;.....................] - ETA: 59s
204128256/616562950 [========&gt;.....................] - ETA: 59s
204505088/616562950 [========&gt;.....................] - ETA: 59s
204914688/616562950 [========&gt;.....................] - ETA: 59s
205340672/616562950 [========&gt;.....................] - ETA: 59s
205717504/616562950 [=========&gt;....................] - ETA: 59s
206143488/616562950 [=========&gt;....................] - ETA: 59s
206569472/616562950 [=========&gt;....................] - ETA: 59s
206962688/616562950 [=========&gt;....................] - ETA: 58s
207405056/616562950 [=========&gt;....................] - ETA: 58s
207847424/616562950 [=========&gt;....................] - ETA: 58s
208240640/616562950 [=========&gt;....................] - ETA: 58s
208699392/616562950 [=========&gt;....................] - ETA: 58s
209158144/616562950 [=========&gt;....................] - ETA: 58s
209600512/616562950 [=========&gt;....................] - ETA: 58s
210059264/616562950 [=========&gt;....................] - ETA: 58s
210501632/616562950 [=========&gt;....................] - ETA: 58s
210944000/616562950 [=========&gt;....................] - ETA: 58s
211419136/616562950 [=========&gt;....................] - ETA: 58s
211877888/616562950 [=========&gt;....................] - ETA: 57s
212336640/616562950 [=========&gt;....................] - ETA: 57s
212828160/616562950 [=========&gt;....................] - ETA: 57s
213303296/616562950 [=========&gt;....................] - ETA: 57s
213778432/616562950 [=========&gt;....................] - ETA: 57s
214269952/616562950 [=========&gt;....................] - ETA: 57s
214761472/616562950 [=========&gt;....................] - ETA: 57s
215252992/616562950 [=========&gt;....................] - ETA: 57s
215760896/616562950 [=========&gt;....................] - ETA: 57s
216268800/616562950 [=========&gt;....................] - ETA: 57s
216776704/616562950 [=========&gt;....................] - ETA: 56s
217300992/616562950 [=========&gt;....................] - ETA: 56s
217825280/616562950 [=========&gt;....................] - ETA: 56s
218333184/616562950 [=========&gt;....................] - ETA: 56s
218857472/616562950 [=========&gt;....................] - ETA: 56s
219381760/616562950 [=========&gt;....................] - ETA: 56s
219906048/616562950 [=========&gt;....................] - ETA: 56s
220397568/616562950 [=========&gt;....................] - ETA: 56s
220938240/616562950 [=========&gt;....................] - ETA: 56s
221462528/616562950 [=========&gt;....................] - ETA: 55s
222019584/616562950 [=========&gt;....................] - ETA: 55s
222543872/616562950 [=========&gt;....................] - ETA: 55s
223084544/616562950 [=========&gt;....................] - ETA: 55s
223625216/616562950 [=========&gt;....................] - ETA: 55s
224149504/616562950 [=========&gt;....................] - ETA: 55s
224706560/616562950 [=========&gt;....................] - ETA: 55s
225263616/616562950 [=========&gt;....................] - ETA: 55s
225837056/616562950 [=========&gt;....................] - ETA: 54s
226410496/616562950 [==========&gt;...................] - ETA: 54s
226983936/616562950 [==========&gt;...................] - ETA: 54s
227565568/616562950 [==========&gt;...................] - ETA: 54s
228130816/616562950 [==========&gt;...................] - ETA: 54s
228720640/616562950 [==========&gt;...................] - ETA: 54s
229310464/616562950 [==========&gt;...................] - ETA: 54s
229851136/616562950 [==========&gt;...................] - ETA: 53s
230440960/616562950 [==========&gt;...................] - ETA: 53s
231030784/616562950 [==========&gt;...................] - ETA: 53s
231620608/616562950 [==========&gt;...................] - ETA: 53s
232210432/616562950 [==========&gt;...................] - ETA: 53s
232800256/616562950 [==========&gt;...................] - ETA: 53s
233390080/616562950 [==========&gt;...................] - ETA: 53s
233963520/616562950 [==========&gt;...................] - ETA: 53s
234569728/616562950 [==========&gt;...................] - ETA: 52s
235159552/616562950 [==========&gt;...................] - ETA: 52s
235749376/616562950 [==========&gt;...................] - ETA: 52s
236355584/616562950 [==========&gt;...................] - ETA: 52s
236945408/616562950 [==========&gt;...................] - ETA: 52s
237535232/616562950 [==========&gt;...................] - ETA: 52s
238125056/616562950 [==========&gt;...................] - ETA: 52s
238714880/616562950 [==========&gt;...................] - ETA: 51s
239304704/616562950 [==========&gt;...................] - ETA: 51s
239910912/616562950 [==========&gt;...................] - ETA: 51s
240500736/616562950 [==========&gt;...................] - ETA: 51s
241090560/616562950 [==========&gt;...................] - ETA: 51s
241680384/616562950 [==========&gt;...................] - ETA: 51s
242270208/616562950 [==========&gt;...................] - ETA: 51s
242860032/616562950 [==========&gt;...................] - ETA: 51s
243449856/616562950 [==========&gt;...................] - ETA: 50s
244056064/616562950 [==========&gt;...................] - ETA: 50s
244645888/616562950 [==========&gt;...................] - ETA: 50s
245252096/616562950 [==========&gt;...................] - ETA: 50s
245841920/616562950 [==========&gt;...................] - ETA: 50s
246431744/616562950 [==========&gt;...................] - ETA: 50s
247021568/616562950 [===========&gt;..................] - ETA: 50s
247611392/616562950 [===========&gt;..................] - ETA: 50s
248201216/616562950 [===========&gt;..................] - ETA: 49s
248791040/616562950 [===========&gt;..................] - ETA: 49s
249380864/616562950 [===========&gt;..................] - ETA: 49s
249790464/616562950 [===========&gt;..................] - ETA: 49s
250298368/616562950 [===========&gt;..................] - ETA: 49s
250855424/616562950 [===========&gt;..................] - ETA: 49s
251232256/616562950 [===========&gt;..................] - ETA: 49s
251625472/616562950 [===========&gt;..................] - ETA: 49s
252002304/616562950 [===========&gt;..................] - ETA: 49s
252395520/616562950 [===========&gt;..................] - ETA: 49s
252739584/616562950 [===========&gt;..................] - ETA: 49s
253132800/616562950 [===========&gt;..................] - ETA: 49s
253542400/616562950 [===========&gt;..................] - ETA: 49s
253919232/616562950 [===========&gt;..................] - ETA: 49s
254328832/616562950 [===========&gt;..................] - ETA: 48s
254722048/616562950 [===========&gt;..................] - ETA: 48s
255131648/616562950 [===========&gt;..................] - ETA: 48s
255557632/616562950 [===========&gt;..................] - ETA: 48s
255950848/616562950 [===========&gt;..................] - ETA: 48s
256376832/616562950 [===========&gt;..................] - ETA: 48s
256802816/616562950 [===========&gt;..................] - ETA: 48s
257212416/616562950 [===========&gt;..................] - ETA: 48s
257654784/616562950 [===========&gt;..................] - ETA: 48s
258080768/616562950 [===========&gt;..................] - ETA: 48s
258506752/616562950 [===========&gt;..................] - ETA: 48s
258965504/616562950 [===========&gt;..................] - ETA: 48s
259407872/616562950 [===========&gt;..................] - ETA: 48s
259833856/616562950 [===========&gt;..................] - ETA: 48s
260276224/616562950 [===========&gt;..................] - ETA: 48s
260734976/616562950 [===========&gt;..................] - ETA: 47s
261193728/616562950 [===========&gt;..................] - ETA: 47s
261652480/616562950 [===========&gt;..................] - ETA: 47s
262111232/616562950 [===========&gt;..................] - ETA: 47s
262586368/616562950 [===========&gt;..................] - ETA: 47s
263061504/616562950 [===========&gt;..................] - ETA: 47s
263536640/616562950 [===========&gt;..................] - ETA: 47s
264028160/616562950 [===========&gt;..................] - ETA: 47s
264519680/616562950 [===========&gt;..................] - ETA: 47s
265011200/616562950 [===========&gt;..................] - ETA: 47s
265502720/616562950 [===========&gt;..................] - ETA: 47s
265977856/616562950 [===========&gt;..................] - ETA: 47s
266469376/616562950 [===========&gt;..................] - ETA: 46s
266977280/616562950 [===========&gt;..................] - ETA: 46s
267485184/616562950 [============&gt;.................] - ETA: 46s
268009472/616562950 [============&gt;.................] - ETA: 46s
268517376/616562950 [============&gt;.................] - ETA: 46s
269041664/616562950 [============&gt;.................] - ETA: 46s
269582336/616562950 [============&gt;.................] - ETA: 46s
270123008/616562950 [============&gt;.................] - ETA: 46s
270663680/616562950 [============&gt;.................] - ETA: 46s
271171584/616562950 [============&gt;.................] - ETA: 46s
271712256/616562950 [============&gt;.................] - ETA: 46s
272252928/616562950 [============&gt;.................] - ETA: 45s
272809984/616562950 [============&gt;.................] - ETA: 45s
273350656/616562950 [============&gt;.................] - ETA: 45s
273907712/616562950 [============&gt;.................] - ETA: 45s
274464768/616562950 [============&gt;.................] - ETA: 45s
275038208/616562950 [============&gt;.................] - ETA: 45s
275595264/616562950 [============&gt;.................] - ETA: 45s
276168704/616562950 [============&gt;.................] - ETA: 45s
276742144/616562950 [============&gt;.................] - ETA: 45s
277315584/616562950 [============&gt;.................] - ETA: 44s
277905408/616562950 [============&gt;.................] - ETA: 44s
278495232/616562950 [============&gt;.................] - ETA: 44s
279085056/616562950 [============&gt;.................] - ETA: 44s
279674880/616562950 [============&gt;.................] - ETA: 44s
280264704/616562950 [============&gt;.................] - ETA: 44s
280870912/616562950 [============&gt;.................] - ETA: 44s
281460736/616562950 [============&gt;.................] - ETA: 44s
282066944/616562950 [============&gt;.................] - ETA: 44s
282656768/616562950 [============&gt;.................] - ETA: 43s
283230208/616562950 [============&gt;.................] - ETA: 43s
283820032/616562950 [============&gt;.................] - ETA: 43s
284409856/616562950 [============&gt;.................] - ETA: 43s
284999680/616562950 [============&gt;.................] - ETA: 43s
285589504/616562950 [============&gt;.................] - ETA: 43s
286179328/616562950 [============&gt;.................] - ETA: 43s
286769152/616562950 [============&gt;.................] - ETA: 43s
287358976/616562950 [============&gt;.................] - ETA: 43s
287948800/616562950 [=============&gt;................] - ETA: 43s
288538624/616562950 [=============&gt;................] - ETA: 42s
289128448/616562950 [=============&gt;................] - ETA: 42s
289685504/616562950 [=============&gt;................] - ETA: 42s
290308096/616562950 [=============&gt;................] - ETA: 42s
290897920/616562950 [=============&gt;................] - ETA: 42s
291487744/616562950 [=============&gt;................] - ETA: 42s
292077568/616562950 [=============&gt;................] - ETA: 42s
292667392/616562950 [=============&gt;................] - ETA: 42s
293273600/616562950 [=============&gt;................] - ETA: 42s
293863424/616562950 [=============&gt;................] - ETA: 41s
294453248/616562950 [=============&gt;................] - ETA: 41s
295043072/616562950 [=============&gt;................] - ETA: 41s
295649280/616562950 [=============&gt;................] - ETA: 41s
296239104/616562950 [=============&gt;................] - ETA: 41s
296828928/616562950 [=============&gt;................] - ETA: 41s
297435136/616562950 [=============&gt;................] - ETA: 41s
298041344/616562950 [=============&gt;................] - ETA: 41s
298631168/616562950 [=============&gt;................] - ETA: 41s
299220992/616562950 [=============&gt;................] - ETA: 41s
299810816/616562950 [=============&gt;................] - ETA: 40s
300400640/616562950 [=============&gt;................] - ETA: 40s
300679168/616562950 [=============&gt;................] - ETA: 40s
301170688/616562950 [=============&gt;................] - ETA: 40s
301727744/616562950 [=============&gt;................] - ETA: 40s
302104576/616562950 [=============&gt;................] - ETA: 40s
302497792/616562950 [=============&gt;................] - ETA: 40s
302874624/616562950 [=============&gt;................] - ETA: 40s
303284224/616562950 [=============&gt;................] - ETA: 40s
303661056/616562950 [=============&gt;................] - ETA: 40s
304070656/616562950 [=============&gt;................] - ETA: 40s
304431104/616562950 [=============&gt;................] - ETA: 40s
304840704/616562950 [=============&gt;................] - ETA: 40s
305266688/616562950 [=============&gt;................] - ETA: 40s
305676288/616562950 [=============&gt;................] - ETA: 40s
306085888/616562950 [=============&gt;................] - ETA: 40s
306511872/616562950 [=============&gt;................] - ETA: 40s
306905088/616562950 [=============&gt;................] - ETA: 39s
307331072/616562950 [=============&gt;................] - ETA: 39s
307773440/616562950 [=============&gt;................] - ETA: 39s
308183040/616562950 [=============&gt;................] - ETA: 39s
308617216/616562950 [==============&gt;...............] - ETA: 39s
309067776/616562950 [==============&gt;...............] - ETA: 39s
309477376/616562950 [==============&gt;...............] - ETA: 39s
309919744/616562950 [==============&gt;...............] - ETA: 39s
310378496/616562950 [==============&gt;...............] - ETA: 39s
310820864/616562950 [==============&gt;...............] - ETA: 39s
311279616/616562950 [==============&gt;...............] - ETA: 39s
311738368/616562950 [==============&gt;...............] - ETA: 39s
312197120/616562950 [==============&gt;...............] - ETA: 39s
312672256/616562950 [==============&gt;...............] - ETA: 39s
313131008/616562950 [==============&gt;...............] - ETA: 39s
313606144/616562950 [==============&gt;...............] - ETA: 38s
314097664/616562950 [==============&gt;...............] - ETA: 38s
314572800/616562950 [==============&gt;...............] - ETA: 38s
315064320/616562950 [==============&gt;...............] - ETA: 38s
315572224/616562950 [==============&gt;...............] - ETA: 38s
316047360/616562950 [==============&gt;...............] - ETA: 38s
316538880/616562950 [==============&gt;...............] - ETA: 38s
317046784/616562950 [==============&gt;...............] - ETA: 38s
317554688/616562950 [==============&gt;...............] - ETA: 38s
318062592/616562950 [==============&gt;...............] - ETA: 38s
318570496/616562950 [==============&gt;...............] - ETA: 38s
319094784/616562950 [==============&gt;...............] - ETA: 38s
319619072/616562950 [==============&gt;...............] - ETA: 38s
320126976/616562950 [==============&gt;...............] - ETA: 37s
320667648/616562950 [==============&gt;...............] - ETA: 37s
321191936/616562950 [==============&gt;...............] - ETA: 37s
321732608/616562950 [==============&gt;...............] - ETA: 37s
322273280/616562950 [==============&gt;...............] - ETA: 37s
322813952/616562950 [==============&gt;...............] - ETA: 37s
323354624/616562950 [==============&gt;...............] - ETA: 37s
323911680/616562950 [==============&gt;...............] - ETA: 37s
324468736/616562950 [==============&gt;...............] - ETA: 37s
325025792/616562950 [==============&gt;...............] - ETA: 37s
325582848/616562950 [==============&gt;...............] - ETA: 37s
326139904/616562950 [==============&gt;...............] - ETA: 37s
326713344/616562950 [==============&gt;...............] - ETA: 36s
327286784/616562950 [==============&gt;...............] - ETA: 36s
327860224/616562950 [==============&gt;...............] - ETA: 36s
328433664/616562950 [==============&gt;...............] - ETA: 36s
329007104/616562950 [===============&gt;..............] - ETA: 36s
329596928/616562950 [===============&gt;..............] - ETA: 36s
330186752/616562950 [===============&gt;..............] - ETA: 36s
330776576/616562950 [===============&gt;..............] - ETA: 36s
331366400/616562950 [===============&gt;..............] - ETA: 36s
331956224/616562950 [===============&gt;..............] - ETA: 36s
332546048/616562950 [===============&gt;..............] - ETA: 35s
333135872/616562950 [===============&gt;..............] - ETA: 35s
333725696/616562950 [===============&gt;..............] - ETA: 35s
334315520/616562950 [===============&gt;..............] - ETA: 35s
334905344/616562950 [===============&gt;..............] - ETA: 35s
335495168/616562950 [===============&gt;..............] - ETA: 35s
336101376/616562950 [===============&gt;..............] - ETA: 35s
336691200/616562950 [===============&gt;..............] - ETA: 35s
337281024/616562950 [===============&gt;..............] - ETA: 35s
337870848/616562950 [===============&gt;..............] - ETA: 35s
338460672/616562950 [===============&gt;..............] - ETA: 35s
339050496/616562950 [===============&gt;..............] - ETA: 34s
339656704/616562950 [===============&gt;..............] - ETA: 34s
340246528/616562950 [===============&gt;..............] - ETA: 34s
340836352/616562950 [===============&gt;..............] - ETA: 34s
341426176/616562950 [===============&gt;..............] - ETA: 34s
342016000/616562950 [===============&gt;..............] - ETA: 34s
342605824/616562950 [===============&gt;..............] - ETA: 34s
343195648/616562950 [===============&gt;..............] - ETA: 34s
343785472/616562950 [===============&gt;..............] - ETA: 34s
344375296/616562950 [===============&gt;..............] - ETA: 34s
344981504/616562950 [===============&gt;..............] - ETA: 34s
345571328/616562950 [===============&gt;..............] - ETA: 33s
346161152/616562950 [===============&gt;..............] - ETA: 33s
346750976/616562950 [===============&gt;..............] - ETA: 33s
347348992/616562950 [===============&gt;..............] - ETA: 33s
347930624/616562950 [===============&gt;..............] - ETA: 33s
348520448/616562950 [===============&gt;..............] - ETA: 33s
349110272/616562950 [===============&gt;..............] - ETA: 33s
349700096/616562950 [================&gt;.............] - ETA: 33s
350289920/616562950 [================&gt;.............] - ETA: 33s
350879744/616562950 [================&gt;.............] - ETA: 33s
351354880/616562950 [================&gt;.............] - ETA: 33s
351879168/616562950 [================&gt;.............] - ETA: 32s
352452608/616562950 [================&gt;.............] - ETA: 32s
352829440/616562950 [================&gt;.............] - ETA: 32s
353222656/616562950 [================&gt;.............] - ETA: 32s
353566720/616562950 [================&gt;.............] - ETA: 32s
353943552/616562950 [================&gt;.............] - ETA: 32s
354336768/616562950 [================&gt;.............] - ETA: 32s
354713600/616562950 [================&gt;.............] - ETA: 32s
355106816/616562950 [================&gt;.............] - ETA: 32s
355508224/616562950 [================&gt;.............] - ETA: 32s
355893248/616562950 [================&gt;.............] - ETA: 32s
356302848/616562950 [================&gt;.............] - ETA: 32s
356712448/616562950 [================&gt;.............] - ETA: 32s
357122048/616562950 [================&gt;.............] - ETA: 32s
357531648/616562950 [================&gt;.............] - ETA: 32s
357941248/616562950 [================&gt;.............] - ETA: 32s
358367232/616562950 [================&gt;.............] - ETA: 32s
358793216/616562950 [================&gt;.............] - ETA: 32s
359219200/616562950 [================&gt;.............] - ETA: 32s
359645184/616562950 [================&gt;.............] - ETA: 31s
360087552/616562950 [================&gt;.............] - ETA: 31s
360529920/616562950 [================&gt;.............] - ETA: 31s
360939520/616562950 [================&gt;.............] - ETA: 31s
361398272/616562950 [================&gt;.............] - ETA: 31s
361857024/616562950 [================&gt;.............] - ETA: 31s
362299392/616562950 [================&gt;.............] - ETA: 31s
362758144/616562950 [================&gt;.............] - ETA: 31s
363233280/616562950 [================&gt;.............] - ETA: 31s
363708416/616562950 [================&gt;.............] - ETA: 31s
364183552/616562950 [================&gt;.............] - ETA: 31s
364658688/616562950 [================&gt;.............] - ETA: 31s
365133824/616562950 [================&gt;.............] - ETA: 31s
365625344/616562950 [================&gt;.............] - ETA: 31s
366116864/616562950 [================&gt;.............] - ETA: 31s
366608384/616562950 [================&gt;.............] - ETA: 31s
367099904/616562950 [================&gt;.............] - ETA: 30s
367591424/616562950 [================&gt;.............] - ETA: 30s
368099328/616562950 [================&gt;.............] - ETA: 30s
368607232/616562950 [================&gt;.............] - ETA: 30s
369115136/616562950 [================&gt;.............] - ETA: 30s
369623040/616562950 [================&gt;.............] - ETA: 30s
370147328/616562950 [=================&gt;............] - ETA: 30s
370671616/616562950 [=================&gt;............] - ETA: 30s
371195904/616562950 [=================&gt;............] - ETA: 30s
371736576/616562950 [=================&gt;............] - ETA: 30s
372277248/616562950 [=================&gt;............] - ETA: 30s
372817920/616562950 [=================&gt;............] - ETA: 30s
373342208/616562950 [=================&gt;............] - ETA: 30s
373899264/616562950 [=================&gt;............] - ETA: 30s
374439936/616562950 [=================&gt;............] - ETA: 29s
374996992/616562950 [=================&gt;............] - ETA: 29s
375537664/616562950 [=================&gt;............] - ETA: 29s
376012800/616562950 [=================&gt;............] - ETA: 29s
376455168/616562950 [=================&gt;............] - ETA: 29s
376963072/616562950 [=================&gt;............] - ETA: 29s
377241600/616562950 [=================&gt;............] - ETA: 29s
377536512/616562950 [=================&gt;............] - ETA: 29s
377831424/616562950 [=================&gt;............] - ETA: 29s
378126336/616562950 [=================&gt;............] - ETA: 29s
378437632/616562950 [=================&gt;............] - ETA: 29s
378748928/616562950 [=================&gt;............] - ETA: 29s
379060224/616562950 [=================&gt;............] - ETA: 29s
379355136/616562950 [=================&gt;............] - ETA: 29s
379682816/616562950 [=================&gt;............] - ETA: 29s
380010496/616562950 [=================&gt;............] - ETA: 29s
380354560/616562950 [=================&gt;............] - ETA: 29s
380698624/616562950 [=================&gt;............] - ETA: 29s
381009920/616562950 [=================&gt;............] - ETA: 29s
381362176/616562950 [=================&gt;............] - ETA: 29s
381698048/616562950 [=================&gt;............] - ETA: 29s
382042112/616562950 [=================&gt;............] - ETA: 29s
382402560/616562950 [=================&gt;............] - ETA: 29s
382763008/616562950 [=================&gt;............] - ETA: 29s
383123456/616562950 [=================&gt;............] - ETA: 28s
383483904/616562950 [=================&gt;............] - ETA: 28s
383844352/616562950 [=================&gt;............] - ETA: 28s
384237568/616562950 [=================&gt;............] - ETA: 28s
384598016/616562950 [=================&gt;............] - ETA: 28s
384974848/616562950 [=================&gt;............] - ETA: 28s
385384448/616562950 [=================&gt;............] - ETA: 28s
385744896/616562950 [=================&gt;............] - ETA: 28s
386154496/616562950 [=================&gt;............] - ETA: 28s
386564096/616562950 [=================&gt;............] - ETA: 28s
386957312/616562950 [=================&gt;............] - ETA: 28s
387383296/616562950 [=================&gt;............] - ETA: 28s
387776512/616562950 [=================&gt;............] - ETA: 28s
388202496/616562950 [=================&gt;............] - ETA: 28s
388644864/616562950 [=================&gt;............] - ETA: 28s
389054464/616562950 [=================&gt;............] - ETA: 28s
389496832/616562950 [=================&gt;............] - ETA: 28s
389922816/616562950 [=================&gt;............] - ETA: 28s
390348800/616562950 [=================&gt;............] - ETA: 28s
390791168/616562950 [==================&gt;...........] - ETA: 28s
391233536/616562950 [==================&gt;...........] - ETA: 28s
391692288/616562950 [==================&gt;...........] - ETA: 27s
392151040/616562950 [==================&gt;...........] - ETA: 27s
392593408/616562950 [==================&gt;...........] - ETA: 27s
393052160/616562950 [==================&gt;...........] - ETA: 27s
393527296/616562950 [==================&gt;...........] - ETA: 27s
393986048/616562950 [==================&gt;...........] - ETA: 27s
394444800/616562950 [==================&gt;...........] - ETA: 27s
394887168/616562950 [==================&gt;...........] - ETA: 27s
395362304/616562950 [==================&gt;...........] - ETA: 27s
395804672/616562950 [==================&gt;...........] - ETA: 27s
396263424/616562950 [==================&gt;...........] - ETA: 27s
396738560/616562950 [==================&gt;...........] - ETA: 27s
397246464/616562950 [==================&gt;...........] - ETA: 27s
397737984/616562950 [==================&gt;...........] - ETA: 27s
398245888/616562950 [==================&gt;...........] - ETA: 27s
398737408/616562950 [==================&gt;...........] - ETA: 27s
399245312/616562950 [==================&gt;...........] - ETA: 26s
399736832/616562950 [==================&gt;...........] - ETA: 26s
400261120/616562950 [==================&gt;...........] - ETA: 26s
400785408/616562950 [==================&gt;...........] - ETA: 26s
401293312/616562950 [==================&gt;...........] - ETA: 26s
401817600/616562950 [==================&gt;...........] - ETA: 26s
402325504/616562950 [==================&gt;...........] - ETA: 26s
402849792/616562950 [==================&gt;...........] - ETA: 26s
403390464/616562950 [==================&gt;...........] - ETA: 26s
403931136/616562950 [==================&gt;...........] - ETA: 26s
404471808/616562950 [==================&gt;...........] - ETA: 26s
405012480/616562950 [==================&gt;...........] - ETA: 26s
405569536/616562950 [==================&gt;...........] - ETA: 26s
406126592/616562950 [==================&gt;...........] - ETA: 25s
406683648/616562950 [==================&gt;...........] - ETA: 25s
407240704/616562950 [==================&gt;...........] - ETA: 25s
407797760/616562950 [==================&gt;...........] - ETA: 25s
408354816/616562950 [==================&gt;...........] - ETA: 25s
408911872/616562950 [==================&gt;...........] - ETA: 25s
409468928/616562950 [==================&gt;...........] - ETA: 25s
410042368/616562950 [==================&gt;...........] - ETA: 25s
410615808/616562950 [==================&gt;...........] - ETA: 25s
411041792/616562950 [==================&gt;...........] - ETA: 25s
411713536/616562950 [===================&gt;..........] - ETA: 25s
412139520/616562950 [===================&gt;..........] - ETA: 25s
412581888/616562950 [===================&gt;..........] - ETA: 25s
412991488/616562950 [===================&gt;..........] - ETA: 25s
413442048/616562950 [===================&gt;..........] - ETA: 24s
413892608/616562950 [===================&gt;..........] - ETA: 24s
414334976/616562950 [===================&gt;..........] - ETA: 24s
414810112/616562950 [===================&gt;..........] - ETA: 24s
415268864/616562950 [===================&gt;..........] - ETA: 24s
415727616/616562950 [===================&gt;..........] - ETA: 24s
416202752/616562950 [===================&gt;..........] - ETA: 24s
416694272/616562950 [===================&gt;..........] - ETA: 24s
417169408/616562950 [===================&gt;..........] - ETA: 24s
417628160/616562950 [===================&gt;..........] - ETA: 24s
418119680/616562950 [===================&gt;..........] - ETA: 24s
418627584/616562950 [===================&gt;..........] - ETA: 24s
419102720/616562950 [===================&gt;..........] - ETA: 24s
419610624/616562950 [===================&gt;..........] - ETA: 24s
420118528/616562950 [===================&gt;..........] - ETA: 24s
420610048/616562950 [===================&gt;..........] - ETA: 24s
421117952/616562950 [===================&gt;..........] - ETA: 23s
421625856/616562950 [===================&gt;..........] - ETA: 23s
422150144/616562950 [===================&gt;..........] - ETA: 23s
422674432/616562950 [===================&gt;..........] - ETA: 23s
423198720/616562950 [===================&gt;..........] - ETA: 23s
423723008/616562950 [===================&gt;..........] - ETA: 23s
424255488/616562950 [===================&gt;..........] - ETA: 23s
424738816/616562950 [===================&gt;..........] - ETA: 23s
425279488/616562950 [===================&gt;..........] - ETA: 23s
425803776/616562950 [===================&gt;..........] - ETA: 23s
426344448/616562950 [===================&gt;..........] - ETA: 23s
426885120/616562950 [===================&gt;..........] - ETA: 23s
427425792/616562950 [===================&gt;..........] - ETA: 23s
427966464/616562950 [===================&gt;..........] - ETA: 23s
428523520/616562950 [===================&gt;..........] - ETA: 22s
429064192/616562950 [===================&gt;..........] - ETA: 22s
429621248/616562950 [===================&gt;..........] - ETA: 22s
430194688/616562950 [===================&gt;..........] - ETA: 22s
430768128/616562950 [===================&gt;..........] - ETA: 22s
431325184/616562950 [===================&gt;..........] - ETA: 22s
431898624/616562950 [====================&gt;.........] - ETA: 22s
432472064/616562950 [====================&gt;.........] - ETA: 22s
433061888/616562950 [====================&gt;.........] - ETA: 22s
433651712/616562950 [====================&gt;.........] - ETA: 22s
434225152/616562950 [====================&gt;.........] - ETA: 22s
434814976/616562950 [====================&gt;.........] - ETA: 22s
435421184/616562950 [====================&gt;.........] - ETA: 22s
436011008/616562950 [====================&gt;.........] - ETA: 21s
436600832/616562950 [====================&gt;.........] - ETA: 21s
437190656/616562950 [====================&gt;.........] - ETA: 21s
437780480/616562950 [====================&gt;.........] - ETA: 21s
438378496/616562950 [====================&gt;.........] - ETA: 21s
438960128/616562950 [====================&gt;.........] - ETA: 21s
439549952/616562950 [====================&gt;.........] - ETA: 21s
440139776/616562950 [====================&gt;.........] - ETA: 21s
440729600/616562950 [====================&gt;.........] - ETA: 21s
441204736/616562950 [====================&gt;.........] - ETA: 21s
441647104/616562950 [====================&gt;.........] - ETA: 21s
441974784/616562950 [====================&gt;.........] - ETA: 21s
442302464/616562950 [====================&gt;.........] - ETA: 21s
442646528/616562950 [====================&gt;.........] - ETA: 21s
442990592/616562950 [====================&gt;.........] - ETA: 21s
443334656/616562950 [====================&gt;.........] - ETA: 21s
443662336/616562950 [====================&gt;.........] - ETA: 21s
444022784/616562950 [====================&gt;.........] - ETA: 20s
444383232/616562950 [====================&gt;.........] - ETA: 20s
444710912/616562950 [====================&gt;.........] - ETA: 20s
445087744/616562950 [====================&gt;.........] - ETA: 20s
445448192/616562950 [====================&gt;.........] - ETA: 20s
445792256/616562950 [====================&gt;.........] - ETA: 20s
446185472/616562950 [====================&gt;.........] - ETA: 20s
446562304/616562950 [====================&gt;.........] - ETA: 20s
446939136/616562950 [====================&gt;.........] - ETA: 20s
447340544/616562950 [====================&gt;.........] - ETA: 20s
447709184/616562950 [====================&gt;.........] - ETA: 20s
448102400/616562950 [====================&gt;.........] - ETA: 20s
448512000/616562950 [====================&gt;.........] - ETA: 20s
448888832/616562950 [====================&gt;.........] - ETA: 20s
449298432/616562950 [====================&gt;.........] - ETA: 20s
449724416/616562950 [====================&gt;.........] - ETA: 20s
450134016/616562950 [====================&gt;.........] - ETA: 20s
450543616/616562950 [====================&gt;.........] - ETA: 20s
450969600/616562950 [====================&gt;.........] - ETA: 20s
451379200/616562950 [====================&gt;.........] - ETA: 20s
451772416/616562950 [====================&gt;.........] - ETA: 20s
452214784/616562950 [=====================&gt;........] - ETA: 19s
452657152/616562950 [=====================&gt;........] - ETA: 19s
453066752/616562950 [=====================&gt;........] - ETA: 19s
453509120/616562950 [=====================&gt;........] - ETA: 19s
453967872/616562950 [=====================&gt;........] - ETA: 19s
454410240/616562950 [=====================&gt;........] - ETA: 19s
454868992/616562950 [=====================&gt;........] - ETA: 19s
455327744/616562950 [=====================&gt;........] - ETA: 19s
455786496/616562950 [=====================&gt;........] - ETA: 19s
456245248/616562950 [=====================&gt;........] - ETA: 19s
456720384/616562950 [=====================&gt;........] - ETA: 19s
457195520/616562950 [=====================&gt;........] - ETA: 19s
457670656/616562950 [=====================&gt;........] - ETA: 19s
458145792/616562950 [=====================&gt;........] - ETA: 19s
458637312/616562950 [=====================&gt;........] - ETA: 19s
459128832/616562950 [=====================&gt;........] - ETA: 19s
459636736/616562950 [=====================&gt;........] - ETA: 19s
460128256/616562950 [=====================&gt;........] - ETA: 19s
460619776/616562950 [=====================&gt;........] - ETA: 18s
461127680/616562950 [=====================&gt;........] - ETA: 18s
461635584/616562950 [=====================&gt;........] - ETA: 18s
462159872/616562950 [=====================&gt;........] - ETA: 18s
462684160/616562950 [=====================&gt;........] - ETA: 18s
463208448/616562950 [=====================&gt;........] - ETA: 18s
463732736/616562950 [=====================&gt;........] - ETA: 18s
464257024/616562950 [=====================&gt;........] - ETA: 18s
464797696/616562950 [=====================&gt;........] - ETA: 18s
465338368/616562950 [=====================&gt;........] - ETA: 18s
465879040/616562950 [=====================&gt;........] - ETA: 18s
466419712/616562950 [=====================&gt;........] - ETA: 18s
466960384/616562950 [=====================&gt;........] - ETA: 18s
467517440/616562950 [=====================&gt;........] - ETA: 18s
468074496/616562950 [=====================&gt;........] - ETA: 17s
468631552/616562950 [=====================&gt;........] - ETA: 17s
469188608/616562950 [=====================&gt;........] - ETA: 17s
469729280/616562950 [=====================&gt;........] - ETA: 17s
470302720/616562950 [=====================&gt;........] - ETA: 17s
470745088/616562950 [=====================&gt;........] - ETA: 17s
471384064/616562950 [=====================&gt;........] - ETA: 17s
471695360/616562950 [=====================&gt;........] - ETA: 17s
472088576/616562950 [=====================&gt;........] - ETA: 17s
472449024/616562950 [=====================&gt;........] - ETA: 17s
472924160/616562950 [======================&gt;.......] - ETA: 17s
473104384/616562950 [======================&gt;.......] - ETA: 17s
473186304/616562950 [======================&gt;.......] - ETA: 17s
473579520/616562950 [======================&gt;.......] - ETA: 17s
473726976/616562950 [======================&gt;.......] - ETA: 17s
473858048/616562950 [======================&gt;.......] - ETA: 17s
474005504/616562950 [======================&gt;.......] - ETA: 17s
474152960/616562950 [======================&gt;.......] - ETA: 17s
474300416/616562950 [======================&gt;.......] - ETA: 17s
474464256/616562950 [======================&gt;.......] - ETA: 17s
474628096/616562950 [======================&gt;.......] - ETA: 17s
474791936/616562950 [======================&gt;.......] - ETA: 17s
474972160/616562950 [======================&gt;.......] - ETA: 17s
475152384/616562950 [======================&gt;.......] - ETA: 17s
475332608/616562950 [======================&gt;.......] - ETA: 17s
475512832/616562950 [======================&gt;.......] - ETA: 17s
475709440/616562950 [======================&gt;.......] - ETA: 17s
475906048/616562950 [======================&gt;.......] - ETA: 17s
476102656/616562950 [======================&gt;.......] - ETA: 17s
476299264/616562950 [======================&gt;.......] - ETA: 17s
476528640/616562950 [======================&gt;.......] - ETA: 17s
476741632/616562950 [======================&gt;.......] - ETA: 17s
476971008/616562950 [======================&gt;.......] - ETA: 17s
477184000/616562950 [======================&gt;.......] - ETA: 17s
477413376/616562950 [======================&gt;.......] - ETA: 17s
477642752/616562950 [======================&gt;.......] - ETA: 17s
477888512/616562950 [======================&gt;.......] - ETA: 17s
478134272/616562950 [======================&gt;.......] - ETA: 17s
478380032/616562950 [======================&gt;.......] - ETA: 17s
478625792/616562950 [======================&gt;.......] - ETA: 16s
478887936/616562950 [======================&gt;.......] - ETA: 16s
479133696/616562950 [======================&gt;.......] - ETA: 16s
479379456/616562950 [======================&gt;.......] - ETA: 16s
479608832/616562950 [======================&gt;.......] - ETA: 16s
480100352/616562950 [======================&gt;.......] - ETA: 16s
480280576/616562950 [======================&gt;.......] - ETA: 16s
480477184/616562950 [======================&gt;.......] - ETA: 16s
480673792/616562950 [======================&gt;.......] - ETA: 16s
480886784/616562950 [======================&gt;.......] - ETA: 16s
481067008/616562950 [======================&gt;.......] - ETA: 16s
481280000/616562950 [======================&gt;.......] - ETA: 16s
481492992/616562950 [======================&gt;.......] - ETA: 16s
481705984/616562950 [======================&gt;.......] - ETA: 16s
481951744/616562950 [======================&gt;.......] - ETA: 16s
482181120/616562950 [======================&gt;.......] - ETA: 16s
482426880/616562950 [======================&gt;.......] - ETA: 16s
482656256/616562950 [======================&gt;.......] - ETA: 16s
482918400/616562950 [======================&gt;.......] - ETA: 16s
483164160/616562950 [======================&gt;.......] - ETA: 16s
483426304/616562950 [======================&gt;.......] - ETA: 16s
483672064/616562950 [======================&gt;.......] - ETA: 16s
483950592/616562950 [======================&gt;.......] - ETA: 16s
484188160/616562950 [======================&gt;.......] - ETA: 16s
484442112/616562950 [======================&gt;.......] - ETA: 16s
484720640/616562950 [======================&gt;.......] - ETA: 16s
484982784/616562950 [======================&gt;.......] - ETA: 16s
485277696/616562950 [======================&gt;.......] - ETA: 16s
485539840/616562950 [======================&gt;.......] - ETA: 16s
485826560/616562950 [======================&gt;.......] - ETA: 16s
486129664/616562950 [======================&gt;.......] - ETA: 16s
486440960/616562950 [======================&gt;.......] - ETA: 16s
486735872/616562950 [======================&gt;.......] - ETA: 16s
487030784/616562950 [======================&gt;.......] - ETA: 16s
487342080/616562950 [======================&gt;.......] - ETA: 16s
487636992/616562950 [======================&gt;.......] - ETA: 16s
487931904/616562950 [======================&gt;.......] - ETA: 16s
488275968/616562950 [======================&gt;.......] - ETA: 16s
488587264/616562950 [======================&gt;.......] - ETA: 15s
488914944/616562950 [======================&gt;.......] - ETA: 15s
489242624/616562950 [======================&gt;.......] - ETA: 15s
489553920/616562950 [======================&gt;.......] - ETA: 15s
489897984/616562950 [======================&gt;.......] - ETA: 15s
490258432/616562950 [======================&gt;.......] - ETA: 15s
490610688/616562950 [======================&gt;.......] - ETA: 15s
490962944/616562950 [======================&gt;.......] - ETA: 15s
491307008/616562950 [======================&gt;.......] - ETA: 15s
491667456/616562950 [======================&gt;.......] - ETA: 15s
492044288/616562950 [======================&gt;.......] - ETA: 15s
492388352/616562950 [======================&gt;.......] - ETA: 15s
492765184/616562950 [======================&gt;.......] - ETA: 15s
493142016/616562950 [======================&gt;.......] - ETA: 15s
493502464/616562950 [=======================&gt;......] - ETA: 15s
493895680/616562950 [=======================&gt;......] - ETA: 15s
494288896/616562950 [=======================&gt;......] - ETA: 15s
494682112/616562950 [=======================&gt;......] - ETA: 15s
495099904/616562950 [=======================&gt;......] - ETA: 15s
495460352/616562950 [=======================&gt;......] - ETA: 15s
495853568/616562950 [=======================&gt;......] - ETA: 15s
496271360/616562950 [=======================&gt;......] - ETA: 15s
496648192/616562950 [=======================&gt;......] - ETA: 15s
497057792/616562950 [=======================&gt;......] - ETA: 14s
497451008/616562950 [=======================&gt;......] - ETA: 14s
497893376/616562950 [=======================&gt;......] - ETA: 14s
498319360/616562950 [=======================&gt;......] - ETA: 14s
498753536/616562950 [=======================&gt;......] - ETA: 14s
499163136/616562950 [=======================&gt;......] - ETA: 14s
499597312/616562950 [=======================&gt;......] - ETA: 14s
500039680/616562950 [=======================&gt;......] - ETA: 14s
500465664/616562950 [=======================&gt;......] - ETA: 14s
500924416/616562950 [=======================&gt;......] - ETA: 14s
501383168/616562950 [=======================&gt;......] - ETA: 14s
501825536/616562950 [=======================&gt;......] - ETA: 14s
502300672/616562950 [=======================&gt;......] - ETA: 14s
502759424/616562950 [=======================&gt;......] - ETA: 14s
503218176/616562950 [=======================&gt;......] - ETA: 14s
503709696/616562950 [=======================&gt;......] - ETA: 14s
504201216/616562950 [=======================&gt;......] - ETA: 14s
504676352/616562950 [=======================&gt;......] - ETA: 13s
505167872/616562950 [=======================&gt;......] - ETA: 13s
505659392/616562950 [=======================&gt;......] - ETA: 13s
506134528/616562950 [=======================&gt;......] - ETA: 13s
506626048/616562950 [=======================&gt;......] - ETA: 13s
507133952/616562950 [=======================&gt;......] - ETA: 13s
507625472/616562950 [=======================&gt;......] - ETA: 13s
508133376/616562950 [=======================&gt;......] - ETA: 13s
508641280/616562950 [=======================&gt;......] - ETA: 13s
509165568/616562950 [=======================&gt;......] - ETA: 13s
509689856/616562950 [=======================&gt;......] - ETA: 13s
510214144/616562950 [=======================&gt;......] - ETA: 13s
510754816/616562950 [=======================&gt;......] - ETA: 13s
511279104/616562950 [=======================&gt;......] - ETA: 13s
511819776/616562950 [=======================&gt;......] - ETA: 13s
512360448/616562950 [=======================&gt;......] - ETA: 12s
512884736/616562950 [=======================&gt;......] - ETA: 12s
513441792/616562950 [=======================&gt;......] - ETA: 12s
513982464/616562950 [========================&gt;.....] - ETA: 12s
514539520/616562950 [========================&gt;.....] - ETA: 12s
515096576/616562950 [========================&gt;.....] - ETA: 12s
515653632/616562950 [========================&gt;.....] - ETA: 12s
516210688/616562950 [========================&gt;.....] - ETA: 12s
516702208/616562950 [========================&gt;.....] - ETA: 12s
516751360/616562950 [========================&gt;.....] - ETA: 12s
517537792/616562950 [========================&gt;.....] - ETA: 12s
517963776/616562950 [========================&gt;.....] - ETA: 12s
518406144/616562950 [========================&gt;.....] - ETA: 12s
518848512/616562950 [========================&gt;.....] - ETA: 12s
519290880/616562950 [========================&gt;.....] - ETA: 12s
519700480/616562950 [========================&gt;.....] - ETA: 12s
520159232/616562950 [========================&gt;.....] - ETA: 11s
520585216/616562950 [========================&gt;.....] - ETA: 11s
521027584/616562950 [========================&gt;.....] - ETA: 11s
521486336/616562950 [========================&gt;.....] - ETA: 11s
521936896/616562950 [========================&gt;.....] - ETA: 11s
522387456/616562950 [========================&gt;.....] - ETA: 11s
522846208/616562950 [========================&gt;.....] - ETA: 11s
523321344/616562950 [========================&gt;.....] - ETA: 11s
523796480/616562950 [========================&gt;.....] - ETA: 11s
524271616/616562950 [========================&gt;.....] - ETA: 11s
524730368/616562950 [========================&gt;.....] - ETA: 11s
525205504/616562950 [========================&gt;.....] - ETA: 11s
525680640/616562950 [========================&gt;.....] - ETA: 11s
526172160/616562950 [========================&gt;.....] - ETA: 11s
526663680/616562950 [========================&gt;.....] - ETA: 11s
527138816/616562950 [========================&gt;.....] - ETA: 11s
527630336/616562950 [========================&gt;.....] - ETA: 11s
528138240/616562950 [========================&gt;.....] - ETA: 10s
528646144/616562950 [========================&gt;.....] - ETA: 10s
529137664/616562950 [========================&gt;.....] - ETA: 10s
529661952/616562950 [========================&gt;.....] - ETA: 10s
530169856/616562950 [========================&gt;.....] - ETA: 10s
530677760/616562950 [========================&gt;.....] - ETA: 10s
531202048/616562950 [========================&gt;.....] - ETA: 10s
531726336/616562950 [========================&gt;.....] - ETA: 10s
532250624/616562950 [========================&gt;.....] - ETA: 10s
532791296/616562950 [========================&gt;.....] - ETA: 10s
533331968/616562950 [========================&gt;.....] - ETA: 10s
533872640/616562950 [========================&gt;.....] - ETA: 10s
534413312/616562950 [=========================&gt;....] - ETA: 10s
534970368/616562950 [=========================&gt;....] - ETA: 10s
535511040/616562950 [=========================&gt;....] - ETA: 10s
536068096/616562950 [=========================&gt;....] - ETA: 9s 
536625152/616562950 [=========================&gt;....] - ETA: 9s
537165824/616562950 [=========================&gt;....] - ETA: 9s
537690112/616562950 [=========================&gt;....] - ETA: 9s
538263552/616562950 [=========================&gt;....] - ETA: 9s
538836992/616562950 [=========================&gt;....] - ETA: 9s
539394048/616562950 [=========================&gt;....] - ETA: 9s
539983872/616562950 [=========================&gt;....] - ETA: 9s
540573696/616562950 [=========================&gt;....] - ETA: 9s
541163520/616562950 [=========================&gt;....] - ETA: 9s
541753344/616562950 [=========================&gt;....] - ETA: 9s
542343168/616562950 [=========================&gt;....] - ETA: 9s
542932992/616562950 [=========================&gt;....] - ETA: 9s
543522816/616562950 [=========================&gt;....] - ETA: 8s
544112640/616562950 [=========================&gt;....] - ETA: 8s
544702464/616562950 [=========================&gt;....] - ETA: 8s
545292288/616562950 [=========================&gt;....] - ETA: 8s
545882112/616562950 [=========================&gt;....] - ETA: 8s
546488320/616562950 [=========================&gt;....] - ETA: 8s
547078144/616562950 [=========================&gt;....] - ETA: 8s
547667968/616562950 [=========================&gt;....] - ETA: 8s
548241408/616562950 [=========================&gt;....] - ETA: 8s
548831232/616562950 [=========================&gt;....] - ETA: 8s
549421056/616562950 [=========================&gt;....] - ETA: 8s
550010880/616562950 [=========================&gt;....] - ETA: 8s
550600704/616562950 [=========================&gt;....] - ETA: 8s
551206912/616562950 [=========================&gt;....] - ETA: 8s
551796736/616562950 [=========================&gt;....] - ETA: 7s
552386560/616562950 [=========================&gt;....] - ETA: 7s
552992768/616562950 [=========================&gt;....] - ETA: 7s
553582592/616562950 [=========================&gt;....] - ETA: 7s
554172416/616562950 [=========================&gt;....] - ETA: 7s
554762240/616562950 [=========================&gt;....] - ETA: 7s
555368448/616562950 [==========================&gt;...] - ETA: 7s
555958272/616562950 [==========================&gt;...] - ETA: 7s
556548096/616562950 [==========================&gt;...] - ETA: 7s
557137920/616562950 [==========================&gt;...] - ETA: 7s
557727744/616562950 [==========================&gt;...] - ETA: 7s
558317568/616562950 [==========================&gt;...] - ETA: 7s
558907392/616562950 [==========================&gt;...] - ETA: 7s
559497216/616562950 [==========================&gt;...] - ETA: 6s
560087040/616562950 [==========================&gt;...] - ETA: 6s
560676864/616562950 [==========================&gt;...] - ETA: 6s
561283072/616562950 [==========================&gt;...] - ETA: 6s
561872896/616562950 [==========================&gt;...] - ETA: 6s
561971200/616562950 [==========================&gt;...] - ETA: 6s
562823168/616562950 [==========================&gt;...] - ETA: 6s
563707904/616562950 [==========================&gt;...] - ETA: 6s
564101120/616562950 [==========================&gt;...] - ETA: 6s
564477952/616562950 [==========================&gt;...] - ETA: 6s
564854784/616562950 [==========================&gt;...] - ETA: 6s
565248000/616562950 [==========================&gt;...] - ETA: 6s
565641216/616562950 [==========================&gt;...] - ETA: 6s
566050816/616562950 [==========================&gt;...] - ETA: 6s
566444032/616562950 [==========================&gt;...] - ETA: 6s
566837248/616562950 [==========================&gt;...] - ETA: 6s
567263232/616562950 [==========================&gt;...] - ETA: 6s
567672832/616562950 [==========================&gt;...] - ETA: 5s
568098816/616562950 [==========================&gt;...] - ETA: 5s
568508416/616562950 [==========================&gt;...] - ETA: 5s
568934400/616562950 [==========================&gt;...] - ETA: 5s
569360384/616562950 [==========================&gt;...] - ETA: 5s
569802752/616562950 [==========================&gt;...] - ETA: 5s
570228736/616562950 [==========================&gt;...] - ETA: 5s
570654720/616562950 [==========================&gt;...] - ETA: 5s
571113472/616562950 [==========================&gt;...] - ETA: 5s
571572224/616562950 [==========================&gt;...] - ETA: 5s
571998208/616562950 [==========================&gt;...] - ETA: 5s
572456960/616562950 [==========================&gt;...] - ETA: 5s
572932096/616562950 [==========================&gt;...] - ETA: 5s
573407232/616562950 [==========================&gt;...] - ETA: 5s
573882368/616562950 [==========================&gt;...] - ETA: 5s
574324736/616562950 [==========================&gt;...] - ETA: 5s
574799872/616562950 [==========================&gt;...] - ETA: 5s
575275008/616562950 [==========================&gt;...] - ETA: 5s
575750144/616562950 [===========================&gt;..] - ETA: 4s
576241664/616562950 [===========================&gt;..] - ETA: 4s
576733184/616562950 [===========================&gt;..] - ETA: 4s
577208320/616562950 [===========================&gt;..] - ETA: 4s
577716224/616562950 [===========================&gt;..] - ETA: 4s
578224128/616562950 [===========================&gt;..] - ETA: 4s
578715648/616562950 [===========================&gt;..] - ETA: 4s
579223552/616562950 [===========================&gt;..] - ETA: 4s
579747840/616562950 [===========================&gt;..] - ETA: 4s
580255744/616562950 [===========================&gt;..] - ETA: 4s
580780032/616562950 [===========================&gt;..] - ETA: 4s
581304320/616562950 [===========================&gt;..] - ETA: 4s
581828608/616562950 [===========================&gt;..] - ETA: 4s
582352896/616562950 [===========================&gt;..] - ETA: 4s
582893568/616562950 [===========================&gt;..] - ETA: 4s
583434240/616562950 [===========================&gt;..] - ETA: 4s
583974912/616562950 [===========================&gt;..] - ETA: 3s
584531968/616562950 [===========================&gt;..] - ETA: 3s
585089024/616562950 [===========================&gt;..] - ETA: 3s
585629696/616562950 [===========================&gt;..] - ETA: 3s
586186752/616562950 [===========================&gt;..] - ETA: 3s
586760192/616562950 [===========================&gt;..] - ETA: 3s
587317248/616562950 [===========================&gt;..] - ETA: 3s
587890688/616562950 [===========================&gt;..] - ETA: 3s
588464128/616562950 [===========================&gt;..] - ETA: 3s
589037568/616562950 [===========================&gt;..] - ETA: 3s
589611008/616562950 [===========================&gt;..] - ETA: 3s
590200832/616562950 [===========================&gt;..] - ETA: 3s
590790656/616562950 [===========================&gt;..] - ETA: 3s
591380480/616562950 [===========================&gt;..] - ETA: 3s
591970304/616562950 [===========================&gt;..] - ETA: 2s
592568320/616562950 [===========================&gt;..] - ETA: 2s
593149952/616562950 [===========================&gt;..] - ETA: 2s
593739776/616562950 [===========================&gt;..] - ETA: 2s
594313216/616562950 [===========================&gt;..] - ETA: 2s
594903040/616562950 [===========================&gt;..] - ETA: 2s
595492864/616562950 [===========================&gt;..] - ETA: 2s
596082688/616562950 [============================&gt;.] - ETA: 2s
596672512/616562950 [============================&gt;.] - ETA: 2s
597278720/616562950 [============================&gt;.] - ETA: 2s
597868544/616562950 [============================&gt;.] - ETA: 2s
598474752/616562950 [============================&gt;.] - ETA: 2s
599064576/616562950 [============================&gt;.] - ETA: 2s
599654400/616562950 [============================&gt;.] - ETA: 2s
600244224/616562950 [============================&gt;.] - ETA: 1s
600834048/616562950 [============================&gt;.] - ETA: 1s
601440256/616562950 [============================&gt;.] - ETA: 1s
602030080/616562950 [============================&gt;.] - ETA: 1s
602636288/616562950 [============================&gt;.] - ETA: 1s
603242496/616562950 [============================&gt;.] - ETA: 1s
603832320/616562950 [============================&gt;.] - ETA: 1s
604422144/616562950 [============================&gt;.] - ETA: 1s
605011968/616562950 [============================&gt;.] - ETA: 1s
605601792/616562950 [============================&gt;.] - ETA: 1s
606191616/616562950 [============================&gt;.] - ETA: 1s
606781440/616562950 [============================&gt;.] - ETA: 1s
607371264/616562950 [============================&gt;.] - ETA: 1s
607977472/616562950 [============================&gt;.] - ETA: 1s
608567296/616562950 [============================&gt;.] - ETA: 0s
609157120/616562950 [============================&gt;.] - ETA: 0s
609746944/616562950 [============================&gt;.] - ETA: 0s
610336768/616562950 [============================&gt;.] - ETA: 0s
610926592/616562950 [============================&gt;.] - ETA: 0s
611516416/616562950 [============================&gt;.] - ETA: 0s
612106240/616562950 [============================&gt;.] - ETA: 0s
612499456/616562950 [============================&gt;.] - ETA: 0s
613351424/616562950 [============================&gt;.] - ETA: 0s
614219776/616562950 [============================&gt;.] - ETA: 0s
614612992/616562950 [============================&gt;.] - ETA: 0s
614973440/616562950 [============================&gt;.] - ETA: 0s
615366656/616562950 [============================&gt;.] - ETA: 0s
615743488/616562950 [============================&gt;.] - ETA: 0s
616120320/616562950 [============================&gt;.] - ETA: 0s
616529920/616562950 [============================&gt;.] - ETA: 0s
616562950/616562950 [==============================] - 74s 0us/step
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">quantizeml.models</span> <span class="kn">import</span> <span class="n">quantize</span>
<span class="kn">from</span> <span class="nn">quantizeml.layers</span> <span class="kn">import</span> <span class="n">QuantizationParams</span>

<span class="c1"># Quantize the model to 8-bit and calibrate using 1024 samples with a batch size of 100 over 2</span>
<span class="c1"># epochs.</span>
<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">quantize</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span>
                           <span class="n">qparams</span><span class="o">=</span><span class="n">QuantizationParams</span><span class="p">(</span><span class="n">weight_bits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">activation_bits</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
                           <span class="n">num_samples</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 48s
 2/11 [====&gt;.........................] - ETA: 1s 
 3/11 [=======&gt;......................] - ETA: 1s
 4/11 [=========&gt;....................] - ETA: 1s
 5/11 [============&gt;.................] - ETA: 0s
 6/11 [===============&gt;..............] - ETA: 0s
 7/11 [==================&gt;...........] - ETA: 0s
 8/11 [====================&gt;.........] - ETA: 0s
 9/11 [=======================&gt;......] - ETA: 0s
10/11 [==========================&gt;...] - ETA: 0s
11/11 [==============================] - ETA: 0s
11/11 [==============================] - 6s 163ms/step

 1/11 [=&gt;............................] - ETA: 1s
 2/11 [====&gt;.........................] - ETA: 1s
 3/11 [=======&gt;......................] - ETA: 1s
 4/11 [=========&gt;....................] - ETA: 1s
 5/11 [============&gt;.................] - ETA: 1s
 6/11 [===============&gt;..............] - ETA: 0s
 7/11 [==================&gt;...........] - ETA: 0s
 8/11 [====================&gt;.........] - ETA: 0s
 9/11 [=======================&gt;......] - ETA: 0s
10/11 [==========================&gt;...] - ETA: 0s
11/11 [==============================] - ETA: 0s
11/11 [==============================] - 2s 162ms/step
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 34s 34s/step
Keras accuracy: 90.00 %
</pre></div>
</div>
</section>
<section id="load-a-pre-trained-quantized-keras-model">
<h3>3.2. Load a pre-trained quantized Keras model<a class="headerlink" href="#load-a-pre-trained-quantized-keras-model" title="Permalink to this headline"></a></h3>
<p>The <a class="reference external" href="../../api_reference/akida_models_apis.html#akida_models.bc_vit_ti16_imagenet_pretrained">bc_vit_ti16_imagenet_pretrained helper</a> was
obtained with the same 8-bit quantization scheme but with an additional QAT step to further
improve accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">bc_vit_ti16_imagenet_pretrained</span>

<span class="c1"># Load the pre-trained quantized model</span>
<span class="n">model_quantized</span> <span class="o">=</span> <span class="n">bc_vit_ti16_imagenet_pretrained</span><span class="p">()</span>
<span class="n">model_quantized</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from https://data.brainchip.com/models/AkidaV2/vit/bc_vit_ti16_224_i8_w8_a8.h5.

       0/24405400 [..............................] - ETA: 0s
  114688/24405400 [..............................] - ETA: 12s
  196608/24405400 [..............................] - ETA: 13s
  237568/24405400 [..............................] - ETA: 19s
  507904/24405400 [..............................] - ETA: 12s
  532480/24405400 [..............................] - ETA: 15s
  598016/24405400 [..............................] - ETA: 16s
  622592/24405400 [..............................] - ETA: 17s
  655360/24405400 [..............................] - ETA: 19s
  663552/24405400 [..............................] - ETA: 22s
  688128/24405400 [..............................] - ETA: 23s
  704512/24405400 [..............................] - ETA: 25s
  712704/24405400 [..............................] - ETA: 49s
  720896/24405400 [..............................] - ETA: 51s
  729088/24405400 [..............................] - ETA: 53s
  737280/24405400 [..............................] - ETA: 1:04
  745472/24405400 [..............................] - ETA: 1:07
  753664/24405400 [..............................] - ETA: 1:14
  761856/24405400 [..............................] - ETA: 1:16
  778240/24405400 [..............................] - ETA: 1:24
  802816/24405400 [..............................] - ETA: 1:23
  827392/24405400 [&gt;.............................] - ETA: 1:22
  851968/24405400 [&gt;.............................] - ETA: 1:21
  884736/24405400 [&gt;.............................] - ETA: 1:19
  942080/24405400 [&gt;.............................] - ETA: 1:16
  999424/24405400 [&gt;.............................] - ETA: 1:12
 1056768/24405400 [&gt;.............................] - ETA: 1:10
 1122304/24405400 [&gt;.............................] - ETA: 1:07
 1204224/24405400 [&gt;.............................] - ETA: 1:03
 1212416/24405400 [&gt;.............................] - ETA: 1:04
 1261568/24405400 [&gt;.............................] - ETA: 1:05
 1310720/24405400 [&gt;.............................] - ETA: 1:03
 1318912/24405400 [&gt;.............................] - ETA: 1:04
 1335296/24405400 [&gt;.............................] - ETA: 1:05
 1359872/24405400 [&gt;.............................] - ETA: 1:16
 1368064/24405400 [&gt;.............................] - ETA: 1:17
 1392640/24405400 [&gt;.............................] - ETA: 1:17
 1417216/24405400 [&gt;.............................] - ETA: 1:17
 1449984/24405400 [&gt;.............................] - ETA: 1:16
 1474560/24405400 [&gt;.............................] - ETA: 1:16
 1515520/24405400 [&gt;.............................] - ETA: 1:14
 1523712/24405400 [&gt;.............................] - ETA: 1:15
 1540096/24405400 [&gt;.............................] - ETA: 1:15
 1556480/24405400 [&gt;.............................] - ETA: 1:15
 1581056/24405400 [&gt;.............................] - ETA: 1:15
 1597440/24405400 [&gt;.............................] - ETA: 1:15
 1613824/24405400 [&gt;.............................] - ETA: 1:15
 1638400/24405400 [=&gt;............................] - ETA: 1:16
 1662976/24405400 [=&gt;............................] - ETA: 1:15
 1687552/24405400 [=&gt;............................] - ETA: 1:15
 1703936/24405400 [=&gt;............................] - ETA: 1:16
 1728512/24405400 [=&gt;............................] - ETA: 1:16
 1736704/24405400 [=&gt;............................] - ETA: 1:18
 1753088/24405400 [=&gt;............................] - ETA: 1:18
 1769472/24405400 [=&gt;............................] - ETA: 1:18
 1785856/24405400 [=&gt;............................] - ETA: 1:18
 1802240/24405400 [=&gt;............................] - ETA: 1:39
 1818624/24405400 [=&gt;............................] - ETA: 1:39
 1851392/24405400 [=&gt;............................] - ETA: 1:37
 1884160/24405400 [=&gt;............................] - ETA: 1:36
 1916928/24405400 [=&gt;............................] - ETA: 1:35
 1949696/24405400 [=&gt;............................] - ETA: 1:34
 2007040/24405400 [=&gt;............................] - ETA: 1:32
 2064384/24405400 [=&gt;............................] - ETA: 1:30
 2105344/24405400 [=&gt;............................] - ETA: 1:28
 2162688/24405400 [=&gt;............................] - ETA: 1:26
 2211840/24405400 [=&gt;............................] - ETA: 1:25
 2260992/24405400 [=&gt;............................] - ETA: 1:23
 2310144/24405400 [=&gt;............................] - ETA: 1:22
 2367488/24405400 [=&gt;............................] - ETA: 1:20
 2416640/24405400 [=&gt;............................] - ETA: 1:19
 2424832/24405400 [=&gt;............................] - ETA: 1:19
 2441216/24405400 [==&gt;...........................] - ETA: 1:19
 2490368/24405400 [==&gt;...........................] - ETA: 1:18
 2523136/24405400 [==&gt;...........................] - ETA: 1:18
 2547712/24405400 [==&gt;...........................] - ETA: 1:17
 2596864/24405400 [==&gt;...........................] - ETA: 1:16
 2613248/24405400 [==&gt;...........................] - ETA: 1:16
 2637824/24405400 [==&gt;...........................] - ETA: 1:16
 2670592/24405400 [==&gt;...........................] - ETA: 1:16
 2703360/24405400 [==&gt;...........................] - ETA: 1:15
 2727936/24405400 [==&gt;...........................] - ETA: 1:16
 2752512/24405400 [==&gt;...........................] - ETA: 1:15
 2768896/24405400 [==&gt;...........................] - ETA: 1:15
 2785280/24405400 [==&gt;...........................] - ETA: 1:15
 2809856/24405400 [==&gt;...........................] - ETA: 1:15
 2818048/24405400 [==&gt;...........................] - ETA: 1:15
 2834432/24405400 [==&gt;...........................] - ETA: 1:15
 2842624/24405400 [==&gt;...........................] - ETA: 1:17
 2859008/24405400 [==&gt;...........................] - ETA: 1:18
 2875392/24405400 [==&gt;...........................] - ETA: 1:17
 2883584/24405400 [==&gt;...........................] - ETA: 1:18
 2899968/24405400 [==&gt;...........................] - ETA: 1:18
 2908160/24405400 [==&gt;...........................] - ETA: 1:18
 2916352/24405400 [==&gt;...........................] - ETA: 1:21
 2932736/24405400 [==&gt;...........................] - ETA: 1:21
 2957312/24405400 [==&gt;...........................] - ETA: 1:20
 2981888/24405400 [==&gt;...........................] - ETA: 1:20
 2998272/24405400 [==&gt;...........................] - ETA: 1:20
 3022848/24405400 [==&gt;...........................] - ETA: 1:20
 3039232/24405400 [==&gt;...........................] - ETA: 1:20
 3055616/24405400 [==&gt;...........................] - ETA: 1:20
 3072000/24405400 [==&gt;...........................] - ETA: 1:21
 3088384/24405400 [==&gt;...........................] - ETA: 1:21
 3112960/24405400 [==&gt;...........................] - ETA: 1:20
 3137536/24405400 [==&gt;...........................] - ETA: 1:20
 3170304/24405400 [==&gt;...........................] - ETA: 1:19
 3203072/24405400 [==&gt;...........................] - ETA: 1:19
 3211264/24405400 [==&gt;...........................] - ETA: 1:21
 3227648/24405400 [==&gt;...........................] - ETA: 1:21
 3252224/24405400 [==&gt;...........................] - ETA: 1:20
 3268608/24405400 [===&gt;..........................] - ETA: 1:20
 3293184/24405400 [===&gt;..........................] - ETA: 1:20
 3317760/24405400 [===&gt;..........................] - ETA: 1:20
 3342336/24405400 [===&gt;..........................] - ETA: 1:19
 3383296/24405400 [===&gt;..........................] - ETA: 1:19
 3424256/24405400 [===&gt;..........................] - ETA: 1:18
 3473408/24405400 [===&gt;..........................] - ETA: 1:17
 3522560/24405400 [===&gt;..........................] - ETA: 1:16
 3588096/24405400 [===&gt;..........................] - ETA: 1:15
 3637248/24405400 [===&gt;..........................] - ETA: 1:14
 3686400/24405400 [===&gt;..........................] - ETA: 1:13
 3751936/24405400 [===&gt;..........................] - ETA: 1:12
 3817472/24405400 [===&gt;..........................] - ETA: 1:11
 3891200/24405400 [===&gt;..........................] - ETA: 1:10
 3956736/24405400 [===&gt;..........................] - ETA: 1:08
 4038656/24405400 [===&gt;..........................] - ETA: 1:07
 4136960/24405400 [====&gt;.........................] - ETA: 1:05
 4235264/24405400 [====&gt;.........................] - ETA: 1:04
 4333568/24405400 [====&gt;.........................] - ETA: 1:02
 4399104/24405400 [====&gt;.........................] - ETA: 1:02
 4497408/24405400 [====&gt;.........................] - ETA: 1:00
 4546560/24405400 [====&gt;.........................] - ETA: 1:00
 4612096/24405400 [====&gt;.........................] - ETA: 59s 
 4677632/24405400 [====&gt;.........................] - ETA: 58s
 4743168/24405400 [====&gt;.........................] - ETA: 57s
 4808704/24405400 [====&gt;.........................] - ETA: 57s
 4874240/24405400 [====&gt;.........................] - ETA: 56s
 4972544/24405400 [=====&gt;........................] - ETA: 55s
 5054464/24405400 [=====&gt;........................] - ETA: 54s
 5152768/24405400 [=====&gt;........................] - ETA: 53s
 5267456/24405400 [=====&gt;........................] - ETA: 51s
 5365760/24405400 [=====&gt;........................] - ETA: 50s
 5480448/24405400 [=====&gt;........................] - ETA: 49s
 5611520/24405400 [=====&gt;........................] - ETA: 48s
 5742592/24405400 [======&gt;.......................] - ETA: 47s
 5873664/24405400 [======&gt;.......................] - ETA: 45s
 6021120/24405400 [======&gt;.......................] - ETA: 44s
 6168576/24405400 [======&gt;.......................] - ETA: 43s
 6332416/24405400 [======&gt;.......................] - ETA: 42s
 6496256/24405400 [======&gt;.......................] - ETA: 40s
 6676480/24405400 [=======&gt;......................] - ETA: 39s
 6856704/24405400 [=======&gt;......................] - ETA: 38s
 7036928/24405400 [=======&gt;......................] - ETA: 36s
 7233536/24405400 [=======&gt;......................] - ETA: 35s
 7430144/24405400 [========&gt;.....................] - ETA: 34s
 7626752/24405400 [========&gt;.....................] - ETA: 33s
 7839744/24405400 [========&gt;.....................] - ETA: 32s
 8052736/24405400 [========&gt;.....................] - ETA: 31s
 8282112/24405400 [=========&gt;....................] - ETA: 29s
 8511488/24405400 [=========&gt;....................] - ETA: 28s
 8740864/24405400 [=========&gt;....................] - ETA: 27s
 8986624/24405400 [==========&gt;...................] - ETA: 26s
 9232384/24405400 [==========&gt;...................] - ETA: 25s
 9478144/24405400 [==========&gt;...................] - ETA: 24s
 9723904/24405400 [==========&gt;...................] - ETA: 23s
 9953280/24405400 [===========&gt;..................] - ETA: 22s
10199040/24405400 [===========&gt;..................] - ETA: 21s
10461184/24405400 [===========&gt;..................] - ETA: 21s
10706944/24405400 [============&gt;.................] - ETA: 20s
10969088/24405400 [============&gt;.................] - ETA: 19s
11264000/24405400 [============&gt;.................] - ETA: 18s
11558912/24405400 [=============&gt;................] - ETA: 17s
11821056/24405400 [=============&gt;................] - ETA: 17s
12099584/24405400 [=============&gt;................] - ETA: 16s
12394496/24405400 [==============&gt;...............] - ETA: 15s
12673024/24405400 [==============&gt;...............] - ETA: 15s
12984320/24405400 [==============&gt;...............] - ETA: 14s
13295616/24405400 [===============&gt;..............] - ETA: 13s
13590528/24405400 [===============&gt;..............] - ETA: 13s
13910016/24405400 [================&gt;.............] - ETA: 12s
14196736/24405400 [================&gt;.............] - ETA: 11s
14508032/24405400 [================&gt;.............] - ETA: 11s
14819328/24405400 [=================&gt;............] - ETA: 10s
15130624/24405400 [=================&gt;............] - ETA: 10s
15441920/24405400 [=================&gt;............] - ETA: 9s 
15785984/24405400 [==================&gt;...........] - ETA: 9s
16113664/24405400 [==================&gt;...........] - ETA: 8s
16457728/24405400 [===================&gt;..........] - ETA: 8s
16801792/24405400 [===================&gt;..........] - ETA: 7s
17145856/24405400 [====================&gt;.........] - ETA: 7s
17489920/24405400 [====================&gt;.........] - ETA: 6s
17817600/24405400 [====================&gt;.........] - ETA: 6s
18128896/24405400 [=====================&gt;........] - ETA: 5s
18423808/24405400 [=====================&gt;........] - ETA: 5s
18685952/24405400 [=====================&gt;........] - ETA: 5s
18948096/24405400 [======================&gt;.......] - ETA: 4s
19226624/24405400 [======================&gt;.......] - ETA: 4s
19505152/24405400 [======================&gt;.......] - ETA: 4s
19750912/24405400 [=======================&gt;......] - ETA: 4s
20029440/24405400 [=======================&gt;......] - ETA: 3s
20226048/24405400 [=======================&gt;......] - ETA: 3s
20520960/24405400 [========================&gt;.....] - ETA: 3s
20684800/24405400 [========================&gt;.....] - ETA: 3s
20865024/24405400 [========================&gt;.....] - ETA: 3s
21045248/24405400 [========================&gt;.....] - ETA: 2s
21225472/24405400 [=========================&gt;....] - ETA: 2s
21405696/24405400 [=========================&gt;....] - ETA: 2s
21585920/24405400 [=========================&gt;....] - ETA: 2s
21774336/24405400 [=========================&gt;....] - ETA: 2s
21946368/24405400 [=========================&gt;....] - ETA: 2s
22142976/24405400 [==========================&gt;...] - ETA: 1s
22339584/24405400 [==========================&gt;...] - ETA: 1s
22552576/24405400 [==========================&gt;...] - ETA: 1s
22749184/24405400 [==========================&gt;...] - ETA: 1s
22945792/24405400 [===========================&gt;..] - ETA: 1s
23142400/24405400 [===========================&gt;..] - ETA: 1s
23322624/24405400 [===========================&gt;..] - ETA: 0s
23552000/24405400 [===========================&gt;..] - ETA: 0s
23781376/24405400 [============================&gt;.] - ETA: 0s
24010752/24405400 [============================&gt;.] - ETA: 0s
24109056/24405400 [============================&gt;.] - ETA: 0s
24354816/24405400 [============================&gt;.] - ETA: 0s
24405400/24405400 [==============================] - 19s 1us/step
Model: &quot;vit-tiny&quot;
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input (InputLayer)             [(None, 224, 224, 3  0           []
                                )]

 Rescale (QuantizedRescaling)   (None, 224, 224, 3)  0           [&#39;input[0][0]&#39;]

 Embedding (QuantizedConv2D)    (None, 14, 14, 192)  147648      [&#39;Rescale[0][0]&#39;]

 reshape (QuantizedReshape)     (None, 196, 192)     0           [&#39;Embedding[0][0]&#39;]

 ClassToken (QuantizedClassToke  (None, 197, 192)    192         [&#39;reshape[0][0]&#39;]
 n)

 Transformer/PosEmbed (Quantize  (None, 197, 192)    38208       [&#39;ClassToken[0][0]&#39;]
 dAddPositionEmbs)

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    768         [&#39;Transformer/PosEmbed[0][0]&#39;]
 erNorm_0 (QuantizedLayerNormal
 ization)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_0/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_0/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_0/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_0/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout (QuantizedDropout)     (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    384         [&#39;dropout[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/PosEmbed[0][0]&#39;]

 Transformer/EncoderBlock_0/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_0/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_0/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_1 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_0/Mlp  (None, 197, 192)    148032      [&#39;dropout_1[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_2 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_0/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_0/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_0/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_0/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_1/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_1/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_1/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_1/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_3 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    384         [&#39;dropout_3[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_0/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_1/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_1/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_1/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_4 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_1/Mlp  (None, 197, 192)    148032      [&#39;dropout_4[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_5 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_1/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_1/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_1/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_5[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_1/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_2/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_2/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_2/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_2/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_6 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    384         [&#39;dropout_6[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_1/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_2/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_2/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_2/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_7 (QuantizedDropout)   (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_2/Mlp  (None, 197, 192)    148032      [&#39;dropout_7[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_8 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_2/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_2/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_2/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_8[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_2/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_3/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_3/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_3/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_3/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_9 (QuantizedDropout)   (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    384         [&#39;dropout_9[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_2/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_3/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_3/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_3/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_10 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_3/Mlp  (None, 197, 192)    148032      [&#39;dropout_10[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_11 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_3/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_3/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_3/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_11[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_3/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_4/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_4/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_4/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_4/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_12 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    384         [&#39;dropout_12[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_3/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_4/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_4/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_4/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_13 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_4/Mlp  (None, 197, 192)    148032      [&#39;dropout_13[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_14 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_4/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_4/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_4/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_14[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_4/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_5/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_5/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_5/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_5/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_15 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    384         [&#39;dropout_15[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_4/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_5/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_5/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_5/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_16 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_5/Mlp  (None, 197, 192)    148032      [&#39;dropout_16[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_17 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_5/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_5/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_5/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_17[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_5/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_6/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_6/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_6/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_6/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_18 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    384         [&#39;dropout_18[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_5/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_6/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_6/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_6/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_19 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_6/Mlp  (None, 197, 192)    148032      [&#39;dropout_19[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_20 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_6/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_6/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_6/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_20[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_6/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_7/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_7/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_7/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_7/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_21 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    384         [&#39;dropout_21[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_6/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_7/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_7/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_7/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_22 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_7/Mlp  (None, 197, 192)    148032      [&#39;dropout_22[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_23 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_7/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_7/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_7/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_23[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_7/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_8/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_8/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_8/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_8/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_24 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    384         [&#39;dropout_24[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_7/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_8/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_8/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_8/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_25 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_8/Mlp  (None, 197, 192)    148032      [&#39;dropout_25[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_26 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_8/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_8/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_8/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_26[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_8/add_
 erNorm_0 (QuantizedLayerNormal                                  2[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/qu                                  rNorm_0[0][0]&#39;]
 ery (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/ke                                  rNorm_0[0][0]&#39;]
 y (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_9/Laye
 tiHeadDotProductAttention_1/va                                  rNorm_0[0][0]&#39;]
 lue (QuantizedDense)

 Transformer/EncoderBlock_9/Mul  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/at   (None, 3, 197, 197             iHeadDotProductAttention_1/query[
 tention (QuantizedAttention)   ))                               0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/key[0]
                                                                 [0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/value[
                                                                 0][0]&#39;]

 Transformer/EncoderBlock_9/Mul  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_9/Mult
 tiHeadDotProductAttention_1/ou                                  iHeadDotProductAttention_1/attent
 t (QuantizedDense)                                              ion[0][0]&#39;]

 dropout_27 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/Mult
                                                                 iHeadDotProductAttention_1/out[0]
                                                                 [0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    384         [&#39;dropout_27[0][0]&#39;,
 _1 (QuantizedAdd)                                                &#39;Transformer/EncoderBlock_8/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_9/Lay  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_9/add_
 erNorm_2 (QuantizedLayerNormal                                  1[0][0]&#39;]
 ization)

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_9/Laye
 Block/Dense_0 (QuantizedDense)                                  rNorm_2[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_9/MlpB
 Block/activation (QuantizedReL                                  lock/Dense_0[0][0]&#39;]
 U)

 dropout_28 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/activation[0][0]&#39;]

 Transformer/EncoderBlock_9/Mlp  (None, 197, 192)    148032      [&#39;dropout_28[0][0]&#39;]
 Block/Dense_1 (QuantizedDense)

 dropout_29 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_9/MlpB
                                                                 lock/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_9/add  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_9/add_
 _2 (QuantizedAdd)                                               1[0][0]&#39;,
                                                                  &#39;dropout_29[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_9/add_
 yerNorm_0 (QuantizedLayerNorma                                  2[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_10/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (QuantizedDense)

 Transformer/EncoderBlock_10/Mu  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (QuantizedAttention)  ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_10/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_10/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (QuantizedDense)                                             tion[0][0]&#39;]

 dropout_30 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    384         [&#39;dropout_30[0][0]&#39;,
 d_1 (QuantizedAdd)                                               &#39;Transformer/EncoderBlock_9/add_
                                                                 2[0][0]&#39;]

 Transformer/EncoderBlock_10/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_2 (QuantizedLayerNorma                                  _1[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_10/Lay
 pBlock/Dense_0 (QuantizedDense                                  erNorm_2[0][0]&#39;]
 )

 Transformer/EncoderBlock_10/Ml  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_10/Mlp
 pBlock/activation (QuantizedRe                                  Block/Dense_0[0][0]&#39;]
 LU)

 dropout_31 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_10/Ml  (None, 197, 192)    148032      [&#39;dropout_31[0][0]&#39;]
 pBlock/Dense_1 (QuantizedDense
 )

 dropout_32 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_10/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_10/ad  (None, 197, 192)    384         [&#39;Transformer/EncoderBlock_10/add
 d_2 (QuantizedAdd)                                              _1[0][0]&#39;,
                                                                  &#39;dropout_32[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_10/add
 yerNorm_0 (QuantizedLayerNorma                                  _2[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/q                                  erNorm_0[0][0]&#39;]
 uery (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37058       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/k                                  erNorm_0[0][0]&#39;]
 ey (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_11/Lay
 ltiHeadDotProductAttention_1/v                                  erNorm_0[0][0]&#39;]
 alue (QuantizedDense)

 Transformer/EncoderBlock_11/Mu  ((None, 197, 192),  384         [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/a   (None, 3, 197, 197             tiHeadDotProductAttention_1/query
 ttention (QuantizedAttention)  ))                               [0][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/key[0
                                                                 ][0]&#39;,
                                                                  &#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/value
                                                                 [0][0]&#39;]

 Transformer/EncoderBlock_11/Mu  (None, 197, 192)    37440       [&#39;Transformer/EncoderBlock_11/Mul
 ltiHeadDotProductAttention_1/o                                  tiHeadDotProductAttention_1/atten
 ut (QuantizedDense)                                             tion[0][0]&#39;]

 dropout_33 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mul
                                                                 tiHeadDotProductAttention_1/out[0
                                                                 ][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    384         [&#39;dropout_33[0][0]&#39;,
 d_1 (QuantizedAdd)                                               &#39;Transformer/EncoderBlock_10/add
                                                                 _2[0][0]&#39;]

 Transformer/EncoderBlock_11/La  (None, 197, 192)    768         [&#39;Transformer/EncoderBlock_11/add
 yerNorm_2 (QuantizedLayerNorma                                  _1[0][0]&#39;]
 lization)

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    148224      [&#39;Transformer/EncoderBlock_11/Lay
 pBlock/Dense_0 (QuantizedDense                                  erNorm_2[0][0]&#39;]
 )

 Transformer/EncoderBlock_11/Ml  (None, 197, 768)    1536        [&#39;Transformer/EncoderBlock_11/Mlp
 pBlock/activation (QuantizedRe                                  Block/Dense_0[0][0]&#39;]
 LU)

 dropout_34 (QuantizedDropout)  (None, 197, 768)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/activation[0][0]&#39;]

 Transformer/EncoderBlock_11/Ml  (None, 197, 192)    148032      [&#39;dropout_34[0][0]&#39;]
 pBlock/Dense_1 (QuantizedDense
 )

 dropout_35 (QuantizedDropout)  (None, 197, 192)     0           [&#39;Transformer/EncoderBlock_11/Mlp
                                                                 Block/Dense_1[0][0]&#39;]

 Transformer/EncoderBlock_11/ad  (None, 197, 192)    0           [&#39;Transformer/EncoderBlock_11/add
 d_2 (QuantizedAdd)                                              _1[0][0]&#39;,
                                                                  &#39;dropout_35[0][0]&#39;]

 Transformer/EncoderNorm (Quant  (None, 197, 192)    1152        [&#39;Transformer/EncoderBlock_11/add
 izedBatchNormalization)                                         _2[0][0]&#39;]

 ExtractToken (QuantizedExtract  (None, 192)         0           [&#39;Transformer/EncoderNorm[0][0]&#39;]
 Token)

 Head (QuantizedDense)          (None, 1000)         193000      [&#39;ExtractToken[0][0]&#39;]

 dequantizer (Dequantizer)      (None, 1000)         0           [&#39;Head[0][0]&#39;]

==================================================================================================
Total params: 5,773,528
Trainable params: 5,717,800
Non-trainable params: 55,728
__________________________________________________________________________________________________
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_model_performance</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 35s 35s/step
Keras accuracy: 100.00 %
</pre></div>
</div>
</section>
</section>
<section id="conversion-to-akida">
<h2>4. Conversion to Akida<a class="headerlink" href="#conversion-to-akida" title="Permalink to this headline"></a></h2>
<p>The quantized Keras model is now converted into an Akida model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">convert</span>

<span class="c1"># Convert the model</span>
<span class="n">model_akida</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">)</span>
<span class="n">model_akida</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>                 Model Summary
________________________________________________
Input shape    Output shape  Sequences  Layers
================================================
[224, 224, 3]  [1, 1, 1000]  1          137
________________________________________________

___________________________________________________________________________________________________________________
Layer (type)                                                                      Output shape   Kernel shape

======================================= SW/Embedding-dequantizer (Software) =======================================

Embedding (Stem)                                                                  [1, 197, 192]  (16, 16, 3, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_0/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_1/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_2/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_3/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_4/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_5/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_6/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_7/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_8/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/LayerNorm_0 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/query (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/key (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/value (Dense2D)         [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/attention (Attention)   [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MultiHeadDotProductAttention_1/out (Dense2D)           [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/add_1 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/LayerNorm_2 (MadNorm)                                  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MlpBlock/Dense_0 (Dense2D)                             [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/MlpBlock/Dense_1 (Dense2D)                             [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_9/add_2 (Add)                                            [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/LayerNorm_0 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/query (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/key (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/value (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/attention (Attention)  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MultiHeadDotProductAttention_1/out (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/add_1 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/LayerNorm_2 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MlpBlock/Dense_0 (Dense2D)                            [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/MlpBlock/Dense_1 (Dense2D)                            [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_10/add_2 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/LayerNorm_0 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/query (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/key (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/value (Dense2D)        [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/attention (Attention)  [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MultiHeadDotProductAttention_1/out (Dense2D)          [1, 197, 192]  (192, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/add_1 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/LayerNorm_2 (MadNorm)                                 [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MlpBlock/Dense_0 (Dense2D)                            [1, 197, 768]  (192, 768)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/MlpBlock/Dense_1 (Dense2D)                            [1, 197, 192]  (768, 192)
___________________________________________________________________________________________________________________
Transformer/EncoderBlock_11/add_2 (Add)                                           [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
Transformer/EncoderNorm (BatchNormalization)                                      [1, 197, 192]  N/A
___________________________________________________________________________________________________________________
ExtractToken (ExtractToken)                                                       [1, 1, 192]    N/A
___________________________________________________________________________________________________________________
Head (Dense2D)                                                                    [1, 1, 1000]   (192, 1000)
___________________________________________________________________________________________________________________
dequantizer (Dequantizer)                                                         [1, 1, 1000]   N/A
___________________________________________________________________________________________________________________
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_akida</span> <span class="o">=</span> <span class="n">model_akida</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">labels_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy_akida</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>

<span class="c1"># For non-regression purposes</span>
<span class="k">assert</span> <span class="n">accuracy_akida</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Accuracy: 100.00 %
</pre></div>
</div>
</section>
<section id="attention-maps">
<h2>5.3 Attention maps<a class="headerlink" href="#attention-maps" title="Permalink to this headline"></a></h2>
<p>Instead of showing predictions, here we propose to show attention maps on an image. This is
derived from <a class="reference external" href="https://arxiv.org/abs/2005.00928">Abnar et al. attention rollout</a> as shown in the
following <a class="reference external" href="https://keras.io/examples/vision/probing_vits/#method-ii-attention-rollout">Keras tutorial</a>. This aims to
highlight the model abilities to focus on relevant parts in the input image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">quantizeml.layers</span> <span class="kn">import</span> <span class="n">ClassToken</span><span class="p">,</span> <span class="n">Attention</span>
<span class="kn">from</span> <span class="nn">quantizeml.tensors</span> <span class="kn">import</span> <span class="n">FixedPoint</span>
<span class="kn">from</span> <span class="nn">quantizeml.models.transforms.transforms_utils</span> <span class="kn">import</span> <span class="n">get_layers_by_type</span>


<span class="k">def</span> <span class="nf">build_attention_map</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">image</span><span class="p">):</span>
    <span class="c1"># Get the Attention layers list</span>
    <span class="n">attentions</span> <span class="o">=</span> <span class="n">get_layers_by_type</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Attention</span><span class="p">)</span>

    <span class="c1"># Calculate the number of tokens and deduce the grid size</span>
    <span class="n">num_tokens</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ly</span><span class="p">,</span> <span class="n">ClassToken</span><span class="p">)</span> <span class="k">for</span> <span class="n">ly</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span>
    <span class="n">grid_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">attentions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">output_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">num_tokens</span><span class="p">))</span>

    <span class="c1"># Get the attention weights from each transformer</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">la</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">la</span> <span class="ow">in</span> <span class="n">attentions</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Converts to float if needed</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">FixedPoint</span><span class="p">)</span> <span class="k">else</span> <span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="c1"># Heads number</span>
    <span class="n">num_heads</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">num_layers</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">num_layers</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Average the attention weights across all heads</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># To account for residual connections, we add an identity matrix to the attention matrix and</span>
    <span class="c1"># re-normalize the weights.</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">reshaped</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">reshaped</span> <span class="o">=</span> <span class="n">reshaped</span> <span class="o">/</span> <span class="n">reshaped</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

    <span class="c1"># Recursively multiply the weight matrices</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">reshaped</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">reshaped</span><span class="p">)):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">reshaped</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">n</span><span class="p">])</span>

    <span class="c1"># Attention from the output token to the input space</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">grid_size</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">mask</span> <span class="o">/</span> <span class="n">mask</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">mask</span> <span class="o">*</span> <span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>


<span class="c1"># Using a specific image for which attention map is easier to observe</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

<span class="c1"># Compute the attention map</span>
<span class="n">attention_float</span> <span class="o">=</span> <span class="n">build_attention_map</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
<span class="n">attention_quantized</span> <span class="o">=</span> <span class="n">build_attention_map</span><span class="p">(</span><span class="n">model_quantized</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>

<span class="c1"># Display the attention map</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Float&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">attention_float</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Quantized&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">attention_quantized</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Attention masks&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_7_vision_transformer_001.png" srcset="../../_images/sphx_glr_plot_7_vision_transformer_001.png" alt="Attention masks, Original, Float, Quantized" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - ETA: 0s
1/1 [==============================] - 2s 2s/step

1/1 [==============================] - ETA: 0s
1/1 [==============================] - 33s 33s/step
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 4 minutes  28.680 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-general-plot-7-vision-transformer-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/eff8033b2bd356f7a111980b79134365/plot_7_vision_transformer.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_7_vision_transformer.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/05650343d25ad287b6cecb0e9a3a3ef5/plot_7_vision_transformer.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_7_vision_transformer.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_6_segmentation.html" class="btn btn-neutral float-left" title="Segmentation tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../quantization/plot_0_advanced_quantizeml.html" class="btn btn-neutral float-right" title="Advanced QuantizeML tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, BrainChip Holdings Ltd. All Rights Reserved.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>