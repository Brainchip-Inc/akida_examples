

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>YOLO/PASCAL-VOC detection tutorial &mdash; Akida Examples  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transfer learning with MobileNet for cats vs. dogs" href="plot_transfer_learning.html" />
    <link rel="prev" title="DS-CNN CIFAR10 inference" href="plot_ds_cnn_cifar10.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #3f51b5" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/akida.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                Akida 1.8.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#quick-installation">Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#running-examples">Running examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/user_guide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#for-beginners">For beginners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#for-users-familiar-with-deep-learning">For users familiar with deep-learning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/aee.html">Akida user guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#the-akida-execution-engine">The Akida Execution Engine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id1">1. The Spiking Neural Network model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id2">2. Input data format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id3">3. Determine training mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id4">4. Interpreting outputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#neural-network-model">Neural Network model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#specifying-the-neural-network-model">Specifying the Neural Network model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#saving-and-loading">Saving and loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#input-layer-types">Input layer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#data-processing-layer-types">Data-Processing layer types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/aee.html#id5">Using Akida Unsupervised Learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#learning-constraints">Learning constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#compiling-a-layer">Compiling a layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/aee.html#id6">Learning parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/cnn2snn.html">CNN2SNN toolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#conversion-workflow">Conversion workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#typical-training-scenario">Typical training scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#design-compatibility-constraints">Design compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#quantization-compatibility-constraints">Quantization compatibility constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#command-line-interface">Command-line interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#layers-considerations">Layers Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#supported-layer-types">Supported layer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#cnn2snn-quantization-aware-layers">CNN2SNN Quantization-aware layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#training-only-layers">Training-Only Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#first-layers">First Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/cnn2snn.html#id6">Final Layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/cnn2snn.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/akida_models.html">Akida models zoo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/akida_models.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/akida_models.html#command-line-interface-for-model-creation">Command-line interface for model creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/akida_models.html#command-line-interface-for-model-training">Command-line interface for model training</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#cifar10-training-and-tuning">CIFAR10 training and tuning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#utk-face-training">UTK Face training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#kws-training">KWS training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#yolo-training">YOLO training</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/akida_models.html#id1">Layer Blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#conv-block"><code class="docutils literal notranslate"><span class="pre">conv_block</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#dense-block"><code class="docutils literal notranslate"><span class="pre">dense_block</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/akida_models.html#separable-conv-block"><code class="docutils literal notranslate"><span class="pre">separable_conv_block</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/hw_constraints.html">Hardware constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/hw_constraints.html#input-layer">Input layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/hw_constraints.html#data-processing-layers">Data-Processing layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/hw_constraints.html#convolutional-layer">Convolutional layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/hw_constraints.html#fully-connected-layer">Fully connected layer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/api_reference.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/aee_apis.html">Akida Execution Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#model">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#layer">Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#layerstatistics">LayerStatistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#observer">Observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#inputdata">InputData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#inputconvolutional">InputConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#fullyconnected">FullyConnected</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#convolutional">Convolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#separableconvolutional">SeparableConvolutional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#dense">Dense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#sparse">Sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#coords-to-sparse">coords_to_sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#dense-to-sparse">dense_to_sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#packetize">packetize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#backend">Backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#convolutionmode">ConvolutionMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#poolingtype">PoolingType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#learningtype">LearningType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/aee_apis.html#compatibility">Compatibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/cnn2snn_apis.html">CNN2SNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantize">quantize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantize-layer">quantize_layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#convert">convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#check-model-compatibility">check_model_compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#weightquantizer">WeightQuantizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#trainableweightquantizer">TrainableWeightQuantizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#maxquantizer">MaxQuantizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#maxperaxisquantizer">MaxPerAxisQuantizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#weightfloat">WeightFloat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedconv2d">QuantizedConv2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizeddepthwiseconv2d">QuantizedDepthwiseConv2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizeddense">QuantizedDense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedseparableconv2d">QuantizedSeparableConv2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#activationdiscreterelu">ActivationDiscreteRelu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/cnn2snn_apis.html#quantizedrelu">QuantizedReLU</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/akida_models_apis.html">Akida models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/akida_models_apis.html#quantization-blocks">Quantization blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#conv-block">conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#separable-conv-block">separable_conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#dense-block">dense_block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/akida_models_apis.html#layer-blocks">Layer blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#id1">conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#id2">separable_conv_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#id3">dense_block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/akida_models_apis.html#model-zoo">Model zoo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#mobilenet">Mobilenet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#ds-cnn">DS-CNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#vgg">VGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/akida_models_apis.html#yolo">YOLO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_gxnor_mnist.html">GXNOR/MNIST inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#loading-the-mnist-dataset">1. Loading the MNIST dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#look-at-some-images-from-the-test-dataset">2. Look at some images from the test dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#load-the-pre-trained-akida-model">3. Load the pre-trained Akida model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#classify-a-single-image">4. Classify a single image</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_gxnor_mnist.html#check-performance-across-a-number-of-samples">5. Check performance across a number of samples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_regression.html">Regression tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#load-the-dataset">1. Load the dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#load-a-pre-trained-quantized-keras-model-satisfying-akida-nsoc-requirements">3. Load a pre-trained quantized Keras model satisfying Akida NSoC requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#conversion-to-akida">4. Conversion to Akida</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_regression.html#estimate-age-on-a-single-image">5. Estimate age on a single image</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_cnn_flow.html">CNN conversion flow tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#load-and-reshape-mnist-dataset">1. Load and reshape MNIST dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#model-definition">2. Model definition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_cnn_flow.html#model-training">3. Model training</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#model-quantization">4. Model quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#model-fine-tuning-quantization-aware-training">5. Model fine tuning (quantization-aware training)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_cnn_flow.html#model-conversion">6. Model conversion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_ds_cnn_kws.html">DS-CNN/KWS inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#load-the-preprocessed-dataset">1. Load the preprocessed dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#load-a-pre-trained-native-keras-model">2. Load a pre-trained native Keras model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#load-a-pre-trained-quantized-keras-model-satisfying-akida-nsoc-requirements">3. Load a pre-trained quantized Keras model satisfying Akida NSoC requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_kws.html#conversion-to-akida">4. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_kws.html#confusion-matrix">5. Confusion matrix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_ds_cnn_cifar10.html">DS-CNN CIFAR10 inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#dataset-preparation">1. Dataset preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#create-a-keras-ds-cnn-model">2. Create a Keras DS-CNN model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#quantized-model">3. Quantized model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#pretrained-quantized-model">4. Pretrained quantized model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_ds_cnn_cifar10.html#conversion-to-akida">5. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_cifar10.html#convert-to-akida-model">5.1 Convert to Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_cifar10.html#check-hardware-compliancy">5.2 Check hardware compliancy</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_cifar10.html#check-performance">5.3 Check performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_ds_cnn_cifar10.html#show-predictions-for-a-random-image">5.4 Show predictions for a random image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">YOLO/PASCAL-VOC detection tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">1. Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#object-detection">1.1 Object detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yolo-key-concepts">1.2 YOLO key concepts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#preprocessing-tools">2. Preprocessing tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-architecture">3. Model architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#training">4. Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance">5. Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-to-akida">6. Conversion to Akida</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#convert-to-akida-model">6.1 Convert to Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-performance">6.1 Check performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#show-predictions-for-a-random-image">6.2 Show predictions for a random image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_transfer_learning.html">Transfer learning with MobileNet for cats vs. dogs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#transfer-learning-process">Transfer learning process</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#load-and-preprocess-data">1. Load and preprocess data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#a-load-and-split-data">1.A - Load and split data</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#b-preprocess-the-test-set">1.B - Preprocess the test set</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#c-get-labels">1.C - Get labels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#modify-a-pre-trained-base-keras-model">2. Modify a pre-trained base Keras model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#a-instantiate-a-keras-base-model">2.A - Instantiate a Keras base model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_transfer_learning.html#b-modify-the-network-for-the-new-task">2.B - Modify the network for the new task</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#train-the-transferred-model-for-the-new-task">3. Train the transferred model for the new task</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#quantize-the-top-layer">4 Quantize the top layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#convert-to-akida">5. Convert to Akida</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_transfer_learning.html#plot-confusion-matrix">6. Plot confusion matrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_mobilenet_imagenet.html">MobileNet/ImageNet inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#load-cnn2snn-tool-dependencies">1. Load CNN2SNN tool dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#load-test-images-from-imagenet">2. Load test images from ImageNet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#load-test-images-and-preprocess-test-images">2.1 Load test images and preprocess test images</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#load-labels">2.2 Load labels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#create-a-quantized-keras-model">3. Create a quantized Keras model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#instantiate-keras-model">3.1 Instantiate Keras model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#check-performance-of-the-keras-model">3.2 Check performance of the Keras model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_mobilenet_imagenet.html#convert-keras-model-for-akida-nsoc">4. Convert Keras model for Akida NSoC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#convert-keras-model-to-an-akida-compatible-model">4.1 Convert Keras model to an Akida compatible model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#test-performance-of-the-akida-model">4.2 Test performance of the Akida model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mobilenet_imagenet.html#show-predictions-for-a-random-test-image">4.3 Show predictions for a random test image</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Brainchip-Inc/akida_examples/releases">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://support.brainchip.com/portal/home">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Akida Examples</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Akida examples</a> &raquo;</li>
        
      <li>YOLO/PASCAL-VOC detection tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-plot-voc-yolo-detection-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="yolo-pascal-voc-detection-tutorial">
<span id="sphx-glr-examples-plot-voc-yolo-detection-py"></span><h1>YOLO/PASCAL-VOC detection tutorial<a class="headerlink" href="#yolo-pascal-voc-detection-tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial demonstrates that Akida can perform object detection using a
state-of-the-art model architecture. This is illustrated using a subset of the
<a class="reference external" href="http://host.robots.ox.ac.uk/pascal/VOC/voc2007/htmldoc/index.html">PASCAL-VOC 2007 dataset</a>
with “car” and “person” classes only. The YOLOv2 architecture from
<a class="reference external" href="https://arxiv.org/pdf/1506.02640.pdf">Redmon et al (2016)</a> has been chosen to
tackle this object detection problem.</p>
<div class="section" id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="object-detection">
<h3>1.1 Object detection<a class="headerlink" href="#object-detection" title="Permalink to this headline">¶</a></h3>
<p>Object detection is a computer vision task that combines two elemental tasks:</p>
<blockquote>
<div><ul class="simple">
<li><p>object classification that consists in assigning a class label to an image
like shown in the <a class="reference external" href="plot_ds_cnn_cifar10.html">DS-CNN CIFAR10</a> or the <a class="reference external" href="plot_mobilenet_imagenet.html">MobileNet
ImageNet</a> example</p></li>
<li><p>object localization that consists in drawing a bounding box around one or
several objects in an image</p></li>
</ul>
</div></blockquote>
<p>One can learn more about the subject reading this <a class="reference external" href="https://machinelearningmastery.com/object-recognition-with-deep-learning/">introduction to object
detection blog article</a>.</p>
</div>
<div class="section" id="yolo-key-concepts">
<h3>1.2 YOLO key concepts<a class="headerlink" href="#yolo-key-concepts" title="Permalink to this headline">¶</a></h3>
<p>You Only Look Once (YOLO) is a deep neural network architecture dedicated to
object detection.</p>
<p>As opposed to classic networks that handle object detection, YOLO predicts
bounding boxes (localization task) and class probabilities (classification
task) from a single neural network in a single evaluation. The object
detection task is reduced to a regression problem to spatially separated boxes
and associated class probabilities.</p>
<p>YOLO base concept is to divide an input image into regions, forming a grid,
and to predict bounding boxes and probabilities for each region. The bounding
boxes are weighted by the prediction probabilities.</p>
<p>YOLO also uses the concept of “anchors boxes” or “prior boxes”. The network
does not actually predict the actual bounding boxes but offsets from anchors
boxes which are templates (width/height ratio) computed by clustering the
dimensions of the ground truth boxes from the training dataset. The anchors
then represent the average shape and size of the objects to detect. More
details on the anchors boxes concept are given in <a class="reference external" href="https://medium.com/&#64;andersasac/anchor-boxes-the-key-to-quality-object-detection-ddf9d612d4f9">this blog article</a>.</p>
<p>Additional information about YOLO can be found on the <a class="reference external" href="https://pjreddie.com/darknet/yolov2/">Darknet website</a> and source code for the preprocessing
and postprocessing functions that are included in akida_models package (see
the <a class="reference external" href="../api_reference/akida_models_apis.html#processing">processing section</a>
in the model zoo) is largely inspired from
<a class="reference external" href="https://github.com/experiencor/keras-yolo2">experiencor github</a>.</p>
</div>
</div>
<div class="section" id="preprocessing-tools">
<h2>2. Preprocessing tools<a class="headerlink" href="#preprocessing-tools" title="Permalink to this headline">¶</a></h2>
<p>As this example focuses on car and person detection only, a subset of VOC has
been prepared with test images from VOC2007 that contains at least one
of the occurence of the two classes. Just like the VOC dataset, the subset
contains an image folder, an annotation folder and a text file listing the
file names of interest.</p>
<p>The <a class="reference external" href="../api_reference/akida_models_apis.html#yolo-toolkit">YOLO toolkit</a>
offers several methods to prepare data for processing, see
<a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.detection.processing.load_image">load_image</a>,
<a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.detection.processing.preprocess_image">preprocess_image</a>
or <a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.detection.processing.parse_voc_annotations">parse_voc_annotations</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">get_file</span>
<span class="kn">from</span> <span class="nn">akida_models.detection.processing</span> <span class="kn">import</span> <span class="n">parse_voc_annotations</span>

<span class="c1"># Download validation set from Brainchip data server</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">get_file</span><span class="p">(</span>
    <span class="s2">&quot;voc_test_car_person.tar.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://data.brainchip.com/dataset-mirror/voc/voc_test_car_person.tar.gz&quot;</span><span class="p">,</span>
    <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;datasets/voc&#39;</span><span class="p">,</span>
    <span class="n">extract</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">gt_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;voc_test_car_person&#39;</span><span class="p">,</span> <span class="s1">&#39;Annotations&#39;</span><span class="p">)</span>
<span class="n">image_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;voc_test_car_person&#39;</span><span class="p">,</span> <span class="s1">&#39;JPEGImages&#39;</span><span class="p">)</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;voc_test_car_person&#39;</span><span class="p">,</span> <span class="s1">&#39;test_car_person.txt&#39;</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;car&#39;</span><span class="p">,</span> <span class="s1">&#39;person&#39;</span><span class="p">]</span>

<span class="n">val_data</span> <span class="o">=</span> <span class="n">parse_voc_annotations</span><span class="p">(</span><span class="n">gt_folder</span><span class="p">,</span> <span class="n">image_folder</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loaded VOC2007 test data for car and person classes: &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">val_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> images.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from http://data.brainchip.com/dataset-mirror/voc/voc_test_car_person.tar.gz

     8192/221551911 [..............................] - ETA: 7:32
    65536/221551911 [..............................] - ETA: 3:48
   204800/221551911 [..............................] - ETA: 2:09
   401408/221551911 [..............................] - ETA: 1:35
   598016/221551911 [..............................] - ETA: 1:23
   794624/221551911 [..............................] - ETA: 1:17
   991232/221551911 [..............................] - ETA: 1:14
  1187840/221551911 [..............................] - ETA: 1:11
  1384448/221551911 [..............................] - ETA: 1:10
  1581056/221551911 [..............................] - ETA: 1:08
  1777664/221551911 [..............................] - ETA: 1:07
  1974272/221551911 [..............................] - ETA: 1:06
  2170880/221551911 [..............................] - ETA: 1:06
  2367488/221551911 [..............................] - ETA: 1:05
  2564096/221551911 [..............................] - ETA: 1:04
  2760704/221551911 [..............................] - ETA: 1:04
  2957312/221551911 [..............................] - ETA: 1:04
  3153920/221551911 [..............................] - ETA: 1:03
  3350528/221551911 [..............................] - ETA: 1:03
  3547136/221551911 [..............................] - ETA: 1:03
  3743744/221551911 [..............................] - ETA: 1:02
  3940352/221551911 [..............................] - ETA: 1:02
  4136960/221551911 [..............................] - ETA: 1:02
  4333568/221551911 [..............................] - ETA: 1:02
  4530176/221551911 [..............................] - ETA: 1:01
  4726784/221551911 [..............................] - ETA: 1:01
  4923392/221551911 [..............................] - ETA: 1:01
  5120000/221551911 [..............................] - ETA: 1:01
  5316608/221551911 [..............................] - ETA: 1:01
  5513216/221551911 [..............................] - ETA: 1:01
  5693440/221551911 [..............................] - ETA: 1:13
  5718016/221551911 [..............................] - ETA: 1:15
  5840896/221551911 [..............................] - ETA: 1:15
  6037504/221551911 [..............................] - ETA: 1:15
  6234112/221551911 [..............................] - ETA: 1:14
  6430720/221551911 [..............................] - ETA: 1:13
  6627328/221551911 [..............................] - ETA: 1:13
  6823936/221551911 [..............................] - ETA: 1:12
  7020544/221551911 [..............................] - ETA: 1:12
  7217152/221551911 [..............................] - ETA: 1:11
  7413760/221551911 [&gt;.............................] - ETA: 1:11
  7610368/221551911 [&gt;.............................] - ETA: 1:11
  7806976/221551911 [&gt;.............................] - ETA: 1:10
  8003584/221551911 [&gt;.............................] - ETA: 1:10
  8200192/221551911 [&gt;.............................] - ETA: 1:09
  8396800/221551911 [&gt;.............................] - ETA: 1:09
  8593408/221551911 [&gt;.............................] - ETA: 1:09
  8790016/221551911 [&gt;.............................] - ETA: 1:08
  8986624/221551911 [&gt;.............................] - ETA: 1:08
  9183232/221551911 [&gt;.............................] - ETA: 1:08
  9379840/221551911 [&gt;.............................] - ETA: 1:08
  9576448/221551911 [&gt;.............................] - ETA: 1:07
  9773056/221551911 [&gt;.............................] - ETA: 1:07
  9969664/221551911 [&gt;.............................] - ETA: 1:07
 10166272/221551911 [&gt;.............................] - ETA: 1:07
 10362880/221551911 [&gt;.............................] - ETA: 1:06
 10559488/221551911 [&gt;.............................] - ETA: 1:06
 10756096/221551911 [&gt;.............................] - ETA: 1:06
 10952704/221551911 [&gt;.............................] - ETA: 1:06
 11149312/221551911 [&gt;.............................] - ETA: 1:05
 11345920/221551911 [&gt;.............................] - ETA: 1:05
 11542528/221551911 [&gt;.............................] - ETA: 1:05
 11739136/221551911 [&gt;.............................] - ETA: 1:05
 11935744/221551911 [&gt;.............................] - ETA: 1:05
 12132352/221551911 [&gt;.............................] - ETA: 1:04
 12328960/221551911 [&gt;.............................] - ETA: 1:04
 12525568/221551911 [&gt;.............................] - ETA: 1:04
 12722176/221551911 [&gt;.............................] - ETA: 1:04
 12918784/221551911 [&gt;.............................] - ETA: 1:04
 13115392/221551911 [&gt;.............................] - ETA: 1:03
 13312000/221551911 [&gt;.............................] - ETA: 1:03
 13508608/221551911 [&gt;.............................] - ETA: 1:03
 13705216/221551911 [&gt;.............................] - ETA: 1:03
 13901824/221551911 [&gt;.............................] - ETA: 1:03
 14098432/221551911 [&gt;.............................] - ETA: 1:03
 14295040/221551911 [&gt;.............................] - ETA: 1:03
 14491648/221551911 [&gt;.............................] - ETA: 1:02
 14688256/221551911 [&gt;.............................] - ETA: 1:02
 14884864/221551911 [=&gt;............................] - ETA: 1:02
 15081472/221551911 [=&gt;............................] - ETA: 1:02
 15278080/221551911 [=&gt;............................] - ETA: 1:02
 15474688/221551911 [=&gt;............................] - ETA: 1:02
 15671296/221551911 [=&gt;............................] - ETA: 1:01
 15867904/221551911 [=&gt;............................] - ETA: 1:01
 16064512/221551911 [=&gt;............................] - ETA: 1:01
 16261120/221551911 [=&gt;............................] - ETA: 1:01
 16457728/221551911 [=&gt;............................] - ETA: 1:01
 16654336/221551911 [=&gt;............................] - ETA: 1:01
 16850944/221551911 [=&gt;............................] - ETA: 1:01
 17047552/221551911 [=&gt;............................] - ETA: 1:01
 17244160/221551911 [=&gt;............................] - ETA: 1:00
 17440768/221551911 [=&gt;............................] - ETA: 1:00
 17637376/221551911 [=&gt;............................] - ETA: 1:00
 17833984/221551911 [=&gt;............................] - ETA: 1:00
 18030592/221551911 [=&gt;............................] - ETA: 1:00
 18227200/221551911 [=&gt;............................] - ETA: 1:00
 18423808/221551911 [=&gt;............................] - ETA: 1:00
 18620416/221551911 [=&gt;............................] - ETA: 1:00
 18817024/221551911 [=&gt;............................] - ETA: 1:00
 19013632/221551911 [=&gt;............................] - ETA: 59s 
 19210240/221551911 [=&gt;............................] - ETA: 59s
 19406848/221551911 [=&gt;............................] - ETA: 59s
 19603456/221551911 [=&gt;............................] - ETA: 59s
 19800064/221551911 [=&gt;............................] - ETA: 59s
 19996672/221551911 [=&gt;............................] - ETA: 59s
 20193280/221551911 [=&gt;............................] - ETA: 59s
 20389888/221551911 [=&gt;............................] - ETA: 59s
 20586496/221551911 [=&gt;............................] - ETA: 59s
 20783104/221551911 [=&gt;............................] - ETA: 59s
 20979712/221551911 [=&gt;............................] - ETA: 58s
 21176320/221551911 [=&gt;............................] - ETA: 58s
 21372928/221551911 [=&gt;............................] - ETA: 58s
 21569536/221551911 [=&gt;............................] - ETA: 58s
 21766144/221551911 [=&gt;............................] - ETA: 58s
 21962752/221551911 [=&gt;............................] - ETA: 58s
 22159360/221551911 [==&gt;...........................] - ETA: 58s
 22355968/221551911 [==&gt;...........................] - ETA: 58s
 22552576/221551911 [==&gt;...........................] - ETA: 58s
 22749184/221551911 [==&gt;...........................] - ETA: 58s
 22945792/221551911 [==&gt;...........................] - ETA: 57s
 23142400/221551911 [==&gt;...........................] - ETA: 57s
 23339008/221551911 [==&gt;...........................] - ETA: 57s
 23535616/221551911 [==&gt;...........................] - ETA: 57s
 23732224/221551911 [==&gt;...........................] - ETA: 57s
 23928832/221551911 [==&gt;...........................] - ETA: 57s
 24125440/221551911 [==&gt;...........................] - ETA: 57s
 24322048/221551911 [==&gt;...........................] - ETA: 57s
 24518656/221551911 [==&gt;...........................] - ETA: 57s
 24715264/221551911 [==&gt;...........................] - ETA: 57s
 24911872/221551911 [==&gt;...........................] - ETA: 57s
 25108480/221551911 [==&gt;...........................] - ETA: 57s
 25305088/221551911 [==&gt;...........................] - ETA: 56s
 25501696/221551911 [==&gt;...........................] - ETA: 56s
 25698304/221551911 [==&gt;...........................] - ETA: 56s
 25894912/221551911 [==&gt;...........................] - ETA: 56s
 26091520/221551911 [==&gt;...........................] - ETA: 56s
 26288128/221551911 [==&gt;...........................] - ETA: 56s
 26484736/221551911 [==&gt;...........................] - ETA: 56s
 26681344/221551911 [==&gt;...........................] - ETA: 56s
 26877952/221551911 [==&gt;...........................] - ETA: 56s
 27074560/221551911 [==&gt;...........................] - ETA: 56s
 27271168/221551911 [==&gt;...........................] - ETA: 56s
 27467776/221551911 [==&gt;...........................] - ETA: 56s
 27664384/221551911 [==&gt;...........................] - ETA: 55s
 27860992/221551911 [==&gt;...........................] - ETA: 55s
 28057600/221551911 [==&gt;...........................] - ETA: 55s
 28254208/221551911 [==&gt;...........................] - ETA: 55s
 28450816/221551911 [==&gt;...........................] - ETA: 55s
 28647424/221551911 [==&gt;...........................] - ETA: 55s
 28844032/221551911 [==&gt;...........................] - ETA: 55s
 29040640/221551911 [==&gt;...........................] - ETA: 55s
 29237248/221551911 [==&gt;...........................] - ETA: 55s
 29433856/221551911 [==&gt;...........................] - ETA: 55s
 29630464/221551911 [===&gt;..........................] - ETA: 55s
 29827072/221551911 [===&gt;..........................] - ETA: 55s
 30023680/221551911 [===&gt;..........................] - ETA: 55s
 30220288/221551911 [===&gt;..........................] - ETA: 54s
 30416896/221551911 [===&gt;..........................] - ETA: 54s
 30613504/221551911 [===&gt;..........................] - ETA: 54s
 30810112/221551911 [===&gt;..........................] - ETA: 54s
 31006720/221551911 [===&gt;..........................] - ETA: 54s
 31203328/221551911 [===&gt;..........................] - ETA: 54s
 31399936/221551911 [===&gt;..........................] - ETA: 54s
 31596544/221551911 [===&gt;..........................] - ETA: 54s
 31793152/221551911 [===&gt;..........................] - ETA: 54s
 31989760/221551911 [===&gt;..........................] - ETA: 54s
 32186368/221551911 [===&gt;..........................] - ETA: 54s
 32382976/221551911 [===&gt;..........................] - ETA: 54s
 32579584/221551911 [===&gt;..........................] - ETA: 54s
 32776192/221551911 [===&gt;..........................] - ETA: 53s
 32972800/221551911 [===&gt;..........................] - ETA: 53s
 33169408/221551911 [===&gt;..........................] - ETA: 53s
 33366016/221551911 [===&gt;..........................] - ETA: 53s
 33562624/221551911 [===&gt;..........................] - ETA: 53s
 33759232/221551911 [===&gt;..........................] - ETA: 53s
 33955840/221551911 [===&gt;..........................] - ETA: 53s
 34152448/221551911 [===&gt;..........................] - ETA: 53s
 34349056/221551911 [===&gt;..........................] - ETA: 53s
 34545664/221551911 [===&gt;..........................] - ETA: 53s
 34742272/221551911 [===&gt;..........................] - ETA: 53s
 34938880/221551911 [===&gt;..........................] - ETA: 53s
 35135488/221551911 [===&gt;..........................] - ETA: 53s
 35332096/221551911 [===&gt;..........................] - ETA: 53s
 35528704/221551911 [===&gt;..........................] - ETA: 52s
 35725312/221551911 [===&gt;..........................] - ETA: 52s
 35921920/221551911 [===&gt;..........................] - ETA: 52s
 36118528/221551911 [===&gt;..........................] - ETA: 52s
 36315136/221551911 [===&gt;..........................] - ETA: 52s
 36511744/221551911 [===&gt;..........................] - ETA: 52s
 36708352/221551911 [===&gt;..........................] - ETA: 52s
 36904960/221551911 [===&gt;..........................] - ETA: 52s
 37101568/221551911 [====&gt;.........................] - ETA: 52s
 37298176/221551911 [====&gt;.........................] - ETA: 52s
 37494784/221551911 [====&gt;.........................] - ETA: 52s
 37691392/221551911 [====&gt;.........................] - ETA: 52s
 37888000/221551911 [====&gt;.........................] - ETA: 52s
 38084608/221551911 [====&gt;.........................] - ETA: 52s
 38281216/221551911 [====&gt;.........................] - ETA: 52s
 38477824/221551911 [====&gt;.........................] - ETA: 51s
 38674432/221551911 [====&gt;.........................] - ETA: 51s
 38871040/221551911 [====&gt;.........................] - ETA: 51s
 39067648/221551911 [====&gt;.........................] - ETA: 51s
 39264256/221551911 [====&gt;.........................] - ETA: 51s
 39460864/221551911 [====&gt;.........................] - ETA: 51s
 39657472/221551911 [====&gt;.........................] - ETA: 51s
 39854080/221551911 [====&gt;.........................] - ETA: 51s
 40050688/221551911 [====&gt;.........................] - ETA: 51s
 40247296/221551911 [====&gt;.........................] - ETA: 51s
 40443904/221551911 [====&gt;.........................] - ETA: 51s
 40640512/221551911 [====&gt;.........................] - ETA: 51s
 40837120/221551911 [====&gt;.........................] - ETA: 51s
 41033728/221551911 [====&gt;.........................] - ETA: 51s
 41230336/221551911 [====&gt;.........................] - ETA: 51s
 41426944/221551911 [====&gt;.........................] - ETA: 50s
 41623552/221551911 [====&gt;.........................] - ETA: 50s
 41820160/221551911 [====&gt;.........................] - ETA: 50s
 42016768/221551911 [====&gt;.........................] - ETA: 50s
 42213376/221551911 [====&gt;.........................] - ETA: 50s
 42409984/221551911 [====&gt;.........................] - ETA: 50s
 42606592/221551911 [====&gt;.........................] - ETA: 50s
 42803200/221551911 [====&gt;.........................] - ETA: 50s
 42999808/221551911 [====&gt;.........................] - ETA: 50s
 43196416/221551911 [====&gt;.........................] - ETA: 50s
 43393024/221551911 [====&gt;.........................] - ETA: 50s
 43589632/221551911 [====&gt;.........................] - ETA: 50s
 43786240/221551911 [====&gt;.........................] - ETA: 50s
 43982848/221551911 [====&gt;.........................] - ETA: 50s
 44179456/221551911 [====&gt;.........................] - ETA: 50s
 44376064/221551911 [=====&gt;........................] - ETA: 50s
 44572672/221551911 [=====&gt;........................] - ETA: 49s
 44769280/221551911 [=====&gt;........................] - ETA: 49s
 44965888/221551911 [=====&gt;........................] - ETA: 49s
 45162496/221551911 [=====&gt;........................] - ETA: 49s
 45359104/221551911 [=====&gt;........................] - ETA: 49s
 45555712/221551911 [=====&gt;........................] - ETA: 49s
 45752320/221551911 [=====&gt;........................] - ETA: 49s
 45948928/221551911 [=====&gt;........................] - ETA: 49s
 46145536/221551911 [=====&gt;........................] - ETA: 49s
 46342144/221551911 [=====&gt;........................] - ETA: 49s
 46538752/221551911 [=====&gt;........................] - ETA: 49s
 46735360/221551911 [=====&gt;........................] - ETA: 49s
 46931968/221551911 [=====&gt;........................] - ETA: 49s
 47128576/221551911 [=====&gt;........................] - ETA: 49s
 47325184/221551911 [=====&gt;........................] - ETA: 49s
 47521792/221551911 [=====&gt;........................] - ETA: 49s
 47718400/221551911 [=====&gt;........................] - ETA: 48s
 47915008/221551911 [=====&gt;........................] - ETA: 48s
 48111616/221551911 [=====&gt;........................] - ETA: 48s
 48308224/221551911 [=====&gt;........................] - ETA: 48s
 48504832/221551911 [=====&gt;........................] - ETA: 48s
 48701440/221551911 [=====&gt;........................] - ETA: 48s
 48898048/221551911 [=====&gt;........................] - ETA: 48s
 49094656/221551911 [=====&gt;........................] - ETA: 48s
 49291264/221551911 [=====&gt;........................] - ETA: 48s
 49487872/221551911 [=====&gt;........................] - ETA: 48s
 49684480/221551911 [=====&gt;........................] - ETA: 48s
 49881088/221551911 [=====&gt;........................] - ETA: 48s
 50077696/221551911 [=====&gt;........................] - ETA: 48s
 50274304/221551911 [=====&gt;........................] - ETA: 48s
 50470912/221551911 [=====&gt;........................] - ETA: 48s
 50667520/221551911 [=====&gt;........................] - ETA: 48s
 50864128/221551911 [=====&gt;........................] - ETA: 47s
 51060736/221551911 [=====&gt;........................] - ETA: 47s
 51257344/221551911 [=====&gt;........................] - ETA: 47s
 51453952/221551911 [=====&gt;........................] - ETA: 47s
 51650560/221551911 [=====&gt;........................] - ETA: 47s
 51847168/221551911 [======&gt;.......................] - ETA: 47s
 52043776/221551911 [======&gt;.......................] - ETA: 47s
 52240384/221551911 [======&gt;.......................] - ETA: 47s
 52436992/221551911 [======&gt;.......................] - ETA: 47s
 52633600/221551911 [======&gt;.......................] - ETA: 47s
 52830208/221551911 [======&gt;.......................] - ETA: 47s
 53026816/221551911 [======&gt;.......................] - ETA: 47s
 53223424/221551911 [======&gt;.......................] - ETA: 47s
 53420032/221551911 [======&gt;.......................] - ETA: 47s
 53616640/221551911 [======&gt;.......................] - ETA: 47s
 53813248/221551911 [======&gt;.......................] - ETA: 47s
 54009856/221551911 [======&gt;.......................] - ETA: 46s
 54206464/221551911 [======&gt;.......................] - ETA: 46s
 54403072/221551911 [======&gt;.......................] - ETA: 46s
 54599680/221551911 [======&gt;.......................] - ETA: 46s
 54796288/221551911 [======&gt;.......................] - ETA: 46s
 54992896/221551911 [======&gt;.......................] - ETA: 46s
 55189504/221551911 [======&gt;.......................] - ETA: 46s
 55386112/221551911 [======&gt;.......................] - ETA: 46s
 55582720/221551911 [======&gt;.......................] - ETA: 46s
 55779328/221551911 [======&gt;.......................] - ETA: 46s
 55975936/221551911 [======&gt;.......................] - ETA: 46s
 56172544/221551911 [======&gt;.......................] - ETA: 46s
 56369152/221551911 [======&gt;.......................] - ETA: 46s
 56565760/221551911 [======&gt;.......................] - ETA: 46s
 56762368/221551911 [======&gt;.......................] - ETA: 46s
 56958976/221551911 [======&gt;.......................] - ETA: 46s
 57155584/221551911 [======&gt;.......................] - ETA: 46s
 57352192/221551911 [======&gt;.......................] - ETA: 45s
 57548800/221551911 [======&gt;.......................] - ETA: 45s
 57745408/221551911 [======&gt;.......................] - ETA: 45s
 57942016/221551911 [======&gt;.......................] - ETA: 45s
 58138624/221551911 [======&gt;.......................] - ETA: 45s
 58335232/221551911 [======&gt;.......................] - ETA: 45s
 58531840/221551911 [======&gt;.......................] - ETA: 45s
 58728448/221551911 [======&gt;.......................] - ETA: 45s
 58925056/221551911 [======&gt;.......................] - ETA: 45s
 59121664/221551911 [=======&gt;......................] - ETA: 45s
 59318272/221551911 [=======&gt;......................] - ETA: 45s
 59514880/221551911 [=======&gt;......................] - ETA: 45s
 59711488/221551911 [=======&gt;......................] - ETA: 45s
 59908096/221551911 [=======&gt;......................] - ETA: 45s
 60104704/221551911 [=======&gt;......................] - ETA: 45s
 60301312/221551911 [=======&gt;......................] - ETA: 45s
 60497920/221551911 [=======&gt;......................] - ETA: 45s
 60694528/221551911 [=======&gt;......................] - ETA: 44s
 60891136/221551911 [=======&gt;......................] - ETA: 44s
 61087744/221551911 [=======&gt;......................] - ETA: 44s
 61284352/221551911 [=======&gt;......................] - ETA: 44s
 61480960/221551911 [=======&gt;......................] - ETA: 44s
 61677568/221551911 [=======&gt;......................] - ETA: 44s
 61874176/221551911 [=======&gt;......................] - ETA: 44s
 62070784/221551911 [=======&gt;......................] - ETA: 44s
 62267392/221551911 [=======&gt;......................] - ETA: 44s
 62464000/221551911 [=======&gt;......................] - ETA: 44s
 62660608/221551911 [=======&gt;......................] - ETA: 44s
 62857216/221551911 [=======&gt;......................] - ETA: 44s
 63053824/221551911 [=======&gt;......................] - ETA: 44s
 63250432/221551911 [=======&gt;......................] - ETA: 44s
 63447040/221551911 [=======&gt;......................] - ETA: 44s
 63643648/221551911 [=======&gt;......................] - ETA: 44s
 63840256/221551911 [=======&gt;......................] - ETA: 44s
 64036864/221551911 [=======&gt;......................] - ETA: 43s
 64233472/221551911 [=======&gt;......................] - ETA: 43s
 64430080/221551911 [=======&gt;......................] - ETA: 43s
 64626688/221551911 [=======&gt;......................] - ETA: 43s
 64823296/221551911 [=======&gt;......................] - ETA: 43s
 65019904/221551911 [=======&gt;......................] - ETA: 43s
 65216512/221551911 [=======&gt;......................] - ETA: 43s
 65413120/221551911 [=======&gt;......................] - ETA: 43s
 65609728/221551911 [=======&gt;......................] - ETA: 43s
 65806336/221551911 [=======&gt;......................] - ETA: 43s
 66002944/221551911 [=======&gt;......................] - ETA: 43s
 66199552/221551911 [=======&gt;......................] - ETA: 43s
 66396160/221551911 [=======&gt;......................] - ETA: 43s
 66592768/221551911 [========&gt;.....................] - ETA: 43s
 66789376/221551911 [========&gt;.....................] - ETA: 43s
 66985984/221551911 [========&gt;.....................] - ETA: 43s
 67182592/221551911 [========&gt;.....................] - ETA: 43s
 67379200/221551911 [========&gt;.....................] - ETA: 42s
 67575808/221551911 [========&gt;.....................] - ETA: 42s
 67772416/221551911 [========&gt;.....................] - ETA: 42s
 67969024/221551911 [========&gt;.....................] - ETA: 42s
 68165632/221551911 [========&gt;.....................] - ETA: 42s
 68362240/221551911 [========&gt;.....................] - ETA: 42s
 68558848/221551911 [========&gt;.....................] - ETA: 42s
 68755456/221551911 [========&gt;.....................] - ETA: 42s
 68952064/221551911 [========&gt;.....................] - ETA: 42s
 69148672/221551911 [========&gt;.....................] - ETA: 42s
 69345280/221551911 [========&gt;.....................] - ETA: 42s
 69541888/221551911 [========&gt;.....................] - ETA: 42s
 69738496/221551911 [========&gt;.....................] - ETA: 42s
 69935104/221551911 [========&gt;.....................] - ETA: 42s
 70131712/221551911 [========&gt;.....................] - ETA: 42s
 70328320/221551911 [========&gt;.....................] - ETA: 42s
 70524928/221551911 [========&gt;.....................] - ETA: 42s
 70721536/221551911 [========&gt;.....................] - ETA: 41s
 70918144/221551911 [========&gt;.....................] - ETA: 41s
 71114752/221551911 [========&gt;.....................] - ETA: 41s
 71311360/221551911 [========&gt;.....................] - ETA: 41s
 71507968/221551911 [========&gt;.....................] - ETA: 41s
 71704576/221551911 [========&gt;.....................] - ETA: 41s
 71901184/221551911 [========&gt;.....................] - ETA: 41s
 72097792/221551911 [========&gt;.....................] - ETA: 41s
 72294400/221551911 [========&gt;.....................] - ETA: 41s
 72466432/221551911 [========&gt;.....................] - ETA: 42s
 72482816/221551911 [========&gt;.....................] - ETA: 42s
 72531968/221551911 [========&gt;.....................] - ETA: 42s
 72687616/221551911 [========&gt;.....................] - ETA: 42s
 72884224/221551911 [========&gt;.....................] - ETA: 42s
 73080832/221551911 [========&gt;.....................] - ETA: 42s
 73277440/221551911 [========&gt;.....................] - ETA: 42s
 73474048/221551911 [========&gt;.....................] - ETA: 41s
 73670656/221551911 [========&gt;.....................] - ETA: 41s
 73867264/221551911 [=========&gt;....................] - ETA: 41s
 74063872/221551911 [=========&gt;....................] - ETA: 41s
 74260480/221551911 [=========&gt;....................] - ETA: 41s
 74457088/221551911 [=========&gt;....................] - ETA: 41s
 74653696/221551911 [=========&gt;....................] - ETA: 41s
 74850304/221551911 [=========&gt;....................] - ETA: 41s
 75046912/221551911 [=========&gt;....................] - ETA: 41s
 75243520/221551911 [=========&gt;....................] - ETA: 41s
 75440128/221551911 [=========&gt;....................] - ETA: 41s
 75636736/221551911 [=========&gt;....................] - ETA: 41s
 75833344/221551911 [=========&gt;....................] - ETA: 41s
 76029952/221551911 [=========&gt;....................] - ETA: 41s
 76226560/221551911 [=========&gt;....................] - ETA: 41s
 76423168/221551911 [=========&gt;....................] - ETA: 41s
 76619776/221551911 [=========&gt;....................] - ETA: 41s
 76816384/221551911 [=========&gt;....................] - ETA: 40s
 77012992/221551911 [=========&gt;....................] - ETA: 40s
 77209600/221551911 [=========&gt;....................] - ETA: 40s
 77406208/221551911 [=========&gt;....................] - ETA: 40s
 77602816/221551911 [=========&gt;....................] - ETA: 40s
 77799424/221551911 [=========&gt;....................] - ETA: 40s
 77996032/221551911 [=========&gt;....................] - ETA: 40s
 78192640/221551911 [=========&gt;....................] - ETA: 40s
 78389248/221551911 [=========&gt;....................] - ETA: 40s
 78585856/221551911 [=========&gt;....................] - ETA: 40s
 78782464/221551911 [=========&gt;....................] - ETA: 40s
 78979072/221551911 [=========&gt;....................] - ETA: 40s
 79175680/221551911 [=========&gt;....................] - ETA: 40s
 79372288/221551911 [=========&gt;....................] - ETA: 40s
 79568896/221551911 [=========&gt;....................] - ETA: 40s
 79765504/221551911 [=========&gt;....................] - ETA: 40s
 79962112/221551911 [=========&gt;....................] - ETA: 40s
 80158720/221551911 [=========&gt;....................] - ETA: 39s
 80355328/221551911 [=========&gt;....................] - ETA: 39s
 80551936/221551911 [=========&gt;....................] - ETA: 39s
 80748544/221551911 [=========&gt;....................] - ETA: 39s
 80945152/221551911 [=========&gt;....................] - ETA: 39s
 81141760/221551911 [=========&gt;....................] - ETA: 39s
 81338368/221551911 [==========&gt;...................] - ETA: 39s
 81534976/221551911 [==========&gt;...................] - ETA: 39s
 81731584/221551911 [==========&gt;...................] - ETA: 39s
 81928192/221551911 [==========&gt;...................] - ETA: 39s
 82124800/221551911 [==========&gt;...................] - ETA: 39s
 82321408/221551911 [==========&gt;...................] - ETA: 39s
 82518016/221551911 [==========&gt;...................] - ETA: 39s
 82714624/221551911 [==========&gt;...................] - ETA: 39s
 82911232/221551911 [==========&gt;...................] - ETA: 39s
 83107840/221551911 [==========&gt;...................] - ETA: 39s
 83304448/221551911 [==========&gt;...................] - ETA: 39s
 83501056/221551911 [==========&gt;...................] - ETA: 38s
 83697664/221551911 [==========&gt;...................] - ETA: 38s
 83894272/221551911 [==========&gt;...................] - ETA: 38s
 84090880/221551911 [==========&gt;...................] - ETA: 38s
 84287488/221551911 [==========&gt;...................] - ETA: 38s
 84484096/221551911 [==========&gt;...................] - ETA: 38s
 84680704/221551911 [==========&gt;...................] - ETA: 38s
 84877312/221551911 [==========&gt;...................] - ETA: 38s
 85073920/221551911 [==========&gt;...................] - ETA: 38s
 85270528/221551911 [==========&gt;...................] - ETA: 38s
 85467136/221551911 [==========&gt;...................] - ETA: 38s
 85663744/221551911 [==========&gt;...................] - ETA: 38s
 85860352/221551911 [==========&gt;...................] - ETA: 38s
 86056960/221551911 [==========&gt;...................] - ETA: 38s
 86253568/221551911 [==========&gt;...................] - ETA: 38s
 86450176/221551911 [==========&gt;...................] - ETA: 38s
 86646784/221551911 [==========&gt;...................] - ETA: 38s
 86843392/221551911 [==========&gt;...................] - ETA: 37s
 87040000/221551911 [==========&gt;...................] - ETA: 37s
 87236608/221551911 [==========&gt;...................] - ETA: 37s
 87433216/221551911 [==========&gt;...................] - ETA: 37s
 87629824/221551911 [==========&gt;...................] - ETA: 37s
 87826432/221551911 [==========&gt;...................] - ETA: 37s
 88023040/221551911 [==========&gt;...................] - ETA: 37s
 88219648/221551911 [==========&gt;...................] - ETA: 37s
 88416256/221551911 [==========&gt;...................] - ETA: 37s
 88612864/221551911 [==========&gt;...................] - ETA: 37s
 88809472/221551911 [===========&gt;..................] - ETA: 37s
 89006080/221551911 [===========&gt;..................] - ETA: 37s
 89202688/221551911 [===========&gt;..................] - ETA: 37s
 89399296/221551911 [===========&gt;..................] - ETA: 37s
 89595904/221551911 [===========&gt;..................] - ETA: 37s
 89792512/221551911 [===========&gt;..................] - ETA: 37s
 89989120/221551911 [===========&gt;..................] - ETA: 37s
 90185728/221551911 [===========&gt;..................] - ETA: 36s
 90382336/221551911 [===========&gt;..................] - ETA: 36s
 90578944/221551911 [===========&gt;..................] - ETA: 36s
 90775552/221551911 [===========&gt;..................] - ETA: 36s
 90972160/221551911 [===========&gt;..................] - ETA: 36s
 91168768/221551911 [===========&gt;..................] - ETA: 36s
 91365376/221551911 [===========&gt;..................] - ETA: 36s
 91561984/221551911 [===========&gt;..................] - ETA: 36s
 91758592/221551911 [===========&gt;..................] - ETA: 36s
 91955200/221551911 [===========&gt;..................] - ETA: 36s
 92151808/221551911 [===========&gt;..................] - ETA: 36s
 92348416/221551911 [===========&gt;..................] - ETA: 36s
 92545024/221551911 [===========&gt;..................] - ETA: 36s
 92741632/221551911 [===========&gt;..................] - ETA: 36s
 92938240/221551911 [===========&gt;..................] - ETA: 36s
 93134848/221551911 [===========&gt;..................] - ETA: 36s
 93331456/221551911 [===========&gt;..................] - ETA: 36s
 93528064/221551911 [===========&gt;..................] - ETA: 35s
 93724672/221551911 [===========&gt;..................] - ETA: 35s
 93921280/221551911 [===========&gt;..................] - ETA: 35s
 94117888/221551911 [===========&gt;..................] - ETA: 35s
 94314496/221551911 [===========&gt;..................] - ETA: 35s
 94511104/221551911 [===========&gt;..................] - ETA: 35s
 94707712/221551911 [===========&gt;..................] - ETA: 35s
 94904320/221551911 [===========&gt;..................] - ETA: 35s
 95100928/221551911 [===========&gt;..................] - ETA: 35s
 95297536/221551911 [===========&gt;..................] - ETA: 35s
 95494144/221551911 [===========&gt;..................] - ETA: 35s
 95690752/221551911 [===========&gt;..................] - ETA: 35s
 95887360/221551911 [===========&gt;..................] - ETA: 35s
 96083968/221551911 [============&gt;.................] - ETA: 35s
 96280576/221551911 [============&gt;.................] - ETA: 35s
 96477184/221551911 [============&gt;.................] - ETA: 35s
 96673792/221551911 [============&gt;.................] - ETA: 35s
 96870400/221551911 [============&gt;.................] - ETA: 35s
 97067008/221551911 [============&gt;.................] - ETA: 34s
 97263616/221551911 [============&gt;.................] - ETA: 34s
 97460224/221551911 [============&gt;.................] - ETA: 34s
 97656832/221551911 [============&gt;.................] - ETA: 34s
 97853440/221551911 [============&gt;.................] - ETA: 34s
 98050048/221551911 [============&gt;.................] - ETA: 34s
 98246656/221551911 [============&gt;.................] - ETA: 34s
 98443264/221551911 [============&gt;.................] - ETA: 34s
 98639872/221551911 [============&gt;.................] - ETA: 34s
 98836480/221551911 [============&gt;.................] - ETA: 34s
 99033088/221551911 [============&gt;.................] - ETA: 34s
 99229696/221551911 [============&gt;.................] - ETA: 34s
 99426304/221551911 [============&gt;.................] - ETA: 34s
 99622912/221551911 [============&gt;.................] - ETA: 34s
 99819520/221551911 [============&gt;.................] - ETA: 34s
100016128/221551911 [============&gt;.................] - ETA: 34s
100212736/221551911 [============&gt;.................] - ETA: 34s
100409344/221551911 [============&gt;.................] - ETA: 33s
100605952/221551911 [============&gt;.................] - ETA: 33s
100802560/221551911 [============&gt;.................] - ETA: 33s
100999168/221551911 [============&gt;.................] - ETA: 33s
101195776/221551911 [============&gt;.................] - ETA: 33s
101392384/221551911 [============&gt;.................] - ETA: 33s
101588992/221551911 [============&gt;.................] - ETA: 33s
101785600/221551911 [============&gt;.................] - ETA: 33s
101982208/221551911 [============&gt;.................] - ETA: 33s
102178816/221551911 [============&gt;.................] - ETA: 33s
102301696/221551911 [============&gt;.................] - ETA: 33s
102318080/221551911 [============&gt;.................] - ETA: 33s
102375424/221551911 [============&gt;.................] - ETA: 33s
102506496/221551911 [============&gt;.................] - ETA: 33s
102703104/221551911 [============&gt;.................] - ETA: 33s
102899712/221551911 [============&gt;.................] - ETA: 33s
103096320/221551911 [============&gt;.................] - ETA: 33s
103292928/221551911 [============&gt;.................] - ETA: 33s
103489536/221551911 [=============&gt;................] - ETA: 33s
103686144/221551911 [=============&gt;................] - ETA: 33s
103882752/221551911 [=============&gt;................] - ETA: 33s
104079360/221551911 [=============&gt;................] - ETA: 33s
104275968/221551911 [=============&gt;................] - ETA: 33s
104472576/221551911 [=============&gt;................] - ETA: 33s
104669184/221551911 [=============&gt;................] - ETA: 33s
104865792/221551911 [=============&gt;................] - ETA: 33s
105062400/221551911 [=============&gt;................] - ETA: 33s
105259008/221551911 [=============&gt;................] - ETA: 33s
105455616/221551911 [=============&gt;................] - ETA: 32s
105652224/221551911 [=============&gt;................] - ETA: 32s
105848832/221551911 [=============&gt;................] - ETA: 32s
106045440/221551911 [=============&gt;................] - ETA: 32s
106242048/221551911 [=============&gt;................] - ETA: 32s
106438656/221551911 [=============&gt;................] - ETA: 32s
106635264/221551911 [=============&gt;................] - ETA: 32s
106831872/221551911 [=============&gt;................] - ETA: 32s
107028480/221551911 [=============&gt;................] - ETA: 32s
107225088/221551911 [=============&gt;................] - ETA: 32s
107421696/221551911 [=============&gt;................] - ETA: 32s
107618304/221551911 [=============&gt;................] - ETA: 32s
107814912/221551911 [=============&gt;................] - ETA: 32s
108011520/221551911 [=============&gt;................] - ETA: 32s
108208128/221551911 [=============&gt;................] - ETA: 32s
108404736/221551911 [=============&gt;................] - ETA: 32s
108601344/221551911 [=============&gt;................] - ETA: 32s
108797952/221551911 [=============&gt;................] - ETA: 31s
108994560/221551911 [=============&gt;................] - ETA: 31s
109191168/221551911 [=============&gt;................] - ETA: 31s
109387776/221551911 [=============&gt;................] - ETA: 31s
109584384/221551911 [=============&gt;................] - ETA: 31s
109780992/221551911 [=============&gt;................] - ETA: 31s
109977600/221551911 [=============&gt;................] - ETA: 31s
110174208/221551911 [=============&gt;................] - ETA: 31s
110370816/221551911 [=============&gt;................] - ETA: 31s
110567424/221551911 [=============&gt;................] - ETA: 31s
110764032/221551911 [=============&gt;................] - ETA: 31s
110960640/221551911 [==============&gt;...............] - ETA: 31s
111157248/221551911 [==============&gt;...............] - ETA: 31s
111353856/221551911 [==============&gt;...............] - ETA: 31s
111550464/221551911 [==============&gt;...............] - ETA: 31s
111747072/221551911 [==============&gt;...............] - ETA: 31s
111943680/221551911 [==============&gt;...............] - ETA: 31s
112140288/221551911 [==============&gt;...............] - ETA: 31s
112336896/221551911 [==============&gt;...............] - ETA: 30s
112533504/221551911 [==============&gt;...............] - ETA: 30s
112730112/221551911 [==============&gt;...............] - ETA: 30s
112926720/221551911 [==============&gt;...............] - ETA: 30s
113123328/221551911 [==============&gt;...............] - ETA: 30s
113319936/221551911 [==============&gt;...............] - ETA: 30s
113516544/221551911 [==============&gt;...............] - ETA: 30s
113713152/221551911 [==============&gt;...............] - ETA: 30s
113909760/221551911 [==============&gt;...............] - ETA: 30s
114106368/221551911 [==============&gt;...............] - ETA: 30s
114302976/221551911 [==============&gt;...............] - ETA: 30s
114499584/221551911 [==============&gt;...............] - ETA: 30s
114696192/221551911 [==============&gt;...............] - ETA: 30s
114892800/221551911 [==============&gt;...............] - ETA: 30s
115089408/221551911 [==============&gt;...............] - ETA: 30s
115286016/221551911 [==============&gt;...............] - ETA: 30s
115482624/221551911 [==============&gt;...............] - ETA: 30s
115679232/221551911 [==============&gt;...............] - ETA: 29s
115875840/221551911 [==============&gt;...............] - ETA: 29s
116072448/221551911 [==============&gt;...............] - ETA: 29s
116269056/221551911 [==============&gt;...............] - ETA: 29s
116465664/221551911 [==============&gt;...............] - ETA: 29s
116662272/221551911 [==============&gt;...............] - ETA: 29s
116858880/221551911 [==============&gt;...............] - ETA: 29s
117055488/221551911 [==============&gt;...............] - ETA: 29s
117252096/221551911 [==============&gt;...............] - ETA: 29s
117448704/221551911 [==============&gt;...............] - ETA: 29s
117645312/221551911 [==============&gt;...............] - ETA: 29s
117841920/221551911 [==============&gt;...............] - ETA: 29s
118038528/221551911 [==============&gt;...............] - ETA: 29s
118235136/221551911 [===============&gt;..............] - ETA: 29s
118431744/221551911 [===============&gt;..............] - ETA: 29s
118628352/221551911 [===============&gt;..............] - ETA: 29s
118824960/221551911 [===============&gt;..............] - ETA: 29s
119021568/221551911 [===============&gt;..............] - ETA: 28s
119218176/221551911 [===============&gt;..............] - ETA: 28s
119414784/221551911 [===============&gt;..............] - ETA: 28s
119611392/221551911 [===============&gt;..............] - ETA: 28s
119808000/221551911 [===============&gt;..............] - ETA: 28s
120004608/221551911 [===============&gt;..............] - ETA: 28s
120201216/221551911 [===============&gt;..............] - ETA: 28s
120397824/221551911 [===============&gt;..............] - ETA: 28s
120594432/221551911 [===============&gt;..............] - ETA: 28s
120791040/221551911 [===============&gt;..............] - ETA: 28s
120987648/221551911 [===============&gt;..............] - ETA: 28s
121184256/221551911 [===============&gt;..............] - ETA: 28s
121380864/221551911 [===============&gt;..............] - ETA: 28s
121577472/221551911 [===============&gt;..............] - ETA: 28s
121774080/221551911 [===============&gt;..............] - ETA: 28s
121970688/221551911 [===============&gt;..............] - ETA: 28s
122167296/221551911 [===============&gt;..............] - ETA: 28s
122363904/221551911 [===============&gt;..............] - ETA: 28s
122560512/221551911 [===============&gt;..............] - ETA: 27s
122757120/221551911 [===============&gt;..............] - ETA: 27s
122953728/221551911 [===============&gt;..............] - ETA: 27s
123150336/221551911 [===============&gt;..............] - ETA: 27s
123346944/221551911 [===============&gt;..............] - ETA: 27s
123543552/221551911 [===============&gt;..............] - ETA: 27s
123740160/221551911 [===============&gt;..............] - ETA: 27s
123936768/221551911 [===============&gt;..............] - ETA: 27s
124133376/221551911 [===============&gt;..............] - ETA: 27s
124329984/221551911 [===============&gt;..............] - ETA: 27s
124526592/221551911 [===============&gt;..............] - ETA: 27s
124723200/221551911 [===============&gt;..............] - ETA: 27s
124919808/221551911 [===============&gt;..............] - ETA: 27s
125116416/221551911 [===============&gt;..............] - ETA: 27s
125313024/221551911 [===============&gt;..............] - ETA: 27s
125509632/221551911 [===============&gt;..............] - ETA: 27s
125706240/221551911 [================&gt;.............] - ETA: 27s
125902848/221551911 [================&gt;.............] - ETA: 26s
126099456/221551911 [================&gt;.............] - ETA: 26s
126296064/221551911 [================&gt;.............] - ETA: 26s
126492672/221551911 [================&gt;.............] - ETA: 26s
126689280/221551911 [================&gt;.............] - ETA: 26s
126885888/221551911 [================&gt;.............] - ETA: 26s
127082496/221551911 [================&gt;.............] - ETA: 26s
127279104/221551911 [================&gt;.............] - ETA: 26s
127475712/221551911 [================&gt;.............] - ETA: 26s
127672320/221551911 [================&gt;.............] - ETA: 26s
127868928/221551911 [================&gt;.............] - ETA: 26s
128065536/221551911 [================&gt;.............] - ETA: 26s
128262144/221551911 [================&gt;.............] - ETA: 26s
128458752/221551911 [================&gt;.............] - ETA: 26s
128655360/221551911 [================&gt;.............] - ETA: 26s
128851968/221551911 [================&gt;.............] - ETA: 26s
129048576/221551911 [================&gt;.............] - ETA: 26s
129245184/221551911 [================&gt;.............] - ETA: 26s
129441792/221551911 [================&gt;.............] - ETA: 25s
129638400/221551911 [================&gt;.............] - ETA: 25s
129835008/221551911 [================&gt;.............] - ETA: 25s
130031616/221551911 [================&gt;.............] - ETA: 25s
130228224/221551911 [================&gt;.............] - ETA: 25s
130424832/221551911 [================&gt;.............] - ETA: 25s
130621440/221551911 [================&gt;.............] - ETA: 25s
130818048/221551911 [================&gt;.............] - ETA: 25s
131014656/221551911 [================&gt;.............] - ETA: 25s
131211264/221551911 [================&gt;.............] - ETA: 25s
131407872/221551911 [================&gt;.............] - ETA: 25s
131604480/221551911 [================&gt;.............] - ETA: 25s
131801088/221551911 [================&gt;.............] - ETA: 25s
131997696/221551911 [================&gt;.............] - ETA: 25s
132194304/221551911 [================&gt;.............] - ETA: 25s
132390912/221551911 [================&gt;.............] - ETA: 25s
132587520/221551911 [================&gt;.............] - ETA: 25s
132784128/221551911 [================&gt;.............] - ETA: 25s
132980736/221551911 [=================&gt;............] - ETA: 24s
133177344/221551911 [=================&gt;............] - ETA: 24s
133373952/221551911 [=================&gt;............] - ETA: 24s
133570560/221551911 [=================&gt;............] - ETA: 24s
133767168/221551911 [=================&gt;............] - ETA: 24s
133963776/221551911 [=================&gt;............] - ETA: 24s
134160384/221551911 [=================&gt;............] - ETA: 24s
134356992/221551911 [=================&gt;............] - ETA: 24s
134553600/221551911 [=================&gt;............] - ETA: 24s
134750208/221551911 [=================&gt;............] - ETA: 24s
134946816/221551911 [=================&gt;............] - ETA: 24s
135143424/221551911 [=================&gt;............] - ETA: 24s
135340032/221551911 [=================&gt;............] - ETA: 24s
135536640/221551911 [=================&gt;............] - ETA: 24s
135733248/221551911 [=================&gt;............] - ETA: 24s
135929856/221551911 [=================&gt;............] - ETA: 24s
136126464/221551911 [=================&gt;............] - ETA: 24s
136323072/221551911 [=================&gt;............] - ETA: 23s
136519680/221551911 [=================&gt;............] - ETA: 23s
136716288/221551911 [=================&gt;............] - ETA: 23s
136912896/221551911 [=================&gt;............] - ETA: 23s
137109504/221551911 [=================&gt;............] - ETA: 23s
137306112/221551911 [=================&gt;............] - ETA: 23s
137502720/221551911 [=================&gt;............] - ETA: 23s
137699328/221551911 [=================&gt;............] - ETA: 23s
137895936/221551911 [=================&gt;............] - ETA: 23s
138092544/221551911 [=================&gt;............] - ETA: 23s
138289152/221551911 [=================&gt;............] - ETA: 23s
138485760/221551911 [=================&gt;............] - ETA: 23s
138682368/221551911 [=================&gt;............] - ETA: 23s
138878976/221551911 [=================&gt;............] - ETA: 23s
139075584/221551911 [=================&gt;............] - ETA: 23s
139272192/221551911 [=================&gt;............] - ETA: 23s
139468800/221551911 [=================&gt;............] - ETA: 23s
139665408/221551911 [=================&gt;............] - ETA: 23s
139862016/221551911 [=================&gt;............] - ETA: 22s
140058624/221551911 [=================&gt;............] - ETA: 22s
140255232/221551911 [=================&gt;............] - ETA: 22s
140451840/221551911 [==================&gt;...........] - ETA: 22s
140648448/221551911 [==================&gt;...........] - ETA: 22s
140845056/221551911 [==================&gt;...........] - ETA: 22s
141041664/221551911 [==================&gt;...........] - ETA: 22s
141238272/221551911 [==================&gt;...........] - ETA: 22s
141434880/221551911 [==================&gt;...........] - ETA: 22s
141631488/221551911 [==================&gt;...........] - ETA: 22s
141828096/221551911 [==================&gt;...........] - ETA: 22s
142024704/221551911 [==================&gt;...........] - ETA: 22s
142221312/221551911 [==================&gt;...........] - ETA: 22s
142417920/221551911 [==================&gt;...........] - ETA: 22s
142614528/221551911 [==================&gt;...........] - ETA: 22s
142811136/221551911 [==================&gt;...........] - ETA: 22s
143007744/221551911 [==================&gt;...........] - ETA: 22s
143204352/221551911 [==================&gt;...........] - ETA: 22s
143400960/221551911 [==================&gt;...........] - ETA: 21s
143597568/221551911 [==================&gt;...........] - ETA: 21s
143794176/221551911 [==================&gt;...........] - ETA: 21s
143990784/221551911 [==================&gt;...........] - ETA: 21s
144187392/221551911 [==================&gt;...........] - ETA: 21s
144384000/221551911 [==================&gt;...........] - ETA: 21s
144580608/221551911 [==================&gt;...........] - ETA: 21s
144777216/221551911 [==================&gt;...........] - ETA: 21s
144973824/221551911 [==================&gt;...........] - ETA: 21s
145170432/221551911 [==================&gt;...........] - ETA: 21s
145367040/221551911 [==================&gt;...........] - ETA: 21s
145563648/221551911 [==================&gt;...........] - ETA: 21s
145760256/221551911 [==================&gt;...........] - ETA: 21s
145956864/221551911 [==================&gt;...........] - ETA: 21s
146153472/221551911 [==================&gt;...........] - ETA: 21s
146350080/221551911 [==================&gt;...........] - ETA: 21s
146546688/221551911 [==================&gt;...........] - ETA: 21s
146743296/221551911 [==================&gt;...........] - ETA: 21s
146939904/221551911 [==================&gt;...........] - ETA: 20s
147136512/221551911 [==================&gt;...........] - ETA: 20s
147333120/221551911 [==================&gt;...........] - ETA: 20s
147529728/221551911 [==================&gt;...........] - ETA: 20s
147726336/221551911 [===================&gt;..........] - ETA: 20s
147922944/221551911 [===================&gt;..........] - ETA: 20s
148119552/221551911 [===================&gt;..........] - ETA: 20s
148316160/221551911 [===================&gt;..........] - ETA: 20s
148512768/221551911 [===================&gt;..........] - ETA: 20s
148709376/221551911 [===================&gt;..........] - ETA: 20s
148905984/221551911 [===================&gt;..........] - ETA: 20s
149102592/221551911 [===================&gt;..........] - ETA: 20s
149299200/221551911 [===================&gt;..........] - ETA: 20s
149495808/221551911 [===================&gt;..........] - ETA: 20s
149692416/221551911 [===================&gt;..........] - ETA: 20s
149889024/221551911 [===================&gt;..........] - ETA: 20s
150085632/221551911 [===================&gt;..........] - ETA: 20s
150233088/221551911 [===================&gt;..........] - ETA: 20s
150413312/221551911 [===================&gt;..........] - ETA: 19s
150609920/221551911 [===================&gt;..........] - ETA: 19s
150806528/221551911 [===================&gt;..........] - ETA: 19s
151003136/221551911 [===================&gt;..........] - ETA: 19s
151199744/221551911 [===================&gt;..........] - ETA: 19s
151396352/221551911 [===================&gt;..........] - ETA: 19s
151592960/221551911 [===================&gt;..........] - ETA: 19s
151789568/221551911 [===================&gt;..........] - ETA: 19s
151986176/221551911 [===================&gt;..........] - ETA: 19s
152182784/221551911 [===================&gt;..........] - ETA: 19s
152379392/221551911 [===================&gt;..........] - ETA: 19s
152576000/221551911 [===================&gt;..........] - ETA: 19s
152772608/221551911 [===================&gt;..........] - ETA: 19s
152969216/221551911 [===================&gt;..........] - ETA: 19s
153165824/221551911 [===================&gt;..........] - ETA: 19s
153362432/221551911 [===================&gt;..........] - ETA: 19s
153559040/221551911 [===================&gt;..........] - ETA: 19s
153755648/221551911 [===================&gt;..........] - ETA: 19s
153952256/221551911 [===================&gt;..........] - ETA: 18s
154148864/221551911 [===================&gt;..........] - ETA: 18s
154345472/221551911 [===================&gt;..........] - ETA: 18s
154542080/221551911 [===================&gt;..........] - ETA: 18s
154738688/221551911 [===================&gt;..........] - ETA: 18s
154935296/221551911 [===================&gt;..........] - ETA: 18s
155131904/221551911 [====================&gt;.........] - ETA: 18s
155328512/221551911 [====================&gt;.........] - ETA: 18s
155525120/221551911 [====================&gt;.........] - ETA: 18s
155721728/221551911 [====================&gt;.........] - ETA: 18s
155918336/221551911 [====================&gt;.........] - ETA: 18s
156114944/221551911 [====================&gt;.........] - ETA: 18s
156311552/221551911 [====================&gt;.........] - ETA: 18s
156508160/221551911 [====================&gt;.........] - ETA: 18s
156704768/221551911 [====================&gt;.........] - ETA: 18s
156901376/221551911 [====================&gt;.........] - ETA: 18s
157097984/221551911 [====================&gt;.........] - ETA: 18s
157294592/221551911 [====================&gt;.........] - ETA: 18s
157491200/221551911 [====================&gt;.........] - ETA: 17s
157687808/221551911 [====================&gt;.........] - ETA: 17s
157884416/221551911 [====================&gt;.........] - ETA: 17s
158081024/221551911 [====================&gt;.........] - ETA: 17s
158277632/221551911 [====================&gt;.........] - ETA: 17s
158474240/221551911 [====================&gt;.........] - ETA: 17s
158670848/221551911 [====================&gt;.........] - ETA: 17s
158867456/221551911 [====================&gt;.........] - ETA: 17s
159064064/221551911 [====================&gt;.........] - ETA: 17s
159260672/221551911 [====================&gt;.........] - ETA: 17s
159457280/221551911 [====================&gt;.........] - ETA: 17s
159653888/221551911 [====================&gt;.........] - ETA: 17s
159850496/221551911 [====================&gt;.........] - ETA: 17s
160047104/221551911 [====================&gt;.........] - ETA: 17s
160243712/221551911 [====================&gt;.........] - ETA: 17s
160440320/221551911 [====================&gt;.........] - ETA: 17s
160636928/221551911 [====================&gt;.........] - ETA: 17s
160833536/221551911 [====================&gt;.........] - ETA: 17s
161030144/221551911 [====================&gt;.........] - ETA: 16s
161226752/221551911 [====================&gt;.........] - ETA: 16s
161423360/221551911 [====================&gt;.........] - ETA: 16s
161619968/221551911 [====================&gt;.........] - ETA: 16s
161816576/221551911 [====================&gt;.........] - ETA: 16s
162013184/221551911 [====================&gt;.........] - ETA: 16s
162209792/221551911 [====================&gt;.........] - ETA: 16s
162406400/221551911 [====================&gt;.........] - ETA: 16s
162603008/221551911 [=====================&gt;........] - ETA: 16s
162799616/221551911 [=====================&gt;........] - ETA: 16s
162996224/221551911 [=====================&gt;........] - ETA: 16s
163192832/221551911 [=====================&gt;........] - ETA: 16s
163389440/221551911 [=====================&gt;........] - ETA: 16s
163586048/221551911 [=====================&gt;........] - ETA: 16s
163782656/221551911 [=====================&gt;........] - ETA: 16s
163979264/221551911 [=====================&gt;........] - ETA: 16s
164175872/221551911 [=====================&gt;........] - ETA: 16s
164372480/221551911 [=====================&gt;........] - ETA: 16s
164569088/221551911 [=====================&gt;........] - ETA: 15s
164765696/221551911 [=====================&gt;........] - ETA: 15s
164962304/221551911 [=====================&gt;........] - ETA: 15s
165158912/221551911 [=====================&gt;........] - ETA: 15s
165355520/221551911 [=====================&gt;........] - ETA: 15s
165552128/221551911 [=====================&gt;........] - ETA: 15s
165748736/221551911 [=====================&gt;........] - ETA: 15s
165945344/221551911 [=====================&gt;........] - ETA: 15s
166141952/221551911 [=====================&gt;........] - ETA: 15s
166338560/221551911 [=====================&gt;........] - ETA: 15s
166535168/221551911 [=====================&gt;........] - ETA: 15s
166731776/221551911 [=====================&gt;........] - ETA: 15s
166928384/221551911 [=====================&gt;........] - ETA: 15s
167124992/221551911 [=====================&gt;........] - ETA: 15s
167321600/221551911 [=====================&gt;........] - ETA: 15s
167518208/221551911 [=====================&gt;........] - ETA: 15s
167714816/221551911 [=====================&gt;........] - ETA: 15s
167911424/221551911 [=====================&gt;........] - ETA: 15s
168108032/221551911 [=====================&gt;........] - ETA: 14s
168304640/221551911 [=====================&gt;........] - ETA: 14s
168501248/221551911 [=====================&gt;........] - ETA: 14s
168697856/221551911 [=====================&gt;........] - ETA: 14s
168894464/221551911 [=====================&gt;........] - ETA: 14s
169091072/221551911 [=====================&gt;........] - ETA: 14s
169287680/221551911 [=====================&gt;........] - ETA: 14s
169484288/221551911 [=====================&gt;........] - ETA: 14s
169680896/221551911 [=====================&gt;........] - ETA: 14s
169877504/221551911 [======================&gt;.......] - ETA: 14s
170074112/221551911 [======================&gt;.......] - ETA: 14s
170270720/221551911 [======================&gt;.......] - ETA: 14s
170467328/221551911 [======================&gt;.......] - ETA: 14s
170663936/221551911 [======================&gt;.......] - ETA: 14s
170860544/221551911 [======================&gt;.......] - ETA: 14s
171057152/221551911 [======================&gt;.......] - ETA: 14s
171253760/221551911 [======================&gt;.......] - ETA: 14s
171450368/221551911 [======================&gt;.......] - ETA: 14s
171646976/221551911 [======================&gt;.......] - ETA: 13s
171843584/221551911 [======================&gt;.......] - ETA: 13s
172040192/221551911 [======================&gt;.......] - ETA: 13s
172236800/221551911 [======================&gt;.......] - ETA: 13s
172433408/221551911 [======================&gt;.......] - ETA: 13s
172630016/221551911 [======================&gt;.......] - ETA: 13s
172826624/221551911 [======================&gt;.......] - ETA: 13s
173023232/221551911 [======================&gt;.......] - ETA: 13s
173219840/221551911 [======================&gt;.......] - ETA: 13s
173416448/221551911 [======================&gt;.......] - ETA: 13s
173613056/221551911 [======================&gt;.......] - ETA: 13s
173809664/221551911 [======================&gt;.......] - ETA: 13s
174006272/221551911 [======================&gt;.......] - ETA: 13s
174202880/221551911 [======================&gt;.......] - ETA: 13s
174399488/221551911 [======================&gt;.......] - ETA: 13s
174596096/221551911 [======================&gt;.......] - ETA: 13s
174792704/221551911 [======================&gt;.......] - ETA: 13s
174989312/221551911 [======================&gt;.......] - ETA: 13s
175185920/221551911 [======================&gt;.......] - ETA: 12s
175382528/221551911 [======================&gt;.......] - ETA: 12s
175579136/221551911 [======================&gt;.......] - ETA: 12s
175775744/221551911 [======================&gt;.......] - ETA: 12s
175972352/221551911 [======================&gt;.......] - ETA: 12s
176168960/221551911 [======================&gt;.......] - ETA: 12s
176365568/221551911 [======================&gt;.......] - ETA: 12s
176562176/221551911 [======================&gt;.......] - ETA: 12s
176758784/221551911 [======================&gt;.......] - ETA: 12s
176955392/221551911 [======================&gt;.......] - ETA: 12s
177152000/221551911 [======================&gt;.......] - ETA: 12s
177348608/221551911 [=======================&gt;......] - ETA: 12s
177545216/221551911 [=======================&gt;......] - ETA: 12s
177741824/221551911 [=======================&gt;......] - ETA: 12s
177938432/221551911 [=======================&gt;......] - ETA: 12s
178135040/221551911 [=======================&gt;......] - ETA: 12s
178331648/221551911 [=======================&gt;......] - ETA: 12s
178528256/221551911 [=======================&gt;......] - ETA: 12s
178724864/221551911 [=======================&gt;......] - ETA: 11s
178921472/221551911 [=======================&gt;......] - ETA: 11s
179118080/221551911 [=======================&gt;......] - ETA: 11s
179314688/221551911 [=======================&gt;......] - ETA: 11s
179511296/221551911 [=======================&gt;......] - ETA: 11s
179707904/221551911 [=======================&gt;......] - ETA: 11s
179904512/221551911 [=======================&gt;......] - ETA: 11s
180101120/221551911 [=======================&gt;......] - ETA: 11s
180297728/221551911 [=======================&gt;......] - ETA: 11s
180494336/221551911 [=======================&gt;......] - ETA: 11s
180690944/221551911 [=======================&gt;......] - ETA: 11s
180887552/221551911 [=======================&gt;......] - ETA: 11s
181084160/221551911 [=======================&gt;......] - ETA: 11s
181280768/221551911 [=======================&gt;......] - ETA: 11s
181477376/221551911 [=======================&gt;......] - ETA: 11s
181673984/221551911 [=======================&gt;......] - ETA: 11s
181870592/221551911 [=======================&gt;......] - ETA: 11s
182067200/221551911 [=======================&gt;......] - ETA: 11s
182263808/221551911 [=======================&gt;......] - ETA: 10s
182460416/221551911 [=======================&gt;......] - ETA: 10s
182657024/221551911 [=======================&gt;......] - ETA: 10s
182853632/221551911 [=======================&gt;......] - ETA: 10s
183050240/221551911 [=======================&gt;......] - ETA: 10s
183246848/221551911 [=======================&gt;......] - ETA: 10s
183443456/221551911 [=======================&gt;......] - ETA: 10s
183640064/221551911 [=======================&gt;......] - ETA: 10s
183836672/221551911 [=======================&gt;......] - ETA: 10s
184033280/221551911 [=======================&gt;......] - ETA: 10s
184229888/221551911 [=======================&gt;......] - ETA: 10s
184426496/221551911 [=======================&gt;......] - ETA: 10s
184623104/221551911 [=======================&gt;......] - ETA: 10s
184819712/221551911 [========================&gt;.....] - ETA: 10s
185016320/221551911 [========================&gt;.....] - ETA: 10s
185212928/221551911 [========================&gt;.....] - ETA: 10s
185409536/221551911 [========================&gt;.....] - ETA: 10s
185606144/221551911 [========================&gt;.....] - ETA: 10s
185802752/221551911 [========================&gt;.....] - ETA: 9s 
185999360/221551911 [========================&gt;.....] - ETA: 9s
186195968/221551911 [========================&gt;.....] - ETA: 9s
186392576/221551911 [========================&gt;.....] - ETA: 9s
186589184/221551911 [========================&gt;.....] - ETA: 9s
186785792/221551911 [========================&gt;.....] - ETA: 9s
186982400/221551911 [========================&gt;.....] - ETA: 9s
187179008/221551911 [========================&gt;.....] - ETA: 9s
187375616/221551911 [========================&gt;.....] - ETA: 9s
187572224/221551911 [========================&gt;.....] - ETA: 9s
187768832/221551911 [========================&gt;.....] - ETA: 9s
187965440/221551911 [========================&gt;.....] - ETA: 9s
188162048/221551911 [========================&gt;.....] - ETA: 9s
188358656/221551911 [========================&gt;.....] - ETA: 9s
188555264/221551911 [========================&gt;.....] - ETA: 9s
188751872/221551911 [========================&gt;.....] - ETA: 9s
188948480/221551911 [========================&gt;.....] - ETA: 9s
189145088/221551911 [========================&gt;.....] - ETA: 9s
189341696/221551911 [========================&gt;.....] - ETA: 8s
189538304/221551911 [========================&gt;.....] - ETA: 8s
189734912/221551911 [========================&gt;.....] - ETA: 8s
189931520/221551911 [========================&gt;.....] - ETA: 8s
190128128/221551911 [========================&gt;.....] - ETA: 8s
190324736/221551911 [========================&gt;.....] - ETA: 8s
190521344/221551911 [========================&gt;.....] - ETA: 8s
190717952/221551911 [========================&gt;.....] - ETA: 8s
190914560/221551911 [========================&gt;.....] - ETA: 8s
191111168/221551911 [========================&gt;.....] - ETA: 8s
191307776/221551911 [========================&gt;.....] - ETA: 8s
191504384/221551911 [========================&gt;.....] - ETA: 8s
191700992/221551911 [========================&gt;.....] - ETA: 8s
191897600/221551911 [========================&gt;.....] - ETA: 8s
192094208/221551911 [=========================&gt;....] - ETA: 8s
192290816/221551911 [=========================&gt;....] - ETA: 8s
192487424/221551911 [=========================&gt;....] - ETA: 8s
192684032/221551911 [=========================&gt;....] - ETA: 8s
192880640/221551911 [=========================&gt;....] - ETA: 7s
193077248/221551911 [=========================&gt;....] - ETA: 7s
193273856/221551911 [=========================&gt;....] - ETA: 7s
193470464/221551911 [=========================&gt;....] - ETA: 7s
193667072/221551911 [=========================&gt;....] - ETA: 7s
193863680/221551911 [=========================&gt;....] - ETA: 7s
194060288/221551911 [=========================&gt;....] - ETA: 7s
194256896/221551911 [=========================&gt;....] - ETA: 7s
194453504/221551911 [=========================&gt;....] - ETA: 7s
194650112/221551911 [=========================&gt;....] - ETA: 7s
194846720/221551911 [=========================&gt;....] - ETA: 7s
195043328/221551911 [=========================&gt;....] - ETA: 7s
195239936/221551911 [=========================&gt;....] - ETA: 7s
195436544/221551911 [=========================&gt;....] - ETA: 7s
195633152/221551911 [=========================&gt;....] - ETA: 7s
195829760/221551911 [=========================&gt;....] - ETA: 7s
196026368/221551911 [=========================&gt;....] - ETA: 7s
196222976/221551911 [=========================&gt;....] - ETA: 7s
196419584/221551911 [=========================&gt;....] - ETA: 7s
196616192/221551911 [=========================&gt;....] - ETA: 6s
196812800/221551911 [=========================&gt;....] - ETA: 6s
197009408/221551911 [=========================&gt;....] - ETA: 6s
197206016/221551911 [=========================&gt;....] - ETA: 6s
197402624/221551911 [=========================&gt;....] - ETA: 6s
197599232/221551911 [=========================&gt;....] - ETA: 6s
197795840/221551911 [=========================&gt;....] - ETA: 6s
197992448/221551911 [=========================&gt;....] - ETA: 6s
198189056/221551911 [=========================&gt;....] - ETA: 6s
198385664/221551911 [=========================&gt;....] - ETA: 6s
198582272/221551911 [=========================&gt;....] - ETA: 6s
198778880/221551911 [=========================&gt;....] - ETA: 6s
198975488/221551911 [=========================&gt;....] - ETA: 6s
199172096/221551911 [=========================&gt;....] - ETA: 6s
199368704/221551911 [=========================&gt;....] - ETA: 6s
199565312/221551911 [==========================&gt;...] - ETA: 6s
199761920/221551911 [==========================&gt;...] - ETA: 6s
199958528/221551911 [==========================&gt;...] - ETA: 6s
200155136/221551911 [==========================&gt;...] - ETA: 5s
200351744/221551911 [==========================&gt;...] - ETA: 5s
200548352/221551911 [==========================&gt;...] - ETA: 5s
200744960/221551911 [==========================&gt;...] - ETA: 5s
200941568/221551911 [==========================&gt;...] - ETA: 5s
201138176/221551911 [==========================&gt;...] - ETA: 5s
201334784/221551911 [==========================&gt;...] - ETA: 5s
201531392/221551911 [==========================&gt;...] - ETA: 5s
201728000/221551911 [==========================&gt;...] - ETA: 5s
201924608/221551911 [==========================&gt;...] - ETA: 5s
202121216/221551911 [==========================&gt;...] - ETA: 5s
202317824/221551911 [==========================&gt;...] - ETA: 5s
202514432/221551911 [==========================&gt;...] - ETA: 5s
202711040/221551911 [==========================&gt;...] - ETA: 5s
202907648/221551911 [==========================&gt;...] - ETA: 5s
203104256/221551911 [==========================&gt;...] - ETA: 5s
203300864/221551911 [==========================&gt;...] - ETA: 5s
203497472/221551911 [==========================&gt;...] - ETA: 5s
203694080/221551911 [==========================&gt;...] - ETA: 4s
203890688/221551911 [==========================&gt;...] - ETA: 4s
204087296/221551911 [==========================&gt;...] - ETA: 4s
204283904/221551911 [==========================&gt;...] - ETA: 4s
204480512/221551911 [==========================&gt;...] - ETA: 4s
204677120/221551911 [==========================&gt;...] - ETA: 4s
204873728/221551911 [==========================&gt;...] - ETA: 4s
205070336/221551911 [==========================&gt;...] - ETA: 4s
205266944/221551911 [==========================&gt;...] - ETA: 4s
205463552/221551911 [==========================&gt;...] - ETA: 4s
205660160/221551911 [==========================&gt;...] - ETA: 4s
205856768/221551911 [==========================&gt;...] - ETA: 4s
206053376/221551911 [==========================&gt;...] - ETA: 4s
206249984/221551911 [==========================&gt;...] - ETA: 4s
206446592/221551911 [==========================&gt;...] - ETA: 4s
206643200/221551911 [==========================&gt;...] - ETA: 4s
206839808/221551911 [===========================&gt;..] - ETA: 4s
207036416/221551911 [===========================&gt;..] - ETA: 4s
207233024/221551911 [===========================&gt;..] - ETA: 3s
207429632/221551911 [===========================&gt;..] - ETA: 3s
207626240/221551911 [===========================&gt;..] - ETA: 3s
207822848/221551911 [===========================&gt;..] - ETA: 3s
208019456/221551911 [===========================&gt;..] - ETA: 3s
208216064/221551911 [===========================&gt;..] - ETA: 3s
208412672/221551911 [===========================&gt;..] - ETA: 3s
208609280/221551911 [===========================&gt;..] - ETA: 3s
208805888/221551911 [===========================&gt;..] - ETA: 3s
209002496/221551911 [===========================&gt;..] - ETA: 3s
209199104/221551911 [===========================&gt;..] - ETA: 3s
209395712/221551911 [===========================&gt;..] - ETA: 3s
209592320/221551911 [===========================&gt;..] - ETA: 3s
209788928/221551911 [===========================&gt;..] - ETA: 3s
209985536/221551911 [===========================&gt;..] - ETA: 3s
210182144/221551911 [===========================&gt;..] - ETA: 3s
210378752/221551911 [===========================&gt;..] - ETA: 3s
210575360/221551911 [===========================&gt;..] - ETA: 3s
210771968/221551911 [===========================&gt;..] - ETA: 2s
210968576/221551911 [===========================&gt;..] - ETA: 2s
211165184/221551911 [===========================&gt;..] - ETA: 2s
211361792/221551911 [===========================&gt;..] - ETA: 2s
211558400/221551911 [===========================&gt;..] - ETA: 2s
211755008/221551911 [===========================&gt;..] - ETA: 2s
211951616/221551911 [===========================&gt;..] - ETA: 2s
212148224/221551911 [===========================&gt;..] - ETA: 2s
212344832/221551911 [===========================&gt;..] - ETA: 2s
212541440/221551911 [===========================&gt;..] - ETA: 2s
212738048/221551911 [===========================&gt;..] - ETA: 2s
212934656/221551911 [===========================&gt;..] - ETA: 2s
213131264/221551911 [===========================&gt;..] - ETA: 2s
213327872/221551911 [===========================&gt;..] - ETA: 2s
213524480/221551911 [===========================&gt;..] - ETA: 2s
213721088/221551911 [===========================&gt;..] - ETA: 2s
213917696/221551911 [===========================&gt;..] - ETA: 2s
214114304/221551911 [===========================&gt;..] - ETA: 2s
214310912/221551911 [============================&gt;.] - ETA: 2s
214507520/221551911 [============================&gt;.] - ETA: 1s
214704128/221551911 [============================&gt;.] - ETA: 1s
214900736/221551911 [============================&gt;.] - ETA: 1s
215097344/221551911 [============================&gt;.] - ETA: 1s
215293952/221551911 [============================&gt;.] - ETA: 1s
215490560/221551911 [============================&gt;.] - ETA: 1s
215687168/221551911 [============================&gt;.] - ETA: 1s
215883776/221551911 [============================&gt;.] - ETA: 1s
216080384/221551911 [============================&gt;.] - ETA: 1s
216276992/221551911 [============================&gt;.] - ETA: 1s
216473600/221551911 [============================&gt;.] - ETA: 1s
216670208/221551911 [============================&gt;.] - ETA: 1s
216866816/221551911 [============================&gt;.] - ETA: 1s
217063424/221551911 [============================&gt;.] - ETA: 1s
217260032/221551911 [============================&gt;.] - ETA: 1s
217456640/221551911 [============================&gt;.] - ETA: 1s
217653248/221551911 [============================&gt;.] - ETA: 1s
217849856/221551911 [============================&gt;.] - ETA: 1s
218046464/221551911 [============================&gt;.] - ETA: 0s
218243072/221551911 [============================&gt;.] - ETA: 0s
218439680/221551911 [============================&gt;.] - ETA: 0s
218636288/221551911 [============================&gt;.] - ETA: 0s
218832896/221551911 [============================&gt;.] - ETA: 0s
219029504/221551911 [============================&gt;.] - ETA: 0s
219226112/221551911 [============================&gt;.] - ETA: 0s
219422720/221551911 [============================&gt;.] - ETA: 0s
219619328/221551911 [============================&gt;.] - ETA: 0s
219815936/221551911 [============================&gt;.] - ETA: 0s
220012544/221551911 [============================&gt;.] - ETA: 0s
220209152/221551911 [============================&gt;.] - ETA: 0s
220405760/221551911 [============================&gt;.] - ETA: 0s
220602368/221551911 [============================&gt;.] - ETA: 0s
220798976/221551911 [============================&gt;.] - ETA: 0s
220995584/221551911 [============================&gt;.] - ETA: 0s
221192192/221551911 [============================&gt;.] - ETA: 0s
221388800/221551911 [============================&gt;.] - ETA: 0s
221552640/221551911 [==============================] - 62s 0us/step
Loaded VOC2007 test data for car and person classes: 2500 images.
</pre></div>
</div>
<p>Anchors can also be computed easily using YOLO toolkit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following code is given as an example. In a real use case
scenario, anchors are computed on the training dataset.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models.detection.generate_anchors</span> <span class="kn">import</span> <span class="n">generate_anchors</span>

<span class="n">num_anchors</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">grid_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">anchors_example</span> <span class="o">=</span> <span class="n">generate_anchors</span><span class="p">(</span><span class="n">val_data</span><span class="p">,</span> <span class="n">num_anchors</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Average IOU for 5 anchors: 0.61
Anchors:  [[0.63263, 1.13864], [1.29467, 2.90717], [2.26527, 2.97757], [3.80627, 5.03516], [5.21984, 5.79988]]
</pre></div>
</div>
</div>
<div class="section" id="model-architecture">
<h2>3. Model architecture<a class="headerlink" href="#model-architecture" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="../api_reference/akida_models_apis.html#yolo">model zoo</a> contains a
YOLO model that is built upon the <a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.mobilenet_imagenet">MobileNet architecture</a>
and 3 separable convolutional layers at the top for bounding box and class
estimation followed by a final separable convolutional which is the detection
layer. Note that for efficiency, the alpha parameter in MobileNet (network
width or number of filter in each layer) is set to 0.5.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">yolo_base</span>

<span class="c1"># Create a yolo model for 2 classes with 5 anchors and grid size of 7</span>
<span class="n">classes</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">yolo_base</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                  <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
                  <span class="n">nb_box</span><span class="o">=</span><span class="n">num_anchors</span><span class="p">,</span>
                  <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>WARNING: Keyword argument &#39;strides&#39; is not supported in conv_block except for the first layer.
Model: &quot;yolo_base&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_10 (InputLayer)        [(None, 224, 224, 3)]     0
_________________________________________________________________
conv_0 (Conv2D)              (None, 112, 112, 16)      432
_________________________________________________________________
conv_0_BN (BatchNormalizatio (None, 112, 112, 16)      64
_________________________________________________________________
conv_0_relu (ReLU)           (None, 112, 112, 16)      0
_________________________________________________________________
separable_1 (SeparableConv2D (None, 112, 112, 32)      656
_________________________________________________________________
separable_1_BN (BatchNormali (None, 112, 112, 32)      128
_________________________________________________________________
separable_1_relu (ReLU)      (None, 112, 112, 32)      0
_________________________________________________________________
separable_2 (SeparableConv2D (None, 112, 112, 64)      2336
_________________________________________________________________
separable_2_maxpool (MaxPool (None, 56, 56, 64)        0
_________________________________________________________________
separable_2_BN (BatchNormali (None, 56, 56, 64)        256
_________________________________________________________________
separable_2_relu (ReLU)      (None, 56, 56, 64)        0
_________________________________________________________________
separable_3 (SeparableConv2D (None, 56, 56, 64)        4672
_________________________________________________________________
separable_3_BN (BatchNormali (None, 56, 56, 64)        256
_________________________________________________________________
separable_3_relu (ReLU)      (None, 56, 56, 64)        0
_________________________________________________________________
separable_4 (SeparableConv2D (None, 56, 56, 128)       8768
_________________________________________________________________
separable_4_maxpool (MaxPool (None, 28, 28, 128)       0
_________________________________________________________________
separable_4_BN (BatchNormali (None, 28, 28, 128)       512
_________________________________________________________________
separable_4_relu (ReLU)      (None, 28, 28, 128)       0
_________________________________________________________________
separable_5 (SeparableConv2D (None, 28, 28, 128)       17536
_________________________________________________________________
separable_5_BN (BatchNormali (None, 28, 28, 128)       512
_________________________________________________________________
separable_5_relu (ReLU)      (None, 28, 28, 128)       0
_________________________________________________________________
separable_6 (SeparableConv2D (None, 28, 28, 256)       33920
_________________________________________________________________
separable_6_maxpool (MaxPool (None, 14, 14, 256)       0
_________________________________________________________________
separable_6_BN (BatchNormali (None, 14, 14, 256)       1024
_________________________________________________________________
separable_6_relu (ReLU)      (None, 14, 14, 256)       0
_________________________________________________________________
separable_7 (SeparableConv2D (None, 14, 14, 256)       67840
_________________________________________________________________
separable_7_BN (BatchNormali (None, 14, 14, 256)       1024
_________________________________________________________________
separable_7_relu (ReLU)      (None, 14, 14, 256)       0
_________________________________________________________________
separable_8 (SeparableConv2D (None, 14, 14, 256)       67840
_________________________________________________________________
separable_8_BN (BatchNormali (None, 14, 14, 256)       1024
_________________________________________________________________
separable_8_relu (ReLU)      (None, 14, 14, 256)       0
_________________________________________________________________
separable_9 (SeparableConv2D (None, 14, 14, 256)       67840
_________________________________________________________________
separable_9_BN (BatchNormali (None, 14, 14, 256)       1024
_________________________________________________________________
separable_9_relu (ReLU)      (None, 14, 14, 256)       0
_________________________________________________________________
separable_10 (SeparableConv2 (None, 14, 14, 256)       67840
_________________________________________________________________
separable_10_BN (BatchNormal (None, 14, 14, 256)       1024
_________________________________________________________________
separable_10_relu (ReLU)     (None, 14, 14, 256)       0
_________________________________________________________________
separable_11 (SeparableConv2 (None, 14, 14, 256)       67840
_________________________________________________________________
separable_11_BN (BatchNormal (None, 14, 14, 256)       1024
_________________________________________________________________
separable_11_relu (ReLU)     (None, 14, 14, 256)       0
_________________________________________________________________
separable_12 (SeparableConv2 (None, 14, 14, 512)       133376
_________________________________________________________________
separable_12_maxpool (MaxPoo (None, 7, 7, 512)         0
_________________________________________________________________
separable_12_BN (BatchNormal (None, 7, 7, 512)         2048
_________________________________________________________________
separable_12_relu (ReLU)     (None, 7, 7, 512)         0
_________________________________________________________________
separable_13 (SeparableConv2 (None, 7, 7, 512)         266752
_________________________________________________________________
separable_13_BN (BatchNormal (None, 7, 7, 512)         2048
_________________________________________________________________
separable_13_relu (ReLU)     (None, 7, 7, 512)         0
_________________________________________________________________
1conv (SeparableConv2D)      (None, 7, 7, 1024)        528896
_________________________________________________________________
1conv_BN (BatchNormalization (None, 7, 7, 1024)        4096
_________________________________________________________________
1conv_relu (ReLU)            (None, 7, 7, 1024)        0
_________________________________________________________________
2conv (SeparableConv2D)      (None, 7, 7, 1024)        1057792
_________________________________________________________________
2conv_BN (BatchNormalization (None, 7, 7, 1024)        4096
_________________________________________________________________
2conv_relu (ReLU)            (None, 7, 7, 1024)        0
_________________________________________________________________
3conv (SeparableConv2D)      (None, 7, 7, 1024)        1057792
_________________________________________________________________
3conv_BN (BatchNormalization (None, 7, 7, 1024)        4096
_________________________________________________________________
3conv_relu (ReLU)            (None, 7, 7, 1024)        0
_________________________________________________________________
detection_layer (SeparableCo (None, 7, 7, 35)          45091
=================================================================
Total params: 3,521,475
Trainable params: 3,509,347
Non-trainable params: 12,128
_________________________________________________________________
</pre></div>
</div>
<p>The model output can be reshaped to a more natural shape of:</p>
<blockquote>
<div><p>(grid_height, grid_width, anchors_box, 4 + 1 + num_classes)</p>
</div></blockquote>
<p>where the “4 + 1” term represents the coordinates of the estimated bounding
boxes (top left x, top left y, width and height) and a confidence score. In
other words, the output channels are actually grouped by anchor boxes, and in
each group one channel provides either a coordinate, a global confidence score
or a class confidence score. This process is done automatically in the
<a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.detection.processing.decode_output">decode_output</a>
function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Reshape</span>

<span class="c1"># Define a reshape output to be added to the YOLO model</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">Reshape</span><span class="p">((</span><span class="n">grid_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">grid_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_anchors</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">classes</span><span class="p">),</span>
                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;YOLO_output&quot;</span><span class="p">)(</span><span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>

<span class="c1"># Build the complete model</span>
<span class="n">full_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
<span class="n">full_model</span><span class="o">.</span><span class="n">output</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;tf.Tensor &#39;YOLO_output/Identity:0&#39; shape=(None, 7, 7, 5, 7) dtype=float32&gt;
</pre></div>
</div>
</div>
<div class="section" id="training">
<h2>4. Training<a class="headerlink" href="#training" title="Permalink to this headline">¶</a></h2>
<p>As the YOLO model relies on Brainchip MobileNet/ImageNet network, it is
possible to perform transfer learning from ImageNet pretrained weights when
training a YOLO model. See the <a class="reference external" href="plot_transfer_learning.html">cats vs. dogs transfer learning example</a> for a detail explanation on transfer learning
principles.</p>
<p>When using transfer learning for YOLO training, we advise to proceed in
several steps that include step-wise quantization:</p>
<ul class="simple">
<li><p>instantiate the <cite>yolo_base</cite> model and load MobileNet/ImageNet pretrained
float weights,</p></li>
<li><p>freeze the MobileNet layers and perform training,</p></li>
<li><p>unfreeze all layers, lower the learning rate and quantize the network (e.g
to 8-bits weights and activations),</p></li>
<li><p>quantize to a lower bitwidth until reaching the target bitwidth and retrain.</p></li>
</ul>
<p>Even if transfer learning should be the preferred way to train a YOLO model, it
has been observed that for some datasets training all layers from scratch
gives better results. That is the case for our <a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.yolo_widerface_pretrained">YOLO WiderFace model</a>
to detect faces. In such a case, the training pipeline to follow is described
in the <a class="reference external" href="../user_guide/cnn2snn.html#typical-training-scenario">typical training scenario</a>.</p>
</div>
<div class="section" id="performance">
<h2>5. Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h2>
<p>The model zoo also contains an <a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.yolo_voc_pretrained">helper method</a>
that allows to create a YOLO model for VOC and load pretrained weights for the
car and person detection task and the corresponding anchors. The anchors are
used to interpret the model outputs.</p>
<p>The metric used to evaluate YOLO is the mean average precision (mAP) which is
the percentage of correct prediction and is given for an intersection over
union (IoU) ratio. Scores in this example are given for the standard IoU of
0.5 meaning that a detection is considered valid if the intersection over
union ratio with its ground truth equivalent is above 0.5.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>A call to <a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.detection.map_evaluation.MapEvaluation.evaluate_map">evaluate_map</a>
will preprocess the images, make the call to <code class="docutils literal notranslate"><span class="pre">Model.predict</span></code> and
use <a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.detection.processing.decode_output">decode_output</a>
before computing precision for all classes.</p>
</div>
</div></blockquote>
<p>Reported performanced for all training steps are as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 22%" />
<col style="width: 27%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Float</p></th>
<th class="head"><p>8-bit/8-bit</p></th>
<th class="head"><p>4-bit/4-bit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Global mAP</p></td>
<td><p>42.99 %</p></td>
<td><p>42.13 %</p></td>
<td><p>35.54 %</p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">timeit</span> <span class="kn">import</span> <span class="n">default_timer</span> <span class="k">as</span> <span class="n">timer</span>
<span class="kn">from</span> <span class="nn">akida_models</span> <span class="kn">import</span> <span class="n">yolo_voc_pretrained</span>
<span class="kn">from</span> <span class="nn">akida_models.detection.map_evaluation</span> <span class="kn">import</span> <span class="n">MapEvaluation</span>

<span class="c1"># Load the pretrained model along with anchors</span>
<span class="n">model_keras</span><span class="p">,</span> <span class="n">anchors</span> <span class="o">=</span> <span class="n">yolo_voc_pretrained</span><span class="p">()</span>

<span class="c1"># Define the final reshape and build the model</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">Reshape</span><span class="p">((</span><span class="n">grid_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">grid_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_anchors</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">classes</span><span class="p">),</span>
                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;YOLO_output&quot;</span><span class="p">)(</span><span class="n">model_keras</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
<span class="n">model_keras</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_keras</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

<span class="c1"># Create the mAP evaluator object</span>
<span class="n">num_images</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">map_evaluator</span> <span class="o">=</span> <span class="n">MapEvaluation</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span> <span class="n">val_data</span><span class="p">[:</span><span class="n">num_images</span><span class="p">],</span> <span class="n">labels</span><span class="p">,</span>
                              <span class="n">anchors</span><span class="p">)</span>

<span class="c1"># Compute the scores for all validation images</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
<span class="n">mAP</span><span class="p">,</span> <span class="n">average_precisions</span> <span class="o">=</span> <span class="n">map_evaluator</span><span class="o">.</span><span class="n">evaluate_map</span><span class="p">()</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">average_precision</span> <span class="ow">in</span> <span class="n">average_precisions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">average_precision</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mAP: </span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mAP</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Keras inference on </span><span class="si">{</span><span class="n">num_images</span><span class="si">}</span><span class="s1"> images took </span><span class="si">{</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> s.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading data from http://data.brainchip.com/dataset-mirror/voc/voc_anchors.pkl

8192/126 [==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================] - 0s 0us/step
Downloading data from http://data.brainchip.com/models/yolo/yolo_voc_iq8_wq4_aq4.h5

    8192/14122408 [..............................] - ETA: 28s
   65536/14122408 [..............................] - ETA: 14s
  204800/14122408 [..............................] - ETA: 8s 
  401408/14122408 [..............................] - ETA: 5s
  598016/14122408 [&gt;.............................] - ETA: 5s
  794624/14122408 [&gt;.............................] - ETA: 4s
  991232/14122408 [=&gt;............................] - ETA: 4s
 1187840/14122408 [=&gt;............................] - ETA: 4s
 1384448/14122408 [=&gt;............................] - ETA: 4s
 1581056/14122408 [==&gt;...........................] - ETA: 3s
 1777664/14122408 [==&gt;...........................] - ETA: 3s
 1974272/14122408 [===&gt;..........................] - ETA: 3s
 2170880/14122408 [===&gt;..........................] - ETA: 3s
 2367488/14122408 [====&gt;.........................] - ETA: 3s
 2564096/14122408 [====&gt;.........................] - ETA: 3s
 2760704/14122408 [====&gt;.........................] - ETA: 3s
 2957312/14122408 [=====&gt;........................] - ETA: 3s
 3153920/14122408 [=====&gt;........................] - ETA: 3s
 3350528/14122408 [======&gt;.......................] - ETA: 3s
 3547136/14122408 [======&gt;.......................] - ETA: 3s
 3743744/14122408 [======&gt;.......................] - ETA: 2s
 3940352/14122408 [=======&gt;......................] - ETA: 2s
 4136960/14122408 [=======&gt;......................] - ETA: 2s
 4333568/14122408 [========&gt;.....................] - ETA: 2s
 4530176/14122408 [========&gt;.....................] - ETA: 2s
 4726784/14122408 [=========&gt;....................] - ETA: 2s
 4923392/14122408 [=========&gt;....................] - ETA: 2s
 5120000/14122408 [=========&gt;....................] - ETA: 2s
 5316608/14122408 [==========&gt;...................] - ETA: 2s
 5513216/14122408 [==========&gt;...................] - ETA: 2s
 5709824/14122408 [===========&gt;..................] - ETA: 2s
 5906432/14122408 [===========&gt;..................] - ETA: 2s
 6103040/14122408 [===========&gt;..................] - ETA: 2s
 6299648/14122408 [============&gt;.................] - ETA: 2s
 6496256/14122408 [============&gt;.................] - ETA: 2s
 6692864/14122408 [=============&gt;................] - ETA: 2s
 6889472/14122408 [=============&gt;................] - ETA: 2s
 7086080/14122408 [==============&gt;...............] - ETA: 1s
 7282688/14122408 [==============&gt;...............] - ETA: 1s
 7479296/14122408 [==============&gt;...............] - ETA: 1s
 7675904/14122408 [===============&gt;..............] - ETA: 1s
 7872512/14122408 [===============&gt;..............] - ETA: 1s
 8069120/14122408 [================&gt;.............] - ETA: 1s
 8265728/14122408 [================&gt;.............] - ETA: 1s
 8462336/14122408 [================&gt;.............] - ETA: 1s
 8658944/14122408 [=================&gt;............] - ETA: 1s
 8855552/14122408 [=================&gt;............] - ETA: 1s
 9052160/14122408 [==================&gt;...........] - ETA: 1s
 9248768/14122408 [==================&gt;...........] - ETA: 1s
 9445376/14122408 [===================&gt;..........] - ETA: 1s
 9641984/14122408 [===================&gt;..........] - ETA: 1s
 9838592/14122408 [===================&gt;..........] - ETA: 1s
10035200/14122408 [====================&gt;.........] - ETA: 1s
10231808/14122408 [====================&gt;.........] - ETA: 1s
10428416/14122408 [=====================&gt;........] - ETA: 1s
10625024/14122408 [=====================&gt;........] - ETA: 0s
10821632/14122408 [=====================&gt;........] - ETA: 0s
11018240/14122408 [======================&gt;.......] - ETA: 0s
11214848/14122408 [======================&gt;.......] - ETA: 0s
11411456/14122408 [=======================&gt;......] - ETA: 0s
11608064/14122408 [=======================&gt;......] - ETA: 0s
11804672/14122408 [========================&gt;.....] - ETA: 0s
12001280/14122408 [========================&gt;.....] - ETA: 0s
12197888/14122408 [========================&gt;.....] - ETA: 0s
12394496/14122408 [=========================&gt;....] - ETA: 0s
12591104/14122408 [=========================&gt;....] - ETA: 0s
12787712/14122408 [==========================&gt;...] - ETA: 0s
12984320/14122408 [==========================&gt;...] - ETA: 0s
13180928/14122408 [===========================&gt;..] - ETA: 0s
13377536/14122408 [===========================&gt;..] - ETA: 0s
13574144/14122408 [===========================&gt;..] - ETA: 0s
13770752/14122408 [============================&gt;.] - ETA: 0s
13967360/14122408 [============================&gt;.] - ETA: 0s
14123008/14122408 [==============================] - 4s 0us/step
car 0.3496
person 0.3020
mAP: 0.3258
Keras inference on 100 images took 3.21 s.
</pre></div>
</div>
</div>
<div class="section" id="conversion-to-akida">
<h2>6. Conversion to Akida<a class="headerlink" href="#conversion-to-akida" title="Permalink to this headline">¶</a></h2>
<div class="section" id="convert-to-akida-model">
<h3>6.1 Convert to Akida model<a class="headerlink" href="#convert-to-akida-model" title="Permalink to this headline">¶</a></h3>
<p>Check model compatibility before akida conversion</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">check_model_compatibility</span>

<span class="n">compat</span> <span class="o">=</span> <span class="n">check_model_compatibility</span><span class="p">(</span><span class="n">model_keras</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The Keras quantized model is not compatible for a conversion to an Akida model:
 The Reshape layer YOLO_output can only be used to transform a tensor of shape (N,) to a tensor of shape (1, 1, N), and vice-versa. Receives input_shape (7, 7, 35) and output_shape (7, 7, 5, 7).
</pre></div>
</div>
<p>The last YOLO_output layer that was added for splitting channels into values
for each box must be removed before akida conversion.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rebuild a model without the last layer</span>
<span class="n">compatible_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_keras</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">model_keras</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>When converting to an Akida model, we just need to pass the Keras model
and the input scaling that was used during training to <a class="reference external" href="../api_reference/cnn2snn_apis.html#convert">CNN2SNN convert</a>. In YOLO
<a class="reference external" href="../api_reference/akida_models_apis.html#akida_models.detection.processing.preprocess_image">preprocess_image</a>
function, images are zero centered and normalized between [-1, 1] hence the
scaling values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cnn2snn</span> <span class="kn">import</span> <span class="n">convert</span>

<span class="n">model_akida</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">compatible_model</span><span class="p">,</span> <span class="n">input_scaling</span><span class="o">=</span><span class="p">(</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">127.5</span><span class="p">))</span>
<span class="n">model_akida</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>                                         Model Summary
_______________________________________________________________________________________________
Layer (type)                              Output shape    Kernel shape
===============================================================================================
conv_0 (InputConvolutional)               [112, 112, 16]  (3, 3, 3, 16)
_______________________________________________________________________________________________
separable_1 (SeparableConvolutional)      [112, 112, 32]  (3, 3, 16, 1), (1, 1, 16, 32)
_______________________________________________________________________________________________
separable_2 (SeparableConvolutional)      [56, 56, 64]    (3, 3, 32, 1), (1, 1, 32, 64)
_______________________________________________________________________________________________
separable_3 (SeparableConvolutional)      [56, 56, 64]    (3, 3, 64, 1), (1, 1, 64, 64)
_______________________________________________________________________________________________
separable_4 (SeparableConvolutional)      [28, 28, 128]   (3, 3, 64, 1), (1, 1, 64, 128)
_______________________________________________________________________________________________
separable_5 (SeparableConvolutional)      [28, 28, 128]   (3, 3, 128, 1), (1, 1, 128, 128)
_______________________________________________________________________________________________
separable_6 (SeparableConvolutional)      [14, 14, 256]   (3, 3, 128, 1), (1, 1, 128, 256)
_______________________________________________________________________________________________
separable_7 (SeparableConvolutional)      [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_______________________________________________________________________________________________
separable_8 (SeparableConvolutional)      [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_______________________________________________________________________________________________
separable_9 (SeparableConvolutional)      [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_______________________________________________________________________________________________
separable_10 (SeparableConvolutional)     [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_______________________________________________________________________________________________
separable_11 (SeparableConvolutional)     [14, 14, 256]   (3, 3, 256, 1), (1, 1, 256, 256)
_______________________________________________________________________________________________
separable_12 (SeparableConvolutional)     [7, 7, 512]     (3, 3, 256, 1), (1, 1, 256, 512)
_______________________________________________________________________________________________
separable_13 (SeparableConvolutional)     [7, 7, 512]     (3, 3, 512, 1), (1, 1, 512, 512)
_______________________________________________________________________________________________
1conv (SeparableConvolutional)            [7, 7, 1024]    (3, 3, 512, 1), (1, 1, 512, 1024)
_______________________________________________________________________________________________
2conv (SeparableConvolutional)            [7, 7, 1024]    (3, 3, 1024, 1), (1, 1, 1024, 1024)
_______________________________________________________________________________________________
3conv (SeparableConvolutional)            [7, 7, 1024]    (3, 3, 1024, 1), (1, 1, 1024, 1024)
_______________________________________________________________________________________________
detection_layer (SeparableConvolutional)  [7, 7, 35]      (3, 3, 1024, 1), (1, 1, 1024, 35)
_______________________________________________________________________________________________
Input shape: 224, 224, 3
Backend type: Software - 1.8.9
</pre></div>
</div>
</div>
<div class="section" id="check-performance">
<h3>6.1 Check performance<a class="headerlink" href="#check-performance" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Akida model accuracy is tested on the first <em>n</em> images of the validation set.</p>
<p>The table below summarizes the expected results:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 35%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>#Images</p></th>
<th class="head"><p>Keras mAP</p></th>
<th class="head"><p>Akida mAP</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>100</p></td>
<td><p>26.70 %</p></td>
<td><p>29.87 %</p></td>
</tr>
<tr class="row-odd"><td><p>1000</p></td>
<td><p>32.95 %</p></td>
<td><p>33.47 %</p></td>
</tr>
<tr class="row-even"><td><p>2500</p></td>
<td><p>35.54 %</p></td>
<td><p>31.65 %</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the mAP evaluator object</span>
<span class="n">map_evaluator_ak</span> <span class="o">=</span> <span class="n">MapEvaluation</span><span class="p">(</span><span class="n">model_akida</span><span class="p">,</span>
                                 <span class="n">val_data</span><span class="p">[:</span><span class="n">num_images</span><span class="p">],</span>
                                 <span class="n">labels</span><span class="p">,</span>
                                 <span class="n">anchors</span><span class="p">,</span>
                                 <span class="n">is_keras_model</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Compute the scores for all validation images</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
<span class="n">mAP_ak</span><span class="p">,</span> <span class="n">average_precisions_ak</span> <span class="o">=</span> <span class="n">map_evaluator_ak</span><span class="o">.</span><span class="n">evaluate_map</span><span class="p">()</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">average_precision</span> <span class="ow">in</span> <span class="n">average_precisions_ak</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">average_precision</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mAP: </span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mAP_ak</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Akida inference on </span><span class="si">{</span><span class="n">num_images</span><span class="si">}</span><span class="s1"> images took </span><span class="si">{</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> s.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>car 0.4114
person 0.3006
mAP: 0.3560
Akida inference on 100 images took 19.41 s.
</pre></div>
</div>
</div>
<div class="section" id="show-predictions-for-a-random-image">
<h3>6.2 Show predictions for a random image<a class="headerlink" href="#show-predictions-for-a-random-image" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>

<span class="kn">from</span> <span class="nn">akida_models.detection.processing</span> <span class="kn">import</span> <span class="n">load_image</span><span class="p">,</span> <span class="n">preprocess_image</span><span class="p">,</span> <span class="n">decode_output</span>

<span class="c1"># Take a random test image</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val_data</span><span class="p">))</span>

<span class="n">input_shape</span> <span class="o">=</span> <span class="n">model_akida</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">input_dims</span>

<span class="c1"># Load the image</span>
<span class="n">raw_image</span> <span class="o">=</span> <span class="n">load_image</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;image_path&#39;</span><span class="p">])</span>

<span class="c1"># Keep the original image size for later bounding boxes rescaling</span>
<span class="n">raw_height</span><span class="p">,</span> <span class="n">raw_width</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">raw_image</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># Pre-process the image</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">preprocess_image</span><span class="p">(</span><span class="n">raw_image</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">input_image</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Call evaluate on the image</span>
<span class="n">pots</span> <span class="o">=</span> <span class="n">model_akida</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">input_image</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Reshape the potentials to prepare for decoding</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">pots</span><span class="o">.</span><span class="n">shape</span>
<span class="n">pots</span> <span class="o">=</span> <span class="n">pots</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">anchors</span><span class="p">),</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>

<span class="c1"># Akida potentials are transposed because they are given in (W,H) format while</span>
<span class="c1"># the decode_output API uses the Keras-style (H,W).</span>
<span class="n">pots</span> <span class="o">=</span> <span class="n">pots</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Decode potentials into bounding boxes</span>
<span class="n">raw_boxes</span> <span class="o">=</span> <span class="n">decode_output</span><span class="p">(</span><span class="n">pots</span><span class="p">,</span> <span class="n">anchors</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>

<span class="c1"># Rescale boxes to the original image size</span>
<span class="n">pred_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>
    <span class="n">box</span><span class="o">.</span><span class="n">x1</span> <span class="o">*</span> <span class="n">raw_width</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y1</span> <span class="o">*</span> <span class="n">raw_height</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">x2</span> <span class="o">*</span> <span class="n">raw_width</span><span class="p">,</span>
    <span class="n">box</span><span class="o">.</span><span class="n">y2</span> <span class="o">*</span> <span class="n">raw_height</span><span class="p">,</span>
    <span class="n">box</span><span class="o">.</span><span class="n">get_label</span><span class="p">(),</span>
    <span class="n">box</span><span class="o">.</span><span class="n">get_score</span><span class="p">()</span>
<span class="p">]</span> <span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">raw_boxes</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
    <span class="n">num</span><span class="o">=</span><span class="s1">&#39;VOC2012 car and person detection by Akida Execution Engine&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">img_plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">raw_image</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
<span class="n">img_plot</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">raw_image</span><span class="p">)</span>

<span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">pred_boxes</span><span class="p">:</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                             <span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                             <span class="n">box</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                             <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
    <span class="n">class_score</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                          <span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span>
                          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="mi">4</span><span class="p">])]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">box</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="plot voc yolo detection" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_voc_yolo_detection_001.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  36.912 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-plot-voc-yolo-detection-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0afd19042f76dc39782a01ac23ff7469/plot_voc_yolo_detection.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_voc_yolo_detection.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c4f2a720eb409e9f2a62889e6ac7b85b/plot_voc_yolo_detection.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_voc_yolo_detection.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_transfer_learning.html" class="btn btn-neutral float-right" title="Transfer learning with MobileNet for cats vs. dogs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_ds_cnn_cifar10.html" class="btn btn-neutral float-left" title="DS-CNN CIFAR10 inference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Copyright 2020, BrainChip Holdings Ltd. All Rights Reserved.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>